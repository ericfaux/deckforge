const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/modals-B-GZkgh0.js","assets/vendor-ui-CmCnxUsc.js","assets/vendor-supabase-CoxeBSpk.js","assets/AnimationPreview-CfGDygZy.js","assets/vendor-react-DgPjhwkL.js","assets/TemplateGalleryModal-Dwd19IvD.js"])))=>i.map(i=>d[i]);
var cl=Object.defineProperty;var kn=t=>{throw TypeError(t)};var dl=(t,r,s)=>r in t?cl(t,r,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[r]=s;var or=(t,r,s)=>dl(t,typeof r!="symbol"?r+"":r,s),hs=(t,r,s)=>r.has(t)||kn("Cannot "+s);var U=(t,r,s)=>(hs(t,r,"read from private field"),s?s.call(t):r.get(t)),xe=(t,r,s)=>r.has(t)?kn("Cannot add the same private member more than once"):r instanceof WeakSet?r.add(t):r.set(t,s),he=(t,r,s,n)=>(hs(t,r,"write to private field"),n?n.call(t,s):r.set(t,s),s),ze=(t,r,s)=>(hs(t,r,"access private method"),s);var kr=(t,r,s,n)=>({set _(a){he(t,r,a,s)},get _(){return U(t,r,n)}});import{j as e,c as wa,a as xt,u as Oe,P as ke,B as ul,b as At,d as yr,e as ye,f as lr,R as hl,g as ja,h as cr,i as fl,k as be,l as pl,m as ml,D as Na,n as Hr,o as X,p as Ee,S as _t,q as ka,r as Ca,s as Qt,t as Jt,v as gt,w as fs,x as xl,L as ae,I as Ae,y as gl,z as yl,A as vl,F as bl,C as _a,E as wl,G as jl,H as Nl,J as kl,K as Cl,M as _l,N as Sl,W as bs,O as Or,Q as Sa,T as Cn,U as El,V as Ue,X as Fe,Y as Ea,Z as Al,_ as we}from"./modals-B-GZkgh0.js";import{a as Ms,r as C,b as De,X as vr,am as Pl,an as _n,ao as Tl,ap as Rl,aa as $s,aq as Aa,ar as Pa,af as Ta,as as Bs,at as Us,ae as Wr,a5 as Fr,au as Ir,av as Dl,aw as Ol,ax as Fl,ay as Il,az as zl,aA as Ll,aB as Ml,V as Sn,aC as $l,aD as Bl,aE as Ul,aF as Vl,g as Vs,aG as Hl,aH as Wl,aI as Gl,p as ql,D as Kl,F as Yl,B as Zl,o as Xl,n as Ql,aJ as Jl,aK as ec,z as tc,y as rc,x as Ra,w as zr,t as Hs,s as at,q as Qe,H as sc,Q as nc,P as ac,O as ic,N as oc,K as lc,J as cc,I as Da,A as dc,aL as uc,aM as hc,aN as fc,aO as pc,a2 as mc,a1 as xc,a0 as gc,$ as yc,_ as vc,Y as bc,E as $t,aP as wc,aQ as jc,aR as Nc,aS as kc,u as J,a3 as We,T as Pt,aT as Oa,aU as Cc,aV as _c,aW as Sc,aX as dr,ad as Fa,aY as Ec,j as Ia,ah as lt,L as Ac,aZ as Pc,a_ as Tc,k as Rc,l as Dc,a9 as Oc,a$ as Fc,b0 as Ic,b1 as zc,b2 as Lc,b3 as Mc,b4 as $c,b5 as Bc,b6 as Uc,m as Vc,G as Hc,i as Wc,b7 as za,U as La,c as Ma,b8 as Gc,a6 as Ws,a7 as $a,b9 as En,ab as Ba,ba as qc,bb as An,bc as Kc,bd as Cr,be as Yc,bf as Zc,bg as Xc,bh as Qc,bi as Pn,bj as Tn,bk as Ua,bl as Jc,bm as ed,bn as Gs,bo as td,C as Rn,bp as rd,bq as sd,br as qs,bs as nd,bt as ad,bu as Dn,bv as id}from"./vendor-ui-CmCnxUsc.js";import{u as qe,a as Va,b as od,B as ld,R as cd,c as Ke}from"./vendor-react-DgPjhwkL.js";import"./vendor-supabase-CoxeBSpk.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const l of i.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function s(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(a){if(a.ep)return;a.ep=!0;const i=s(a);fetch(a.href,i)}})();var Ha,On=Ms;Ha=On.createRoot,On.hydrateRoot;function Fn(t){const r=dd(t),s=C.forwardRef((n,a)=>{const{children:i,...l}=n,o=C.Children.toArray(i),c=o.find(hd);if(c){const f=c.props.children,m=o.map(p=>p===c?C.Children.count(f)>1?C.Children.only(null):C.isValidElement(f)?f.props.children:null:p);return e.jsx(r,{...l,ref:a,children:C.isValidElement(f)?C.cloneElement(f,void 0,m):null})}return e.jsx(r,{...l,ref:a,children:i})});return s.displayName=`${t}.Slot`,s}function dd(t){const r=C.forwardRef((s,n)=>{const{children:a,...i}=s;if(C.isValidElement(a)){const l=pd(a),o=fd(i,a.props);return a.type!==C.Fragment&&(o.ref=n?wa(n,l):l),C.cloneElement(a,o)}return C.Children.count(a)>1?C.Children.only(null):null});return r.displayName=`${t}.SlotClone`,r}var ud=Symbol("radix.slottable");function hd(t){return C.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===ud}function fd(t,r){const s={...r};for(const n in r){const a=t[n],i=r[n];/^on[A-Z]/.test(n)?a&&i?s[n]=(...o)=>{const c=i(...o);return a(...o),c}:a&&(s[n]=a):n==="style"?s[n]={...a,...i}:n==="className"&&(s[n]=[a,i].filter(Boolean).join(" "))}return{...t,...s}}function pd(t){var n,a;let r=(n=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:n.get,s=r&&"isReactWarning"in r&&r.isReactWarning;return s?t.ref:(r=(a=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:a.get,s=r&&"isReactWarning"in r&&r.isReactWarning,s?t.props.ref:t.props.ref||t.ref)}function Ks(t){const r=t+"CollectionProvider",[s,n]=xt(r),[a,i]=s(r,{collectionRef:{current:null},itemMap:new Map}),l=d=>{const{scope:u,children:g}=d,x=De.useRef(null),j=De.useRef(new Map).current;return e.jsx(a,{scope:u,itemMap:j,collectionRef:x,children:g})};l.displayName=r;const o=t+"CollectionSlot",c=Fn(o),f=De.forwardRef((d,u)=>{const{scope:g,children:x}=d,j=i(o,g),k=Oe(u,j.collectionRef);return e.jsx(c,{ref:k,children:x})});f.displayName=o;const m=t+"CollectionItemSlot",p="data-radix-collection-item",b=Fn(m),h=De.forwardRef((d,u)=>{const{scope:g,children:x,...j}=d,k=De.useRef(null),N=Oe(u,k),P=i(m,g);return De.useEffect(()=>(P.itemMap.set(k,{ref:k,...j}),()=>void P.itemMap.delete(k))),e.jsx(b,{[p]:"",ref:N,children:x})});h.displayName=m;function w(d){const u=i(t+"CollectionConsumer",d);return De.useCallback(()=>{const x=u.collectionRef.current;if(!x)return[];const j=Array.from(x.querySelectorAll(`[${p}]`));return Array.from(u.itemMap.values()).sort((P,A)=>j.indexOf(P.ref.current)-j.indexOf(A.ref.current))},[u.collectionRef,u.itemMap])}return[{Provider:l,Slot:f,ItemSlot:h},w,n]}var md=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),xd="VisuallyHidden",Gr=C.forwardRef((t,r)=>e.jsx(ke.span,{...t,ref:r,style:{...md,...t.style}}));Gr.displayName=xd;var gd=Gr,Ys="ToastProvider",[Zs,yd,vd]=Ks("Toast"),[Wa]=xt("Toast",[vd]),[bd,qr]=Wa(Ys),Ga=t=>{const{__scopeToast:r,label:s="Notification",duration:n=5e3,swipeDirection:a="right",swipeThreshold:i=50,children:l}=t,[o,c]=C.useState(null),[f,m]=C.useState(0),p=C.useRef(!1),b=C.useRef(!1);return s.trim()||console.error(`Invalid prop \`label\` supplied to \`${Ys}\`. Expected non-empty \`string\`.`),e.jsx(Zs.Provider,{scope:r,children:e.jsx(bd,{scope:r,label:s,duration:n,swipeDirection:a,swipeThreshold:i,toastCount:f,viewport:o,onViewportChange:c,onToastAdd:C.useCallback(()=>m(h=>h+1),[]),onToastRemove:C.useCallback(()=>m(h=>h-1),[]),isFocusedToastEscapeKeyDownRef:p,isClosePausedRef:b,children:l})})};Ga.displayName=Ys;var qa="ToastViewport",wd=["F8"],ws="toast.viewportPause",js="toast.viewportResume",Ka=C.forwardRef((t,r)=>{const{__scopeToast:s,hotkey:n=wd,label:a="Notifications ({hotkey})",...i}=t,l=qr(qa,s),o=yd(s),c=C.useRef(null),f=C.useRef(null),m=C.useRef(null),p=C.useRef(null),b=Oe(r,p,l.onViewportChange),h=n.join("+").replace(/Key/g,"").replace(/Digit/g,""),w=l.toastCount>0;C.useEffect(()=>{const u=g=>{var j;n.length!==0&&n.every(k=>g[k]||g.code===k)&&((j=p.current)==null||j.focus())};return document.addEventListener("keydown",u),()=>document.removeEventListener("keydown",u)},[n]),C.useEffect(()=>{const u=c.current,g=p.current;if(w&&u&&g){const x=()=>{if(!l.isClosePausedRef.current){const P=new CustomEvent(ws);g.dispatchEvent(P),l.isClosePausedRef.current=!0}},j=()=>{if(l.isClosePausedRef.current){const P=new CustomEvent(js);g.dispatchEvent(P),l.isClosePausedRef.current=!1}},k=P=>{!u.contains(P.relatedTarget)&&j()},N=()=>{u.contains(document.activeElement)||j()};return u.addEventListener("focusin",x),u.addEventListener("focusout",k),u.addEventListener("pointermove",x),u.addEventListener("pointerleave",N),window.addEventListener("blur",x),window.addEventListener("focus",j),()=>{u.removeEventListener("focusin",x),u.removeEventListener("focusout",k),u.removeEventListener("pointermove",x),u.removeEventListener("pointerleave",N),window.removeEventListener("blur",x),window.removeEventListener("focus",j)}}},[w,l.isClosePausedRef]);const d=C.useCallback(({tabbingDirection:u})=>{const x=o().map(j=>{const k=j.ref.current,N=[k,...Od(k)];return u==="forwards"?N:N.reverse()});return(u==="forwards"?x.reverse():x).flat()},[o]);return C.useEffect(()=>{const u=p.current;if(u){const g=x=>{var N,P,A;const j=x.altKey||x.ctrlKey||x.metaKey;if(x.key==="Tab"&&!j){const F=document.activeElement,R=x.shiftKey;if(x.target===u&&R){(N=f.current)==null||N.focus();return}const _=d({tabbingDirection:R?"backwards":"forwards"}),D=_.findIndex(y=>y===F);ps(_.slice(D+1))?x.preventDefault():R?(P=f.current)==null||P.focus():(A=m.current)==null||A.focus()}};return u.addEventListener("keydown",g),()=>u.removeEventListener("keydown",g)}},[o,d]),e.jsxs(ul,{ref:c,role:"region","aria-label":a.replace("{hotkey}",h),tabIndex:-1,style:{pointerEvents:w?void 0:"none"},children:[w&&e.jsx(Ns,{ref:f,onFocusFromOutsideViewport:()=>{const u=d({tabbingDirection:"forwards"});ps(u)}}),e.jsx(Zs.Slot,{scope:s,children:e.jsx(ke.ol,{tabIndex:-1,...i,ref:b})}),w&&e.jsx(Ns,{ref:m,onFocusFromOutsideViewport:()=>{const u=d({tabbingDirection:"backwards"});ps(u)}})]})});Ka.displayName=qa;var Ya="ToastFocusProxy",Ns=C.forwardRef((t,r)=>{const{__scopeToast:s,onFocusFromOutsideViewport:n,...a}=t,i=qr(Ya,s);return e.jsx(Gr,{tabIndex:0,...a,ref:r,style:{position:"fixed"},onFocus:l=>{var f;const o=l.relatedTarget;!((f=i.viewport)!=null&&f.contains(o))&&n()}})});Ns.displayName=Ya;var br="Toast",jd="toast.swipeStart",Nd="toast.swipeMove",kd="toast.swipeCancel",Cd="toast.swipeEnd",Za=C.forwardRef((t,r)=>{const{forceMount:s,open:n,defaultOpen:a,onOpenChange:i,...l}=t,[o,c]=At({prop:n,defaultProp:a??!0,onChange:i,caller:br});return e.jsx(yr,{present:s||o,children:e.jsx(Ed,{open:o,...l,ref:r,onClose:()=>c(!1),onPause:lr(t.onPause),onResume:lr(t.onResume),onSwipeStart:ye(t.onSwipeStart,f=>{f.currentTarget.setAttribute("data-swipe","start")}),onSwipeMove:ye(t.onSwipeMove,f=>{const{x:m,y:p}=f.detail.delta;f.currentTarget.setAttribute("data-swipe","move"),f.currentTarget.style.setProperty("--radix-toast-swipe-move-x",`${m}px`),f.currentTarget.style.setProperty("--radix-toast-swipe-move-y",`${p}px`)}),onSwipeCancel:ye(t.onSwipeCancel,f=>{f.currentTarget.setAttribute("data-swipe","cancel"),f.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),f.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),f.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),f.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")}),onSwipeEnd:ye(t.onSwipeEnd,f=>{const{x:m,y:p}=f.detail.delta;f.currentTarget.setAttribute("data-swipe","end"),f.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),f.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),f.currentTarget.style.setProperty("--radix-toast-swipe-end-x",`${m}px`),f.currentTarget.style.setProperty("--radix-toast-swipe-end-y",`${p}px`),c(!1)})})})});Za.displayName=br;var[_d,Sd]=Wa(br,{onClose(){}}),Ed=C.forwardRef((t,r)=>{const{__scopeToast:s,type:n="foreground",duration:a,open:i,onClose:l,onEscapeKeyDown:o,onPause:c,onResume:f,onSwipeStart:m,onSwipeMove:p,onSwipeCancel:b,onSwipeEnd:h,...w}=t,d=qr(br,s),[u,g]=C.useState(null),x=Oe(r,y=>g(y)),j=C.useRef(null),k=C.useRef(null),N=a||d.duration,P=C.useRef(0),A=C.useRef(N),F=C.useRef(0),{onToastAdd:R,onToastRemove:B}=d,K=lr(()=>{var O;(u==null?void 0:u.contains(document.activeElement))&&((O=d.viewport)==null||O.focus()),l()}),_=C.useCallback(y=>{!y||y===1/0||(window.clearTimeout(F.current),P.current=new Date().getTime(),F.current=window.setTimeout(K,y))},[K]);C.useEffect(()=>{const y=d.viewport;if(y){const O=()=>{_(A.current),f==null||f()},ee=()=>{const M=new Date().getTime()-P.current;A.current=A.current-M,window.clearTimeout(F.current),c==null||c()};return y.addEventListener(ws,ee),y.addEventListener(js,O),()=>{y.removeEventListener(ws,ee),y.removeEventListener(js,O)}}},[d.viewport,N,c,f,_]),C.useEffect(()=>{i&&!d.isClosePausedRef.current&&_(N)},[i,N,d.isClosePausedRef,_]),C.useEffect(()=>(R(),()=>B()),[R,B]);const D=C.useMemo(()=>u?si(u):null,[u]);return d.viewport?e.jsxs(e.Fragment,{children:[D&&e.jsx(Ad,{__scopeToast:s,role:"status","aria-live":n==="foreground"?"assertive":"polite",children:D}),e.jsx(_d,{scope:s,onClose:K,children:Ms.createPortal(e.jsx(Zs.ItemSlot,{scope:s,children:e.jsx(hl,{asChild:!0,onEscapeKeyDown:ye(o,()=>{d.isFocusedToastEscapeKeyDownRef.current||K(),d.isFocusedToastEscapeKeyDownRef.current=!1}),children:e.jsx(ke.li,{tabIndex:0,"data-state":i?"open":"closed","data-swipe-direction":d.swipeDirection,...w,ref:x,style:{userSelect:"none",touchAction:"none",...t.style},onKeyDown:ye(t.onKeyDown,y=>{y.key==="Escape"&&(o==null||o(y.nativeEvent),y.nativeEvent.defaultPrevented||(d.isFocusedToastEscapeKeyDownRef.current=!0,K()))}),onPointerDown:ye(t.onPointerDown,y=>{y.button===0&&(j.current={x:y.clientX,y:y.clientY})}),onPointerMove:ye(t.onPointerMove,y=>{if(!j.current)return;const O=y.clientX-j.current.x,ee=y.clientY-j.current.y,M=!!k.current,Z=["left","right"].includes(d.swipeDirection),V=["left","up"].includes(d.swipeDirection)?Math.min:Math.max,ie=Z?V(0,O):0,L=Z?0:V(0,ee),z=y.pointerType==="touch"?10:2,le={x:ie,y:L},se={originalEvent:y,delta:le};M?(k.current=le,_r(Nd,p,se,{discrete:!1})):In(le,d.swipeDirection,z)?(k.current=le,_r(jd,m,se,{discrete:!1}),y.target.setPointerCapture(y.pointerId)):(Math.abs(O)>z||Math.abs(ee)>z)&&(j.current=null)}),onPointerUp:ye(t.onPointerUp,y=>{const O=k.current,ee=y.target;if(ee.hasPointerCapture(y.pointerId)&&ee.releasePointerCapture(y.pointerId),k.current=null,j.current=null,O){const M=y.currentTarget,Z={originalEvent:y,delta:O};In(O,d.swipeDirection,d.swipeThreshold)?_r(Cd,h,Z,{discrete:!0}):_r(kd,b,Z,{discrete:!0}),M.addEventListener("click",V=>V.preventDefault(),{once:!0})}})})})}),d.viewport)})]}):null}),Ad=t=>{const{__scopeToast:r,children:s,...n}=t,a=qr(br,r),[i,l]=C.useState(!1),[o,c]=C.useState(!1);return Rd(()=>l(!0)),C.useEffect(()=>{const f=window.setTimeout(()=>c(!0),1e3);return()=>window.clearTimeout(f)},[]),o?null:e.jsx(ja,{asChild:!0,children:e.jsx(Gr,{...n,children:i&&e.jsxs(e.Fragment,{children:[a.label," ",s]})})})},Pd="ToastTitle",Xa=C.forwardRef((t,r)=>{const{__scopeToast:s,...n}=t;return e.jsx(ke.div,{...n,ref:r})});Xa.displayName=Pd;var Td="ToastDescription",Qa=C.forwardRef((t,r)=>{const{__scopeToast:s,...n}=t;return e.jsx(ke.div,{...n,ref:r})});Qa.displayName=Td;var Ja="ToastAction",ei=C.forwardRef((t,r)=>{const{altText:s,...n}=t;return s.trim()?e.jsx(ri,{altText:s,asChild:!0,children:e.jsx(Xs,{...n,ref:r})}):(console.error(`Invalid prop \`altText\` supplied to \`${Ja}\`. Expected non-empty \`string\`.`),null)});ei.displayName=Ja;var ti="ToastClose",Xs=C.forwardRef((t,r)=>{const{__scopeToast:s,...n}=t,a=Sd(ti,s);return e.jsx(ri,{asChild:!0,children:e.jsx(ke.button,{type:"button",...n,ref:r,onClick:ye(t.onClick,a.onClose)})})});Xs.displayName=ti;var ri=C.forwardRef((t,r)=>{const{__scopeToast:s,altText:n,...a}=t;return e.jsx(ke.div,{"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":n||void 0,...a,ref:r})});function si(t){const r=[];return Array.from(t.childNodes).forEach(n=>{if(n.nodeType===n.TEXT_NODE&&n.textContent&&r.push(n.textContent),Dd(n)){const a=n.ariaHidden||n.hidden||n.style.display==="none",i=n.dataset.radixToastAnnounceExclude==="";if(!a)if(i){const l=n.dataset.radixToastAnnounceAlt;l&&r.push(l)}else r.push(...si(n))}}),r}function _r(t,r,s,{discrete:n}){const a=s.originalEvent.currentTarget,i=new CustomEvent(t,{bubbles:!0,cancelable:!0,detail:s});r&&a.addEventListener(t,r,{once:!0}),n?fl(a,i):a.dispatchEvent(i)}var In=(t,r,s=0)=>{const n=Math.abs(t.x),a=Math.abs(t.y),i=n>a;return r==="left"||r==="right"?i&&n>s:!i&&a>s};function Rd(t=()=>{}){const r=lr(t);cr(()=>{let s=0,n=0;return s=window.requestAnimationFrame(()=>n=window.requestAnimationFrame(r)),()=>{window.cancelAnimationFrame(s),window.cancelAnimationFrame(n)}},[r])}function Dd(t){return t.nodeType===t.ELEMENT_NODE}function Od(t){const r=[],s=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>{const a=n.tagName==="INPUT"&&n.type==="hidden";return n.disabled||n.hidden||a?NodeFilter.FILTER_SKIP:n.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;s.nextNode();)r.push(s.currentNode);return r}function ps(t){const r=document.activeElement;return t.some(s=>s===r?!0:(s.focus(),document.activeElement!==r))}var Fd=Ga,ni=Ka,ai=Za,ii=Xa,oi=Qa,li=ei,ci=Xs;const Id=Fd,di=C.forwardRef(({className:t,...r},s)=>e.jsx(ni,{ref:s,className:be("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",t),...r}));di.displayName=ni.displayName;const zd=pl("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),ui=C.forwardRef(({className:t,variant:r,...s},n)=>e.jsx(ai,{ref:n,className:be(zd({variant:r}),t),...s}));ui.displayName=ai.displayName;const Ld=C.forwardRef(({className:t,...r},s)=>e.jsx(li,{ref:s,className:be("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors group-[.destructive]:border-muted/40 hover:bg-secondary group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 group-[.destructive]:focus:ring-destructive disabled:pointer-events-none disabled:opacity-50",t),...r}));Ld.displayName=li.displayName;const hi=C.forwardRef(({className:t,...r},s)=>e.jsx(ci,{ref:s,className:be("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity group-hover:opacity-100 group-[.destructive]:text-red-300 hover:text-foreground group-[.destructive]:hover:text-red-50 focus:opacity-100 focus:outline-none focus:ring-2 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",t),"toast-close":"",...r,children:e.jsx(vr,{className:"h-4 w-4"})}));hi.displayName=ci.displayName;const fi=C.forwardRef(({className:t,...r},s)=>e.jsx(ii,{ref:s,className:be("text-sm font-semibold",t),...r}));fi.displayName=ii.displayName;const pi=C.forwardRef(({className:t,...r},s)=>e.jsx(oi,{ref:s,className:be("text-sm opacity-90",t),...r}));pi.displayName=oi.displayName;function Md(){const{toasts:t}=ml();return e.jsxs(Id,{children:[t.map(function({id:r,title:s,description:n,action:a,...i}){return e.jsxs(ui,{...i,children:[e.jsxs("div",{className:"grid gap-1",children:[s&&e.jsx(fi,{children:s}),n&&e.jsx(pi,{children:n})]}),a,e.jsx(hi,{})]},r)}),e.jsx(di,{})]})}var zn=["light","dark"],$d="(prefers-color-scheme: dark)",Bd=C.createContext(void 0),Ud={setTheme:t=>{},themes:[]},Vd=()=>{var t;return(t=C.useContext(Bd))!=null?t:Ud};C.memo(({forcedTheme:t,storageKey:r,attribute:s,enableSystem:n,enableColorScheme:a,defaultTheme:i,value:l,attrs:o,nonce:c})=>{let f=i==="system",m=s==="class"?`var d=document.documentElement,c=d.classList;${`c.remove(${o.map(w=>`'${w}'`).join(",")})`};`:`var d=document.documentElement,n='${s}',s='setAttribute';`,p=a?zn.includes(i)&&i?`if(e==='light'||e==='dark'||!e)d.style.colorScheme=e||'${i}'`:"if(e==='light'||e==='dark')d.style.colorScheme=e":"",b=(w,d=!1,u=!0)=>{let g=l?l[w]:w,x=d?w+"|| ''":`'${g}'`,j="";return a&&u&&!d&&zn.includes(w)&&(j+=`d.style.colorScheme = '${w}';`),s==="class"?d||g?j+=`c.add(${x})`:j+="null":g&&(j+=`d[s](n,${x})`),j},h=t?`!function(){${m}${b(t)}}()`:n?`!function(){try{${m}var e=localStorage.getItem('${r}');if('system'===e||(!e&&${f})){var t='${$d}',m=window.matchMedia(t);if(m.media!==t||m.matches){${b("dark")}}else{${b("light")}}}else if(e){${l?`var x=${JSON.stringify(l)};`:""}${b(l?"x[e]":"e",!0)}}${f?"":"else{"+b(i,!1,!1)+"}"}${p}}catch(e){}}()`:`!function(){try{${m}var e=localStorage.getItem('${r}');if(e){${l?`var x=${JSON.stringify(l)};`:""}${b(l?"x[e]":"e",!0)}}else{${b(i,!1,!1)};}${p}}catch(t){}}();`;return C.createElement("script",{nonce:c,dangerouslySetInnerHTML:{__html:h}})});const Hd=({...t})=>{const{theme:r="system"}=Vd();return e.jsx(Pl,{theme:r,className:"toaster group",toastOptions:{classNames:{toast:"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg",description:"group-[.toast]:text-muted-foreground",actionButton:"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground",cancelButton:"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground"}},...t})},Wd=["top","right","bottom","left"],St=Math.min,Ve=Math.max,Lr=Math.round,Sr=Math.floor,ct=t=>({x:t,y:t}),Gd={left:"right",right:"left",bottom:"top",top:"bottom"},qd={start:"end",end:"start"};function ks(t,r,s){return Ve(t,St(r,s))}function pt(t,r){return typeof t=="function"?t(r):t}function mt(t){return t.split("-")[0]}function sr(t){return t.split("-")[1]}function Qs(t){return t==="x"?"y":"x"}function Js(t){return t==="y"?"height":"width"}const Kd=new Set(["top","bottom"]);function it(t){return Kd.has(mt(t))?"y":"x"}function en(t){return Qs(it(t))}function Yd(t,r,s){s===void 0&&(s=!1);const n=sr(t),a=en(t),i=Js(a);let l=a==="x"?n===(s?"end":"start")?"right":"left":n==="start"?"bottom":"top";return r.reference[i]>r.floating[i]&&(l=Mr(l)),[l,Mr(l)]}function Zd(t){const r=Mr(t);return[Cs(t),r,Cs(r)]}function Cs(t){return t.replace(/start|end/g,r=>qd[r])}const Ln=["left","right"],Mn=["right","left"],Xd=["top","bottom"],Qd=["bottom","top"];function Jd(t,r,s){switch(t){case"top":case"bottom":return s?r?Mn:Ln:r?Ln:Mn;case"left":case"right":return r?Xd:Qd;default:return[]}}function eu(t,r,s,n){const a=sr(t);let i=Jd(mt(t),s==="start",n);return a&&(i=i.map(l=>l+"-"+a),r&&(i=i.concat(i.map(Cs)))),i}function Mr(t){return t.replace(/left|right|bottom|top/g,r=>Gd[r])}function tu(t){return{top:0,right:0,bottom:0,left:0,...t}}function mi(t){return typeof t!="number"?tu(t):{top:t,right:t,bottom:t,left:t}}function $r(t){const{x:r,y:s,width:n,height:a}=t;return{width:n,height:a,top:s,left:r,right:r+n,bottom:s+a,x:r,y:s}}function $n(t,r,s){let{reference:n,floating:a}=t;const i=it(r),l=en(r),o=Js(l),c=mt(r),f=i==="y",m=n.x+n.width/2-a.width/2,p=n.y+n.height/2-a.height/2,b=n[o]/2-a[o]/2;let h;switch(c){case"top":h={x:m,y:n.y-a.height};break;case"bottom":h={x:m,y:n.y+n.height};break;case"right":h={x:n.x+n.width,y:p};break;case"left":h={x:n.x-a.width,y:p};break;default:h={x:n.x,y:n.y}}switch(sr(r)){case"start":h[l]-=b*(s&&f?-1:1);break;case"end":h[l]+=b*(s&&f?-1:1);break}return h}async function ru(t,r){var s;r===void 0&&(r={});const{x:n,y:a,platform:i,rects:l,elements:o,strategy:c}=t,{boundary:f="clippingAncestors",rootBoundary:m="viewport",elementContext:p="floating",altBoundary:b=!1,padding:h=0}=pt(r,t),w=mi(h),u=o[b?p==="floating"?"reference":"floating":p],g=$r(await i.getClippingRect({element:(s=await(i.isElement==null?void 0:i.isElement(u)))==null||s?u:u.contextElement||await(i.getDocumentElement==null?void 0:i.getDocumentElement(o.floating)),boundary:f,rootBoundary:m,strategy:c})),x=p==="floating"?{x:n,y:a,width:l.floating.width,height:l.floating.height}:l.reference,j=await(i.getOffsetParent==null?void 0:i.getOffsetParent(o.floating)),k=await(i.isElement==null?void 0:i.isElement(j))?await(i.getScale==null?void 0:i.getScale(j))||{x:1,y:1}:{x:1,y:1},N=$r(i.convertOffsetParentRelativeRectToViewportRelativeRect?await i.convertOffsetParentRelativeRectToViewportRelativeRect({elements:o,rect:x,offsetParent:j,strategy:c}):x);return{top:(g.top-N.top+w.top)/k.y,bottom:(N.bottom-g.bottom+w.bottom)/k.y,left:(g.left-N.left+w.left)/k.x,right:(N.right-g.right+w.right)/k.x}}const su=async(t,r,s)=>{const{placement:n="bottom",strategy:a="absolute",middleware:i=[],platform:l}=s,o=i.filter(Boolean),c=await(l.isRTL==null?void 0:l.isRTL(r));let f=await l.getElementRects({reference:t,floating:r,strategy:a}),{x:m,y:p}=$n(f,n,c),b=n,h={},w=0;for(let u=0;u<o.length;u++){var d;const{name:g,fn:x}=o[u],{x:j,y:k,data:N,reset:P}=await x({x:m,y:p,initialPlacement:n,placement:b,strategy:a,middlewareData:h,rects:f,platform:{...l,detectOverflow:(d=l.detectOverflow)!=null?d:ru},elements:{reference:t,floating:r}});m=j??m,p=k??p,h={...h,[g]:{...h[g],...N}},P&&w<=50&&(w++,typeof P=="object"&&(P.placement&&(b=P.placement),P.rects&&(f=P.rects===!0?await l.getElementRects({reference:t,floating:r,strategy:a}):P.rects),{x:m,y:p}=$n(f,b,c)),u=-1)}return{x:m,y:p,placement:b,strategy:a,middlewareData:h}},nu=t=>({name:"arrow",options:t,async fn(r){const{x:s,y:n,placement:a,rects:i,platform:l,elements:o,middlewareData:c}=r,{element:f,padding:m=0}=pt(t,r)||{};if(f==null)return{};const p=mi(m),b={x:s,y:n},h=en(a),w=Js(h),d=await l.getDimensions(f),u=h==="y",g=u?"top":"left",x=u?"bottom":"right",j=u?"clientHeight":"clientWidth",k=i.reference[w]+i.reference[h]-b[h]-i.floating[w],N=b[h]-i.reference[h],P=await(l.getOffsetParent==null?void 0:l.getOffsetParent(f));let A=P?P[j]:0;(!A||!await(l.isElement==null?void 0:l.isElement(P)))&&(A=o.floating[j]||i.floating[w]);const F=k/2-N/2,R=A/2-d[w]/2-1,B=St(p[g],R),K=St(p[x],R),_=B,D=A-d[w]-K,y=A/2-d[w]/2+F,O=ks(_,y,D),ee=!c.arrow&&sr(a)!=null&&y!==O&&i.reference[w]/2-(y<_?B:K)-d[w]/2<0,M=ee?y<_?y-_:y-D:0;return{[h]:b[h]+M,data:{[h]:O,centerOffset:y-O-M,...ee&&{alignmentOffset:M}},reset:ee}}}),au=function(t){return t===void 0&&(t={}),{name:"flip",options:t,async fn(r){var s,n;const{placement:a,middlewareData:i,rects:l,initialPlacement:o,platform:c,elements:f}=r,{mainAxis:m=!0,crossAxis:p=!0,fallbackPlacements:b,fallbackStrategy:h="bestFit",fallbackAxisSideDirection:w="none",flipAlignment:d=!0,...u}=pt(t,r);if((s=i.arrow)!=null&&s.alignmentOffset)return{};const g=mt(a),x=it(o),j=mt(o)===o,k=await(c.isRTL==null?void 0:c.isRTL(f.floating)),N=b||(j||!d?[Mr(o)]:Zd(o)),P=w!=="none";!b&&P&&N.push(...eu(o,d,w,k));const A=[o,...N],F=await c.detectOverflow(r,u),R=[];let B=((n=i.flip)==null?void 0:n.overflows)||[];if(m&&R.push(F[g]),p){const y=Yd(a,l,k);R.push(F[y[0]],F[y[1]])}if(B=[...B,{placement:a,overflows:R}],!R.every(y=>y<=0)){var K,_;const y=(((K=i.flip)==null?void 0:K.index)||0)+1,O=A[y];if(O&&(!(p==="alignment"?x!==it(O):!1)||B.every(Z=>it(Z.placement)===x?Z.overflows[0]>0:!0)))return{data:{index:y,overflows:B},reset:{placement:O}};let ee=(_=B.filter(M=>M.overflows[0]<=0).sort((M,Z)=>M.overflows[1]-Z.overflows[1])[0])==null?void 0:_.placement;if(!ee)switch(h){case"bestFit":{var D;const M=(D=B.filter(Z=>{if(P){const V=it(Z.placement);return V===x||V==="y"}return!0}).map(Z=>[Z.placement,Z.overflows.filter(V=>V>0).reduce((V,ie)=>V+ie,0)]).sort((Z,V)=>Z[1]-V[1])[0])==null?void 0:D[0];M&&(ee=M);break}case"initialPlacement":ee=o;break}if(a!==ee)return{reset:{placement:ee}}}return{}}}};function Bn(t,r){return{top:t.top-r.height,right:t.right-r.width,bottom:t.bottom-r.height,left:t.left-r.width}}function Un(t){return Wd.some(r=>t[r]>=0)}const iu=function(t){return t===void 0&&(t={}),{name:"hide",options:t,async fn(r){const{rects:s,platform:n}=r,{strategy:a="referenceHidden",...i}=pt(t,r);switch(a){case"referenceHidden":{const l=await n.detectOverflow(r,{...i,elementContext:"reference"}),o=Bn(l,s.reference);return{data:{referenceHiddenOffsets:o,referenceHidden:Un(o)}}}case"escaped":{const l=await n.detectOverflow(r,{...i,altBoundary:!0}),o=Bn(l,s.floating);return{data:{escapedOffsets:o,escaped:Un(o)}}}default:return{}}}}},xi=new Set(["left","top"]);async function ou(t,r){const{placement:s,platform:n,elements:a}=t,i=await(n.isRTL==null?void 0:n.isRTL(a.floating)),l=mt(s),o=sr(s),c=it(s)==="y",f=xi.has(l)?-1:1,m=i&&c?-1:1,p=pt(r,t);let{mainAxis:b,crossAxis:h,alignmentAxis:w}=typeof p=="number"?{mainAxis:p,crossAxis:0,alignmentAxis:null}:{mainAxis:p.mainAxis||0,crossAxis:p.crossAxis||0,alignmentAxis:p.alignmentAxis};return o&&typeof w=="number"&&(h=o==="end"?w*-1:w),c?{x:h*m,y:b*f}:{x:b*f,y:h*m}}const lu=function(t){return t===void 0&&(t=0),{name:"offset",options:t,async fn(r){var s,n;const{x:a,y:i,placement:l,middlewareData:o}=r,c=await ou(r,t);return l===((s=o.offset)==null?void 0:s.placement)&&(n=o.arrow)!=null&&n.alignmentOffset?{}:{x:a+c.x,y:i+c.y,data:{...c,placement:l}}}}},cu=function(t){return t===void 0&&(t={}),{name:"shift",options:t,async fn(r){const{x:s,y:n,placement:a,platform:i}=r,{mainAxis:l=!0,crossAxis:o=!1,limiter:c={fn:g=>{let{x,y:j}=g;return{x,y:j}}},...f}=pt(t,r),m={x:s,y:n},p=await i.detectOverflow(r,f),b=it(mt(a)),h=Qs(b);let w=m[h],d=m[b];if(l){const g=h==="y"?"top":"left",x=h==="y"?"bottom":"right",j=w+p[g],k=w-p[x];w=ks(j,w,k)}if(o){const g=b==="y"?"top":"left",x=b==="y"?"bottom":"right",j=d+p[g],k=d-p[x];d=ks(j,d,k)}const u=c.fn({...r,[h]:w,[b]:d});return{...u,data:{x:u.x-s,y:u.y-n,enabled:{[h]:l,[b]:o}}}}}},du=function(t){return t===void 0&&(t={}),{options:t,fn(r){const{x:s,y:n,placement:a,rects:i,middlewareData:l}=r,{offset:o=0,mainAxis:c=!0,crossAxis:f=!0}=pt(t,r),m={x:s,y:n},p=it(a),b=Qs(p);let h=m[b],w=m[p];const d=pt(o,r),u=typeof d=="number"?{mainAxis:d,crossAxis:0}:{mainAxis:0,crossAxis:0,...d};if(c){const j=b==="y"?"height":"width",k=i.reference[b]-i.floating[j]+u.mainAxis,N=i.reference[b]+i.reference[j]-u.mainAxis;h<k?h=k:h>N&&(h=N)}if(f){var g,x;const j=b==="y"?"width":"height",k=xi.has(mt(a)),N=i.reference[p]-i.floating[j]+(k&&((g=l.offset)==null?void 0:g[p])||0)+(k?0:u.crossAxis),P=i.reference[p]+i.reference[j]+(k?0:((x=l.offset)==null?void 0:x[p])||0)-(k?u.crossAxis:0);w<N?w=N:w>P&&(w=P)}return{[b]:h,[p]:w}}}},uu=function(t){return t===void 0&&(t={}),{name:"size",options:t,async fn(r){var s,n;const{placement:a,rects:i,platform:l,elements:o}=r,{apply:c=()=>{},...f}=pt(t,r),m=await l.detectOverflow(r,f),p=mt(a),b=sr(a),h=it(a)==="y",{width:w,height:d}=i.floating;let u,g;p==="top"||p==="bottom"?(u=p,g=b===(await(l.isRTL==null?void 0:l.isRTL(o.floating))?"start":"end")?"left":"right"):(g=p,u=b==="end"?"top":"bottom");const x=d-m.top-m.bottom,j=w-m.left-m.right,k=St(d-m[u],x),N=St(w-m[g],j),P=!r.middlewareData.shift;let A=k,F=N;if((s=r.middlewareData.shift)!=null&&s.enabled.x&&(F=j),(n=r.middlewareData.shift)!=null&&n.enabled.y&&(A=x),P&&!b){const B=Ve(m.left,0),K=Ve(m.right,0),_=Ve(m.top,0),D=Ve(m.bottom,0);h?F=w-2*(B!==0||K!==0?B+K:Ve(m.left,m.right)):A=d-2*(_!==0||D!==0?_+D:Ve(m.top,m.bottom))}await c({...r,availableWidth:F,availableHeight:A});const R=await l.getDimensions(o.floating);return w!==R.width||d!==R.height?{reset:{rects:!0}}:{}}}};function Kr(){return typeof window<"u"}function nr(t){return gi(t)?(t.nodeName||"").toLowerCase():"#document"}function He(t){var r;return(t==null||(r=t.ownerDocument)==null?void 0:r.defaultView)||window}function ut(t){var r;return(r=(gi(t)?t.ownerDocument:t.document)||window.document)==null?void 0:r.documentElement}function gi(t){return Kr()?t instanceof Node||t instanceof He(t).Node:!1}function Je(t){return Kr()?t instanceof Element||t instanceof He(t).Element:!1}function dt(t){return Kr()?t instanceof HTMLElement||t instanceof He(t).HTMLElement:!1}function Vn(t){return!Kr()||typeof ShadowRoot>"u"?!1:t instanceof ShadowRoot||t instanceof He(t).ShadowRoot}const hu=new Set(["inline","contents"]);function wr(t){const{overflow:r,overflowX:s,overflowY:n,display:a}=et(t);return/auto|scroll|overlay|hidden|clip/.test(r+n+s)&&!hu.has(a)}const fu=new Set(["table","td","th"]);function pu(t){return fu.has(nr(t))}const mu=[":popover-open",":modal"];function Yr(t){return mu.some(r=>{try{return t.matches(r)}catch{return!1}})}const xu=["transform","translate","scale","rotate","perspective"],gu=["transform","translate","scale","rotate","perspective","filter"],yu=["paint","layout","strict","content"];function tn(t){const r=rn(),s=Je(t)?et(t):t;return xu.some(n=>s[n]?s[n]!=="none":!1)||(s.containerType?s.containerType!=="normal":!1)||!r&&(s.backdropFilter?s.backdropFilter!=="none":!1)||!r&&(s.filter?s.filter!=="none":!1)||gu.some(n=>(s.willChange||"").includes(n))||yu.some(n=>(s.contain||"").includes(n))}function vu(t){let r=Et(t);for(;dt(r)&&!er(r);){if(tn(r))return r;if(Yr(r))return null;r=Et(r)}return null}function rn(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const bu=new Set(["html","body","#document"]);function er(t){return bu.has(nr(t))}function et(t){return He(t).getComputedStyle(t)}function Zr(t){return Je(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.scrollX,scrollTop:t.scrollY}}function Et(t){if(nr(t)==="html")return t;const r=t.assignedSlot||t.parentNode||Vn(t)&&t.host||ut(t);return Vn(r)?r.host:r}function yi(t){const r=Et(t);return er(r)?t.ownerDocument?t.ownerDocument.body:t.body:dt(r)&&wr(r)?r:yi(r)}function ur(t,r,s){var n;r===void 0&&(r=[]),s===void 0&&(s=!0);const a=yi(t),i=a===((n=t.ownerDocument)==null?void 0:n.body),l=He(a);if(i){const o=_s(l);return r.concat(l,l.visualViewport||[],wr(a)?a:[],o&&s?ur(o):[])}return r.concat(a,ur(a,[],s))}function _s(t){return t.parent&&Object.getPrototypeOf(t.parent)?t.frameElement:null}function vi(t){const r=et(t);let s=parseFloat(r.width)||0,n=parseFloat(r.height)||0;const a=dt(t),i=a?t.offsetWidth:s,l=a?t.offsetHeight:n,o=Lr(s)!==i||Lr(n)!==l;return o&&(s=i,n=l),{width:s,height:n,$:o}}function sn(t){return Je(t)?t:t.contextElement}function Vt(t){const r=sn(t);if(!dt(r))return ct(1);const s=r.getBoundingClientRect(),{width:n,height:a,$:i}=vi(r);let l=(i?Lr(s.width):s.width)/n,o=(i?Lr(s.height):s.height)/a;return(!l||!Number.isFinite(l))&&(l=1),(!o||!Number.isFinite(o))&&(o=1),{x:l,y:o}}const wu=ct(0);function bi(t){const r=He(t);return!rn()||!r.visualViewport?wu:{x:r.visualViewport.offsetLeft,y:r.visualViewport.offsetTop}}function ju(t,r,s){return r===void 0&&(r=!1),!s||r&&s!==He(t)?!1:r}function Bt(t,r,s,n){r===void 0&&(r=!1),s===void 0&&(s=!1);const a=t.getBoundingClientRect(),i=sn(t);let l=ct(1);r&&(n?Je(n)&&(l=Vt(n)):l=Vt(t));const o=ju(i,s,n)?bi(i):ct(0);let c=(a.left+o.x)/l.x,f=(a.top+o.y)/l.y,m=a.width/l.x,p=a.height/l.y;if(i){const b=He(i),h=n&&Je(n)?He(n):n;let w=b,d=_s(w);for(;d&&n&&h!==w;){const u=Vt(d),g=d.getBoundingClientRect(),x=et(d),j=g.left+(d.clientLeft+parseFloat(x.paddingLeft))*u.x,k=g.top+(d.clientTop+parseFloat(x.paddingTop))*u.y;c*=u.x,f*=u.y,m*=u.x,p*=u.y,c+=j,f+=k,w=He(d),d=_s(w)}}return $r({width:m,height:p,x:c,y:f})}function Xr(t,r){const s=Zr(t).scrollLeft;return r?r.left+s:Bt(ut(t)).left+s}function wi(t,r){const s=t.getBoundingClientRect(),n=s.left+r.scrollLeft-Xr(t,s),a=s.top+r.scrollTop;return{x:n,y:a}}function Nu(t){let{elements:r,rect:s,offsetParent:n,strategy:a}=t;const i=a==="fixed",l=ut(n),o=r?Yr(r.floating):!1;if(n===l||o&&i)return s;let c={scrollLeft:0,scrollTop:0},f=ct(1);const m=ct(0),p=dt(n);if((p||!p&&!i)&&((nr(n)!=="body"||wr(l))&&(c=Zr(n)),dt(n))){const h=Bt(n);f=Vt(n),m.x=h.x+n.clientLeft,m.y=h.y+n.clientTop}const b=l&&!p&&!i?wi(l,c):ct(0);return{width:s.width*f.x,height:s.height*f.y,x:s.x*f.x-c.scrollLeft*f.x+m.x+b.x,y:s.y*f.y-c.scrollTop*f.y+m.y+b.y}}function ku(t){return Array.from(t.getClientRects())}function Cu(t){const r=ut(t),s=Zr(t),n=t.ownerDocument.body,a=Ve(r.scrollWidth,r.clientWidth,n.scrollWidth,n.clientWidth),i=Ve(r.scrollHeight,r.clientHeight,n.scrollHeight,n.clientHeight);let l=-s.scrollLeft+Xr(t);const o=-s.scrollTop;return et(n).direction==="rtl"&&(l+=Ve(r.clientWidth,n.clientWidth)-a),{width:a,height:i,x:l,y:o}}const Hn=25;function _u(t,r){const s=He(t),n=ut(t),a=s.visualViewport;let i=n.clientWidth,l=n.clientHeight,o=0,c=0;if(a){i=a.width,l=a.height;const m=rn();(!m||m&&r==="fixed")&&(o=a.offsetLeft,c=a.offsetTop)}const f=Xr(n);if(f<=0){const m=n.ownerDocument,p=m.body,b=getComputedStyle(p),h=m.compatMode==="CSS1Compat"&&parseFloat(b.marginLeft)+parseFloat(b.marginRight)||0,w=Math.abs(n.clientWidth-p.clientWidth-h);w<=Hn&&(i-=w)}else f<=Hn&&(i+=f);return{width:i,height:l,x:o,y:c}}const Su=new Set(["absolute","fixed"]);function Eu(t,r){const s=Bt(t,!0,r==="fixed"),n=s.top+t.clientTop,a=s.left+t.clientLeft,i=dt(t)?Vt(t):ct(1),l=t.clientWidth*i.x,o=t.clientHeight*i.y,c=a*i.x,f=n*i.y;return{width:l,height:o,x:c,y:f}}function Wn(t,r,s){let n;if(r==="viewport")n=_u(t,s);else if(r==="document")n=Cu(ut(t));else if(Je(r))n=Eu(r,s);else{const a=bi(t);n={x:r.x-a.x,y:r.y-a.y,width:r.width,height:r.height}}return $r(n)}function ji(t,r){const s=Et(t);return s===r||!Je(s)||er(s)?!1:et(s).position==="fixed"||ji(s,r)}function Au(t,r){const s=r.get(t);if(s)return s;let n=ur(t,[],!1).filter(o=>Je(o)&&nr(o)!=="body"),a=null;const i=et(t).position==="fixed";let l=i?Et(t):t;for(;Je(l)&&!er(l);){const o=et(l),c=tn(l);!c&&o.position==="fixed"&&(a=null),(i?!c&&!a:!c&&o.position==="static"&&!!a&&Su.has(a.position)||wr(l)&&!c&&ji(t,l))?n=n.filter(m=>m!==l):a=o,l=Et(l)}return r.set(t,n),n}function Pu(t){let{element:r,boundary:s,rootBoundary:n,strategy:a}=t;const l=[...s==="clippingAncestors"?Yr(r)?[]:Au(r,this._c):[].concat(s),n],o=l[0],c=l.reduce((f,m)=>{const p=Wn(r,m,a);return f.top=Ve(p.top,f.top),f.right=St(p.right,f.right),f.bottom=St(p.bottom,f.bottom),f.left=Ve(p.left,f.left),f},Wn(r,o,a));return{width:c.right-c.left,height:c.bottom-c.top,x:c.left,y:c.top}}function Tu(t){const{width:r,height:s}=vi(t);return{width:r,height:s}}function Ru(t,r,s){const n=dt(r),a=ut(r),i=s==="fixed",l=Bt(t,!0,i,r);let o={scrollLeft:0,scrollTop:0};const c=ct(0);function f(){c.x=Xr(a)}if(n||!n&&!i)if((nr(r)!=="body"||wr(a))&&(o=Zr(r)),n){const h=Bt(r,!0,i,r);c.x=h.x+r.clientLeft,c.y=h.y+r.clientTop}else a&&f();i&&!n&&a&&f();const m=a&&!n&&!i?wi(a,o):ct(0),p=l.left+o.scrollLeft-c.x-m.x,b=l.top+o.scrollTop-c.y-m.y;return{x:p,y:b,width:l.width,height:l.height}}function ms(t){return et(t).position==="static"}function Gn(t,r){if(!dt(t)||et(t).position==="fixed")return null;if(r)return r(t);let s=t.offsetParent;return ut(t)===s&&(s=s.ownerDocument.body),s}function Ni(t,r){const s=He(t);if(Yr(t))return s;if(!dt(t)){let a=Et(t);for(;a&&!er(a);){if(Je(a)&&!ms(a))return a;a=Et(a)}return s}let n=Gn(t,r);for(;n&&pu(n)&&ms(n);)n=Gn(n,r);return n&&er(n)&&ms(n)&&!tn(n)?s:n||vu(t)||s}const Du=async function(t){const r=this.getOffsetParent||Ni,s=this.getDimensions,n=await s(t.floating);return{reference:Ru(t.reference,await r(t.floating),t.strategy),floating:{x:0,y:0,width:n.width,height:n.height}}};function Ou(t){return et(t).direction==="rtl"}const Fu={convertOffsetParentRelativeRectToViewportRelativeRect:Nu,getDocumentElement:ut,getClippingRect:Pu,getOffsetParent:Ni,getElementRects:Du,getClientRects:ku,getDimensions:Tu,getScale:Vt,isElement:Je,isRTL:Ou};function ki(t,r){return t.x===r.x&&t.y===r.y&&t.width===r.width&&t.height===r.height}function Iu(t,r){let s=null,n;const a=ut(t);function i(){var o;clearTimeout(n),(o=s)==null||o.disconnect(),s=null}function l(o,c){o===void 0&&(o=!1),c===void 0&&(c=1),i();const f=t.getBoundingClientRect(),{left:m,top:p,width:b,height:h}=f;if(o||r(),!b||!h)return;const w=Sr(p),d=Sr(a.clientWidth-(m+b)),u=Sr(a.clientHeight-(p+h)),g=Sr(m),j={rootMargin:-w+"px "+-d+"px "+-u+"px "+-g+"px",threshold:Ve(0,St(1,c))||1};let k=!0;function N(P){const A=P[0].intersectionRatio;if(A!==c){if(!k)return l();A?l(!1,A):n=setTimeout(()=>{l(!1,1e-7)},1e3)}A===1&&!ki(f,t.getBoundingClientRect())&&l(),k=!1}try{s=new IntersectionObserver(N,{...j,root:a.ownerDocument})}catch{s=new IntersectionObserver(N,j)}s.observe(t)}return l(!0),i}function zu(t,r,s,n){n===void 0&&(n={});const{ancestorScroll:a=!0,ancestorResize:i=!0,elementResize:l=typeof ResizeObserver=="function",layoutShift:o=typeof IntersectionObserver=="function",animationFrame:c=!1}=n,f=sn(t),m=a||i?[...f?ur(f):[],...ur(r)]:[];m.forEach(g=>{a&&g.addEventListener("scroll",s,{passive:!0}),i&&g.addEventListener("resize",s)});const p=f&&o?Iu(f,s):null;let b=-1,h=null;l&&(h=new ResizeObserver(g=>{let[x]=g;x&&x.target===f&&h&&(h.unobserve(r),cancelAnimationFrame(b),b=requestAnimationFrame(()=>{var j;(j=h)==null||j.observe(r)})),s()}),f&&!c&&h.observe(f),h.observe(r));let w,d=c?Bt(t):null;c&&u();function u(){const g=Bt(t);d&&!ki(d,g)&&s(),d=g,w=requestAnimationFrame(u)}return s(),()=>{var g;m.forEach(x=>{a&&x.removeEventListener("scroll",s),i&&x.removeEventListener("resize",s)}),p==null||p(),(g=h)==null||g.disconnect(),h=null,c&&cancelAnimationFrame(w)}}const Lu=lu,Mu=cu,$u=au,Bu=uu,Uu=iu,qn=nu,Vu=du,Hu=(t,r,s)=>{const n=new Map,a={platform:Fu,...s},i={...a.platform,_c:n};return su(t,r,{...a,platform:i})};var Wu=typeof document<"u",Gu=function(){},Dr=Wu?C.useLayoutEffect:Gu;function Br(t,r){if(t===r)return!0;if(typeof t!=typeof r)return!1;if(typeof t=="function"&&t.toString()===r.toString())return!0;let s,n,a;if(t&&r&&typeof t=="object"){if(Array.isArray(t)){if(s=t.length,s!==r.length)return!1;for(n=s;n--!==0;)if(!Br(t[n],r[n]))return!1;return!0}if(a=Object.keys(t),s=a.length,s!==Object.keys(r).length)return!1;for(n=s;n--!==0;)if(!{}.hasOwnProperty.call(r,a[n]))return!1;for(n=s;n--!==0;){const i=a[n];if(!(i==="_owner"&&t.$$typeof)&&!Br(t[i],r[i]))return!1}return!0}return t!==t&&r!==r}function Ci(t){return typeof window>"u"?1:(t.ownerDocument.defaultView||window).devicePixelRatio||1}function Kn(t,r){const s=Ci(t);return Math.round(r*s)/s}function xs(t){const r=C.useRef(t);return Dr(()=>{r.current=t}),r}function qu(t){t===void 0&&(t={});const{placement:r="bottom",strategy:s="absolute",middleware:n=[],platform:a,elements:{reference:i,floating:l}={},transform:o=!0,whileElementsMounted:c,open:f}=t,[m,p]=C.useState({x:0,y:0,strategy:s,placement:r,middlewareData:{},isPositioned:!1}),[b,h]=C.useState(n);Br(b,n)||h(n);const[w,d]=C.useState(null),[u,g]=C.useState(null),x=C.useCallback(Z=>{Z!==P.current&&(P.current=Z,d(Z))},[]),j=C.useCallback(Z=>{Z!==A.current&&(A.current=Z,g(Z))},[]),k=i||w,N=l||u,P=C.useRef(null),A=C.useRef(null),F=C.useRef(m),R=c!=null,B=xs(c),K=xs(a),_=xs(f),D=C.useCallback(()=>{if(!P.current||!A.current)return;const Z={placement:r,strategy:s,middleware:b};K.current&&(Z.platform=K.current),Hu(P.current,A.current,Z).then(V=>{const ie={...V,isPositioned:_.current!==!1};y.current&&!Br(F.current,ie)&&(F.current=ie,Ms.flushSync(()=>{p(ie)}))})},[b,r,s,K,_]);Dr(()=>{f===!1&&F.current.isPositioned&&(F.current.isPositioned=!1,p(Z=>({...Z,isPositioned:!1})))},[f]);const y=C.useRef(!1);Dr(()=>(y.current=!0,()=>{y.current=!1}),[]),Dr(()=>{if(k&&(P.current=k),N&&(A.current=N),k&&N){if(B.current)return B.current(k,N,D);D()}},[k,N,D,B,R]);const O=C.useMemo(()=>({reference:P,floating:A,setReference:x,setFloating:j}),[x,j]),ee=C.useMemo(()=>({reference:k,floating:N}),[k,N]),M=C.useMemo(()=>{const Z={position:s,left:0,top:0};if(!ee.floating)return Z;const V=Kn(ee.floating,m.x),ie=Kn(ee.floating,m.y);return o?{...Z,transform:"translate("+V+"px, "+ie+"px)",...Ci(ee.floating)>=1.5&&{willChange:"transform"}}:{position:s,left:V,top:ie}},[s,o,ee.floating,m.x,m.y]);return C.useMemo(()=>({...m,update:D,refs:O,elements:ee,floatingStyles:M}),[m,D,O,ee,M])}const Ku=t=>{function r(s){return{}.hasOwnProperty.call(s,"current")}return{name:"arrow",options:t,fn(s){const{element:n,padding:a}=typeof t=="function"?t(s):t;return n&&r(n)?n.current!=null?qn({element:n.current,padding:a}).fn(s):{}:n?qn({element:n,padding:a}).fn(s):{}}}},Yu=(t,r)=>({...Lu(t),options:[t,r]}),Zu=(t,r)=>({...Mu(t),options:[t,r]}),Xu=(t,r)=>({...Vu(t),options:[t,r]}),Qu=(t,r)=>({...$u(t),options:[t,r]}),Ju=(t,r)=>({...Bu(t),options:[t,r]}),eh=(t,r)=>({...Uu(t),options:[t,r]}),th=(t,r)=>({...Ku(t),options:[t,r]});var rh="Arrow",_i=C.forwardRef((t,r)=>{const{children:s,width:n=10,height:a=5,...i}=t;return e.jsx(ke.svg,{...i,ref:r,width:n,height:a,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:t.asChild?s:e.jsx("polygon",{points:"0,0 30,0 15,10"})})});_i.displayName=rh;var sh=_i;function nn(t){const[r,s]=C.useState(void 0);return cr(()=>{if(t){s({width:t.offsetWidth,height:t.offsetHeight});const n=new ResizeObserver(a=>{if(!Array.isArray(a)||!a.length)return;const i=a[0];let l,o;if("borderBoxSize"in i){const c=i.borderBoxSize,f=Array.isArray(c)?c[0]:c;l=f.inlineSize,o=f.blockSize}else l=t.offsetWidth,o=t.offsetHeight;s({width:l,height:o})});return n.observe(t,{box:"border-box"}),()=>n.unobserve(t)}else s(void 0)},[t]),r}var an="Popper",[Si,Qr]=xt(an),[nh,Ei]=Si(an),Ai=t=>{const{__scopePopper:r,children:s}=t,[n,a]=C.useState(null);return e.jsx(nh,{scope:r,anchor:n,onAnchorChange:a,children:s})};Ai.displayName=an;var Pi="PopperAnchor",Ti=C.forwardRef((t,r)=>{const{__scopePopper:s,virtualRef:n,...a}=t,i=Ei(Pi,s),l=C.useRef(null),o=Oe(r,l),c=C.useRef(null);return C.useEffect(()=>{const f=c.current;c.current=(n==null?void 0:n.current)||l.current,f!==c.current&&i.onAnchorChange(c.current)}),n?null:e.jsx(ke.div,{...a,ref:o})});Ti.displayName=Pi;var on="PopperContent",[ah,ih]=Si(on),Ri=C.forwardRef((t,r)=>{var _e,fe,me,Ce,je,Me;const{__scopePopper:s,side:n="bottom",sideOffset:a=0,align:i="center",alignOffset:l=0,arrowPadding:o=0,avoidCollisions:c=!0,collisionBoundary:f=[],collisionPadding:m=0,sticky:p="partial",hideWhenDetached:b=!1,updatePositionStrategy:h="optimized",onPlaced:w,...d}=t,u=Ei(on,s),[g,x]=C.useState(null),j=Oe(r,Pe=>x(Pe)),[k,N]=C.useState(null),P=nn(k),A=(P==null?void 0:P.width)??0,F=(P==null?void 0:P.height)??0,R=n+(i!=="center"?"-"+i:""),B=typeof m=="number"?m:{top:0,right:0,bottom:0,left:0,...m},K=Array.isArray(f)?f:[f],_=K.length>0,D={padding:B,boundary:K.filter(lh),altBoundary:_},{refs:y,floatingStyles:O,placement:ee,isPositioned:M,middlewareData:Z}=qu({strategy:"fixed",placement:R,whileElementsMounted:(...Pe)=>zu(...Pe,{animationFrame:h==="always"}),elements:{reference:u.anchor},middleware:[Yu({mainAxis:a+F,alignmentAxis:l}),c&&Zu({mainAxis:!0,crossAxis:!1,limiter:p==="partial"?Xu():void 0,...D}),c&&Qu({...D}),Ju({...D,apply:({elements:Pe,rects:v,availableWidth:H,availableHeight:$})=>{const{width:E,height:S}=v.reference,T=Pe.floating.style;T.setProperty("--radix-popper-available-width",`${H}px`),T.setProperty("--radix-popper-available-height",`${$}px`),T.setProperty("--radix-popper-anchor-width",`${E}px`),T.setProperty("--radix-popper-anchor-height",`${S}px`)}}),k&&th({element:k,padding:o}),ch({arrowWidth:A,arrowHeight:F}),b&&eh({strategy:"referenceHidden",...D})]}),[V,ie]=Fi(ee),L=lr(w);cr(()=>{M&&(L==null||L())},[M,L]);const z=(_e=Z.arrow)==null?void 0:_e.x,le=(fe=Z.arrow)==null?void 0:fe.y,se=((me=Z.arrow)==null?void 0:me.centerOffset)!==0,[re,Ne]=C.useState();return cr(()=>{g&&Ne(window.getComputedStyle(g).zIndex)},[g]),e.jsx("div",{ref:y.setFloating,"data-radix-popper-content-wrapper":"",style:{...O,transform:M?O.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:re,"--radix-popper-transform-origin":[(Ce=Z.transformOrigin)==null?void 0:Ce.x,(je=Z.transformOrigin)==null?void 0:je.y].join(" "),...((Me=Z.hide)==null?void 0:Me.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:t.dir,children:e.jsx(ah,{scope:s,placedSide:V,onArrowChange:N,arrowX:z,arrowY:le,shouldHideArrow:se,children:e.jsx(ke.div,{"data-side":V,"data-align":ie,...d,ref:j,style:{...d.style,animation:M?void 0:"none"}})})})});Ri.displayName=on;var Di="PopperArrow",oh={top:"bottom",right:"left",bottom:"top",left:"right"},Oi=C.forwardRef(function(r,s){const{__scopePopper:n,...a}=r,i=ih(Di,n),l=oh[i.placedSide];return e.jsx("span",{ref:i.onArrowChange,style:{position:"absolute",left:i.arrowX,top:i.arrowY,[l]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[i.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[i.placedSide],visibility:i.shouldHideArrow?"hidden":void 0},children:e.jsx(sh,{...a,ref:s,style:{...a.style,display:"block"}})})});Oi.displayName=Di;function lh(t){return t!==null}var ch=t=>({name:"transformOrigin",options:t,fn(r){var u,g,x;const{placement:s,rects:n,middlewareData:a}=r,l=((u=a.arrow)==null?void 0:u.centerOffset)!==0,o=l?0:t.arrowWidth,c=l?0:t.arrowHeight,[f,m]=Fi(s),p={start:"0%",center:"50%",end:"100%"}[m],b=(((g=a.arrow)==null?void 0:g.x)??0)+o/2,h=(((x=a.arrow)==null?void 0:x.y)??0)+c/2;let w="",d="";return f==="bottom"?(w=l?p:`${b}px`,d=`${-c}px`):f==="top"?(w=l?p:`${b}px`,d=`${n.floating.height+c}px`):f==="right"?(w=`${-c}px`,d=l?p:`${h}px`):f==="left"&&(w=`${n.floating.width+c}px`,d=l?p:`${h}px`),{data:{x:w,y:d}}}});function Fi(t){const[r,s="center"]=t.split("-");return[r,s]}var Ii=Ai,ln=Ti,zi=Ri,Li=Oi,dh=Symbol("radix.slottable");function uh(t){const r=({children:s})=>e.jsx(e.Fragment,{children:s});return r.displayName=`${t}.Slottable`,r.__radixId=dh,r}var[Jr]=xt("Tooltip",[Qr]),es=Qr(),Mi="TooltipProvider",hh=700,Ss="tooltip.open",[fh,cn]=Jr(Mi),$i=t=>{const{__scopeTooltip:r,delayDuration:s=hh,skipDelayDuration:n=300,disableHoverableContent:a=!1,children:i}=t,l=C.useRef(!0),o=C.useRef(!1),c=C.useRef(0);return C.useEffect(()=>{const f=c.current;return()=>window.clearTimeout(f)},[]),e.jsx(fh,{scope:r,isOpenDelayedRef:l,delayDuration:s,onOpen:C.useCallback(()=>{window.clearTimeout(c.current),l.current=!1},[]),onClose:C.useCallback(()=>{window.clearTimeout(c.current),c.current=window.setTimeout(()=>l.current=!0,n)},[n]),isPointerInTransitRef:o,onPointerInTransitChange:C.useCallback(f=>{o.current=f},[]),disableHoverableContent:a,children:i})};$i.displayName=Mi;var hr="Tooltip",[ph,ts]=Jr(hr),Bi=t=>{const{__scopeTooltip:r,children:s,open:n,defaultOpen:a,onOpenChange:i,disableHoverableContent:l,delayDuration:o}=t,c=cn(hr,t.__scopeTooltip),f=es(r),[m,p]=C.useState(null),b=Hr(),h=C.useRef(0),w=l??c.disableHoverableContent,d=o??c.delayDuration,u=C.useRef(!1),[g,x]=At({prop:n,defaultProp:a??!1,onChange:A=>{A?(c.onOpen(),document.dispatchEvent(new CustomEvent(Ss))):c.onClose(),i==null||i(A)},caller:hr}),j=C.useMemo(()=>g?u.current?"delayed-open":"instant-open":"closed",[g]),k=C.useCallback(()=>{window.clearTimeout(h.current),h.current=0,u.current=!1,x(!0)},[x]),N=C.useCallback(()=>{window.clearTimeout(h.current),h.current=0,x(!1)},[x]),P=C.useCallback(()=>{window.clearTimeout(h.current),h.current=window.setTimeout(()=>{u.current=!0,x(!0),h.current=0},d)},[d,x]);return C.useEffect(()=>()=>{h.current&&(window.clearTimeout(h.current),h.current=0)},[]),e.jsx(Ii,{...f,children:e.jsx(ph,{scope:r,contentId:b,open:g,stateAttribute:j,trigger:m,onTriggerChange:p,onTriggerEnter:C.useCallback(()=>{c.isOpenDelayedRef.current?P():k()},[c.isOpenDelayedRef,P,k]),onTriggerLeave:C.useCallback(()=>{w?N():(window.clearTimeout(h.current),h.current=0)},[N,w]),onOpen:k,onClose:N,disableHoverableContent:w,children:s})})};Bi.displayName=hr;var Es="TooltipTrigger",Ui=C.forwardRef((t,r)=>{const{__scopeTooltip:s,...n}=t,a=ts(Es,s),i=cn(Es,s),l=es(s),o=C.useRef(null),c=Oe(r,o,a.onTriggerChange),f=C.useRef(!1),m=C.useRef(!1),p=C.useCallback(()=>f.current=!1,[]);return C.useEffect(()=>()=>document.removeEventListener("pointerup",p),[p]),e.jsx(ln,{asChild:!0,...l,children:e.jsx(ke.button,{"aria-describedby":a.open?a.contentId:void 0,"data-state":a.stateAttribute,...n,ref:c,onPointerMove:ye(t.onPointerMove,b=>{b.pointerType!=="touch"&&!m.current&&!i.isPointerInTransitRef.current&&(a.onTriggerEnter(),m.current=!0)}),onPointerLeave:ye(t.onPointerLeave,()=>{a.onTriggerLeave(),m.current=!1}),onPointerDown:ye(t.onPointerDown,()=>{a.open&&a.onClose(),f.current=!0,document.addEventListener("pointerup",p,{once:!0})}),onFocus:ye(t.onFocus,()=>{f.current||a.onOpen()}),onBlur:ye(t.onBlur,a.onClose),onClick:ye(t.onClick,a.onClose)})})});Ui.displayName=Es;var mh="TooltipPortal",[Um,xh]=Jr(mh,{forceMount:void 0}),tr="TooltipContent",Vi=C.forwardRef((t,r)=>{const s=xh(tr,t.__scopeTooltip),{forceMount:n=s.forceMount,side:a="top",...i}=t,l=ts(tr,t.__scopeTooltip);return e.jsx(yr,{present:n||l.open,children:l.disableHoverableContent?e.jsx(Hi,{side:a,...i,ref:r}):e.jsx(gh,{side:a,...i,ref:r})})}),gh=C.forwardRef((t,r)=>{const s=ts(tr,t.__scopeTooltip),n=cn(tr,t.__scopeTooltip),a=C.useRef(null),i=Oe(r,a),[l,o]=C.useState(null),{trigger:c,onClose:f}=s,m=a.current,{onPointerInTransitChange:p}=n,b=C.useCallback(()=>{o(null),p(!1)},[p]),h=C.useCallback((w,d)=>{const u=w.currentTarget,g={x:w.clientX,y:w.clientY},x=jh(g,u.getBoundingClientRect()),j=Nh(g,x),k=kh(d.getBoundingClientRect()),N=_h([...j,...k]);o(N),p(!0)},[p]);return C.useEffect(()=>()=>b(),[b]),C.useEffect(()=>{if(c&&m){const w=u=>h(u,m),d=u=>h(u,c);return c.addEventListener("pointerleave",w),m.addEventListener("pointerleave",d),()=>{c.removeEventListener("pointerleave",w),m.removeEventListener("pointerleave",d)}}},[c,m,h,b]),C.useEffect(()=>{if(l){const w=d=>{const u=d.target,g={x:d.clientX,y:d.clientY},x=(c==null?void 0:c.contains(u))||(m==null?void 0:m.contains(u)),j=!Ch(g,l);x?b():j&&(b(),f())};return document.addEventListener("pointermove",w),()=>document.removeEventListener("pointermove",w)}},[c,m,l,f,b]),e.jsx(Hi,{...t,ref:i})}),[yh,vh]=Jr(hr,{isInside:!1}),bh=uh("TooltipContent"),Hi=C.forwardRef((t,r)=>{const{__scopeTooltip:s,children:n,"aria-label":a,onEscapeKeyDown:i,onPointerDownOutside:l,...o}=t,c=ts(tr,s),f=es(s),{onClose:m}=c;return C.useEffect(()=>(document.addEventListener(Ss,m),()=>document.removeEventListener(Ss,m)),[m]),C.useEffect(()=>{if(c.trigger){const p=b=>{const h=b.target;h!=null&&h.contains(c.trigger)&&m()};return window.addEventListener("scroll",p,{capture:!0}),()=>window.removeEventListener("scroll",p,{capture:!0})}},[c.trigger,m]),e.jsx(Na,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:i,onPointerDownOutside:l,onFocusOutside:p=>p.preventDefault(),onDismiss:m,children:e.jsxs(zi,{"data-state":c.stateAttribute,...f,...o,ref:r,style:{...o.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[e.jsx(bh,{children:n}),e.jsx(yh,{scope:s,isInside:!0,children:e.jsx(gd,{id:c.contentId,role:"tooltip",children:a||n})})]})})});Vi.displayName=tr;var Wi="TooltipArrow",wh=C.forwardRef((t,r)=>{const{__scopeTooltip:s,...n}=t,a=es(s);return vh(Wi,s).isInside?null:e.jsx(Li,{...a,...n,ref:r})});wh.displayName=Wi;function jh(t,r){const s=Math.abs(r.top-t.y),n=Math.abs(r.bottom-t.y),a=Math.abs(r.right-t.x),i=Math.abs(r.left-t.x);switch(Math.min(s,n,a,i)){case i:return"left";case a:return"right";case s:return"top";case n:return"bottom";default:throw new Error("unreachable")}}function Nh(t,r,s=5){const n=[];switch(r){case"top":n.push({x:t.x-s,y:t.y+s},{x:t.x+s,y:t.y+s});break;case"bottom":n.push({x:t.x-s,y:t.y-s},{x:t.x+s,y:t.y-s});break;case"left":n.push({x:t.x+s,y:t.y-s},{x:t.x+s,y:t.y+s});break;case"right":n.push({x:t.x-s,y:t.y-s},{x:t.x-s,y:t.y+s});break}return n}function kh(t){const{top:r,right:s,bottom:n,left:a}=t;return[{x:a,y:r},{x:s,y:r},{x:s,y:n},{x:a,y:n}]}function Ch(t,r){const{x:s,y:n}=t;let a=!1;for(let i=0,l=r.length-1;i<r.length;l=i++){const o=r[i],c=r[l],f=o.x,m=o.y,p=c.x,b=c.y;m>n!=b>n&&s<(p-f)*(n-m)/(b-m)+f&&(a=!a)}return a}function _h(t){const r=t.slice();return r.sort((s,n)=>s.x<n.x?-1:s.x>n.x?1:s.y<n.y?-1:s.y>n.y?1:0),Sh(r)}function Sh(t){if(t.length<=1)return t.slice();const r=[];for(let n=0;n<t.length;n++){const a=t[n];for(;r.length>=2;){const i=r[r.length-1],l=r[r.length-2];if((i.x-l.x)*(a.y-l.y)>=(i.y-l.y)*(a.x-l.x))r.pop();else break}r.push(a)}r.pop();const s=[];for(let n=t.length-1;n>=0;n--){const a=t[n];for(;s.length>=2;){const i=s[s.length-1],l=s[s.length-2];if((i.x-l.x)*(a.y-l.y)>=(i.y-l.y)*(a.x-l.x))s.pop();else break}s.push(a)}return s.pop(),r.length===1&&s.length===1&&r[0].x===s[0].x&&r[0].y===s[0].y?r:r.concat(s)}var Eh=$i,Ah=Bi,Ph=Ui,Gi=Vi;const Th=Eh,dn=Ah,un=Ph,rs=C.forwardRef(({className:t,sideOffset:r=4,...s},n)=>e.jsx(Gi,{ref:n,sideOffset:r,className:be("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...s}));rs.displayName=Gi.displayName;var ss=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(t){return this.listeners.add(t),this.onSubscribe(),()=>{this.listeners.delete(t),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},Rh={setTimeout:(t,r)=>setTimeout(t,r),clearTimeout:t=>clearTimeout(t),setInterval:(t,r)=>setInterval(t,r),clearInterval:t=>clearInterval(t)},bt,Ls,ha,Dh=(ha=class{constructor(){xe(this,bt,Rh);xe(this,Ls,!1)}setTimeoutProvider(t){he(this,bt,t)}setTimeout(t,r){return U(this,bt).setTimeout(t,r)}clearTimeout(t){U(this,bt).clearTimeout(t)}setInterval(t,r){return U(this,bt).setInterval(t,r)}clearInterval(t){U(this,bt).clearInterval(t)}},bt=new WeakMap,Ls=new WeakMap,ha),As=new Dh;function Oh(t){setTimeout(t,0)}var ns=typeof window>"u"||"Deno"in globalThis;function Ye(){}function Fh(t,r){return typeof t=="function"?t(r):t}function Ih(t){return typeof t=="number"&&t>=0&&t!==1/0}function zh(t,r){return Math.max(t+(r||0)-Date.now(),0)}function Ps(t,r){return typeof t=="function"?t(r):t}function Lh(t,r){return typeof t=="function"?t(r):t}function Yn(t,r){const{type:s="all",exact:n,fetchStatus:a,predicate:i,queryKey:l,stale:o}=t;if(l){if(n){if(r.queryHash!==hn(l,r.options))return!1}else if(!pr(r.queryKey,l))return!1}if(s!=="all"){const c=r.isActive();if(s==="active"&&!c||s==="inactive"&&c)return!1}return!(typeof o=="boolean"&&r.isStale()!==o||a&&a!==r.state.fetchStatus||i&&!i(r))}function Zn(t,r){const{exact:s,status:n,predicate:a,mutationKey:i}=t;if(i){if(!r.options.mutationKey)return!1;if(s){if(fr(r.options.mutationKey)!==fr(i))return!1}else if(!pr(r.options.mutationKey,i))return!1}return!(n&&r.state.status!==n||a&&!a(r))}function hn(t,r){return((r==null?void 0:r.queryKeyHashFn)||fr)(t)}function fr(t){return JSON.stringify(t,(r,s)=>Ts(s)?Object.keys(s).sort().reduce((n,a)=>(n[a]=s[a],n),{}):s)}function pr(t,r){return t===r?!0:typeof t!=typeof r?!1:t&&r&&typeof t=="object"&&typeof r=="object"?Object.keys(r).every(s=>pr(t[s],r[s])):!1}var Mh=Object.prototype.hasOwnProperty;function qi(t,r,s=0){if(t===r)return t;if(s>500)return r;const n=Xn(t)&&Xn(r);if(!n&&!(Ts(t)&&Ts(r)))return r;const i=(n?t:Object.keys(t)).length,l=n?r:Object.keys(r),o=l.length,c=n?new Array(o):{};let f=0;for(let m=0;m<o;m++){const p=n?m:l[m],b=t[p],h=r[p];if(b===h){c[p]=b,(n?m<i:Mh.call(t,p))&&f++;continue}if(b===null||h===null||typeof b!="object"||typeof h!="object"){c[p]=h;continue}const w=qi(b,h,s+1);c[p]=w,w===b&&f++}return i===o&&f===i?t:c}function Xn(t){return Array.isArray(t)&&t.length===Object.keys(t).length}function Ts(t){if(!Qn(t))return!1;const r=t.constructor;if(r===void 0)return!0;const s=r.prototype;return!(!Qn(s)||!s.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(t)!==Object.prototype)}function Qn(t){return Object.prototype.toString.call(t)==="[object Object]"}function $h(t){return new Promise(r=>{As.setTimeout(r,t)})}function Bh(t,r,s){return typeof s.structuralSharing=="function"?s.structuralSharing(t,r):s.structuralSharing!==!1?qi(t,r):r}function Uh(t,r,s=0){const n=[...t,r];return s&&n.length>s?n.slice(1):n}function Vh(t,r,s=0){const n=[r,...t];return s&&n.length>s?n.slice(0,-1):n}var fn=Symbol();function Ki(t,r){return!t.queryFn&&(r!=null&&r.initialPromise)?()=>r.initialPromise:!t.queryFn||t.queryFn===fn?()=>Promise.reject(new Error(`Missing queryFn: '${t.queryHash}'`)):t.queryFn}function Hh(t,r,s){let n=!1,a;return Object.defineProperty(t,"signal",{enumerable:!0,get:()=>(a??(a=r()),n||(n=!0,a.aborted?s():a.addEventListener("abort",s,{once:!0})),a)}),t}var Ot,wt,Ht,fa,Wh=(fa=class extends ss{constructor(){super();xe(this,Ot);xe(this,wt);xe(this,Ht);he(this,Ht,r=>{if(!ns&&window.addEventListener){const s=()=>r();return window.addEventListener("visibilitychange",s,!1),()=>{window.removeEventListener("visibilitychange",s)}}})}onSubscribe(){U(this,wt)||this.setEventListener(U(this,Ht))}onUnsubscribe(){var r;this.hasListeners()||((r=U(this,wt))==null||r.call(this),he(this,wt,void 0))}setEventListener(r){var s;he(this,Ht,r),(s=U(this,wt))==null||s.call(this),he(this,wt,r(n=>{typeof n=="boolean"?this.setFocused(n):this.onFocus()}))}setFocused(r){U(this,Ot)!==r&&(he(this,Ot,r),this.onFocus())}onFocus(){const r=this.isFocused();this.listeners.forEach(s=>{s(r)})}isFocused(){var r;return typeof U(this,Ot)=="boolean"?U(this,Ot):((r=globalThis.document)==null?void 0:r.visibilityState)!=="hidden"}},Ot=new WeakMap,wt=new WeakMap,Ht=new WeakMap,fa),Yi=new Wh;function Gh(){let t,r;const s=new Promise((a,i)=>{t=a,r=i});s.status="pending",s.catch(()=>{});function n(a){Object.assign(s,a),delete s.resolve,delete s.reject}return s.resolve=a=>{n({status:"fulfilled",value:a}),t(a)},s.reject=a=>{n({status:"rejected",reason:a}),r(a)},s}var qh=Oh;function Kh(){let t=[],r=0,s=o=>{o()},n=o=>{o()},a=qh;const i=o=>{r?t.push(o):a(()=>{s(o)})},l=()=>{const o=t;t=[],o.length&&a(()=>{n(()=>{o.forEach(c=>{s(c)})})})};return{batch:o=>{let c;r++;try{c=o()}finally{r--,r||l()}return c},batchCalls:o=>(...c)=>{i(()=>{o(...c)})},schedule:i,setNotifyFunction:o=>{s=o},setBatchNotifyFunction:o=>{n=o},setScheduler:o=>{a=o}}}var Be=Kh(),Wt,jt,Gt,pa,Yh=(pa=class extends ss{constructor(){super();xe(this,Wt,!0);xe(this,jt);xe(this,Gt);he(this,Gt,r=>{if(!ns&&window.addEventListener){const s=()=>r(!0),n=()=>r(!1);return window.addEventListener("online",s,!1),window.addEventListener("offline",n,!1),()=>{window.removeEventListener("online",s),window.removeEventListener("offline",n)}}})}onSubscribe(){U(this,jt)||this.setEventListener(U(this,Gt))}onUnsubscribe(){var r;this.hasListeners()||((r=U(this,jt))==null||r.call(this),he(this,jt,void 0))}setEventListener(r){var s;he(this,Gt,r),(s=U(this,jt))==null||s.call(this),he(this,jt,r(this.setOnline.bind(this)))}setOnline(r){U(this,Wt)!==r&&(he(this,Wt,r),this.listeners.forEach(n=>{n(r)}))}isOnline(){return U(this,Wt)}},Wt=new WeakMap,jt=new WeakMap,Gt=new WeakMap,pa),Ur=new Yh;function Zh(t){return Math.min(1e3*2**t,3e4)}function Zi(t){return(t??"online")==="online"?Ur.isOnline():!0}var Rs=class extends Error{constructor(t){super("CancelledError"),this.revert=t==null?void 0:t.revert,this.silent=t==null?void 0:t.silent}};function Xi(t){let r=!1,s=0,n;const a=Gh(),i=()=>a.status!=="pending",l=d=>{var u;if(!i()){const g=new Rs(d);b(g),(u=t.onCancel)==null||u.call(t,g)}},o=()=>{r=!0},c=()=>{r=!1},f=()=>Yi.isFocused()&&(t.networkMode==="always"||Ur.isOnline())&&t.canRun(),m=()=>Zi(t.networkMode)&&t.canRun(),p=d=>{i()||(n==null||n(),a.resolve(d))},b=d=>{i()||(n==null||n(),a.reject(d))},h=()=>new Promise(d=>{var u;n=g=>{(i()||f())&&d(g)},(u=t.onPause)==null||u.call(t)}).then(()=>{var d;n=void 0,i()||(d=t.onContinue)==null||d.call(t)}),w=()=>{if(i())return;let d;const u=s===0?t.initialPromise:void 0;try{d=u??t.fn()}catch(g){d=Promise.reject(g)}Promise.resolve(d).then(p).catch(g=>{var P;if(i())return;const x=t.retry??(ns?0:3),j=t.retryDelay??Zh,k=typeof j=="function"?j(s,g):j,N=x===!0||typeof x=="number"&&s<x||typeof x=="function"&&x(s,g);if(r||!N){b(g);return}s++,(P=t.onFail)==null||P.call(t,s,g),$h(k).then(()=>f()?void 0:h()).then(()=>{r?b(g):w()})})};return{promise:a,status:()=>a.status,cancel:l,continue:()=>(n==null||n(),a),cancelRetry:o,continueRetry:c,canStart:m,start:()=>(m()?w():h().then(w),a)}}var Ft,ma,Qi=(ma=class{constructor(){xe(this,Ft)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),Ih(this.gcTime)&&he(this,Ft,As.setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(t){this.gcTime=Math.max(this.gcTime||0,t??(ns?1/0:5*60*1e3))}clearGcTimeout(){U(this,Ft)&&(As.clearTimeout(U(this,Ft)),he(this,Ft,void 0))}},Ft=new WeakMap,ma),It,qt,Ge,zt,Ie,mr,Lt,Ze,ht,xa,Xh=(xa=class extends Qi{constructor(r){super();xe(this,Ze);xe(this,It);xe(this,qt);xe(this,Ge);xe(this,zt);xe(this,Ie);xe(this,mr);xe(this,Lt);he(this,Lt,!1),he(this,mr,r.defaultOptions),this.setOptions(r.options),this.observers=[],he(this,zt,r.client),he(this,Ge,U(this,zt).getQueryCache()),this.queryKey=r.queryKey,this.queryHash=r.queryHash,he(this,It,ea(this.options)),this.state=r.state??U(this,It),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var r;return(r=U(this,Ie))==null?void 0:r.promise}setOptions(r){if(this.options={...U(this,mr),...r},this.updateGcTime(this.options.gcTime),this.state&&this.state.data===void 0){const s=ea(this.options);s.data!==void 0&&(this.setState(Jn(s.data,s.dataUpdatedAt)),he(this,It,s))}}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&U(this,Ge).remove(this)}setData(r,s){const n=Bh(this.state.data,r,this.options);return ze(this,Ze,ht).call(this,{data:n,type:"success",dataUpdatedAt:s==null?void 0:s.updatedAt,manual:s==null?void 0:s.manual}),n}setState(r,s){ze(this,Ze,ht).call(this,{type:"setState",state:r,setStateOptions:s})}cancel(r){var n,a;const s=(n=U(this,Ie))==null?void 0:n.promise;return(a=U(this,Ie))==null||a.cancel(r),s?s.then(Ye).catch(Ye):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(U(this,It))}isActive(){return this.observers.some(r=>Lh(r.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===fn||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(r=>Ps(r.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(r=>r.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(r=0){return this.state.data===void 0?!0:r==="static"?!1:this.state.isInvalidated?!0:!zh(this.state.dataUpdatedAt,r)}onFocus(){var s;const r=this.observers.find(n=>n.shouldFetchOnWindowFocus());r==null||r.refetch({cancelRefetch:!1}),(s=U(this,Ie))==null||s.continue()}onOnline(){var s;const r=this.observers.find(n=>n.shouldFetchOnReconnect());r==null||r.refetch({cancelRefetch:!1}),(s=U(this,Ie))==null||s.continue()}addObserver(r){this.observers.includes(r)||(this.observers.push(r),this.clearGcTimeout(),U(this,Ge).notify({type:"observerAdded",query:this,observer:r}))}removeObserver(r){this.observers.includes(r)&&(this.observers=this.observers.filter(s=>s!==r),this.observers.length||(U(this,Ie)&&(U(this,Lt)?U(this,Ie).cancel({revert:!0}):U(this,Ie).cancelRetry()),this.scheduleGc()),U(this,Ge).notify({type:"observerRemoved",query:this,observer:r}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||ze(this,Ze,ht).call(this,{type:"invalidate"})}async fetch(r,s){var c,f,m,p,b,h,w,d,u,g,x,j;if(this.state.fetchStatus!=="idle"&&((c=U(this,Ie))==null?void 0:c.status())!=="rejected"){if(this.state.data!==void 0&&(s!=null&&s.cancelRefetch))this.cancel({silent:!0});else if(U(this,Ie))return U(this,Ie).continueRetry(),U(this,Ie).promise}if(r&&this.setOptions(r),!this.options.queryFn){const k=this.observers.find(N=>N.options.queryFn);k&&this.setOptions(k.options)}const n=new AbortController,a=k=>{Object.defineProperty(k,"signal",{enumerable:!0,get:()=>(he(this,Lt,!0),n.signal)})},i=()=>{const k=Ki(this.options,s),P=(()=>{const A={client:U(this,zt),queryKey:this.queryKey,meta:this.meta};return a(A),A})();return he(this,Lt,!1),this.options.persister?this.options.persister(k,P,this):k(P)},o=(()=>{const k={fetchOptions:s,options:this.options,queryKey:this.queryKey,client:U(this,zt),state:this.state,fetchFn:i};return a(k),k})();(f=this.options.behavior)==null||f.onFetch(o,this),he(this,qt,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((m=o.fetchOptions)==null?void 0:m.meta))&&ze(this,Ze,ht).call(this,{type:"fetch",meta:(p=o.fetchOptions)==null?void 0:p.meta}),he(this,Ie,Xi({initialPromise:s==null?void 0:s.initialPromise,fn:o.fetchFn,onCancel:k=>{k instanceof Rs&&k.revert&&this.setState({...U(this,qt),fetchStatus:"idle"}),n.abort()},onFail:(k,N)=>{ze(this,Ze,ht).call(this,{type:"failed",failureCount:k,error:N})},onPause:()=>{ze(this,Ze,ht).call(this,{type:"pause"})},onContinue:()=>{ze(this,Ze,ht).call(this,{type:"continue"})},retry:o.options.retry,retryDelay:o.options.retryDelay,networkMode:o.options.networkMode,canRun:()=>!0}));try{const k=await U(this,Ie).start();if(k===void 0)throw new Error(`${this.queryHash} data is undefined`);return this.setData(k),(h=(b=U(this,Ge).config).onSuccess)==null||h.call(b,k,this),(d=(w=U(this,Ge).config).onSettled)==null||d.call(w,k,this.state.error,this),k}catch(k){if(k instanceof Rs){if(k.silent)return U(this,Ie).promise;if(k.revert){if(this.state.data===void 0)throw k;return this.state.data}}throw ze(this,Ze,ht).call(this,{type:"error",error:k}),(g=(u=U(this,Ge).config).onError)==null||g.call(u,k,this),(j=(x=U(this,Ge).config).onSettled)==null||j.call(x,this.state.data,k,this),k}finally{this.scheduleGc()}}},It=new WeakMap,qt=new WeakMap,Ge=new WeakMap,zt=new WeakMap,Ie=new WeakMap,mr=new WeakMap,Lt=new WeakMap,Ze=new WeakSet,ht=function(r){const s=n=>{switch(r.type){case"failed":return{...n,fetchFailureCount:r.failureCount,fetchFailureReason:r.error};case"pause":return{...n,fetchStatus:"paused"};case"continue":return{...n,fetchStatus:"fetching"};case"fetch":return{...n,...Qh(n.data,this.options),fetchMeta:r.meta??null};case"success":const a={...n,...Jn(r.data,r.dataUpdatedAt),dataUpdateCount:n.dataUpdateCount+1,...!r.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return he(this,qt,r.manual?a:void 0),a;case"error":const i=r.error;return{...n,error:i,errorUpdateCount:n.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:n.fetchFailureCount+1,fetchFailureReason:i,fetchStatus:"idle",status:"error",isInvalidated:!0};case"invalidate":return{...n,isInvalidated:!0};case"setState":return{...n,...r.state}}};this.state=s(this.state),Be.batch(()=>{this.observers.forEach(n=>{n.onQueryUpdate()}),U(this,Ge).notify({query:this,type:"updated",action:r})})},xa);function Qh(t,r){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:Zi(r.networkMode)?"fetching":"paused",...t===void 0&&{error:null,status:"pending"}}}function Jn(t,r){return{data:t,dataUpdatedAt:r??Date.now(),error:null,isInvalidated:!1,status:"success"}}function ea(t){const r=typeof t.initialData=="function"?t.initialData():t.initialData,s=r!==void 0,n=s?typeof t.initialDataUpdatedAt=="function"?t.initialDataUpdatedAt():t.initialDataUpdatedAt:0;return{data:r,dataUpdateCount:0,dataUpdatedAt:s?n??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:s?"success":"pending",fetchStatus:"idle"}}function ta(t){return{onFetch:(r,s)=>{var m,p,b,h,w;const n=r.options,a=(b=(p=(m=r.fetchOptions)==null?void 0:m.meta)==null?void 0:p.fetchMore)==null?void 0:b.direction,i=((h=r.state.data)==null?void 0:h.pages)||[],l=((w=r.state.data)==null?void 0:w.pageParams)||[];let o={pages:[],pageParams:[]},c=0;const f=async()=>{let d=!1;const u=j=>{Hh(j,()=>r.signal,()=>d=!0)},g=Ki(r.options,r.fetchOptions),x=async(j,k,N)=>{if(d)return Promise.reject();if(k==null&&j.pages.length)return Promise.resolve(j);const A=(()=>{const K={client:r.client,queryKey:r.queryKey,pageParam:k,direction:N?"backward":"forward",meta:r.options.meta};return u(K),K})(),F=await g(A),{maxPages:R}=r.options,B=N?Vh:Uh;return{pages:B(j.pages,F,R),pageParams:B(j.pageParams,k,R)}};if(a&&i.length){const j=a==="backward",k=j?Jh:ra,N={pages:i,pageParams:l},P=k(n,N);o=await x(N,P,j)}else{const j=t??i.length;do{const k=c===0?l[0]??n.initialPageParam:ra(n,o);if(c>0&&k==null)break;o=await x(o,k),c++}while(c<j)}return o};r.options.persister?r.fetchFn=()=>{var d,u;return(u=(d=r.options).persister)==null?void 0:u.call(d,f,{client:r.client,queryKey:r.queryKey,meta:r.options.meta,signal:r.signal},s)}:r.fetchFn=f}}}function ra(t,{pages:r,pageParams:s}){const n=r.length-1;return r.length>0?t.getNextPageParam(r[n],r,s[n],s):void 0}function Jh(t,{pages:r,pageParams:s}){var n;return r.length>0?(n=t.getPreviousPageParam)==null?void 0:n.call(t,r[0],r,s[0],s):void 0}var xr,rt,Le,Mt,st,vt,ga,ef=(ga=class extends Qi{constructor(r){super();xe(this,st);xe(this,xr);xe(this,rt);xe(this,Le);xe(this,Mt);he(this,xr,r.client),this.mutationId=r.mutationId,he(this,Le,r.mutationCache),he(this,rt,[]),this.state=r.state||tf(),this.setOptions(r.options),this.scheduleGc()}setOptions(r){this.options=r,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(r){U(this,rt).includes(r)||(U(this,rt).push(r),this.clearGcTimeout(),U(this,Le).notify({type:"observerAdded",mutation:this,observer:r}))}removeObserver(r){he(this,rt,U(this,rt).filter(s=>s!==r)),this.scheduleGc(),U(this,Le).notify({type:"observerRemoved",mutation:this,observer:r})}optionalRemove(){U(this,rt).length||(this.state.status==="pending"?this.scheduleGc():U(this,Le).remove(this))}continue(){var r;return((r=U(this,Mt))==null?void 0:r.continue())??this.execute(this.state.variables)}async execute(r){var l,o,c,f,m,p,b,h,w,d,u,g,x,j,k,N,P,A;const s=()=>{ze(this,st,vt).call(this,{type:"continue"})},n={client:U(this,xr),meta:this.options.meta,mutationKey:this.options.mutationKey};he(this,Mt,Xi({fn:()=>this.options.mutationFn?this.options.mutationFn(r,n):Promise.reject(new Error("No mutationFn found")),onFail:(F,R)=>{ze(this,st,vt).call(this,{type:"failed",failureCount:F,error:R})},onPause:()=>{ze(this,st,vt).call(this,{type:"pause"})},onContinue:s,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>U(this,Le).canRun(this)}));const a=this.state.status==="pending",i=!U(this,Mt).canStart();try{if(a)s();else{ze(this,st,vt).call(this,{type:"pending",variables:r,isPaused:i}),U(this,Le).config.onMutate&&await U(this,Le).config.onMutate(r,this,n);const R=await((o=(l=this.options).onMutate)==null?void 0:o.call(l,r,n));R!==this.state.context&&ze(this,st,vt).call(this,{type:"pending",context:R,variables:r,isPaused:i})}const F=await U(this,Mt).start();return await((f=(c=U(this,Le).config).onSuccess)==null?void 0:f.call(c,F,r,this.state.context,this,n)),await((p=(m=this.options).onSuccess)==null?void 0:p.call(m,F,r,this.state.context,n)),await((h=(b=U(this,Le).config).onSettled)==null?void 0:h.call(b,F,null,this.state.variables,this.state.context,this,n)),await((d=(w=this.options).onSettled)==null?void 0:d.call(w,F,null,r,this.state.context,n)),ze(this,st,vt).call(this,{type:"success",data:F}),F}catch(F){try{await((g=(u=U(this,Le).config).onError)==null?void 0:g.call(u,F,r,this.state.context,this,n))}catch(R){Promise.reject(R)}try{await((j=(x=this.options).onError)==null?void 0:j.call(x,F,r,this.state.context,n))}catch(R){Promise.reject(R)}try{await((N=(k=U(this,Le).config).onSettled)==null?void 0:N.call(k,void 0,F,this.state.variables,this.state.context,this,n))}catch(R){Promise.reject(R)}try{await((A=(P=this.options).onSettled)==null?void 0:A.call(P,void 0,F,r,this.state.context,n))}catch(R){Promise.reject(R)}throw ze(this,st,vt).call(this,{type:"error",error:F}),F}finally{U(this,Le).runNext(this)}}},xr=new WeakMap,rt=new WeakMap,Le=new WeakMap,Mt=new WeakMap,st=new WeakSet,vt=function(r){const s=n=>{switch(r.type){case"failed":return{...n,failureCount:r.failureCount,failureReason:r.error};case"pause":return{...n,isPaused:!0};case"continue":return{...n,isPaused:!1};case"pending":return{...n,context:r.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:r.isPaused,status:"pending",variables:r.variables,submittedAt:Date.now()};case"success":return{...n,data:r.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...n,data:void 0,error:r.error,failureCount:n.failureCount+1,failureReason:r.error,isPaused:!1,status:"error"}}};this.state=s(this.state),Be.batch(()=>{U(this,rt).forEach(n=>{n.onMutationUpdate(r)}),U(this,Le).notify({mutation:this,type:"updated",action:r})})},ga);function tf(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var ft,Xe,gr,ya,rf=(ya=class extends ss{constructor(r={}){super();xe(this,ft);xe(this,Xe);xe(this,gr);this.config=r,he(this,ft,new Set),he(this,Xe,new Map),he(this,gr,0)}build(r,s,n){const a=new ef({client:r,mutationCache:this,mutationId:++kr(this,gr)._,options:r.defaultMutationOptions(s),state:n});return this.add(a),a}add(r){U(this,ft).add(r);const s=Er(r);if(typeof s=="string"){const n=U(this,Xe).get(s);n?n.push(r):U(this,Xe).set(s,[r])}this.notify({type:"added",mutation:r})}remove(r){if(U(this,ft).delete(r)){const s=Er(r);if(typeof s=="string"){const n=U(this,Xe).get(s);if(n)if(n.length>1){const a=n.indexOf(r);a!==-1&&n.splice(a,1)}else n[0]===r&&U(this,Xe).delete(s)}}this.notify({type:"removed",mutation:r})}canRun(r){const s=Er(r);if(typeof s=="string"){const n=U(this,Xe).get(s),a=n==null?void 0:n.find(i=>i.state.status==="pending");return!a||a===r}else return!0}runNext(r){var n;const s=Er(r);if(typeof s=="string"){const a=(n=U(this,Xe).get(s))==null?void 0:n.find(i=>i!==r&&i.state.isPaused);return(a==null?void 0:a.continue())??Promise.resolve()}else return Promise.resolve()}clear(){Be.batch(()=>{U(this,ft).forEach(r=>{this.notify({type:"removed",mutation:r})}),U(this,ft).clear(),U(this,Xe).clear()})}getAll(){return Array.from(U(this,ft))}find(r){const s={exact:!0,...r};return this.getAll().find(n=>Zn(s,n))}findAll(r={}){return this.getAll().filter(s=>Zn(r,s))}notify(r){Be.batch(()=>{this.listeners.forEach(s=>{s(r)})})}resumePausedMutations(){const r=this.getAll().filter(s=>s.state.isPaused);return Be.batch(()=>Promise.all(r.map(s=>s.continue().catch(Ye))))}},ft=new WeakMap,Xe=new WeakMap,gr=new WeakMap,ya);function Er(t){var r;return(r=t.options.scope)==null?void 0:r.id}var nt,va,sf=(va=class extends ss{constructor(r={}){super();xe(this,nt);this.config=r,he(this,nt,new Map)}build(r,s,n){const a=s.queryKey,i=s.queryHash??hn(a,s);let l=this.get(i);return l||(l=new Xh({client:r,queryKey:a,queryHash:i,options:r.defaultQueryOptions(s),state:n,defaultOptions:r.getQueryDefaults(a)}),this.add(l)),l}add(r){U(this,nt).has(r.queryHash)||(U(this,nt).set(r.queryHash,r),this.notify({type:"added",query:r}))}remove(r){const s=U(this,nt).get(r.queryHash);s&&(r.destroy(),s===r&&U(this,nt).delete(r.queryHash),this.notify({type:"removed",query:r}))}clear(){Be.batch(()=>{this.getAll().forEach(r=>{this.remove(r)})})}get(r){return U(this,nt).get(r)}getAll(){return[...U(this,nt).values()]}find(r){const s={exact:!0,...r};return this.getAll().find(n=>Yn(s,n))}findAll(r={}){const s=this.getAll();return Object.keys(r).length>0?s.filter(n=>Yn(r,n)):s}notify(r){Be.batch(()=>{this.listeners.forEach(s=>{s(r)})})}onFocus(){Be.batch(()=>{this.getAll().forEach(r=>{r.onFocus()})})}onOnline(){Be.batch(()=>{this.getAll().forEach(r=>{r.onOnline()})})}},nt=new WeakMap,va),Se,Nt,kt,Kt,Yt,Ct,Zt,Xt,ba,nf=(ba=class{constructor(t={}){xe(this,Se);xe(this,Nt);xe(this,kt);xe(this,Kt);xe(this,Yt);xe(this,Ct);xe(this,Zt);xe(this,Xt);he(this,Se,t.queryCache||new sf),he(this,Nt,t.mutationCache||new rf),he(this,kt,t.defaultOptions||{}),he(this,Kt,new Map),he(this,Yt,new Map),he(this,Ct,0)}mount(){kr(this,Ct)._++,U(this,Ct)===1&&(he(this,Zt,Yi.subscribe(async t=>{t&&(await this.resumePausedMutations(),U(this,Se).onFocus())})),he(this,Xt,Ur.subscribe(async t=>{t&&(await this.resumePausedMutations(),U(this,Se).onOnline())})))}unmount(){var t,r;kr(this,Ct)._--,U(this,Ct)===0&&((t=U(this,Zt))==null||t.call(this),he(this,Zt,void 0),(r=U(this,Xt))==null||r.call(this),he(this,Xt,void 0))}isFetching(t){return U(this,Se).findAll({...t,fetchStatus:"fetching"}).length}isMutating(t){return U(this,Nt).findAll({...t,status:"pending"}).length}getQueryData(t){var s;const r=this.defaultQueryOptions({queryKey:t});return(s=U(this,Se).get(r.queryHash))==null?void 0:s.state.data}ensureQueryData(t){const r=this.defaultQueryOptions(t),s=U(this,Se).build(this,r),n=s.state.data;return n===void 0?this.fetchQuery(t):(t.revalidateIfStale&&s.isStaleByTime(Ps(r.staleTime,s))&&this.prefetchQuery(r),Promise.resolve(n))}getQueriesData(t){return U(this,Se).findAll(t).map(({queryKey:r,state:s})=>{const n=s.data;return[r,n]})}setQueryData(t,r,s){const n=this.defaultQueryOptions({queryKey:t}),a=U(this,Se).get(n.queryHash),i=a==null?void 0:a.state.data,l=Fh(r,i);if(l!==void 0)return U(this,Se).build(this,n).setData(l,{...s,manual:!0})}setQueriesData(t,r,s){return Be.batch(()=>U(this,Se).findAll(t).map(({queryKey:n})=>[n,this.setQueryData(n,r,s)]))}getQueryState(t){var s;const r=this.defaultQueryOptions({queryKey:t});return(s=U(this,Se).get(r.queryHash))==null?void 0:s.state}removeQueries(t){const r=U(this,Se);Be.batch(()=>{r.findAll(t).forEach(s=>{r.remove(s)})})}resetQueries(t,r){const s=U(this,Se);return Be.batch(()=>(s.findAll(t).forEach(n=>{n.reset()}),this.refetchQueries({type:"active",...t},r)))}cancelQueries(t,r={}){const s={revert:!0,...r},n=Be.batch(()=>U(this,Se).findAll(t).map(a=>a.cancel(s)));return Promise.all(n).then(Ye).catch(Ye)}invalidateQueries(t,r={}){return Be.batch(()=>(U(this,Se).findAll(t).forEach(s=>{s.invalidate()}),(t==null?void 0:t.refetchType)==="none"?Promise.resolve():this.refetchQueries({...t,type:(t==null?void 0:t.refetchType)??(t==null?void 0:t.type)??"active"},r)))}refetchQueries(t,r={}){const s={...r,cancelRefetch:r.cancelRefetch??!0},n=Be.batch(()=>U(this,Se).findAll(t).filter(a=>!a.isDisabled()&&!a.isStatic()).map(a=>{let i=a.fetch(void 0,s);return s.throwOnError||(i=i.catch(Ye)),a.state.fetchStatus==="paused"?Promise.resolve():i}));return Promise.all(n).then(Ye)}fetchQuery(t){const r=this.defaultQueryOptions(t);r.retry===void 0&&(r.retry=!1);const s=U(this,Se).build(this,r);return s.isStaleByTime(Ps(r.staleTime,s))?s.fetch(r):Promise.resolve(s.state.data)}prefetchQuery(t){return this.fetchQuery(t).then(Ye).catch(Ye)}fetchInfiniteQuery(t){return t.behavior=ta(t.pages),this.fetchQuery(t)}prefetchInfiniteQuery(t){return this.fetchInfiniteQuery(t).then(Ye).catch(Ye)}ensureInfiniteQueryData(t){return t.behavior=ta(t.pages),this.ensureQueryData(t)}resumePausedMutations(){return Ur.isOnline()?U(this,Nt).resumePausedMutations():Promise.resolve()}getQueryCache(){return U(this,Se)}getMutationCache(){return U(this,Nt)}getDefaultOptions(){return U(this,kt)}setDefaultOptions(t){he(this,kt,t)}setQueryDefaults(t,r){U(this,Kt).set(fr(t),{queryKey:t,defaultOptions:r})}getQueryDefaults(t){const r=[...U(this,Kt).values()],s={};return r.forEach(n=>{pr(t,n.queryKey)&&Object.assign(s,n.defaultOptions)}),s}setMutationDefaults(t,r){U(this,Yt).set(fr(t),{mutationKey:t,defaultOptions:r})}getMutationDefaults(t){const r=[...U(this,Yt).values()],s={};return r.forEach(n=>{pr(t,n.mutationKey)&&Object.assign(s,n.defaultOptions)}),s}defaultQueryOptions(t){if(t._defaulted)return t;const r={...U(this,kt).queries,...this.getQueryDefaults(t.queryKey),...t,_defaulted:!0};return r.queryHash||(r.queryHash=hn(r.queryKey,r)),r.refetchOnReconnect===void 0&&(r.refetchOnReconnect=r.networkMode!=="always"),r.throwOnError===void 0&&(r.throwOnError=!!r.suspense),!r.networkMode&&r.persister&&(r.networkMode="offlineFirst"),r.queryFn===fn&&(r.enabled=!1),r}defaultMutationOptions(t){return t!=null&&t._defaulted?t:{...U(this,kt).mutations,...(t==null?void 0:t.mutationKey)&&this.getMutationDefaults(t.mutationKey),...t,_defaulted:!0}}clear(){U(this,Se).clear(),U(this,Nt).clear()}},Se=new WeakMap,Nt=new WeakMap,kt=new WeakMap,Kt=new WeakMap,Yt=new WeakMap,Ct=new WeakMap,Zt=new WeakMap,Xt=new WeakMap,ba),af=C.createContext(void 0),of=({client:t,children:r})=>(C.useEffect(()=>(t.mount(),()=>{t.unmount()}),[t]),e.jsx(af.Provider,{value:t,children:r}));class lf extends C.Component{constructor(){super(...arguments);or(this,"state",{hasError:!1,error:null,errorInfo:null});or(this,"handleReload",()=>{window.location.reload()});or(this,"handleGoHome",()=>{window.location.href="/"});or(this,"handleReportBug",()=>{var a,i,l;const s=`Error: ${(a=this.state.error)==null?void 0:a.message}

Stack: ${(i=this.state.error)==null?void 0:i.stack}

Component Stack: ${(l=this.state.errorInfo)==null?void 0:l.componentStack}`,n=`mailto:support@deckforge.com?subject=DeckForge Error Report&body=${encodeURIComponent(s)}`;window.location.href=n})}static getDerivedStateFromError(s){return{hasError:!0,error:s,errorInfo:null}}componentDidCatch(s,n){console.error("ErrorBoundary caught an error:",s,n),this.setState({error:s,errorInfo:n});try{const a=localStorage.getItem("deckforge-autosave");if(a){const i={timestamp:new Date().toISOString(),state:a};localStorage.setItem("deckforge-crash-backup",JSON.stringify(i))}}catch(a){console.error("Failed to save crash backup:",a)}}render(){var s,n;return this.state.hasError?this.props.fallback?this.props.fallback:e.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center p-8",children:e.jsx("div",{className:"max-w-2xl w-full",children:e.jsxs("div",{className:"bg-card border-2 border-destructive p-8 space-y-6",children:[e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:"w-20 h-20 rounded-full bg-destructive/20 flex items-center justify-center",children:e.jsx(_n,{className:"w-10 h-10 text-destructive"})})}),e.jsxs("div",{className:"text-center space-y-2",children:[e.jsx("h1",{className:"font-display text-2xl uppercase tracking-widest",children:"Something Went Wrong"}),e.jsx("p",{className:"text-muted-foreground",children:"DeckForge encountered an unexpected error"})]}),e.jsxs("details",{className:"bg-secondary p-4 rounded border border-border",children:[e.jsx("summary",{className:"cursor-pointer text-sm font-mono text-muted-foreground hover:text-foreground transition-colors",children:"Technical Details (click to expand)"}),e.jsx("div",{className:"mt-4 space-y-2",children:e.jsxs("div",{className:"text-xs font-mono bg-background p-3 rounded overflow-auto max-h-40",children:[e.jsx("p",{className:"text-destructive font-semibold",children:(s=this.state.error)==null?void 0:s.message}),((n=this.state.error)==null?void 0:n.stack)&&e.jsx("pre",{className:"mt-2 text-muted-foreground text-[10px] whitespace-pre-wrap",children:this.state.error.stack})]})})]}),e.jsx("div",{className:"bg-accent/10 border border-accent/30 p-4 rounded",children:e.jsxs("p",{className:"text-sm text-foreground flex items-start gap-2",children:[e.jsx("span",{className:"text-lg",children:""}),e.jsxs("span",{children:[e.jsx("strong",{children:"Your work may be saved!"})," We automatically backed up your design before the crash. Try reloading the page to recover it."]})]})}),e.jsxs("div",{className:"flex flex-wrap gap-3 justify-center",children:[e.jsxs(X,{onClick:this.handleReload,className:"gap-2",children:[e.jsx(Tl,{className:"w-4 h-4"}),"Reload Page"]}),e.jsxs(X,{onClick:this.handleGoHome,variant:"outline",className:"gap-2",children:[e.jsx(Rl,{className:"w-4 h-4"}),"Go to Dashboard"]}),e.jsxs(X,{onClick:this.handleReportBug,variant:"outline",className:"gap-2",children:[e.jsx(_n,{className:"w-4 h-4"}),"Report Bug"]})]}),e.jsx("div",{className:"text-center",children:e.jsxs("p",{className:"text-xs text-muted-foreground",children:["If this keeps happening,"," ",e.jsx("a",{href:"/designs",className:"text-accent hover:underline",children:"try starting a new design"})," ","or"," ",e.jsx("a",{href:"mailto:support@deckforge.com",className:"text-accent hover:underline",children:"contact support"})]})})]})})}):this.props.children}}const cf="modulepreload",df=function(t){return"/"+t},sa={},yt=function(r,s,n){let a=Promise.resolve();if(s&&s.length>0){document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),o=(l==null?void 0:l.nonce)||(l==null?void 0:l.getAttribute("nonce"));a=Promise.allSettled(s.map(c=>{if(c=df(c),c in sa)return;sa[c]=!0;const f=c.endsWith(".css"),m=f?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${m}`))return;const p=document.createElement("link");if(p.rel=f?"stylesheet":cf,f||(p.as="script"),p.crossOrigin="",p.href=c,o&&p.setAttribute("nonce",o),document.head.appendChild(p),f)return new Promise((b,h)=>{p.addEventListener("load",b),p.addEventListener("error",()=>h(new Error(`Unable to preload CSS for ${c}`)))})}))}function i(l){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=l,window.dispatchEvent(o),!o.defaultPrevented)throw l}return a.then(l=>{for(const o of l||[])o.status==="rejected"&&i(o.reason);return r().catch(i)})},gs=[{id:"pen",icon:$s,label:"Pen Tool",shortcut:"P",description:"Draw custom shapes with click-to-point or free draw"},{id:"stickers",icon:Aa,label:"Stickers",shortcut:"S",description:"Add vector icons and decals from library"},{id:"lines",icon:Pa,label:"Lines",shortcut:"L",description:"Draw straight, curved, and decorative lines"},{id:"patterns",icon:Ta,label:"Patterns",description:"Apply procedural patterns (checkerboard, stripes, etc.)"},{id:"textures",icon:Bs,label:"Textures",description:"Add realistic texture overlays (concrete, rust, graffiti)"},{id:"graphics",icon:Us,label:"Graphics",shortcut:"G",description:"Basic shapes (circle, square, star)"},{id:"text",icon:Wr,label:"Text",shortcut:"T",description:"Add text with custom fonts and styling"},{id:"uploads",icon:Fr,label:"Uploads",shortcut:"U",description:"Upload your own images, SVGs, and assets"},{id:"finishes",icon:Ir,label:"Finishes",description:"Apply print textures (scratched wood, grip tape, halftone)"}];function na(){const{activeTool:t,setActiveTool:r}=Ee();return C.useEffect(()=>{const s=n=>{if(n.target instanceof HTMLInputElement||n.target instanceof HTMLTextAreaElement||n.ctrlKey||n.metaKey||n.altKey)return;const a=n.key.toLowerCase(),i=gs.find(l=>{var o;return((o=l.shortcut)==null?void 0:o.toLowerCase())===a});i&&(n.preventDefault(),r(t===i.id?null:i.id))};return window.addEventListener("keydown",s),()=>window.removeEventListener("keydown",s)},[t,r]),e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"hidden md:flex flex-col w-14 bg-card border-r border-border h-full",children:[e.jsx("div",{className:"py-4 px-2 border-b border-border",children:e.jsx("span",{className:"font-display text-[10px] uppercase tracking-widest text-muted-foreground block text-center",children:"Tools"})}),e.jsx(_t,{className:"flex-1",children:e.jsx("div",{className:"flex flex-col gap-1 p-2",children:gs.map(s=>{const n=s.icon,a=t===s.id;return e.jsxs(dn,{delayDuration:300,children:[e.jsx(un,{asChild:!0,children:e.jsx("button",{onClick:()=>r(a?null:s.id),className:be("w-10 h-10 flex items-center justify-center border border-transparent","hover:border-border hover:bg-secondary transition-colors duration-75",a&&"tool-active border-primary"),children:e.jsx(n,{className:"w-5 h-5",strokeWidth:1.5})})}),e.jsx(rs,{side:"right",className:"max-w-xs",children:e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsx("span",{className:"font-semibold",children:s.label}),s.shortcut&&e.jsx("kbd",{className:"px-1.5 py-0.5 text-xs bg-muted border border-border rounded font-mono",children:s.shortcut})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:s.description})]})})]},s.id)})})})]}),e.jsx("div",{className:"md:hidden w-full bg-card border-b border-border",children:e.jsx(_t,{className:"w-full",orientation:"horizontal",children:e.jsx("div",{className:"flex gap-1 p-2",children:gs.map(s=>{const n=s.icon,a=t===s.id;return e.jsxs("button",{onClick:()=>r(a?null:s.id),className:be("min-w-[64px] h-16 flex flex-col items-center justify-center gap-1 border border-transparent shrink-0","active:bg-secondary/80 active:scale-95 transition-all duration-75 touch-manipulation",a&&"tool-active border-primary bg-primary/10"),children:[e.jsx(n,{className:"w-5 h-5",strokeWidth:1.5}),e.jsx("span",{className:"text-[9px] uppercase tracking-wider",children:s.label})]},s.id)})})})})]})}function Ji(t){const r=C.useRef({value:t,previous:t});return C.useMemo(()=>(r.current.value!==t&&(r.current.previous=r.current.value,r.current.value=t),r.current.previous),[t])}var eo=["PageUp","PageDown"],to=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],ro={"from-left":["Home","PageDown","ArrowDown","ArrowLeft"],"from-right":["Home","PageDown","ArrowDown","ArrowRight"],"from-bottom":["Home","PageDown","ArrowDown","ArrowLeft"],"from-top":["Home","PageDown","ArrowUp","ArrowLeft"]},ar="Slider",[Ds,uf,hf]=Ks(ar),[so]=xt(ar,[hf]),[ff,as]=so(ar),no=C.forwardRef((t,r)=>{const{name:s,min:n=0,max:a=100,step:i=1,orientation:l="horizontal",disabled:o=!1,minStepsBetweenThumbs:c=0,defaultValue:f=[n],value:m,onValueChange:p=()=>{},onValueCommit:b=()=>{},inverted:h=!1,form:w,...d}=t,u=C.useRef(new Set),g=C.useRef(0),j=l==="horizontal"?pf:mf,[k=[],N]=At({prop:m,defaultProp:f,onChange:K=>{var D;(D=[...u.current][g.current])==null||D.focus(),p(K)}}),P=C.useRef(k);function A(K){const _=bf(k,K);B(K,_)}function F(K){B(K,g.current)}function R(){const K=P.current[g.current];k[g.current]!==K&&b(k)}function B(K,_,{commit:D}={commit:!1}){const y=kf(i),O=Cf(Math.round((K-n)/i)*i+n,y),ee=Ca(O,[n,a]);N((M=[])=>{const Z=yf(M,ee,_);if(Nf(Z,c*i)){g.current=Z.indexOf(ee);const V=String(Z)!==String(M);return V&&D&&b(Z),V?Z:M}else return M})}return e.jsx(ff,{scope:t.__scopeSlider,name:s,disabled:o,min:n,max:a,valueIndexToChangeRef:g,thumbs:u.current,values:k,orientation:l,form:w,children:e.jsx(Ds.Provider,{scope:t.__scopeSlider,children:e.jsx(Ds.Slot,{scope:t.__scopeSlider,children:e.jsx(j,{"aria-disabled":o,"data-disabled":o?"":void 0,...d,ref:r,onPointerDown:ye(d.onPointerDown,()=>{o||(P.current=k)}),min:n,max:a,inverted:h,onSlideStart:o?void 0:A,onSlideMove:o?void 0:F,onSlideEnd:o?void 0:R,onHomeKeyDown:()=>!o&&B(n,0,{commit:!0}),onEndKeyDown:()=>!o&&B(a,k.length-1,{commit:!0}),onStepKeyDown:({event:K,direction:_})=>{if(!o){const O=eo.includes(K.key)||K.shiftKey&&to.includes(K.key)?10:1,ee=g.current,M=k[ee],Z=i*O*_;B(M+Z,ee,{commit:!0})}}})})})})});no.displayName=ar;var[ao,io]=so(ar,{startEdge:"left",endEdge:"right",size:"width",direction:1}),pf=C.forwardRef((t,r)=>{const{min:s,max:n,dir:a,inverted:i,onSlideStart:l,onSlideMove:o,onSlideEnd:c,onStepKeyDown:f,...m}=t,[p,b]=C.useState(null),h=Oe(r,j=>b(j)),w=C.useRef(void 0),d=ka(a),u=d==="ltr",g=u&&!i||!u&&i;function x(j){const k=w.current||p.getBoundingClientRect(),N=[0,k.width],A=pn(N,g?[s,n]:[n,s]);return w.current=k,A(j-k.left)}return e.jsx(ao,{scope:t.__scopeSlider,startEdge:g?"left":"right",endEdge:g?"right":"left",direction:g?1:-1,size:"width",children:e.jsx(oo,{dir:d,"data-orientation":"horizontal",...m,ref:h,style:{...m.style,"--radix-slider-thumb-transform":"translateX(-50%)"},onSlideStart:j=>{const k=x(j.clientX);l==null||l(k)},onSlideMove:j=>{const k=x(j.clientX);o==null||o(k)},onSlideEnd:()=>{w.current=void 0,c==null||c()},onStepKeyDown:j=>{const N=ro[g?"from-left":"from-right"].includes(j.key);f==null||f({event:j,direction:N?-1:1})}})})}),mf=C.forwardRef((t,r)=>{const{min:s,max:n,inverted:a,onSlideStart:i,onSlideMove:l,onSlideEnd:o,onStepKeyDown:c,...f}=t,m=C.useRef(null),p=Oe(r,m),b=C.useRef(void 0),h=!a;function w(d){const u=b.current||m.current.getBoundingClientRect(),g=[0,u.height],j=pn(g,h?[n,s]:[s,n]);return b.current=u,j(d-u.top)}return e.jsx(ao,{scope:t.__scopeSlider,startEdge:h?"bottom":"top",endEdge:h?"top":"bottom",size:"height",direction:h?1:-1,children:e.jsx(oo,{"data-orientation":"vertical",...f,ref:p,style:{...f.style,"--radix-slider-thumb-transform":"translateY(50%)"},onSlideStart:d=>{const u=w(d.clientY);i==null||i(u)},onSlideMove:d=>{const u=w(d.clientY);l==null||l(u)},onSlideEnd:()=>{b.current=void 0,o==null||o()},onStepKeyDown:d=>{const g=ro[h?"from-bottom":"from-top"].includes(d.key);c==null||c({event:d,direction:g?-1:1})}})})}),oo=C.forwardRef((t,r)=>{const{__scopeSlider:s,onSlideStart:n,onSlideMove:a,onSlideEnd:i,onHomeKeyDown:l,onEndKeyDown:o,onStepKeyDown:c,...f}=t,m=as(ar,s);return e.jsx(ke.span,{...f,ref:r,onKeyDown:ye(t.onKeyDown,p=>{p.key==="Home"?(l(p),p.preventDefault()):p.key==="End"?(o(p),p.preventDefault()):eo.concat(to).includes(p.key)&&(c(p),p.preventDefault())}),onPointerDown:ye(t.onPointerDown,p=>{const b=p.target;b.setPointerCapture(p.pointerId),p.preventDefault(),m.thumbs.has(b)?b.focus():n(p)}),onPointerMove:ye(t.onPointerMove,p=>{p.target.hasPointerCapture(p.pointerId)&&a(p)}),onPointerUp:ye(t.onPointerUp,p=>{const b=p.target;b.hasPointerCapture(p.pointerId)&&(b.releasePointerCapture(p.pointerId),i(p))})})}),lo="SliderTrack",co=C.forwardRef((t,r)=>{const{__scopeSlider:s,...n}=t,a=as(lo,s);return e.jsx(ke.span,{"data-disabled":a.disabled?"":void 0,"data-orientation":a.orientation,...n,ref:r})});co.displayName=lo;var Os="SliderRange",uo=C.forwardRef((t,r)=>{const{__scopeSlider:s,...n}=t,a=as(Os,s),i=io(Os,s),l=C.useRef(null),o=Oe(r,l),c=a.values.length,f=a.values.map(b=>po(b,a.min,a.max)),m=c>1?Math.min(...f):0,p=100-Math.max(...f);return e.jsx(ke.span,{"data-orientation":a.orientation,"data-disabled":a.disabled?"":void 0,...n,ref:o,style:{...t.style,[i.startEdge]:m+"%",[i.endEdge]:p+"%"}})});uo.displayName=Os;var Fs="SliderThumb",ho=C.forwardRef((t,r)=>{const s=uf(t.__scopeSlider),[n,a]=C.useState(null),i=Oe(r,o=>a(o)),l=C.useMemo(()=>n?s().findIndex(o=>o.ref.current===n):-1,[s,n]);return e.jsx(xf,{...t,ref:i,index:l})}),xf=C.forwardRef((t,r)=>{const{__scopeSlider:s,index:n,name:a,...i}=t,l=as(Fs,s),o=io(Fs,s),[c,f]=C.useState(null),m=Oe(r,x=>f(x)),p=c?l.form||!!c.closest("form"):!0,b=nn(c),h=l.values[n],w=h===void 0?0:po(h,l.min,l.max),d=vf(n,l.values.length),u=b==null?void 0:b[o.size],g=u?wf(u,w,o.direction):0;return C.useEffect(()=>{if(c)return l.thumbs.add(c),()=>{l.thumbs.delete(c)}},[c,l.thumbs]),e.jsxs("span",{style:{transform:"var(--radix-slider-thumb-transform)",position:"absolute",[o.startEdge]:`calc(${w}% + ${g}px)`},children:[e.jsx(Ds.ItemSlot,{scope:t.__scopeSlider,children:e.jsx(ke.span,{role:"slider","aria-label":t["aria-label"]||d,"aria-valuemin":l.min,"aria-valuenow":h,"aria-valuemax":l.max,"aria-orientation":l.orientation,"data-orientation":l.orientation,"data-disabled":l.disabled?"":void 0,tabIndex:l.disabled?void 0:0,...i,ref:m,style:h===void 0?{display:"none"}:t.style,onFocus:ye(t.onFocus,()=>{l.valueIndexToChangeRef.current=n})})}),p&&e.jsx(fo,{name:a??(l.name?l.name+(l.values.length>1?"[]":""):void 0),form:l.form,value:h},n)]})});ho.displayName=Fs;var gf="RadioBubbleInput",fo=C.forwardRef(({__scopeSlider:t,value:r,...s},n)=>{const a=C.useRef(null),i=Oe(a,n),l=Ji(r);return C.useEffect(()=>{const o=a.current;if(!o)return;const c=window.HTMLInputElement.prototype,m=Object.getOwnPropertyDescriptor(c,"value").set;if(l!==r&&m){const p=new Event("input",{bubbles:!0});m.call(o,r),o.dispatchEvent(p)}},[l,r]),e.jsx(ke.input,{style:{display:"none"},...s,ref:i,defaultValue:r})});fo.displayName=gf;function yf(t=[],r,s){const n=[...t];return n[s]=r,n.sort((a,i)=>a-i)}function po(t,r,s){const i=100/(s-r)*(t-r);return Ca(i,[0,100])}function vf(t,r){return r>2?`Value ${t+1} of ${r}`:r===2?["Minimum","Maximum"][t]:void 0}function bf(t,r){if(t.length===1)return 0;const s=t.map(a=>Math.abs(a-r)),n=Math.min(...s);return s.indexOf(n)}function wf(t,r,s){const n=t/2,i=pn([0,50],[0,n]);return(n-i(r)*s)*s}function jf(t){return t.slice(0,-1).map((r,s)=>t[s+1]-r)}function Nf(t,r){if(r>0){const s=jf(t);return Math.min(...s)>=r}return!0}function pn(t,r){return s=>{if(t[0]===t[1]||r[0]===r[1])return r[0];const n=(r[1]-r[0])/(t[1]-t[0]);return r[0]+n*(s-t[0])}}function kf(t){return(String(t).split(".")[1]||"").length}function Cf(t,r){const s=Math.pow(10,r);return Math.round(t*s)/s}var mo=no,_f=co,Sf=uo,Ef=ho;const ve=C.forwardRef(({className:t,...r},s)=>e.jsxs(mo,{ref:s,className:be("relative flex w-full touch-none select-none items-center",t),...r,children:[e.jsx(_f,{className:"relative h-2 w-full grow overflow-hidden rounded-full bg-secondary",children:e.jsx(Sf,{className:"absolute h-full bg-primary"})}),e.jsx(Ef,{className:"block h-5 w-5 rounded-full border-2 border-primary bg-background ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50"})]}));ve.displayName=mo.displayName;async function Af(t){const r=await t.text(),n=new DOMParser().parseFromString(r,"image/svg+xml");if(n.querySelector("parsererror"))throw new Error("Invalid SVG file");const i=n.querySelector("svg");if(!i)throw new Error("No SVG element found");const l=i.getAttribute("viewBox");let o=parseFloat(i.getAttribute("width")||"100"),c=parseFloat(i.getAttribute("height")||"100");if(l){const[,,p,b]=l.split(/\s+/).map(parseFloat);o=p||o,c=b||c}const f=[];if(i.querySelectorAll("rect, circle, ellipse, path, polygon, polyline, line").forEach(p=>{const b=Pf(p,o,c);b&&f.push(b)}),f.length===0){const p=new XMLSerializer().serializeToString(i),b=new Blob([p],{type:"image/svg+xml"}),h=URL.createObjectURL(b);f.push({type:"image",x:0,y:0,width:Math.min(o,200),height:Math.min(c,200),rotation:0,opacity:1,scaleX:1,scaleY:1,src:h})}return f}function Pf(t,r,s){const n=t.tagName.toLowerCase(),a=t.getAttribute("fill")||"#000000",i=t.getAttribute("stroke")||"",l=parseFloat(t.getAttribute("stroke-width")||"0"),o=parseFloat(t.getAttribute("opacity")||"1");if(a==="none"&&!i)return null;switch(n){case"rect":return Tf(t,a,i,l,o);case"circle":return Rf(t,a,i,l,o);case"ellipse":return Df(t,a,i,l,o);case"line":return Of(t,i||a,l,o);case"path":case"polygon":case"polyline":return Ff(t,r,s,o);default:return null}}function Tf(t,r,s,n,a){const i=parseFloat(t.getAttribute("x")||"0"),l=parseFloat(t.getAttribute("y")||"0"),o=parseFloat(t.getAttribute("width")||"100"),c=parseFloat(t.getAttribute("height")||"100");return{type:"shape",shapeType:"rect",x:i,y:l,width:o,height:c,rotation:0,opacity:a,scaleX:1,scaleY:1,fill:r!=="none"?r:void 0,stroke:s||void 0,strokeWidth:n}}function Rf(t,r,s,n,a){const i=parseFloat(t.getAttribute("cx")||"50"),l=parseFloat(t.getAttribute("cy")||"50"),o=parseFloat(t.getAttribute("r")||"25");return{type:"shape",shapeType:"circle",x:i-o,y:l-o,width:o*2,height:o*2,rotation:0,opacity:a,scaleX:1,scaleY:1,fill:r!=="none"?r:void 0,stroke:s||void 0,strokeWidth:n}}function Df(t,r,s,n,a){const i=parseFloat(t.getAttribute("cx")||"50"),l=parseFloat(t.getAttribute("cy")||"50"),o=parseFloat(t.getAttribute("rx")||"25"),c=parseFloat(t.getAttribute("ry")||"25");return{type:"shape",shapeType:"circle",x:i-o,y:l-c,width:o*2,height:c*2,rotation:0,opacity:a,scaleX:1,scaleY:c/o,fill:r!=="none"?r:void 0,stroke:s||void 0,strokeWidth:n}}function Of(t,r,s,n){const a=parseFloat(t.getAttribute("x1")||"0"),i=parseFloat(t.getAttribute("y1")||"0"),l=parseFloat(t.getAttribute("x2")||"100"),o=parseFloat(t.getAttribute("y2")||"100");return{type:"line",x:a,y:i,width:Math.abs(l-a),height:Math.abs(o-i),rotation:0,opacity:n,scaleX:1,scaleY:1,lineType:"straight",lineEndX:l-a,lineEndY:o-i,stroke:r||"#000000",strokeWidth:s||2,lineCapStyle:"round"}}function Ff(t,r,s,n){let a={x:0,y:0,width:100,height:100};try{const m=document.createElementNS("http://www.w3.org/2000/svg","svg");m.style.position="absolute",m.style.visibility="hidden";const p=t.cloneNode(!0);if(m.appendChild(p),document.body.appendChild(m),p.getBBox){const b=p.getBBox();a={x:b.x,y:b.y,width:b.width,height:b.height}}document.body.removeChild(m)}catch(m){console.warn("Failed to get accurate bounding box, using defaults",m)}const i=t.cloneNode(!0),l=document.createElementNS("http://www.w3.org/2000/svg","svg");l.setAttribute("xmlns","http://www.w3.org/2000/svg"),l.setAttribute("viewBox",`${a.x} ${a.y} ${a.width} ${a.height}`),l.setAttribute("width",String(a.width)),l.setAttribute("height",String(a.height)),l.appendChild(i);const o=new XMLSerializer().serializeToString(l),c=new Blob([o],{type:"image/svg+xml"}),f=URL.createObjectURL(c);return{type:"image",x:a.x,y:a.y,width:a.width,height:a.height,rotation:0,opacity:n,scaleX:1,scaleY:1,src:f}}function If(t){const r=["image/svg+xml","image/svg","text/xml"],s=[".svg"],n=r.includes(t.type),a=s.some(i=>t.name.toLowerCase().endsWith(i));return n||a}const aa={edgy:[{name:"Skull",icon:mc},{name:"Flame",icon:xc},{name:"Zap",icon:gc},{name:"Sword",icon:yc},{name:"Ghost",icon:vc},{name:"Bug",icon:bc},{name:"Eye",icon:$t},{name:"Target",icon:Sn},{name:"Bomb",icon:wc},{name:"Swords",icon:jc},{name:"Shield",icon:Nc},{name:"Crosshair",icon:kc}],retro:[{name:"Radio",icon:nc},{name:"Disc",icon:ac},{name:"Music",icon:ic},{name:"Rocket",icon:oc},{name:"Crown",icon:lc},{name:"Anchor",icon:cc},{name:"Sun",icon:Da},{name:"Moon",icon:dc},{name:"Camera",icon:uc},{name:"Gamepad",icon:hc},{name:"Headphones",icon:fc},{name:"Watch",icon:pc}],shapes:[{name:"Triangle",icon:tc},{name:"Hexagon",icon:rc},{name:"Circle",icon:Ra},{name:"Square",icon:zr},{name:"Star",icon:Hs},{name:"Heart",icon:at},{name:"Sparkles",icon:Qe},{name:"Hand",icon:sc}],nature:[{name:"Cat",icon:ql},{name:"Dog",icon:Kl},{name:"Fish",icon:Yl},{name:"Bird",icon:Zl},{name:"Leaf",icon:Xl},{name:"Cloud",icon:Ql},{name:"Mountain",icon:Bs},{name:"Waves",icon:Jl},{name:"Feather",icon:ec}],street:[{name:"Pizza",icon:$l},{name:"Coffee",icon:Bl},{name:"Cherry",icon:Ul},{name:"Glasses",icon:Vl},{name:"Lock",icon:Vs},{name:"Key",icon:Hl},{name:"Fingerprint",icon:Wl},{name:"Compass",icon:Gl}],sports:[{name:"Trophy",icon:Il},{name:"Award",icon:zl},{name:"Medal",icon:Ll},{name:"Dumbbell",icon:Ml},{name:"Target",icon:Sn}],emoji:[{name:"Laugh",icon:Dl},{name:"Smile",icon:Ol},{name:"Frown",icon:Fl}]},zf=[{id:"checkerboard",name:"Checkerboard",description:"Vans style"},{id:"speed-lines",name:"Speed Lines",description:"Racing stripes"},{id:"halftone",name:"Halftone",description:"Comic book dots"},{id:"noise",name:"Noise",description:"Grainy texture"},{id:"tie-dye",name:"Tie-Dye",description:"Psychedelic swirl"},{id:"diagonal-stripes",name:"Diagonal Stripes",description:"Bold lines"},{id:"hexagons",name:"Hexagons",description:"Honeycomb pattern"},{id:"crosshatch",name:"Crosshatch",description:"Grid overlay"}],Lf=[{id:"concrete",name:"Concrete",query:"concrete texture"},{id:"rust",name:"Rust",query:"rust metal texture"},{id:"graffiti",name:"Graffiti",query:"graffiti wall"},{id:"wood",name:"Wood Grain",query:"wood grain texture"},{id:"sticker-bomb",name:"Sticker Bomb",query:"sticker collage"},{id:"asphalt",name:"Asphalt",query:"asphalt pavement"},{id:"brick",name:"Brick Wall",query:"red brick wall"},{id:"marble",name:"Marble",query:"white marble texture"},{id:"carbon-fiber",name:"Carbon Fiber",query:"carbon fiber weave"},{id:"splatter",name:"Paint Splatter",query:"paint splatter drips"}],Mf=[{id:"g1",label:"Circle",shapeType:"circle"},{id:"g2",label:"Square",shapeType:"rect"},{id:"g4",label:"Star",shapeType:"star"}],$f={"scratched-wood":"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='60' height='60' viewBox='0 0 60 60'%3E%3Crect fill='%23222'/%3E%3Cpath d='M5 10 L55 8 M10 25 L50 27 M8 40 L52 38 M15 52 L45 55' stroke='%23444' stroke-width='0.5' fill='none'/%3E%3Cpath d='M20 5 L22 55 M35 8 L37 52 M48 3 L50 57' stroke='%23333' stroke-width='0.3' fill='none'/%3E%3C/svg%3E","grip-tape-dust":"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='60' height='60' viewBox='0 0 60 60'%3E%3Crect fill='%23222'/%3E%3Ccircle cx='10' cy='15' r='1' fill='%23555'/%3E%3Ccircle cx='25' cy='8' r='0.5' fill='%23444'/%3E%3Ccircle cx='45' cy='20' r='1.5' fill='%23555'/%3E%3Ccircle cx='15' cy='35' r='0.8' fill='%23444'/%3E%3Ccircle cx='50' cy='45' r='1' fill='%23555'/%3E%3Ccircle cx='30' cy='50' r='0.6' fill='%23444'/%3E%3Ccircle cx='8' cy='55' r='1.2' fill='%23555'/%3E%3Ccircle cx='40' cy='30' r='0.7' fill='%23444'/%3E%3C/svg%3E","halftone-dots":"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='60' height='60' viewBox='0 0 60 60'%3E%3Crect fill='%23222'/%3E%3Ccircle cx='10' cy='10' r='3' fill='%23444'/%3E%3Ccircle cx='30' cy='10' r='2' fill='%23444'/%3E%3Ccircle cx='50' cy='10' r='3' fill='%23444'/%3E%3Ccircle cx='20' cy='30' r='2.5' fill='%23444'/%3E%3Ccircle cx='40' cy='30' r='2' fill='%23444'/%3E%3Ccircle cx='10' cy='50' r='2' fill='%23444'/%3E%3Ccircle cx='30' cy='50' r='3' fill='%23444'/%3E%3Ccircle cx='50' cy='50' r='2.5' fill='%23444'/%3E%3C/svg%3E"};function Bf({onAddObject:t,deckCenterX:r,deckCenterY:s}){const[n,a]=C.useState("edgy"),i=l=>{t({type:"sticker",x:r-20,y:s-20,width:40,height:40,rotation:0,opacity:1,scaleX:1,scaleY:1,iconName:l,strokeWidth:3,stroke:"#ffffff",solidFill:!1})};return e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-[10px] text-muted-foreground",children:"Vector stickers from Lucide icons. Click to add as large decals."}),e.jsx("div",{className:"flex flex-wrap gap-1",children:Object.keys(aa).map(l=>e.jsx("button",{onClick:()=>a(l),className:be("px-2 py-1 text-[9px] uppercase tracking-wider border transition-colors",n===l?"border-primary bg-primary text-primary-foreground":"border-border hover:border-primary"),children:l},l))}),e.jsx("div",{className:"grid grid-cols-4 gap-2",children:aa[n].map(l=>{const o=l.icon;return e.jsx("button",{onClick:()=>i(l.name),className:"aspect-square border border-border bg-secondary hover:border-primary transition-colors flex items-center justify-center",title:l.name,children:e.jsx(o,{className:"w-6 h-6",strokeWidth:3})},l.name)})}),e.jsx("p",{className:"text-[9px] text-muted-foreground",children:'Tip: Use the Inspector to toggle "Solid Fill" and adjust stroke width.'})]})}function Uf({onAddObject:t,deckCenterX:r,deckCenterY:s}){const[n,a]=C.useState("#1e3a8a"),[i,l]=C.useState("#3b82f6"),[o,c]=C.useState(20),f=p=>{switch(p){case"checkerboard":return`conic-gradient(from 90deg at 1px 1px, ${i} 90deg, ${n} 0) 0 0/${o}px ${o}px`;case"speed-lines":return`repeating-linear-gradient(90deg, ${n} 0px, ${n} ${o/4}px, ${i} ${o/4}px, ${i} ${o/2}px)`;case"halftone":return`radial-gradient(${n} ${o/6}px, ${i} ${o/6}px)`;case"noise":return i;case"tie-dye":return`radial-gradient(ellipse at 30% 30%, ${n}, transparent 50%), radial-gradient(ellipse at 70% 70%, ${i}, transparent 50%), ${n}`;case"diagonal-stripes":return`repeating-linear-gradient(45deg, ${n} 0px, ${n} ${o}px, ${i} ${o}px, ${i} ${o*2}px)`;case"hexagons":return`repeating-conic-gradient(from 30deg, ${n} 0deg 60deg, ${i} 60deg 120deg, ${n} 120deg 180deg, ${i} 180deg 240deg, ${n} 240deg 300deg, ${i} 300deg 360deg) 0 0/${o*2}px ${o*2}px`;case"crosshatch":return`repeating-linear-gradient(0deg, transparent, transparent ${o}px, ${i} ${o}px, ${i} ${o+2}px), repeating-linear-gradient(90deg, transparent, transparent ${o}px, ${n} ${o}px, ${n} ${o+2}px)`;default:return n}},m=p=>{t({type:"shape",x:0,y:0,width:Jt,height:Qt,rotation:0,opacity:1,scaleX:1,scaleY:1,shapeType:"rect",patternType:p,patternPrimaryColor:n,patternSecondaryColor:i,patternScale:o,fill:n})};return e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-[10px] text-muted-foreground",children:"Procedural patterns using CSS gradients. Infinite color combinations."}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("span",{className:"text-[9px] uppercase tracking-widest text-muted-foreground",children:"Primary"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"color",value:n,onChange:p=>a(p.target.value),className:"w-8 h-8 border border-border cursor-pointer bg-transparent"}),e.jsx("span",{className:"text-[9px] font-mono",children:n})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("span",{className:"text-[9px] uppercase tracking-widest text-muted-foreground",children:"Secondary"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"color",value:i,onChange:p=>l(p.target.value),className:"w-8 h-8 border border-border cursor-pointer bg-transparent"}),e.jsx("span",{className:"text-[9px] font-mono",children:i})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-[9px] uppercase tracking-widest text-muted-foreground",children:"Scale"}),e.jsxs("span",{className:"text-[10px] font-mono",children:[o,"px"]})]}),e.jsx(ve,{value:[o],onValueChange:([p])=>c(p),min:5,max:50,step:5})]}),e.jsx("div",{className:"space-y-2",children:zf.map(p=>e.jsxs("button",{onClick:()=>m(p.id),className:"w-full border border-border hover:border-primary transition-colors p-2 flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 border border-border flex-shrink-0",style:{background:f(p.id),backgroundSize:`${o}px ${o}px`}}),e.jsxs("div",{className:"text-left",children:[e.jsx("span",{className:"text-xs font-mono block",children:p.name}),e.jsx("span",{className:"text-[9px] text-muted-foreground",children:p.description})]})]},p.id))})]})}function Vf({onAddObject:t,deckCenterX:r,deckCenterY:s}){const n=(a,i)=>{const l=`https://picsum.photos/seed/${a.replace(/\s/g,"")}-${i}/200/300`;t({type:"texture",x:0,y:0,width:Jt,height:Qt,rotation:0,opacity:.6,scaleX:1,scaleY:1,textureUrl:l,blendMode:"multiply"})};return e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-[10px] text-muted-foreground",children:"Realistic textures applied with blend modes. Click to add as overlay."}),Lf.map(a=>e.jsxs("div",{className:"space-y-2",children:[e.jsx("span",{className:"text-[10px] uppercase tracking-widest text-muted-foreground",children:a.name}),e.jsx("div",{className:"grid grid-cols-3 gap-1",children:[0,1,2].map(i=>e.jsx("button",{onClick:()=>n(a.query,i),className:"aspect-square border border-border hover:border-primary transition-colors overflow-hidden bg-secondary",children:e.jsx("img",{src:`https://picsum.photos/seed/${a.query.replace(/\s/g,"")}-${i}/100/100`,alt:a.name,className:"w-full h-full object-cover opacity-70 hover:opacity-100 transition-opacity",loading:"lazy"})},i))})]},a.id)),e.jsx("p",{className:"text-[9px] text-muted-foreground",children:"Textures use multiply blend by default. Change in Inspector."})]})}const Hf=[{id:"straight",name:"Straight",description:"Clean straight line",icon:""},{id:"curved",name:"Curved",description:"Smooth bezier curve",icon:""},{id:"zigzag",name:"Zigzag",description:"Sharp angles",icon:""},{id:"dashed",name:"Dashed",description:"Dotted line",icon:""}];function Wf({onAddObject:t,deckCenterX:r,deckCenterY:s}){const[n,a]=C.useState("#ffffff"),[i,l]=C.useState(3),o=c=>{t({type:"line",x:r-30,y:s,width:60,height:60,rotation:0,opacity:1,scaleX:1,scaleY:1,lineType:c,lineEndX:60,lineEndY:c==="curved"?-30:0,lineCurve:c==="curved"?50:0,strokeWidth:i,stroke:n,lineCapStyle:"round"})};return e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-[10px] text-muted-foreground",children:"Draw lines and curves. Click to add, then drag endpoints in canvas."}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("span",{className:"text-[9px] uppercase tracking-widest text-muted-foreground",children:"Stroke Color"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"color",value:n,onChange:c=>a(c.target.value),className:"w-8 h-8 border border-border cursor-pointer bg-transparent"}),e.jsx("div",{className:"flex gap-1",children:["#ffffff","#ccff00","#ff6600","#00ffff","#ff00ff","#000000"].map(c=>e.jsx("button",{onClick:()=>a(c),className:`w-5 h-5 border ${n===c?"border-primary":"border-border"}`,style:{backgroundColor:c}},c))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-[9px] uppercase tracking-widest text-muted-foreground",children:"Stroke Width"}),e.jsxs("span",{className:"text-[10px] font-mono",children:[i,"px"]})]}),e.jsx(ve,{value:[i],onValueChange:([c])=>l(c),min:1,max:12,step:1})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("span",{className:"text-[9px] uppercase tracking-widest text-muted-foreground",children:"Line Types"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:Hf.map(c=>e.jsxs("button",{onClick:()=>o(c.id),className:"border border-border hover:border-primary transition-colors p-3 flex flex-col items-center gap-1",children:[e.jsx("span",{className:"text-2xl leading-none",style:{color:n},children:c.icon}),e.jsx("span",{className:"text-[9px] font-mono",children:c.name})]},c.id))})]}),e.jsx("p",{className:"text-[9px] text-muted-foreground",children:"Tip: Use Inspector to adjust curve amount and endpoints."})]})}function Gf({onAddObject:t,deckCenterX:r,deckCenterY:s}){const[n,a]=C.useState([]),[i,l]=C.useState(!1),[o,c]=C.useState(!1),f=C.useRef(null),{isAuthenticated:m}=gt();C.useState(()=>{m&&p()});const p=async()=>{if(m){l(!0);try{const d=await fs.list();a(d.assets||[])}catch(d){console.error("Failed to load assets:",d)}finally{l(!1)}}},b=async d=>{const u=d.target.files;if(!u||u.length===0)return;c(!0);let g=0,x=0,j=0;try{for(const k of Array.from(u))if(If(k))try{const N=await Af(k);N.forEach(P=>t(P)),g++,j+=N.length,N.length>0?J.success(`Imported ${k.name}`,{description:`${N.length} shape${N.length!==1?"s":""} added to canvas`,duration:3e3}):J.warning(`${k.name} imported but no shapes found`,{description:"The SVG may be empty or use unsupported features",duration:3e3})}catch(N){console.error("SVG import failed:",N),J.error(`Failed to import ${k.name}`,{description:"Invalid SVG file or unsupported format",duration:4e3})}else try{const{url:N,width:P,height:A}=await fs.upload(k);x++,J.success(`Uploaded ${k.name}`,{description:"Image added to your library"}),await p()}catch(N){console.error("Image upload failed:",N),J.error(`Failed to upload ${k.name}`,{description:"Please try again or check file format"})}if(u.length>1){const k=[];g>0&&k.push(`${g} SVG${g!==1?"s":""} (${j} shapes)`),x>0&&k.push(`${x} image${x!==1?"s":""}`),k.length>0&&J.success("Batch upload complete",{description:k.join(" + ")})}}catch(k){console.error("Upload failed:",k),J.error("Upload failed",{description:"Please try again or check your files"})}finally{c(!1),f.current&&(f.current.value="")}},h=d=>{const g=Math.min(120/d.width,120/d.height),x=d.width*g,j=d.height*g;t({type:"image",x:r-x/2,y:s-j/2,width:d.width,height:d.height,rotation:0,opacity:1,scaleX:g,scaleY:g,src:d.file_url})},w=async d=>{if(confirm("Delete this asset?"))try{await fs.delete(d),await p()}catch(u){console.error("Delete failed:",u)}};return m?e.jsxs("div",{className:"space-y-4",children:[e.jsx("input",{ref:f,type:"file",accept:"image/*,.svg",multiple:!0,className:"hidden",onChange:b}),e.jsx("div",{onClick:()=>{var d;return(d=f.current)==null?void 0:d.click()},className:"border-2 border-dashed border-border p-6 text-center hover:border-primary transition-colors cursor-pointer",children:o?e.jsxs(e.Fragment,{children:[e.jsx(We,{className:"w-6 h-6 mx-auto mb-2 animate-spin text-primary"}),e.jsx("span",{className:"text-[10px] uppercase tracking-widest text-muted-foreground",children:"Uploading..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(Fr,{className:"w-6 h-6 mx-auto mb-2 text-muted-foreground"}),e.jsx("span",{className:"text-[10px] uppercase tracking-widest text-muted-foreground block mb-1",children:"Upload Images"}),e.jsx("span",{className:"text-xs text-muted-foreground",children:"PNG, JPG, SVG"})]})}),i?e.jsx("div",{className:"text-center py-4",children:e.jsx(We,{className:"w-5 h-5 mx-auto animate-spin text-muted-foreground"})}):n.length>0?e.jsx("div",{className:"grid grid-cols-2 gap-2",children:n.map(d=>e.jsxs("div",{className:"relative group border border-border hover:border-primary transition-colors overflow-hidden aspect-square cursor-pointer",onClick:()=>h(d),children:[e.jsx("img",{src:d.file_url,alt:d.name,className:"w-full h-full object-cover"}),e.jsx("button",{onClick:u=>{u.stopPropagation(),w(d.id)},className:"absolute top-1 right-1 p-1 bg-destructive text-destructive-foreground rounded opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx(Pt,{className:"w-3 h-3"})})]},d.id))}):e.jsx("p",{className:"text-center text-xs text-muted-foreground py-4",children:"No uploads yet. Click above to upload!"})]}):e.jsxs("div",{className:"text-center py-8 space-y-4",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Login to upload custom images"}),e.jsx(X,{size:"sm",onClick:()=>window.location.href="/auth",children:"Login"})]})}function qf(){const{textureOverlays:t,toggleTexture:r,updateTexture:s}=Ee();return e.jsxs("div",{className:"space-y-4",children:[e.jsx("span",{className:"text-[10px] uppercase tracking-widest text-muted-foreground block",children:"Texture Overlays"}),e.jsx("p",{className:"text-[10px] text-muted-foreground",children:"Add realistic print textures that blend over your design."}),t.map(n=>e.jsxs("div",{className:be("border p-3 space-y-3 transition-colors",n.enabled?"border-primary bg-secondary/50":"border-border"),children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:()=>r(n.id),className:be("w-12 h-12 border flex-shrink-0 bg-cover bg-center",n.enabled?"border-primary":"border-border"),style:{backgroundImage:`url("${$f[n.id]}")`}}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"font-mono text-xs",children:n.name}),e.jsx("button",{onClick:()=>r(n.id),className:be("w-8 h-4 rounded-full transition-colors relative",n.enabled?"bg-primary":"bg-muted"),children:e.jsx("span",{className:be("absolute top-0.5 w-3 h-3 rounded-full bg-white transition-transform",n.enabled?"translate-x-4":"translate-x-0.5")})})]}),e.jsx("span",{className:"text-[9px] text-muted-foreground uppercase tracking-wider",children:n.blendMode})]})]}),n.enabled&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-[9px] uppercase tracking-widest text-muted-foreground",children:"Opacity"}),e.jsxs("span",{className:"font-mono text-[10px]",children:[Math.round(n.opacity*100),"%"]})]}),e.jsx(ve,{value:[n.opacity*100],onValueChange:([a])=>s(n.id,{opacity:a/100}),min:5,max:100,step:5,className:"w-full"})]})]},n.id))]})}function Kf({tool:t,onAddObject:r,deckCenterX:s,deckCenterY:n}){const a=(o,c)=>{o.dataTransfer.setData("application/json",JSON.stringify(c)),o.dataTransfer.effectAllowed="copy"},i=()=>{r({type:"text",x:s-25,y:n,width:50,height:24,rotation:0,opacity:1,scaleX:1,scaleY:1,text:"SKATE",fontSize:18,fontFamily:"Oswald",fill:"#ffffff"}),J.success("Text added to center of deck",{description:"Double-click text to edit, or use Inspector panel to customize",duration:3e3})},l=o=>{r({type:"shape",x:s-15,y:n-15,width:30,height:30,rotation:0,opacity:1,scaleX:1,scaleY:1,shapeType:o,fill:"#ffffff"})};if(t==="stickers")return e.jsx(Bf,{onAddObject:r,deckCenterX:s,deckCenterY:n});if(t==="patterns")return e.jsx(Uf,{onAddObject:r,deckCenterX:s,deckCenterY:n});if(t==="textures")return e.jsx(Vf,{onAddObject:r,deckCenterX:s,deckCenterY:n});if(t==="lines")return e.jsx(Wf,{onAddObject:r,deckCenterX:s,deckCenterY:n});if(t==="graphics")return e.jsxs("div",{className:"space-y-3",children:[e.jsx("span",{className:"text-[10px] uppercase tracking-widest text-muted-foreground",children:"Click to add or drag to canvas"}),e.jsx("div",{className:"grid grid-cols-3 gap-2",children:Mf.map(o=>e.jsxs("button",{draggable:!0,onDragStart:c=>a(c,{type:"shape",shapeType:o.shapeType,width:30,height:30,fill:"#ffffff"}),onClick:()=>l(o.shapeType),className:"aspect-square border border-border bg-secondary hover:border-primary transition-colors flex items-center justify-center cursor-grab active:cursor-grabbing",children:[o.shapeType==="circle"&&e.jsx("div",{className:"w-8 h-8 rounded-full bg-white"}),o.shapeType==="rect"&&e.jsx("div",{className:"w-8 h-8 bg-white"}),o.shapeType==="star"&&e.jsx("span",{className:"text-white text-2xl",children:""})]},o.id))})]});if(t==="pen"){const o=()=>{r({type:"path",x:s-30,y:n-30,width:60,height:60,rotation:0,opacity:1,scaleX:1,scaleY:1,stroke:"#ffffff",strokeWidth:3,solidFill:!1,pathPoints:[{x:0,y:30},{x:30,y:0,cp1x:10,cp1y:30,cp2x:20,cp2y:0},{x:60,y:30,cp1x:40,cp1y:0,cp2x:50,cp2y:30}],pathClosed:!1})},c=()=>{r({type:"path",x:s-25,y:n-25,width:50,height:50,rotation:0,opacity:1,scaleX:1,scaleY:1,fill:"#ccff00",stroke:"#ffffff",strokeWidth:2,solidFill:!0,pathPoints:[{x:25,y:0},{x:50,y:43,cp1x:50,cp1y:15,cp2x:50,cp2y:28},{x:0,y:43,cp1x:0,cp1y:28,cp2x:0,cp2y:15}],pathClosed:!0})};return e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("span",{className:"text-[10px] uppercase tracking-widest text-muted-foreground",children:"Quick Start"}),e.jsx("button",{onClick:o,className:"w-full btn-brutal text-left",children:"+ Curved Path"}),e.jsx("button",{onClick:c,className:"w-full btn-brutal text-left",children:"+ Closed Shape"})]}),e.jsxs("div",{className:"space-y-2 pt-3 border-t border-border",children:[e.jsx("span",{className:"text-[10px] uppercase tracking-widest text-muted-foreground",children:"Instructions"}),e.jsxs("div",{className:"text-xs text-muted-foreground space-y-2",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Select a path"})," to see anchor points (blue) and control handles (orange)."]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Drag"})," the path to move it around the canvas."]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Edit points"})," in the Inspector panel to add/remove anchors or adjust curves."]}),e.jsxs("p",{children:["Use ",e.jsx("strong",{children:"Transform tools"})," to scale and rotate paths."]})]})]})]})}return t==="text"?e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-[10px] text-muted-foreground",children:"Add custom text to your deck. Text appears in the center and is immediately selected for editing."}),e.jsxs("button",{onClick:i,className:"w-full btn-brutal text-left flex items-center justify-between group",children:[e.jsx("span",{children:"+ Add Text"}),e.jsx("span",{className:"text-[9px] text-muted-foreground group-hover:text-foreground transition-colors",children:"Click to add"})]}),e.jsx("div",{className:"p-3 border border-accent/30 bg-accent/10 space-y-2",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-accent text-lg",children:""}),e.jsxs("div",{className:"text-[10px] text-muted-foreground space-y-1",children:[e.jsx("p",{children:e.jsx("strong",{children:"After adding:"})}),e.jsx("p",{children:" Edit text in Inspector panel"}),e.jsx("p",{children:" Change font, size, color"}),e.jsx("p",{children:" Drag to reposition"}),e.jsx("p",{children:" Use transform handles to resize/rotate"})]})]})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("span",{className:"text-[10px] uppercase tracking-widest text-muted-foreground",children:"Popular Styles"}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"p-2 border border-border bg-secondary",children:[e.jsx("span",{className:"font-display text-base font-bold",children:"BOLD IMPACT"}),e.jsx("p",{className:"text-[9px] text-muted-foreground mt-1",children:"High visibility branding"})]}),e.jsxs("div",{className:"p-2 border border-border bg-secondary",children:[e.jsx("span",{className:"font-display text-base italic",children:"Stylish Script"}),e.jsx("p",{className:"text-[9px] text-muted-foreground mt-1",children:"Elegant cursive look"})]}),e.jsxs("div",{className:"p-2 border border-border bg-secondary",children:[e.jsx("span",{className:"font-mono text-sm",children:"TECHNICAL MONO"}),e.jsx("p",{className:"text-[9px] text-muted-foreground mt-1",children:"Clean modern aesthetic"})]})]})]})]}):t==="uploads"?e.jsx(Gf,{onAddObject:r,deckCenterX:s,deckCenterY:n}):t==="finishes"?e.jsx(qf,{}):e.jsx("div",{className:"text-center py-8",children:e.jsx("span",{className:"text-[10px] text-muted-foreground",children:"Use Stickers, Patterns, or Textures for assets."})})}const Yf={templates:"Templates",graphics:"Graphics",text:"Text",uploads:"Uploads",background:"Background",finishes:"Finishes",stickers:"Stickers",patterns:"Patterns",textures:"Textures",lines:"Lines",pen:"Pen Tool"};function ia(){const{activeTool:t,drawerOpen:r,toggleDrawer:s,addObject:n}=Ee();if(!r||!t||t==="pen")return null;const a=Jt/2,i=Qt/2;return e.jsxs("div",{className:"w-56 bg-card border-r border-border h-full flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between py-3 px-3 border-b border-border",children:[e.jsx("span",{className:"font-display text-xs uppercase tracking-widest",children:Yf[t]}),e.jsx("button",{onClick:()=>s(!1),className:"w-6 h-6 flex items-center justify-center hover:bg-secondary transition-colors",children:e.jsx(vr,{className:"w-4 h-4"})})]}),e.jsx(_t,{className:"flex-1 p-3",children:e.jsx(Kf,{tool:t,onAddObject:n,deckCenterX:a,deckCenterY:i})})]})}function Zf(t){return t.type==="text"?Wr:t.type==="image"?Us:t.type==="sticker"?Aa:t.type==="line"?Pa:t.type==="path"?$s:t.type==="texture"?Bs:t.type==="shape"?t.shapeType==="circle"?Ra:t.shapeType==="star"?Hs:zr:zr}function oa(t){return t.type==="text"&&t.text?t.text.length>15?t.text.slice(0,15)+"...":t.text:t.type==="sticker"&&t.iconName?`${t.iconName} Sticker`:t.type==="shape"&&t.shapeType?`${t.shapeType.charAt(0).toUpperCase()+t.shapeType.slice(1)} Shape`:t.type==="line"&&t.lineType?`${t.lineType.charAt(0).toUpperCase()+t.lineType.slice(1)} Line`:t.type==="path"?t.pathClosed?"Closed Path":"Open Path":t.type==="texture"?"Texture Overlay":t.type==="image"?"Image":t.type.charAt(0).toUpperCase()+t.type.slice(1)}function Xf({obj:t,index:r,isSelected:s,onSelect:n,onDelete:a}){const i=Zf(t);return e.jsxs("div",{onClick:n,className:be("flex items-center gap-2 px-2 py-1.5 border-b border-border cursor-pointer group","hover:bg-secondary transition-colors",s&&"bg-primary/10 border-l-2 border-l-primary"),children:[e.jsx(Cc,{className:"w-3 h-3 text-muted-foreground cursor-grab"}),e.jsx(i,{className:"w-4 h-4 text-foreground"}),e.jsx("span",{className:"flex-1 text-xs truncate font-medium",children:oa(t)}),e.jsxs(dn,{children:[e.jsx(un,{asChild:!0,children:e.jsx("button",{onClick:l=>{l.stopPropagation();const o=oa(t);a(),J.success(`Deleted "${o}"`,{description:"Use Layers panel to manage or remove items",duration:2e3})},className:"w-6 h-6 flex items-center justify-center hover:bg-destructive hover:text-destructive-foreground transition-colors rounded opacity-0 group-hover:opacity-100",title:"Delete layer",children:e.jsx(Pt,{className:"w-3.5 h-3.5"})})}),e.jsx(rs,{side:"left",children:e.jsx("p",{className:"text-xs",children:"Delete this layer"})})]})]})}function xo(){const{objects:t,selectedId:r,selectObject:s,deleteObject:n,moveLayer:a}=Ee(),i=[...t].reverse();return e.jsxs("div",{className:"border-t border-border",children:[e.jsxs("div",{className:"py-2 px-3 border-b border-border bg-accent/10",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ir,{className:"w-4 h-4 text-accent"}),e.jsxs("span",{className:"font-display text-xs uppercase tracking-widest text-foreground font-semibold",children:["Layers ",t.length>0&&`(${t.length})`]})]}),e.jsxs(dn,{children:[e.jsx(un,{asChild:!0,children:e.jsx("button",{className:"w-4 h-4 flex items-center justify-center text-muted-foreground hover:text-foreground transition-colors",children:e.jsx(Oa,{className:"w-3.5 h-3.5"})})}),e.jsxs(rs,{side:"left",className:"max-w-xs",children:[e.jsx("p",{className:"text-xs font-semibold mb-1",children:"Layers Panel"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Shows all elements on your deck. Click to select, hover to reveal delete button."})]})]})]}),t.length>0&&e.jsx("p",{className:"text-[9px] text-muted-foreground mt-1",children:"Click layer to select  Hover to delete"})]}),e.jsx(_t,{className:"h-48",children:i.length===0?e.jsxs("div",{className:"p-6 text-center space-y-2",children:[e.jsx(Ir,{className:"w-8 h-8 mx-auto text-muted-foreground opacity-50"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-semibold text-muted-foreground uppercase tracking-wider",children:"No layers yet"}),e.jsx("p",{className:"text-[10px] text-muted-foreground mt-1",children:"Add text, shapes, or images to see them here"})]})]}):i.map((l,o)=>{const c=t.length-1-o;return e.jsx(Xf,{obj:l,index:c,isSelected:r===l.id,onSelect:()=>s(l.id),onDelete:()=>n(l.id),onMoveUp:()=>a(l.id,"up"),onMoveDown:()=>a(l.id,"down"),isFirst:o===0,isLast:o===i.length-1},l.id)})})]})}var is="Switch",[Qf]=xt(is),[Jf,ep]=Qf(is),go=C.forwardRef((t,r)=>{const{__scopeSwitch:s,name:n,checked:a,defaultChecked:i,required:l,disabled:o,value:c="on",onCheckedChange:f,form:m,...p}=t,[b,h]=C.useState(null),w=Oe(r,j=>h(j)),d=C.useRef(!1),u=b?m||!!b.closest("form"):!0,[g,x]=At({prop:a,defaultProp:i??!1,onChange:f,caller:is});return e.jsxs(Jf,{scope:s,checked:g,disabled:o,children:[e.jsx(ke.button,{type:"button",role:"switch","aria-checked":g,"aria-required":l,"data-state":wo(g),"data-disabled":o?"":void 0,disabled:o,value:c,...p,ref:w,onClick:ye(t.onClick,j=>{x(k=>!k),u&&(d.current=j.isPropagationStopped(),d.current||j.stopPropagation())})}),u&&e.jsx(bo,{control:b,bubbles:!d.current,name:n,value:c,checked:g,required:l,disabled:o,form:m,style:{transform:"translateX(-100%)"}})]})});go.displayName=is;var yo="SwitchThumb",vo=C.forwardRef((t,r)=>{const{__scopeSwitch:s,...n}=t,a=ep(yo,s);return e.jsx(ke.span,{"data-state":wo(a.checked),"data-disabled":a.disabled?"":void 0,...n,ref:r})});vo.displayName=yo;var tp="SwitchBubbleInput",bo=C.forwardRef(({__scopeSwitch:t,control:r,checked:s,bubbles:n=!0,...a},i)=>{const l=C.useRef(null),o=Oe(l,i),c=Ji(s),f=nn(r);return C.useEffect(()=>{const m=l.current;if(!m)return;const p=window.HTMLInputElement.prototype,h=Object.getOwnPropertyDescriptor(p,"checked").set;if(c!==s&&h){const w=new Event("click",{bubbles:n});h.call(m,s),m.dispatchEvent(w)}},[c,s,n]),e.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:s,...a,tabIndex:-1,ref:o,style:{...a.style,...f,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});bo.displayName=tp;function wo(t){return t?"checked":"unchecked"}var jo=go,rp=vo;const os=C.forwardRef(({className:t,...r},s)=>e.jsx(jo,{className:be("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors data-[state=checked]:bg-primary data-[state=unchecked]:bg-input focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50",t),...r,ref:s,children:e.jsx(rp,{className:be("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})}));os.displayName=jo.displayName;var sp=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],np=sp.reduce((t,r)=>{const s=xl(`Primitive.${r}`),n=C.forwardRef((a,i)=>{const{asChild:l,...o}=a,c=l?s:r;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),e.jsx(c,{...o,ref:i})});return n.displayName=`Primitive.${r}`,{...t,[r]:n}},{}),ap="Separator",la="horizontal",ip=["horizontal","vertical"],No=C.forwardRef((t,r)=>{const{decorative:s,orientation:n=la,...a}=t,i=op(n)?n:la,o=s?{role:"none"}:{"aria-orientation":i==="vertical"?i:void 0,role:"separator"};return e.jsx(np.div,{"data-orientation":i,...o,...a,ref:r})});No.displayName=ap;function op(t){return ip.includes(t)}var ko=No;const Dt=C.forwardRef(({className:t,orientation:r="horizontal",decorative:s=!0,...n},a)=>e.jsx(ko,{ref:a,decorative:s,orientation:r,className:be("shrink-0 bg-border",r==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",t),...n}));Dt.displayName=ko.displayName;function lp(){const{selectedId:t,objects:r,updateObject:s}=Ee(),[n,a]=C.useState("gradient"),i=r.find(l=>l.id===t);return!t||!i?e.jsx("div",{className:"p-4 text-center text-sm text-muted-foreground",children:"Select an object to add effects"}):i.type!=="shape"&&i.type!=="text"&&i.type!=="sticker"?e.jsx("div",{className:"p-4 text-center text-sm text-muted-foreground",children:"Effects only available for shapes, text, and stickers"}):e.jsx(_t,{className:"h-full",children:e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-2 border-b border-border pb-2",children:[e.jsxs(X,{variant:n==="gradient"?"default":"ghost",size:"sm",onClick:()=>a("gradient"),children:[e.jsx(Qe,{className:"w-3 h-3 mr-1"}),"Gradient"]}),e.jsxs(X,{variant:n==="shadow"?"default":"ghost",size:"sm",onClick:()=>a("shadow"),children:[e.jsx(_c,{className:"w-3 h-3 mr-1"}),"Shadow"]}),e.jsxs(X,{variant:n==="glow"?"default":"ghost",size:"sm",onClick:()=>a("glow"),children:[e.jsx(Da,{className:"w-3 h-3 mr-1"}),"Glow"]}),e.jsxs(X,{variant:n==="filters"?"default":"ghost",size:"sm",onClick:()=>a("filters"),children:[e.jsx(Sc,{className:"w-3 h-3 mr-1"}),"Filters"]})]}),n==="gradient"&&e.jsx(cp,{object:i,updateObject:s}),n==="shadow"&&e.jsx(dp,{object:i,updateObject:s}),n==="glow"&&e.jsx(up,{object:i,updateObject:s}),n==="filters"&&e.jsx(hp,{object:i,updateObject:s})]})})}function cp({object:t,updateObject:r}){const s=t.fillType||"solid",n=t.gradientStops||[{offset:0,color:"#ff0000"},{offset:1,color:"#0000ff"}],a=t.gradientAngle||0,i=f=>{r(t.id,{fillType:f,gradientStops:f!=="solid"?n:void 0,gradientAngle:f==="linear-gradient"?a:void 0})},l=(f,m)=>{const p=[...n];p[f]={...p[f],...m},r(t.id,{gradientStops:p})},o=()=>{const f=[...n,{offset:.5,color:"#00ff00"}].sort((m,p)=>m.offset-p.offset);r(t.id,{gradientStops:f})},c=f=>{if(n.length<=2)return;const m=n.filter((p,b)=>b!==f);r(t.id,{gradientStops:m})};return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(ae,{className:"text-xs",children:"Fill Type"}),e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[e.jsx(X,{variant:s==="solid"?"default":"outline",size:"sm",onClick:()=>i("solid"),className:"text-xs",children:"Solid"}),e.jsx(X,{variant:s==="linear-gradient"?"default":"outline",size:"sm",onClick:()=>i("linear-gradient"),className:"text-xs",children:"Linear"}),e.jsx(X,{variant:s==="radial-gradient"?"default":"outline",size:"sm",onClick:()=>i("radial-gradient"),className:"text-xs",children:"Radial"})]})]}),s!=="solid"&&e.jsxs(e.Fragment,{children:[s==="linear-gradient"&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs(ae,{className:"text-xs",children:["Angle: ",a,""]}),e.jsx(ve,{value:[a],onValueChange:([f])=>r(t.id,{gradientAngle:f}),min:0,max:360,step:1})]}),e.jsx(Dt,{}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(ae,{className:"text-xs",children:"Color Stops"}),e.jsx(X,{size:"sm",variant:"ghost",onClick:o,children:e.jsx(dr,{className:"w-3 h-3"})})]}),n.map((f,m)=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ae,{type:"color",value:f.color,onChange:p=>l(m,{color:p.target.value}),className:"w-12 h-8 p-1 cursor-pointer"}),e.jsx(ve,{value:[f.offset*100],onValueChange:([p])=>l(m,{offset:p/100}),min:0,max:100,step:1,className:"flex-1"}),e.jsxs("span",{className:"text-xs text-muted-foreground w-10 text-right",children:[Math.round(f.offset*100),"%"]}),n.length>2&&e.jsx(X,{size:"sm",variant:"ghost",onClick:()=>c(m),children:e.jsx(Pt,{className:"w-3 h-3"})})]},m))]})]})]})}function dp({object:t,updateObject:r}){const s=t.dropShadow||{enabled:!1,offsetX:4,offsetY:4,blur:8,color:"#000000",opacity:.5},n=a=>{r(t.id,{dropShadow:{...s,...a}})};return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(ae,{className:"text-xs",children:"Drop Shadow"}),e.jsx(os,{checked:s.enabled,onCheckedChange:a=>n({enabled:a})})]}),s.enabled&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(ae,{className:"text-xs",children:["Offset X: ",s.offsetX,"px"]}),e.jsx(ve,{value:[s.offsetX],onValueChange:([a])=>n({offsetX:a}),min:-50,max:50,step:1})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(ae,{className:"text-xs",children:["Offset Y: ",s.offsetY,"px"]}),e.jsx(ve,{value:[s.offsetY],onValueChange:([a])=>n({offsetY:a}),min:-50,max:50,step:1})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(ae,{className:"text-xs",children:["Blur: ",s.blur,"px"]}),e.jsx(ve,{value:[s.blur],onValueChange:([a])=>n({blur:a}),min:0,max:50,step:1})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(ae,{className:"text-xs",children:["Opacity: ",Math.round(s.opacity*100),"%"]}),e.jsx(ve,{value:[s.opacity*100],onValueChange:([a])=>n({opacity:a/100}),min:0,max:100,step:1})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(ae,{className:"text-xs",children:"Color"}),e.jsx(Ae,{type:"color",value:s.color,onChange:a=>n({color:a.target.value}),className:"w-full h-10 cursor-pointer"})]})]})]})}function up({object:t,updateObject:r}){const s=t.glow||{enabled:!1,radius:10,color:"#ffffff",intensity:.8},n=a=>{r(t.id,{glow:{...s,...a}})};return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(ae,{className:"text-xs",children:"Glow Effect"}),e.jsx(os,{checked:s.enabled,onCheckedChange:a=>n({enabled:a})})]}),s.enabled&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(ae,{className:"text-xs",children:["Radius: ",s.radius,"px"]}),e.jsx(ve,{value:[s.radius],onValueChange:([a])=>n({radius:a}),min:0,max:50,step:1})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(ae,{className:"text-xs",children:["Intensity: ",Math.round(s.intensity*100),"%"]}),e.jsx(ve,{value:[s.intensity*100],onValueChange:([a])=>n({intensity:a/100}),min:0,max:100,step:1})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(ae,{className:"text-xs",children:"Color"}),e.jsx(Ae,{type:"color",value:s.color,onChange:a=>n({color:a.target.value}),className:"w-full h-10 cursor-pointer"})]})]})]})}function hp({object:t,updateObject:r}){const s=t.duotone||{enabled:!1,color1:"#000000",color2:"#ccff00"},n=a=>{r(t.id,{duotone:{...s,...a}})};return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(ae,{className:"text-xs",children:["Blur: ",t.blur||0,"px"]}),e.jsx(ve,{value:[t.blur||0],onValueChange:([a])=>r(t.id,{blur:a}),min:0,max:20,step:.5}),e.jsx("p",{className:"text-[9px] text-muted-foreground",children:"Gaussian blur effect (0-20px)"})]}),e.jsx(Dt,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(ae,{className:"text-xs",children:["Saturation: ",t.saturate||100,"%"]}),e.jsx(ve,{value:[t.saturate||100],onValueChange:([a])=>r(t.id,{saturate:a}),min:0,max:200,step:5}),e.jsx("p",{className:"text-[9px] text-muted-foreground",children:"0% = grayscale, 100% = normal, 200% = hyper-saturated"})]}),e.jsx(Dt,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(ae,{className:"text-xs",children:["Sepia: ",t.sepia||0,"%"]}),e.jsx(ve,{value:[t.sepia||0],onValueChange:([a])=>r(t.id,{sepia:a}),min:0,max:100,step:5}),e.jsx("p",{className:"text-[9px] text-muted-foreground",children:"Vintage photo tone effect"})]}),e.jsx(Dt,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(ae,{className:"text-xs",children:["Posterize: ",t.posterize||32," levels"]}),e.jsx(ve,{value:[t.posterize||32],onValueChange:([a])=>r(t.id,{posterize:a}),min:2,max:32,step:1}),e.jsx("p",{className:"text-[9px] text-muted-foreground",children:"Reduce color levels (lower = more posterized)"})]}),e.jsx(Dt,{}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(ae,{className:"text-xs",children:"Duotone Effect"}),e.jsx(os,{checked:s.enabled,onCheckedChange:a=>n({enabled:a})})]}),s.enabled&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(ae,{className:"text-xs",children:"Shadow Color"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Ae,{type:"color",value:s.color1,onChange:a=>n({color1:a.target.value}),className:"w-16 h-10 cursor-pointer"}),e.jsx("div",{className:"flex gap-1 flex-1",children:["#000000","#1a1a1a","#0000ff","#ff0000"].map(a=>e.jsx("button",{onClick:()=>n({color1:a}),className:"w-8 h-8 border border-border hover:border-primary transition-colors",style:{backgroundColor:a}},a))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(ae,{className:"text-xs",children:"Highlight Color"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Ae,{type:"color",value:s.color2,onChange:a=>n({color2:a.target.value}),className:"w-16 h-10 cursor-pointer"}),e.jsx("div",{className:"flex gap-1 flex-1",children:["#ccff00","#00ffff","#ff00ff","#ffff00"].map(a=>e.jsx("button",{onClick:()=>n({color2:a}),className:"w-8 h-8 border border-border hover:border-primary transition-colors",style:{backgroundColor:a}},a))})]})]}),e.jsx("p",{className:"text-[9px] text-muted-foreground",children:"Classic punk/skate magazine effect"})]})]}),e.jsx(Dt,{}),e.jsx(X,{onClick:()=>r(t.id,{blur:0,saturate:100,sepia:0,posterize:32,duotone:{enabled:!1,color1:"#000000",color2:"#ccff00"}}),variant:"outline",size:"sm",className:"w-full",children:"Reset All Filters"})]})}const fp=[{id:"sunset",name:"Sunset",gradient:"linear-gradient(135deg, #ff6b6b 0%, #feca57 50%, #ee5a6f 100%)",stops:[{offset:0,color:"#ff6b6b"},{offset:.5,color:"#feca57"},{offset:1,color:"#ee5a6f"}],angle:135},{id:"ocean",name:"Ocean",gradient:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",stops:[{offset:0,color:"#667eea"},{offset:1,color:"#764ba2"}],angle:135},{id:"fire",name:"Fire",gradient:"linear-gradient(135deg, #f12711 0%, #f5af19 100%)",stops:[{offset:0,color:"#f12711"},{offset:1,color:"#f5af19"}],angle:135},{id:"mint",name:"Mint",gradient:"linear-gradient(135deg, #00d2ff 0%, #3a7bd5 100%)",stops:[{offset:0,color:"#00d2ff"},{offset:1,color:"#3a7bd5"}],angle:135},{id:"purple",name:"Purple Haze",gradient:"linear-gradient(135deg, #8e2de2 0%, #4a00e0 100%)",stops:[{offset:0,color:"#8e2de2"},{offset:1,color:"#4a00e0"}],angle:135},{id:"neon",name:"Neon",gradient:"linear-gradient(135deg, #ccff00 0%, #00ffff 100%)",stops:[{offset:0,color:"#ccff00"},{offset:1,color:"#00ffff"}],angle:135}];function pp({currentFill:t,onApplyGradient:r,onApplySolid:s}){const[n,a]=C.useState(!1);return e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"flex-1 flex items-center gap-2",children:[e.jsx("input",{type:"color",value:t||"#ffffff",onChange:i=>s(i.target.value),className:"w-8 h-8 border border-border cursor-pointer bg-transparent"}),e.jsx(Ae,{type:"text",value:t||"#ffffff",onChange:i=>s(i.target.value),className:"h-8 text-xs font-mono bg-secondary border-border flex-1"})]}),e.jsxs(X,{size:"sm",variant:"outline",onClick:()=>a(!n),className:"gap-1.5 shrink-0",title:"Apply gradient fill",children:[e.jsx(Qe,{className:"w-3.5 h-3.5"}),e.jsx("span",{className:"text-[10px]",children:"Gradient"})]})]}),n&&e.jsxs("div",{className:"p-3 border border-accent/30 bg-accent/5 rounded space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-[10px] uppercase tracking-widest text-muted-foreground flex items-center gap-1.5",children:[e.jsx(Fa,{className:"w-3 h-3"}),"Gradient Presets"]}),e.jsx("button",{onClick:()=>a(!1),className:"text-[9px] text-muted-foreground hover:text-foreground",children:"Close"})]}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:fp.map(i=>e.jsxs("button",{onClick:()=>{r(i.stops,i.angle||0),J.success(`Applied ${i.name} gradient`),a(!1)},className:"group space-y-1.5",children:[e.jsx("div",{className:be("h-12 rounded border border-border group-hover:border-primary transition-colors","group-hover:scale-105 transform transition-transform"),style:{background:i.gradient}}),e.jsx("span",{className:"text-[9px] text-muted-foreground group-hover:text-foreground transition-colors block text-center",children:i.name})]},i.id))}),e.jsx("div",{className:"pt-2 border-t border-border",children:e.jsx("p",{className:"text-[9px] text-muted-foreground",children:" Tip: After applying a gradient, adjust colors and angle in the Advanced panel below"})})]})]})}function mp(t){const r=xp(t),s=C.forwardRef((n,a)=>{const{children:i,...l}=n,o=C.Children.toArray(i),c=o.find(yp);if(c){const f=c.props.children,m=o.map(p=>p===c?C.Children.count(f)>1?C.Children.only(null):C.isValidElement(f)?f.props.children:null:p);return e.jsx(r,{...l,ref:a,children:C.isValidElement(f)?C.cloneElement(f,void 0,m):null})}return e.jsx(r,{...l,ref:a,children:i})});return s.displayName=`${t}.Slot`,s}function xp(t){const r=C.forwardRef((s,n)=>{const{children:a,...i}=s;if(C.isValidElement(a)){const l=bp(a),o=vp(i,a.props);return a.type!==C.Fragment&&(o.ref=n?wa(n,l):l),C.cloneElement(a,o)}return C.Children.count(a)>1?C.Children.only(null):null});return r.displayName=`${t}.SlotClone`,r}var gp=Symbol("radix.slottable");function yp(t){return C.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===gp}function vp(t,r){const s={...r};for(const n in r){const a=t[n],i=r[n];/^on[A-Z]/.test(n)?a&&i?s[n]=(...o)=>{const c=i(...o);return a(...o),c}:a&&(s[n]=a):n==="style"?s[n]={...a,...i}:n==="className"&&(s[n]=[a,i].filter(Boolean).join(" "))}return{...t,...s}}function bp(t){var n,a;let r=(n=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:n.get,s=r&&"isReactWarning"in r&&r.isReactWarning;return s?t.ref:(r=(a=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:a.get,s=r&&"isReactWarning"in r&&r.isReactWarning,s?t.props.ref:t.props.ref||t.ref)}var ls="Popover",[Co]=xt(ls,[Qr]),jr=Qr(),[wp,Tt]=Co(ls),_o=t=>{const{__scopePopover:r,children:s,open:n,defaultOpen:a,onOpenChange:i,modal:l=!1}=t,o=jr(r),c=C.useRef(null),[f,m]=C.useState(!1),[p,b]=At({prop:n,defaultProp:a??!1,onChange:i,caller:ls});return e.jsx(Ii,{...o,children:e.jsx(wp,{scope:r,contentId:Hr(),triggerRef:c,open:p,onOpenChange:b,onOpenToggle:C.useCallback(()=>b(h=>!h),[b]),hasCustomAnchor:f,onCustomAnchorAdd:C.useCallback(()=>m(!0),[]),onCustomAnchorRemove:C.useCallback(()=>m(!1),[]),modal:l,children:s})})};_o.displayName=ls;var So="PopoverAnchor",jp=C.forwardRef((t,r)=>{const{__scopePopover:s,...n}=t,a=Tt(So,s),i=jr(s),{onCustomAnchorAdd:l,onCustomAnchorRemove:o}=a;return C.useEffect(()=>(l(),()=>o()),[l,o]),e.jsx(ln,{...i,...n,ref:r})});jp.displayName=So;var Eo="PopoverTrigger",Ao=C.forwardRef((t,r)=>{const{__scopePopover:s,...n}=t,a=Tt(Eo,s),i=jr(s),l=Oe(r,a.triggerRef),o=e.jsx(ke.button,{type:"button","aria-haspopup":"dialog","aria-expanded":a.open,"aria-controls":a.contentId,"data-state":Oo(a.open),...n,ref:l,onClick:ye(t.onClick,a.onOpenToggle)});return a.hasCustomAnchor?o:e.jsx(ln,{asChild:!0,...i,children:o})});Ao.displayName=Eo;var mn="PopoverPortal",[Np,kp]=Co(mn,{forceMount:void 0}),Po=t=>{const{__scopePopover:r,forceMount:s,children:n,container:a}=t,i=Tt(mn,r);return e.jsx(Np,{scope:r,forceMount:s,children:e.jsx(yr,{present:s||i.open,children:e.jsx(ja,{asChild:!0,container:a,children:n})})})};Po.displayName=mn;var rr="PopoverContent",To=C.forwardRef((t,r)=>{const s=kp(rr,t.__scopePopover),{forceMount:n=s.forceMount,...a}=t,i=Tt(rr,t.__scopePopover);return e.jsx(yr,{present:n||i.open,children:i.modal?e.jsx(_p,{...a,ref:r}):e.jsx(Sp,{...a,ref:r})})});To.displayName=rr;var Cp=mp("PopoverContent.RemoveScroll"),_p=C.forwardRef((t,r)=>{const s=Tt(rr,t.__scopePopover),n=C.useRef(null),a=Oe(r,n),i=C.useRef(!1);return C.useEffect(()=>{const l=n.current;if(l)return gl(l)},[]),e.jsx(yl,{as:Cp,allowPinchZoom:!0,children:e.jsx(Ro,{...t,ref:a,trapFocus:s.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:ye(t.onCloseAutoFocus,l=>{var o;l.preventDefault(),i.current||(o=s.triggerRef.current)==null||o.focus()}),onPointerDownOutside:ye(t.onPointerDownOutside,l=>{const o=l.detail.originalEvent,c=o.button===0&&o.ctrlKey===!0,f=o.button===2||c;i.current=f},{checkForDefaultPrevented:!1}),onFocusOutside:ye(t.onFocusOutside,l=>l.preventDefault(),{checkForDefaultPrevented:!1})})})}),Sp=C.forwardRef((t,r)=>{const s=Tt(rr,t.__scopePopover),n=C.useRef(!1),a=C.useRef(!1);return e.jsx(Ro,{...t,ref:r,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:i=>{var l,o;(l=t.onCloseAutoFocus)==null||l.call(t,i),i.defaultPrevented||(n.current||(o=s.triggerRef.current)==null||o.focus(),i.preventDefault()),n.current=!1,a.current=!1},onInteractOutside:i=>{var c,f;(c=t.onInteractOutside)==null||c.call(t,i),i.defaultPrevented||(n.current=!0,i.detail.originalEvent.type==="pointerdown"&&(a.current=!0));const l=i.target;((f=s.triggerRef.current)==null?void 0:f.contains(l))&&i.preventDefault(),i.detail.originalEvent.type==="focusin"&&a.current&&i.preventDefault()}})}),Ro=C.forwardRef((t,r)=>{const{__scopePopover:s,trapFocus:n,onOpenAutoFocus:a,onCloseAutoFocus:i,disableOutsidePointerEvents:l,onEscapeKeyDown:o,onPointerDownOutside:c,onFocusOutside:f,onInteractOutside:m,...p}=t,b=Tt(rr,s),h=jr(s);return vl(),e.jsx(bl,{asChild:!0,loop:!0,trapped:n,onMountAutoFocus:a,onUnmountAutoFocus:i,children:e.jsx(Na,{asChild:!0,disableOutsidePointerEvents:l,onInteractOutside:m,onEscapeKeyDown:o,onPointerDownOutside:c,onFocusOutside:f,onDismiss:()=>b.onOpenChange(!1),children:e.jsx(zi,{"data-state":Oo(b.open),role:"dialog",id:b.contentId,...h,...p,ref:r,style:{...p.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),Do="PopoverClose",Ep=C.forwardRef((t,r)=>{const{__scopePopover:s,...n}=t,a=Tt(Do,s);return e.jsx(ke.button,{type:"button",...n,ref:r,onClick:ye(t.onClick,()=>a.onOpenChange(!1))})});Ep.displayName=Do;var Ap="PopoverArrow",Pp=C.forwardRef((t,r)=>{const{__scopePopover:s,...n}=t,a=jr(s);return e.jsx(Li,{...a,...n,ref:r})});Pp.displayName=Ap;function Oo(t){return t?"open":"closed"}var Tp=_o,Rp=Ao,Dp=Po,Fo=To;const Op=Tp,Fp=Rp,Io=C.forwardRef(({className:t,align:r="center",sideOffset:s=4,...n},a)=>e.jsx(Dp,{children:e.jsx(Fo,{ref:a,align:r,sideOffset:s,className:be("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...n})}));Io.displayName=Fo.displayName;function Rt({value:t,onChange:r,label:s,showEyedropper:n=!0}){const[a,i]=C.useState(!1),{objects:l}=Ee(),o=Array.from(new Set(l.flatMap(m=>[m.fill,m.stroke,m.colorize]).filter(m=>!!m&&m!=="none"))).slice(0,12),c=m=>{r(m),i(!1),J.success("Color picked!",{description:m.toUpperCase()})},f=["#000000","#ffffff","#ccff00","#ff6600","#00ffff","#ff00ff","#ff0000","#00ff00"];return e.jsxs("div",{className:"space-y-2",children:[s&&e.jsx("label",{className:"text-[10px] uppercase tracking-widest text-muted-foreground font-medium block",children:s}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-10 h-10 rounded border-2 border-border shadow-sm cursor-pointer hover:scale-105 transition-transform shrink-0",style:{backgroundColor:t},title:t}),e.jsx("input",{type:"color",value:t,onChange:m=>r(m.target.value),className:"flex-1 h-10 border border-border rounded cursor-pointer min-w-0"}),n&&o.length>0&&e.jsxs(Op,{open:a,onOpenChange:i,children:[e.jsx(Fp,{asChild:!0,children:e.jsx(X,{size:"sm",variant:"outline",className:"gap-2 shrink-0",title:"Pick color from canvas",children:e.jsx(Ec,{className:"w-4 h-4"})})}),e.jsx(Io,{className:"w-64 p-3",align:"end",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h4",{className:"text-sm font-medium",children:"Pick from canvas"}),e.jsx(X,{size:"sm",variant:"ghost",className:"h-6 w-6 p-0",onClick:()=>i(!1),children:e.jsx(vr,{className:"h-4 w-4"})})]}),e.jsx("div",{className:"grid grid-cols-6 gap-2",children:o.map((m,p)=>e.jsx("button",{onClick:()=>c(m),className:`w-9 h-9 rounded border-2 transition-all hover:scale-110 ${t.toLowerCase()===m.toLowerCase()?"border-accent ring-2 ring-accent/30":"border-border/50 hover:border-accent/50"}`,style:{backgroundColor:m},title:m},`${m}-${p}`))}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Colors from your design"})]})})]})]}),e.jsx("div",{className:"grid grid-cols-8 gap-1.5",children:f.map(m=>e.jsx("button",{onClick:()=>r(m),className:`w-8 h-8 rounded border-2 transition-all hover:scale-110 ${t.toLowerCase()===m.toLowerCase()?"border-accent ring-2 ring-accent/30":"border-border/50"}`,style:{backgroundColor:m},title:m},m))}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("input",{type:"text",value:t,onChange:m=>{const p=m.target.value;(/^#[0-9A-Fa-f]{0,6}$/.test(p)||p==="")&&r(p)},placeholder:"#000000",maxLength:7,className:"flex-1 h-8 px-2 text-xs font-mono border border-border rounded bg-background"})})]})}var cs="Collapsible",[Ip,zo]=xt(cs),[zp,xn]=Ip(cs),Lo=C.forwardRef((t,r)=>{const{__scopeCollapsible:s,open:n,defaultOpen:a,disabled:i,onOpenChange:l,...o}=t,[c,f]=At({prop:n,defaultProp:a??!1,onChange:l,caller:cs});return e.jsx(zp,{scope:s,disabled:i,contentId:Hr(),open:c,onOpenToggle:C.useCallback(()=>f(m=>!m),[f]),children:e.jsx(ke.div,{"data-state":yn(c),"data-disabled":i?"":void 0,...o,ref:r})})});Lo.displayName=cs;var Mo="CollapsibleTrigger",$o=C.forwardRef((t,r)=>{const{__scopeCollapsible:s,...n}=t,a=xn(Mo,s);return e.jsx(ke.button,{type:"button","aria-controls":a.contentId,"aria-expanded":a.open||!1,"data-state":yn(a.open),"data-disabled":a.disabled?"":void 0,disabled:a.disabled,...n,ref:r,onClick:ye(t.onClick,a.onOpenToggle)})});$o.displayName=Mo;var gn="CollapsibleContent",Bo=C.forwardRef((t,r)=>{const{forceMount:s,...n}=t,a=xn(gn,t.__scopeCollapsible);return e.jsx(yr,{present:s||a.open,children:({present:i})=>e.jsx(Lp,{...n,ref:r,present:i})})});Bo.displayName=gn;var Lp=C.forwardRef((t,r)=>{const{__scopeCollapsible:s,present:n,children:a,...i}=t,l=xn(gn,s),[o,c]=C.useState(n),f=C.useRef(null),m=Oe(r,f),p=C.useRef(0),b=p.current,h=C.useRef(0),w=h.current,d=l.open||o,u=C.useRef(d),g=C.useRef(void 0);return C.useEffect(()=>{const x=requestAnimationFrame(()=>u.current=!1);return()=>cancelAnimationFrame(x)},[]),cr(()=>{const x=f.current;if(x){g.current=g.current||{transitionDuration:x.style.transitionDuration,animationName:x.style.animationName},x.style.transitionDuration="0s",x.style.animationName="none";const j=x.getBoundingClientRect();p.current=j.height,h.current=j.width,u.current||(x.style.transitionDuration=g.current.transitionDuration,x.style.animationName=g.current.animationName),c(n)}},[l.open,n]),e.jsx(ke.div,{"data-state":yn(l.open),"data-disabled":l.disabled?"":void 0,id:l.contentId,hidden:!d,...i,ref:m,style:{"--radix-collapsible-content-height":b?`${b}px`:void 0,"--radix-collapsible-content-width":w?`${w}px`:void 0,...t.style},children:d&&a})});function yn(t){return t?"open":"closed"}var Mp=Lo,$p=$o,Bp=Bo,tt="Accordion",Up=["Home","End","ArrowDown","ArrowUp","ArrowLeft","ArrowRight"],[vn,Vp,Hp]=Ks(tt),[ds]=xt(tt,[Hp,zo]),bn=zo(),Uo=De.forwardRef((t,r)=>{const{type:s,...n}=t,a=n,i=n;return e.jsx(vn.Provider,{scope:t.__scopeAccordion,children:s==="multiple"?e.jsx(Kp,{...i,ref:r}):e.jsx(qp,{...a,ref:r})})});Uo.displayName=tt;var[Vo,Wp]=ds(tt),[Ho,Gp]=ds(tt,{collapsible:!1}),qp=De.forwardRef((t,r)=>{const{value:s,defaultValue:n,onValueChange:a=()=>{},collapsible:i=!1,...l}=t,[o,c]=At({prop:s,defaultProp:n??"",onChange:a,caller:tt});return e.jsx(Vo,{scope:t.__scopeAccordion,value:De.useMemo(()=>o?[o]:[],[o]),onItemOpen:c,onItemClose:De.useCallback(()=>i&&c(""),[i,c]),children:e.jsx(Ho,{scope:t.__scopeAccordion,collapsible:i,children:e.jsx(Wo,{...l,ref:r})})})}),Kp=De.forwardRef((t,r)=>{const{value:s,defaultValue:n,onValueChange:a=()=>{},...i}=t,[l,o]=At({prop:s,defaultProp:n??[],onChange:a,caller:tt}),c=De.useCallback(m=>o((p=[])=>[...p,m]),[o]),f=De.useCallback(m=>o((p=[])=>p.filter(b=>b!==m)),[o]);return e.jsx(Vo,{scope:t.__scopeAccordion,value:l,onItemOpen:c,onItemClose:f,children:e.jsx(Ho,{scope:t.__scopeAccordion,collapsible:!0,children:e.jsx(Wo,{...i,ref:r})})})}),[Yp,us]=ds(tt),Wo=De.forwardRef((t,r)=>{const{__scopeAccordion:s,disabled:n,dir:a,orientation:i="vertical",...l}=t,o=De.useRef(null),c=Oe(o,r),f=Vp(s),p=ka(a)==="ltr",b=ye(t.onKeyDown,h=>{var F;if(!Up.includes(h.key))return;const w=h.target,d=f().filter(R=>{var B;return!((B=R.ref.current)!=null&&B.disabled)}),u=d.findIndex(R=>R.ref.current===w),g=d.length;if(u===-1)return;h.preventDefault();let x=u;const j=0,k=g-1,N=()=>{x=u+1,x>k&&(x=j)},P=()=>{x=u-1,x<j&&(x=k)};switch(h.key){case"Home":x=j;break;case"End":x=k;break;case"ArrowRight":i==="horizontal"&&(p?N():P());break;case"ArrowDown":i==="vertical"&&N();break;case"ArrowLeft":i==="horizontal"&&(p?P():N());break;case"ArrowUp":i==="vertical"&&P();break}const A=x%g;(F=d[A].ref.current)==null||F.focus()});return e.jsx(Yp,{scope:s,disabled:n,direction:a,orientation:i,children:e.jsx(vn.Slot,{scope:s,children:e.jsx(ke.div,{...l,"data-orientation":i,ref:c,onKeyDown:n?void 0:b})})})}),Vr="AccordionItem",[Zp,wn]=ds(Vr),Go=De.forwardRef((t,r)=>{const{__scopeAccordion:s,value:n,...a}=t,i=us(Vr,s),l=Wp(Vr,s),o=bn(s),c=Hr(),f=n&&l.value.includes(n)||!1,m=i.disabled||t.disabled;return e.jsx(Zp,{scope:s,open:f,disabled:m,triggerId:c,children:e.jsx(Mp,{"data-orientation":i.orientation,"data-state":Qo(f),...o,...a,ref:r,disabled:m,open:f,onOpenChange:p=>{p?l.onItemOpen(n):l.onItemClose(n)}})})});Go.displayName=Vr;var qo="AccordionHeader",Ko=De.forwardRef((t,r)=>{const{__scopeAccordion:s,...n}=t,a=us(tt,s),i=wn(qo,s);return e.jsx(ke.h3,{"data-orientation":a.orientation,"data-state":Qo(i.open),"data-disabled":i.disabled?"":void 0,...n,ref:r})});Ko.displayName=qo;var Is="AccordionTrigger",Yo=De.forwardRef((t,r)=>{const{__scopeAccordion:s,...n}=t,a=us(tt,s),i=wn(Is,s),l=Gp(Is,s),o=bn(s);return e.jsx(vn.ItemSlot,{scope:s,children:e.jsx($p,{"aria-disabled":i.open&&!l.collapsible||void 0,"data-orientation":a.orientation,id:i.triggerId,...o,...n,ref:r})})});Yo.displayName=Is;var Zo="AccordionContent",Xo=De.forwardRef((t,r)=>{const{__scopeAccordion:s,...n}=t,a=us(tt,s),i=wn(Zo,s),l=bn(s);return e.jsx(Bp,{role:"region","aria-labelledby":i.triggerId,"data-orientation":a.orientation,...l,...n,ref:r,style:{"--radix-accordion-content-height":"var(--radix-collapsible-content-height)","--radix-accordion-content-width":"var(--radix-collapsible-content-width)",...t.style}})});Xo.displayName=Zo;function Qo(t){return t?"open":"closed"}var Xp=Uo,Qp=Go,Jp=Ko,Jo=Yo,el=Xo;const em=Xp,tl=C.forwardRef(({className:t,...r},s)=>e.jsx(Qp,{ref:s,className:be("border-b",t),...r}));tl.displayName="AccordionItem";const rl=C.forwardRef(({className:t,children:r,...s},n)=>e.jsx(Jp,{className:"flex",children:e.jsxs(Jo,{ref:n,className:be("flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180",t),...s,children:[r,e.jsx(Ia,{className:"h-4 w-4 shrink-0 transition-transform duration-200"})]})}));rl.displayName=Jo.displayName;const sl=C.forwardRef(({className:t,children:r,...s},n)=>e.jsx(el,{ref:n,className:"overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down",...s,children:e.jsx("div",{className:be("pb-4 pt-0",t),children:r})}));sl.displayName=el.displayName;function ca(){const{objects:t,selectedId:r,updateObject:s,saveToHistory:n,generatePattern:a,moveLayer:i,bringToFront:l,sendToBack:o}=Ee(),c=t.find(N=>N.id===r),[f,m]=C.useState(5),[p,b]=C.useState(0),[h,w]=C.useState(!1),[d,u]=C.useState([]);C.useEffect(()=>{_a().then(u)},[]);const g=()=>{alert("Export feature coming soon! The deck design will be exported as a high-resolution PNG.")},x=N=>{r&&(n(),s(r,N))},{backgroundColor:j,setBackgroundColor:k}=Ee();return e.jsxs("div",{className:"w-64 bg-card border-l border-border h-full flex flex-col",children:[e.jsx("div",{className:"p-3 border-b border-border",children:e.jsxs("button",{onClick:g,className:"w-full bg-accent text-accent-foreground font-display text-sm uppercase tracking-wider py-2.5 px-4 border border-accent hover:bg-accent/90 transition-colors flex items-center justify-center gap-2",children:[e.jsx(lt,{className:"w-4 h-4"}),"Export Print"]})}),e.jsx("div",{className:"p-3 border-b border-border space-y-2",children:e.jsx(Rt,{label:"Deck Background",value:j,onChange:k,showEyedropper:!0})}),e.jsx("div",{className:"flex-1 overflow-auto",children:c?e.jsxs("div",{className:"p-3 space-y-4",children:[e.jsxs("div",{className:"py-2 border-b border-border flex items-center justify-between",children:[e.jsx("span",{className:"font-display text-[10px] uppercase tracking-widest text-muted-foreground",children:"Properties"}),e.jsx("button",{onClick:()=>x({locked:!c.locked}),className:`flex items-center gap-1.5 px-2 py-1 text-xs transition-colors ${c.locked?"bg-destructive/20 text-destructive hover:bg-destructive/30":"bg-secondary text-muted-foreground hover:bg-secondary/80"}`,title:c.locked?"Unlock object":"Lock object",children:c.locked?e.jsxs(e.Fragment,{children:[e.jsx(Vs,{className:"w-3 h-3"}),e.jsx("span",{className:"uppercase tracking-wider",children:"Locked"})]}):e.jsxs(e.Fragment,{children:[e.jsx(Ac,{className:"w-3 h-3"}),e.jsx("span",{className:"uppercase tracking-wider",children:"Unlocked"})]})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(ae,{className:"text-[10px] uppercase tracking-widest text-muted-foreground",children:"Layer Order"}),e.jsxs("div",{className:"grid grid-cols-4 gap-1",children:[e.jsxs("button",{onClick:()=>{i(r,"up"),J.success("Moved forward")},className:"flex items-center justify-center gap-1 px-2 py-1.5 text-xs bg-secondary hover:bg-secondary/80 border border-border transition-colors",title:"Bring forward (Ctrl+])",children:[e.jsx(Pc,{className:"w-3.5 h-3.5"}),e.jsx("span",{className:"text-[9px] uppercase",children:"Forward"})]}),e.jsxs("button",{onClick:()=>{i(r,"down"),J.success("Moved backward")},className:"flex items-center justify-center gap-1 px-2 py-1.5 text-xs bg-secondary hover:bg-secondary/80 border border-border transition-colors",title:"Send backward (Ctrl+[)",children:[e.jsx(Tc,{className:"w-3.5 h-3.5"}),e.jsx("span",{className:"text-[9px] uppercase",children:"Back"})]}),e.jsxs("button",{onClick:()=>{l(r),J.success("Brought to front")},className:"flex items-center justify-center gap-1 px-2 py-1.5 text-xs bg-secondary hover:bg-secondary/80 border border-border transition-colors",title:"Bring to front (Ctrl+Shift+])",children:[e.jsx(Rc,{className:"w-3.5 h-3.5"}),e.jsx("span",{className:"text-[9px] uppercase",children:"Front"})]}),e.jsxs("button",{onClick:()=>{o(r),J.success("Sent to back")},className:"flex items-center justify-center gap-1 px-2 py-1.5 text-xs bg-secondary hover:bg-secondary/80 border border-border transition-colors",title:"Send to back (Ctrl+Shift+[)",children:[e.jsx(Dc,{className:"w-3.5 h-3.5"}),e.jsx("span",{className:"text-[9px] uppercase",children:"Back"})]})]}),e.jsx("p",{className:"text-[9px] text-muted-foreground",children:"Move layer in front of or behind other objects"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(ae,{className:"text-[10px] uppercase tracking-widest text-muted-foreground",children:"Opacity"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ve,{value:[c.opacity*100],onValueChange:([N])=>x({opacity:N/100}),max:100,min:0,step:1,className:"flex-1"}),e.jsxs("span",{className:"text-[11px] font-mono w-10 text-right",children:[Math.round(c.opacity*100),"%"]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(ae,{className:"text-[10px] uppercase tracking-widest text-muted-foreground",children:"Rotation"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ae,{type:"number",value:Math.round(c.rotation),onChange:N=>x({rotation:Number(N.target.value)}),className:"h-8 text-xs font-mono bg-secondary border-border"}),e.jsx("span",{className:"text-[11px] text-muted-foreground",children:"deg"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(ae,{className:"text-[10px] uppercase tracking-widest text-muted-foreground",children:"Scale"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-[9px] text-muted-foreground",children:"X"}),e.jsx(Ae,{type:"number",step:"0.1",value:c.scaleX.toFixed(2),onChange:N=>x({scaleX:Number(N.target.value)}),className:"h-8 text-xs font-mono bg-secondary border-border"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-[9px] text-muted-foreground",children:"Y"}),e.jsx(Ae,{type:"number",step:"0.1",value:c.scaleY.toFixed(2),onChange:N=>x({scaleY:Number(N.target.value)}),className:"h-8 text-xs font-mono bg-secondary border-border"})]})]})]}),(c.type==="text"||c.type==="shape")&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(ae,{className:"text-[10px] uppercase tracking-widest text-muted-foreground",children:"Color"}),e.jsx(pp,{currentFill:c.fill,onApplySolid:N=>x({fill:N}),onApplyGradient:(N,P)=>{x({gradientType:"linear",gradientStops:N,gradientAngle:P,fill:N[0].color})}})]}),c.type==="shape"&&c.patternType&&e.jsxs("div",{className:"pt-4 border-t border-border space-y-4",children:[e.jsx("div",{className:"py-2",children:e.jsx("span",{className:"font-display text-[10px] uppercase tracking-widest text-muted-foreground",children:"Pattern Settings"})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(ae,{className:"text-[10px] uppercase tracking-widest text-muted-foreground",children:"Pattern Type"}),e.jsxs("select",{value:c.patternType,onChange:N=>x({patternType:N.target.value}),className:"w-full h-8 text-xs bg-secondary border-border rounded px-2",children:[e.jsx("option",{value:"checkerboard",children:"Checkerboard"}),e.jsx("option",{value:"speed-lines",children:"Speed Lines"}),e.jsx("option",{value:"halftone",children:"Halftone"}),e.jsx("option",{value:"diagonal-stripes",children:"Diagonal Stripes"}),e.jsx("option",{value:"hexagons",children:"Hexagons"}),e.jsx("option",{value:"crosshatch",children:"Crosshatch"})]})]}),e.jsx(Rt,{label:"Primary Color",value:c.patternPrimaryColor||"#1e3a8a",onChange:N=>x({patternPrimaryColor:N}),showEyedropper:!0}),e.jsx(Rt,{label:"Secondary Color",value:c.patternSecondaryColor||"#3b82f6",onChange:N=>x({patternSecondaryColor:N}),showEyedropper:!0}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(ae,{className:"text-[10px] uppercase tracking-widest text-muted-foreground",children:"Pattern Scale"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ve,{value:[c.patternScale||20],onValueChange:([N])=>x({patternScale:N}),max:100,min:5,step:5,className:"flex-1"}),e.jsxs("span",{className:"text-[11px] font-mono w-10 text-right",children:[c.patternScale||20,"px"]})]})]})]}),(c.type==="image"||c.type==="path")&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(ae,{className:"text-[10px] uppercase tracking-widest text-muted-foreground",children:"Color Tint"}),e.jsx("button",{onClick:()=>x({colorize:c.colorize?null:"#ccff00"}),className:`px-2 py-1 text-[9px] uppercase tracking-wider border transition-colors rounded ${c.colorize?"bg-primary text-primary-foreground border-primary":"bg-secondary text-muted-foreground border-border hover:border-primary"}`,children:c.colorize?"On":"Off"})]}),c.colorize&&e.jsx(Rt,{label:"",value:c.colorize,onChange:N=>x({colorize:N}),showEyedropper:!0}),e.jsxs("p",{className:"text-[9px] text-muted-foreground",children:["Apply a color overlay to the ",c.type]})]}),c.type==="sticker"&&e.jsxs("div",{className:"pt-4 border-t border-border space-y-4",children:[e.jsx("div",{className:"py-2",children:e.jsx("span",{className:"font-display text-[10px] uppercase tracking-widest text-muted-foreground",children:"Sticker Options"})}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(ae,{className:"text-[10px] uppercase tracking-widest text-muted-foreground",children:"Fill Color"}),e.jsx("button",{onClick:()=>x({colorize:c.colorize?null:"#ccff00"}),className:`px-2 py-1 text-[9px] uppercase tracking-wider border transition-colors rounded ${c.colorize?"bg-primary text-primary-foreground border-primary":"bg-secondary text-muted-foreground border-border hover:border-primary"}`,children:c.colorize?"On":"Off"})]}),c.colorize&&e.jsx(Rt,{label:"",value:c.colorize,onChange:N=>x({colorize:N}),showEyedropper:!0}),e.jsx("p",{className:"text-[9px] text-muted-foreground",children:"Tint the sticker with a solid color"})]}),e.jsx(Rt,{label:"Stroke Color",value:c.stroke||"#ffffff",onChange:N=>x({stroke:N}),showEyedropper:!0}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(ae,{className:"text-[10px] uppercase tracking-widest text-muted-foreground",children:"Stroke Width"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ve,{value:[c.strokeWidth??3],onValueChange:([N])=>x({strokeWidth:N}),max:8,min:1,step:.5,className:"flex-1"}),e.jsxs("span",{className:"text-[11px] font-mono w-10 text-right",children:[c.strokeWidth??3,"px"]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(ae,{className:"text-[10px] uppercase tracking-widest text-muted-foreground",children:"Line Style"}),e.jsx("div",{className:"grid grid-cols-3 gap-1",children:["solid","dashed","dotted"].map(N=>e.jsx("button",{onClick:()=>x({strokeDashStyle:N}),className:`px-2 py-1.5 text-[10px] uppercase tracking-wider border transition-colors ${(c.strokeDashStyle||"solid")===N?"bg-primary text-primary-foreground border-primary":"bg-secondary text-muted-foreground border-border hover:border-primary"}`,children:N==="solid"?"":N==="dashed"?"":""},N))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(ae,{className:"text-[10px] uppercase tracking-widest text-muted-foreground",children:"Solid Fill"}),e.jsx("button",{onClick:()=>x({solidFill:!c.solidFill}),className:`w-10 h-5 rounded-full transition-colors relative ${c.solidFill?"bg-primary":"bg-muted"}`,children:e.jsx("span",{className:`absolute top-0.5 w-4 h-4 rounded-full bg-white transition-transform ${c.solidFill?"translate-x-5":"translate-x-0.5"}`})})]}),e.jsx("p",{className:"text-[9px] text-muted-foreground",children:"Fill the icon with solid color instead of outline"})]})]}),c.type==="texture"&&e.jsxs("div",{className:"pt-4 border-t border-border space-y-4",children:[e.jsx("div",{className:"py-2",children:e.jsx("span",{className:"font-display text-[10px] uppercase tracking-widest text-muted-foreground",children:"Texture Options"})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(ae,{className:"text-[10px] uppercase tracking-widest text-muted-foreground",children:"Blend Mode"}),e.jsx("div",{className:"grid grid-cols-2 gap-1",children:["multiply","overlay","soft-light","color-burn","normal"].map(N=>e.jsx("button",{onClick:()=>x({blendMode:N}),className:`py-1.5 px-2 text-[9px] uppercase tracking-wider border transition-colors ${c.blendMode===N?"border-primary bg-primary text-primary-foreground":"border-border hover:border-primary"}`,children:N},N))})]})]}),c.type==="line"&&e.jsxs("div",{className:"pt-4 border-t border-border space-y-4",children:[e.jsx("div",{className:"py-2",children:e.jsx("span",{className:"font-display text-[10px] uppercase tracking-widest text-muted-foreground",children:"Line Options"})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(ae,{className:"text-[10px] uppercase tracking-widest text-muted-foreground",children:"Line Type"}),e.jsx("div",{className:"grid grid-cols-2 gap-1",children:["straight","curved","zigzag","dashed"].map(N=>e.jsx("button",{onClick:()=>x({lineType:N}),className:`py-1.5 px-2 text-[9px] uppercase tracking-wider border transition-colors ${c.lineType===N?"border-primary bg-primary text-primary-foreground":"border-border hover:border-primary"}`,children:N},N))})]}),e.jsx(Rt,{label:"Stroke Color",value:c.stroke||"#ffffff",onChange:N=>x({stroke:N}),showEyedropper:!0}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(ae,{className:"text-[10px] uppercase tracking-widest text-muted-foreground",children:"Stroke Width"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ve,{value:[c.strokeWidth??3],onValueChange:([N])=>x({strokeWidth:N}),max:12,min:1,step:1,className:"flex-1"}),e.jsxs("span",{className:"text-[11px] font-mono w-10 text-right",children:[c.strokeWidth??3,"px"]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(ae,{className:"text-[10px] uppercase tracking-widest text-muted-foreground",children:"Line Style"}),e.jsx("div",{className:"grid grid-cols-3 gap-1",children:["solid","dashed","dotted"].map(N=>e.jsx("button",{onClick:()=>x({strokeDashStyle:N}),className:`px-2 py-1.5 text-[10px] uppercase tracking-wider border transition-colors ${(c.strokeDashStyle||"solid")===N?"bg-primary text-primary-foreground border-primary":"bg-secondary text-muted-foreground border-border hover:border-primary"}`,children:N==="solid"?"":N==="dashed"?"":""},N))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(ae,{className:"text-[10px] uppercase tracking-widest text-muted-foreground",children:"Length (X)"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ve,{value:[c.lineEndX??60],onValueChange:([N])=>x({lineEndX:N}),max:200,min:-200,step:5,className:"flex-1"}),e.jsx("span",{className:"text-[11px] font-mono w-10 text-right",children:c.lineEndX??60})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(ae,{className:"text-[10px] uppercase tracking-widest text-muted-foreground",children:"Length (Y)"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ve,{value:[c.lineEndY??0],onValueChange:([N])=>x({lineEndY:N}),max:200,min:-200,step:5,className:"flex-1"}),e.jsx("span",{className:"text-[11px] font-mono w-10 text-right",children:c.lineEndY??0})]})]}),c.lineType==="curved"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(ae,{className:"text-[10px] uppercase tracking-widest text-muted-foreground",children:"Curve Amount"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ve,{value:[c.lineCurve??50],onValueChange:([N])=>x({lineCurve:N}),max:100,min:-100,step:5,className:"flex-1"}),e.jsx("span",{className:"text-[11px] font-mono w-10 text-right",children:c.lineCurve??50})]}),e.jsx("p",{className:"text-[9px] text-muted-foreground",children:"Negative = curve down, Positive = curve up"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(ae,{className:"text-[10px] uppercase tracking-widest text-muted-foreground",children:"Cap Style"}),e.jsx("div",{className:"grid grid-cols-3 gap-1",children:["butt","round","square"].map(N=>e.jsx("button",{onClick:()=>x({lineCapStyle:N}),className:`py-1.5 px-2 text-[9px] uppercase tracking-wider border transition-colors ${c.lineCapStyle===N?"border-primary bg-primary text-primary-foreground":"border-border hover:border-primary"}`,children:N},N))})]})]}),c.type==="text"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(ae,{className:"text-[10px] uppercase tracking-widest text-muted-foreground",children:"Text"}),e.jsx(Ae,{type:"text",value:c.text||"",onChange:N=>x({text:N.target.value}),className:"h-8 text-xs font-mono bg-secondary border-border"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(ae,{className:"text-[10px] uppercase tracking-widest text-muted-foreground",children:["Font Family ",d.length>0&&e.jsxs("span",{className:"text-accent font-normal",children:["(",d.length," custom)"]})]}),e.jsxs("button",{onClick:()=>w(!0),className:"text-[10px] uppercase tracking-widest text-accent hover:text-accent/80 transition-colors flex items-center gap-1",children:[e.jsx(Wr,{className:"w-3 h-3"}),d.length>0?"Manage":"Upload"]})]}),e.jsxs("select",{value:c.fontFamily||"Arial",onChange:N=>x({fontFamily:N.target.value}),className:"w-full h-8 text-xs bg-secondary border border-border px-2 cursor-pointer hover:border-primary transition-colors",children:[d.length>0&&e.jsx("optgroup",{label:" Your Custom Fonts",children:d.map(N=>e.jsx("option",{value:N.font_family,children:N.name},N.id))}),e.jsxs("optgroup",{label:"System Fonts",children:[e.jsx("option",{value:"Arial",children:"Arial"}),e.jsx("option",{value:"Helvetica",children:"Helvetica"}),e.jsx("option",{value:"Times New Roman",children:"Times New Roman"}),e.jsx("option",{value:"Courier New",children:"Courier New"}),e.jsx("option",{value:"Georgia",children:"Georgia"}),e.jsx("option",{value:"Verdana",children:"Verdana"}),e.jsx("option",{value:"Impact",children:"Impact"}),e.jsx("option",{value:"Comic Sans MS",children:"Comic Sans MS"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(ae,{className:"text-[10px] uppercase tracking-widest text-muted-foreground",children:"Font Size"}),e.jsx(Ae,{type:"number",value:c.fontSize||24,onChange:N=>x({fontSize:Number(N.target.value)}),className:"h-8 text-xs font-mono bg-secondary border-border"})]})]}),e.jsxs("div",{className:"pt-4 border-t border-border space-y-4",children:[e.jsx("div",{className:"py-2",children:e.jsx("span",{className:"font-display text-[10px] uppercase tracking-widest text-muted-foreground",children:"Filters"})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(ae,{className:"text-[10px] uppercase tracking-widest text-muted-foreground",children:"Contrast"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ve,{value:[c.contrast??100],onValueChange:([N])=>x({contrast:N}),max:200,min:0,step:5,className:"flex-1"}),e.jsxs("span",{className:"text-[11px] font-mono w-10 text-right",children:[c.contrast??100,"%"]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(ae,{className:"text-[10px] uppercase tracking-widest text-muted-foreground",children:"Brightness"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ve,{value:[c.brightness??100],onValueChange:([N])=>x({brightness:N}),max:200,min:0,step:5,className:"flex-1"}),e.jsxs("span",{className:"text-[11px] font-mono w-10 text-right",children:[c.brightness??100,"%"]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(ae,{className:"text-[10px] uppercase tracking-widest text-muted-foreground",children:"Grayscale"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ve,{value:[c.grayscale??0],onValueChange:([N])=>x({grayscale:N}),max:100,min:0,step:5,className:"flex-1"}),e.jsxs("span",{className:"text-[11px] font-mono w-10 text-right",children:[c.grayscale??0,"%"]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(ae,{className:"text-[10px] uppercase tracking-widest text-muted-foreground",children:"Threshold"}),e.jsx("button",{onClick:()=>x({threshold:!c.threshold}),className:`w-10 h-5 rounded-full transition-colors relative ${c.threshold?"bg-primary":"bg-muted"}`,children:e.jsx("span",{className:`absolute top-0.5 w-4 h-4 rounded-full bg-white transition-transform ${c.threshold?"translate-x-5":"translate-x-0.5"}`})})]}),e.jsx("p",{className:"text-[9px] text-muted-foreground",children:"High-contrast black & white xerox effect"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(ae,{className:"text-[10px] uppercase tracking-widest text-muted-foreground",children:"Colorize"}),e.jsx("button",{onClick:()=>x({colorize:c.colorize?null:"#00ff00"}),className:`w-10 h-5 rounded-full transition-colors relative ${c.colorize?"bg-primary":"bg-muted"}`,children:e.jsx("span",{className:`absolute top-0.5 w-4 h-4 rounded-full bg-white transition-transform ${c.colorize?"translate-x-5":"translate-x-0.5"}`})})]}),c.colorize&&e.jsxs("div",{className:"flex items-center gap-2 pt-1",children:[e.jsx("input",{type:"color",value:c.colorize,onChange:N=>x({colorize:N.target.value}),className:"w-8 h-8 border border-border cursor-pointer bg-transparent"}),e.jsx("div",{className:"flex gap-1",children:["#ccff00","#ff6600","#00ffff","#ff00ff","#ffffff"].map(N=>e.jsx("button",{onClick:()=>x({colorize:N}),className:`w-6 h-6 border ${c.colorize===N?"border-primary":"border-border"}`,style:{backgroundColor:N}},N))})]}),e.jsx("p",{className:"text-[9px] text-muted-foreground",children:"Cast in a single punk zine color"})]})]}),e.jsxs("div",{className:"pt-4 border-t border-border space-y-4",children:[e.jsx("div",{className:"py-2",children:e.jsx("span",{className:"font-display text-[10px] uppercase tracking-widest text-muted-foreground",children:"Remix Effects"})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(ae,{className:"text-[10px] uppercase tracking-widest text-muted-foreground",children:"Hue Shift"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ve,{value:[c.hueRotate??0],onValueChange:([N])=>x({hueRotate:N}),max:360,min:0,step:15,className:"flex-1"}),e.jsxs("span",{className:"text-[11px] font-mono w-10 text-right",children:[c.hueRotate??0,""]})]}),e.jsx("div",{className:"h-3 w-full rounded",style:{background:"linear-gradient(to right, #ff0000, #ffff00, #00ff00, #00ffff, #0000ff, #ff00ff, #ff0000)"}})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(ae,{className:"text-[10px] uppercase tracking-widest text-muted-foreground",children:"Invert"}),e.jsx("button",{onClick:()=>x({invert:!c.invert}),className:`w-10 h-5 rounded-full transition-colors relative ${c.invert?"bg-primary":"bg-muted"}`,children:e.jsx("span",{className:`absolute top-0.5 w-4 h-4 rounded-full bg-white transition-transform ${c.invert?"translate-x-5":"translate-x-0.5"}`})})]}),e.jsx("p",{className:"text-[9px] text-muted-foreground",children:"Flip colors to negative"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(ae,{className:"text-[10px] uppercase tracking-widest text-muted-foreground",children:"Pixelate"}),e.jsx("button",{onClick:()=>x({pixelate:!c.pixelate}),className:`w-10 h-5 rounded-full transition-colors relative ${c.pixelate?"bg-primary":"bg-muted"}`,children:e.jsx("span",{className:`absolute top-0.5 w-4 h-4 rounded-full bg-white transition-transform ${c.pixelate?"translate-x-5":"translate-x-0.5"}`})})]}),e.jsx("p",{className:"text-[9px] text-muted-foreground",children:"Lo-fi 8-bit effect (images only)"})]}),e.jsxs("button",{onClick:()=>x({hueRotate:0,invert:!1,pixelate:!1,contrast:100,brightness:100,grayscale:0,threshold:!1,colorize:null}),className:"w-full border border-border hover:border-primary transition-colors py-1.5 px-3 text-[10px] uppercase tracking-wider flex items-center justify-center gap-2",children:[e.jsx(Oc,{className:"w-3 h-3"}),"Reset All Filters"]})]}),e.jsx(em,{type:"single",collapsible:!0,className:"border-t border-border",children:e.jsxs(tl,{value:"effects",className:"border-none",children:[e.jsx(rl,{className:"py-3 px-0 hover:no-underline",children:e.jsx("span",{className:"font-display text-[10px] uppercase tracking-widest text-muted-foreground",children:"Advanced Effects"})}),e.jsx(sl,{className:"pb-4",children:e.jsx(lp,{})})]})}),(c.type==="shape"||c.type==="image"||c.type==="sticker")&&e.jsxs("div",{className:"pt-4 border-t border-border space-y-4",children:[e.jsx("div",{className:"py-2",children:e.jsx("span",{className:"font-display text-[10px] uppercase tracking-widest text-muted-foreground",children:"Pattern Generator"})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(ae,{className:"text-[10px] uppercase tracking-widest text-muted-foreground",children:"Gap (spacing)"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ve,{value:[f],onValueChange:([N])=>m(N),max:30,min:0,step:1,className:"flex-1"}),e.jsxs("span",{className:"text-[11px] font-mono w-10 text-right",children:[f,"px"]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(ae,{className:"text-[10px] uppercase tracking-widest text-muted-foreground",children:"Random Rotation"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ve,{value:[p],onValueChange:([N])=>b(N),max:180,min:0,step:5,className:"flex-1"}),e.jsxs("span",{className:"text-[11px] font-mono w-10 text-right",children:[p,""]})]}),e.jsx("p",{className:"text-[9px] text-muted-foreground",children:"0 = neat grid, 180 = chaotic sticker bomb"})]}),e.jsxs("button",{onClick:()=>{r&&a(r,f,p,Jt,Qt)},className:"w-full bg-primary text-primary-foreground font-display text-sm uppercase tracking-wider py-2.5 px-4 border border-primary hover:bg-primary/90 transition-colors flex items-center justify-center gap-2",children:[e.jsx(Ta,{className:"w-4 h-4"}),"Make Pattern"]}),e.jsx("p",{className:"text-[9px] text-muted-foreground text-center",children:"Tiles the selected sticker across the entire deck"})]})]}):e.jsx("div",{className:"p-4 text-center",children:e.jsx("span",{className:"text-[10px] text-muted-foreground uppercase tracking-widest",children:"Select an object"})})}),e.jsx(xo,{}),e.jsx(wl,{isOpen:h,onClose:()=>w(!1),onFontUploaded:async N=>{u([...d,N]);try{await jl(N),J.success(`Font "${N.name}" ready to use`,{description:"Select it from the font dropdown",duration:3e3}),c&&c.type==="text"&&(x({fontFamily:N.font_family}),J.info("Applied to selected text",{duration:2e3}))}catch(P){console.error("Failed to load font:",P),J.error("Font uploaded but failed to load",{description:"Try refreshing the page"})}}})]})}function tm(){var f;const{selectedIds:t,objects:r,alignObjects:s,distributeObjects:n,groupObjects:a,ungroupObject:i}=Ee();if(t.length<2)return null;const l=t.length===1&&((f=r.find(m=>m.id===t[0]))==null?void 0:f.type)==="group",o=m=>{s(m);const p={left:"Left",center:"Center",right:"Right",top:"Top",middle:"Middle",bottom:"Bottom"};J.success(`Aligned ${t.length} objects`,{description:p[m]})},c=m=>{if(t.length<3){J.error("Need at least 3 objects to distribute");return}n(m),J.success(`Distributed ${t.length} objects`,{description:m==="horizontal"?"Horizontally":"Vertically"})};return e.jsx("div",{className:"fixed bottom-4 left-1/2 -translate-x-1/2 z-50 bg-card border-2 border-primary shadow-2xl rounded-lg p-3 animate-in slide-in-from-bottom-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"px-3 py-1.5 bg-primary/10 rounded border border-primary/20",children:e.jsxs("span",{className:"text-sm font-medium text-primary",children:[t.length," selected"]})}),e.jsx("div",{className:"w-px h-8 bg-border"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"text-xs text-muted-foreground mr-1",children:"Align:"}),e.jsx(X,{size:"sm",variant:"outline",onClick:()=>o("left"),className:"h-8 w-8 p-0",title:"Align Left",children:e.jsx(Fc,{className:"w-4 h-4"})}),e.jsx(X,{size:"sm",variant:"outline",onClick:()=>o("center"),className:"h-8 w-8 p-0",title:"Align Center",children:e.jsx(Ic,{className:"w-4 h-4"})}),e.jsx(X,{size:"sm",variant:"outline",onClick:()=>o("right"),className:"h-8 w-8 p-0",title:"Align Right",children:e.jsx(zc,{className:"w-4 h-4"})})]}),e.jsx("div",{className:"w-px h-8 bg-border"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(X,{size:"sm",variant:"outline",onClick:()=>o("top"),className:"h-8 w-8 p-0",title:"Align Top",children:e.jsx(Lc,{className:"w-4 h-4"})}),e.jsx(X,{size:"sm",variant:"outline",onClick:()=>o("middle"),className:"h-8 w-8 p-0",title:"Align Middle",children:e.jsx(Mc,{className:"w-4 h-4"})}),e.jsx(X,{size:"sm",variant:"outline",onClick:()=>o("bottom"),className:"h-8 w-8 p-0",title:"Align Bottom",children:e.jsx($c,{className:"w-4 h-4"})})]}),t.length>=3&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-px h-8 bg-border"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"text-xs text-muted-foreground mr-1",children:"Distribute:"}),e.jsx(X,{size:"sm",variant:"outline",onClick:()=>c("horizontal"),className:"h-8 w-8 p-0",title:"Distribute Horizontally",children:e.jsx(Bc,{className:"w-4 h-4"})}),e.jsx(X,{size:"sm",variant:"outline",onClick:()=>c("vertical"),className:"h-8 w-8 p-0",title:"Distribute Vertically",children:e.jsx(Uc,{className:"w-4 h-4"})})]})]}),e.jsx("div",{className:"w-px h-8 bg-border"}),l?e.jsxs(X,{size:"sm",variant:"outline",onClick:()=>{i(t[0]),J.success("Ungrouped objects")},className:"gap-2",title:"Ungroup (Ctrl+Shift+G)",children:[e.jsx(Vc,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline text-xs",children:"Ungroup"})]}):e.jsxs(X,{size:"sm",variant:"outline",onClick:()=>{a(t),J.success(`Grouped ${t.length} objects`)},className:"gap-2",title:"Group (Ctrl+G)",children:[e.jsx(Hc,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline text-xs",children:"Group"})]})]})})}function rm({onSave:t,onExport:r,onOpenHistory:s,onOpenInspector:n,onOpenLayers:a,isSaving:i,isExporting:l}){const{undo:o,redo:c,past:f,future:m,selectedId:p,deleteObject:b}=Ee(),[h,w]=C.useState(!1),d=(j=10)=>{"vibrate"in navigator&&navigator.vibrate(j)},u=()=>{d(10),o()},g=()=>{d(10),c()},x=()=>{p&&(d([10,50,10]),b(p))};return e.jsxs(e.Fragment,{children:[h&&e.jsx("div",{className:"fixed inset-0 bg-black/40 z-40",onClick:()=>w(!1)}),e.jsxs("div",{className:be("fixed bottom-0 left-0 right-0 bg-card border-t border-border z-50 transition-all duration-300",h?"h-48":"h-14"),children:[e.jsx("button",{onClick:()=>w(!h),className:"absolute -top-8 right-4 w-12 h-8 bg-card border border-border border-b-0 rounded-t-lg flex items-center justify-center hover:bg-secondary transition-colors",children:h?e.jsx(Wc,{className:"w-4 h-4"}):e.jsx(za,{className:"w-4 h-4"})}),e.jsxs("div",{className:"h-14 flex items-center justify-around px-1",children:[e.jsxs("button",{onClick:u,disabled:f.length===0,className:"flex flex-col items-center gap-0.5 p-2 min-w-[56px] disabled:opacity-30 disabled:cursor-not-allowed active:scale-95 transition-transform",children:[e.jsx(La,{className:"w-5 h-5"}),e.jsx("span",{className:"text-[9px] uppercase tracking-wider",children:"Undo"})]}),e.jsxs("button",{onClick:g,disabled:m.length===0,className:"flex flex-col items-center gap-0.5 p-2 min-w-[56px] disabled:opacity-30 disabled:cursor-not-allowed active:scale-95 transition-transform",children:[e.jsx(Ma,{className:"w-5 h-5"}),e.jsx("span",{className:"text-[9px] uppercase tracking-wider",children:"Redo"})]}),p&&e.jsxs("button",{onClick:x,className:"flex flex-col items-center gap-0.5 p-2 min-w-[56px] text-destructive active:scale-95 transition-transform",children:[e.jsx(Pt,{className:"w-5 h-5"}),e.jsx("span",{className:"text-[9px] uppercase tracking-wider",children:"Delete"})]}),e.jsxs("button",{onClick:()=>{d(10),a()},className:"flex flex-col items-center gap-0.5 p-2 min-w-[56px] active:scale-95 transition-transform",children:[e.jsx(Ir,{className:"w-5 h-5"}),e.jsx("span",{className:"text-[9px] uppercase tracking-wider",children:"Layers"})]}),e.jsxs("button",{onClick:()=>{d(10),n()},className:"flex flex-col items-center gap-0.5 p-2 min-w-[56px] active:scale-95 transition-transform",children:[e.jsx(Gc,{className:"w-5 h-5"}),e.jsx("span",{className:"text-[9px] uppercase tracking-wider",children:"Props"})]}),e.jsxs("button",{onClick:()=>{d(10),s()},className:"flex flex-col items-center gap-0.5 p-2 min-w-[56px] active:scale-95 transition-transform",children:[e.jsx(Ws,{className:"w-5 h-5"}),e.jsx("span",{className:"text-[9px] uppercase tracking-wider",children:"History"})]})]}),h&&e.jsxs("div",{className:"border-t border-border p-3 space-y-2",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("button",{onClick:()=>{t(),w(!1)},disabled:i,className:"btn-brutal text-sm py-2.5 flex items-center justify-center gap-2",children:[e.jsx($a,{className:"w-4 h-4"}),i?"Saving...":"Save"]}),e.jsxs("button",{onClick:()=>{r(),w(!1)},disabled:l,className:"btn-brutal text-sm py-2.5 flex items-center justify-center gap-2",children:[e.jsx(lt,{className:"w-4 h-4"}),l?"Exporting...":"Export"]})]}),e.jsx("p",{className:"text-xs text-muted-foreground text-center",children:"Tap outside to close"})]})]})]})}function ys({isOpen:t,onClose:r,title:s,children:n}){return t?e.jsxs("div",{className:"fixed inset-0 z-50 md:hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm",onClick:r}),e.jsxs("div",{className:be("absolute bottom-0 left-0 right-0 bg-card border-t-2 border-border max-h-[80vh] flex flex-col","animate-in slide-in-from-bottom duration-300"),children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-border shrink-0",children:[e.jsx("h2",{className:"font-display text-sm uppercase tracking-wider",children:s}),e.jsx("button",{onClick:r,className:"text-muted-foreground hover:text-foreground transition-colors",children:e.jsx(vr,{className:"w-5 h-5"})})]}),e.jsx(_t,{className:"flex-1",children:e.jsx("div",{className:"p-4",children:n})})]})]}):null}const nl=[{keys:["Click"],description:"Select object",category:"Selection"},{keys:["Shift","Click"],description:"Multi-select",category:"Selection"},{keys:["Esc"],description:"Deselect all",category:"Selection"},{keys:["Tab"],description:"Select next object",category:"Selection"},{keys:["Shift","Tab"],description:"Select previous object",category:"Selection"},{keys:["Delete"],description:"Delete selected",category:"Editing"},{keys:["Backspace"],description:"Delete selected",category:"Editing"},{keys:["Ctrl","Z"],description:"Undo",category:"Editing"},{keys:["Ctrl","Shift","Z"],description:"Redo",category:"Editing"},{keys:["Ctrl","D"],description:"Duplicate",category:"Editing"},{keys:["Ctrl","Shift","D"],description:"Array duplicate (custom grid)",category:"Editing"},{keys:["Ctrl","C"],description:"Copy to clipboard",category:"Editing"},{keys:["Ctrl","V"],description:"Paste from clipboard",category:"Editing"},{keys:["Ctrl","A"],description:"Select all (top object)",category:"Editing"},{keys:["Ctrl","L"],description:"Lock/unlock object",category:"Editing"},{keys:["Ctrl","G"],description:"Group selected objects",category:"Editing"},{keys:["Ctrl","Shift","G"],description:"Ungroup selected group",category:"Editing"},{keys:["Drag"],description:"Move object",category:"Transform"},{keys:["Shift","Drag"],description:"Move with snapping disabled",category:"Transform"},{keys:["Corner","Drag"],description:"Scale object",category:"Transform"},{keys:["Shift","Scale"],description:"Scale proportionally",category:"Transform"},{keys:["Alt","Scale"],description:"Scale from center",category:"Transform"},{keys:["Rotate","Handle"],description:"Rotate object",category:"Transform"},{keys:["Shift","Rotate"],description:"Rotate in 15 increments",category:"Transform"},{keys:["Ctrl","]"],description:"Bring forward",category:"Layers"},{keys:["Ctrl","["],description:"Send backward",category:"Layers"},{keys:["Ctrl","Shift","]"],description:"Bring to front",category:"Layers"},{keys:["Ctrl","Shift","["],description:"Send to back",category:"Layers"},{keys:["Alt","L"],description:"Align left",category:"Alignment"},{keys:["Alt","R"],description:"Align right",category:"Alignment"},{keys:["Alt","C"],description:"Align center",category:"Alignment"},{keys:["Alt","T"],description:"Align top",category:"Alignment"},{keys:["Alt","B"],description:"Align bottom",category:"Alignment"},{keys:["Alt","M"],description:"Align middle",category:"Alignment"},{keys:["Space","Drag"],description:"Pan canvas",category:"View"},{keys:["Scroll"],description:"Zoom in/out",category:"View"},{keys:["Ctrl","0"],description:"Reset zoom to 100%",category:"View"},{keys:["Ctrl","1"],description:"Zoom to fit",category:"View"},{keys:["Ctrl","Shift","R"],description:"Toggle rulers",category:"View"},{keys:["H"],description:"Toggle hardware guide",category:"View"},{keys:["T"],description:"Select text tool",category:"Tools"},{keys:["R"],description:"Select rectangle tool",category:"Tools"},{keys:["C"],description:"Select circle tool",category:"Tools"},{keys:["L"],description:"Select line tool",category:"Tools"},{keys:["V"],description:"Select move tool (default)",category:"Tools"},{keys:["Ctrl","S"],description:"Save design",category:"File"},{keys:["Ctrl","E"],description:"Export PNG",category:"File"},{keys:["Ctrl","N"],description:"New design",category:"File"},{keys:["Ctrl","O"],description:"Open design",category:"File"}],sm=[...new Set(nl.map(t=>t.category))];function da({text:t}){return e.jsx("kbd",{className:"px-2 py-1 text-xs font-mono bg-muted border border-border rounded",children:t})}function nm(){const[t,r]=C.useState(!1);return e.jsxs(Nl,{open:t,onOpenChange:r,children:[e.jsx(kl,{asChild:!0,children:e.jsxs(X,{size:"sm",variant:"ghost",className:"gap-2",children:[e.jsx(En,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden md:inline",children:"Shortcuts"})]})}),e.jsxs(Cl,{className:"max-w-3xl max-h-[80vh]",children:[e.jsx(_l,{children:e.jsxs(Sl,{className:"font-display text-xl uppercase tracking-widest flex items-center gap-2",children:[e.jsx(En,{className:"w-5 h-5"}),"Keyboard Shortcuts"]})}),e.jsx(_t,{className:"h-[60vh] pr-4",children:e.jsx("div",{className:"space-y-6",children:sm.map(s=>e.jsxs("div",{children:[e.jsx("h3",{className:"font-display text-sm uppercase tracking-widest text-primary mb-3",children:s}),e.jsx("div",{className:"space-y-2",children:nl.filter(n=>n.category===s).map((n,a)=>e.jsxs("div",{className:"flex items-center justify-between py-2 border-b border-border last:border-0",children:[e.jsx("span",{className:"text-sm text-foreground",children:n.description}),e.jsx("div",{className:"flex items-center gap-1",children:n.keys.map((i,l)=>e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(da,{text:i}),l<n.keys.length-1&&e.jsx("span",{className:"text-xs text-muted-foreground",children:"+"})]},l))})]},a))})]},s))})}),e.jsxs("div",{className:"text-xs text-muted-foreground text-center pt-4 border-t",children:["Press ",e.jsx(da,{text:"?"})," anytime to view shortcuts"]})]})]})}function am(){const[t,r]=C.useState(!1);return C.useEffect(()=>{const s=()=>{r(window.innerWidth<768)};return s(),window.addEventListener("resize",s),()=>window.removeEventListener("resize",s)},[]),t}const im=C.lazy(()=>yt(()=>import("./modals-B-GZkgh0.js").then(t=>t.a0),__vite__mapDeps([0,1,2])).then(t=>({default:t.VersionHistory}))),om=C.lazy(()=>yt(()=>import("./modals-B-GZkgh0.js").then(t=>t.a1),__vite__mapDeps([0,1,2])).then(t=>({default:t.ShareModal}))),lm=C.lazy(()=>yt(()=>import("./AnimationPreview-CfGDygZy.js"),__vite__mapDeps([3,0,1,2,4])).then(t=>({default:t.AnimationPreview}))),cm=C.lazy(()=>yt(()=>import("./modals-B-GZkgh0.js").then(t=>t.a2),__vite__mapDeps([0,1,2])).then(t=>({default:t.BrandKitModal}))),dm=C.lazy(()=>yt(()=>import("./modals-B-GZkgh0.js").then(t=>t.$),__vite__mapDeps([0,1,2])).then(t=>({default:t.FontUploadModal}))),um=C.lazy(()=>yt(()=>import("./modals-B-GZkgh0.js").then(t=>t.a3),__vite__mapDeps([0,1,2])).then(t=>({default:t.ArrayDuplicateModal}))),hm=C.lazy(()=>yt(()=>import("./modals-B-GZkgh0.js").then(t=>t.a4),__vite__mapDeps([0,1,2])).then(t=>({default:t.ExportPreview}))),fm=C.lazy(()=>yt(()=>import("./modals-B-GZkgh0.js").then(t=>t.a5),__vite__mapDeps([0,1,2])).then(t=>({default:t.ExportPresetsModal}))),pm=C.lazy(()=>yt(()=>import("./TemplateGalleryModal-Dwd19IvD.js"),__vite__mapDeps([5,0,1,2])).then(t=>({default:t.TemplateGalleryModal})));function mm(){const{selectedId:t,selectedIds:r,deleteObject:s,undo:n,redo:a,getCanvasState:i,currentDesignId:l,setDesignId:o,setSaving:c,isSaving:f,objects:m,designName:p,createVersion:b,past:h,future:w,updateObject:d,saveToHistory:u,addObject:g,selectObject:x,setActiveTool:j,stageScale:k,setStageScale:N,arrayDuplicate:P,showRulers:A,toggleRulers:F,groupObjects:R,ungroupObject:B}=Ee(),{isAuthenticated:K}=gt(),_=qe(),D=am(),[y,O]=C.useState(""),[ee,M]=C.useState(!1),[Z,V]=C.useState(!1),[ie,L]=C.useState(!1),[z,le]=C.useState(!1),[se,re]=C.useState(!1),[Ne,_e]=C.useState(!1),[fe,me]=C.useState(!1),[Ce,je]=C.useState(!1),[Me,Pe]=C.useState(!1),[v,H]=C.useState(!1),[$,E]=C.useState(!1),[S,T]=C.useState(!1),[W,G]=C.useState(!1),[I,Q]=C.useState(!1),ne=async()=>{if(!K){_("/auth");return}c(!0),O("Saving...");try{const oe=i();if(l)await Or.update(l,{canvas_data:oe,name:oe.name}),O("Saved!"),J.success("Design saved successfully");else{const q=await Or.create({name:oe.name,canvas_data:oe});o(q.design.id),O("Saved!"),J.success("Design created successfully")}setTimeout(()=>O(""),2e3)}catch(oe){console.error("Save failed:",oe),O("Save failed"),J.error("Failed to save design. Please try again."),setTimeout(()=>O(""),2e3)}finally{c(!1)}},te=async()=>{M(!0),O("Exporting PNG..."),V(!1);try{const oe=await Sa(m,{scale:3,format:"png",includeBackground:!0}),q=`${p.replace(/[^a-z0-9]/gi,"_").toLowerCase()}_${Date.now()}.png`;Cn(oe,q),O("Exported PNG!"),J.success(`Exported as ${q}`),setTimeout(()=>O(""),2e3)}catch(oe){console.error("Export failed:",oe),O("Export failed"),J.error("Failed to export PNG. Please try again."),setTimeout(()=>O(""),2e3)}finally{M(!1)}},de=async()=>{M(!0),O("Exporting SVG..."),V(!1);try{const oe=await El(m,{includeBackground:!0}),q=`${p.replace(/[^a-z0-9]/gi,"_").toLowerCase()}_${Date.now()}.svg`;Cn(oe,q),O("Exported SVG!"),J.success(`Exported vector as ${q}`),setTimeout(()=>O(""),2e3)}catch(oe){console.error("SVG export failed:",oe),O("Export failed"),J.error("Failed to export SVG. Please try again."),setTimeout(()=>O(""),2e3)}finally{M(!1)}};return C.useEffect(()=>{K&&_a().catch(console.error)},[K]),C.useEffect(()=>{if(m.length===0)return;const oe=setInterval(()=>{b(void 0,!0)},5*60*1e3);return()=>clearInterval(oe)},[m.length,b]),C.useEffect(()=>{const oe=q=>{if(q.target instanceof HTMLInputElement||q.target instanceof HTMLTextAreaElement)return;const ce=q.key.toLowerCase(),pe=q.ctrlKey||q.metaKey,ge=q.shiftKey,Te=q.altKey;if(pe&&ce==="s"){q.preventDefault(),ne();return}if(pe&&ce==="e"){q.preventDefault(),te();return}if((ce==="delete"||ce==="backspace")&&t){q.preventDefault(),s(t);return}if(pe&&ce==="z"&&!ge){q.preventDefault(),n();return}if(pe&&ce==="z"&&ge){q.preventDefault(),a();return}if(pe&&ce==="d"&&!ge&&t){q.preventDefault();const Y=m.find(ue=>ue.id===t);if(Y){const{id:ue,...Re}=Y;g({...Re,x:Y.x+10,y:Y.y+10}),J.success("Object duplicated")}return}if(pe&&ge&&ce==="d"&&t){q.preventDefault(),je(!0);return}if(ce==="t"&&!pe&&!Te){q.preventDefault(),j("text");return}if(ce==="p"&&!pe&&!Te){q.preventDefault(),j("pen");return}if(ce==="g"&&!pe&&!Te){q.preventDefault(),j("graphics");return}if(ce==="l"&&!pe&&!Te){q.preventDefault(),j("lines");return}if(ce==="s"&&!pe&&!Te){q.preventDefault(),j("stickers");return}if(ce==="u"&&!pe&&!Te){q.preventDefault(),j("uploads");return}if(ce==="escape"){q.preventDefault(),x(null),j(null);return}if(pe&&ge&&ce==="r"){q.preventDefault(),Ee.getState().toggleRulers();const Y=Ee.getState().showRulers;J.success(Y?"Rulers enabled":"Rulers disabled");return}if(pe&&ce==="l"&&t){q.preventDefault();const Y=m.find(ue=>ue.id===t);Y&&(d(t,{locked:!Y.locked}),J.success(Y.locked?"Object unlocked":"Object locked"));return}if(pe&&ce==="g"&&!ge&&r.length>=2){q.preventDefault(),R(r),J.success(`Grouped ${r.length} objects`);return}if(pe&&ge&&ce==="g"&&r.length===1){q.preventDefault();const Y=m.find(ue=>ue.id===r[0]);Y&&Y.type==="group"?(B(r[0]),J.success("Ungrouped objects")):J.error("Selected object is not a group");return}if(t&&["arrowup","arrowdown","arrowleft","arrowright"].includes(ce)){q.preventDefault();const Y=m.find($e=>$e.id===t);if(!Y)return;const ue=ge?10:1,Re={};ce==="arrowup"&&(Re.y=Y.y-ue),ce==="arrowdown"&&(Re.y=Y.y+ue),ce==="arrowleft"&&(Re.x=Y.x-ue),ce==="arrowright"&&(Re.x=Y.x+ue),d(t,Re);return}if(pe&&ce==="c"&&t){q.preventDefault();const Y=m.find(ue=>ue.id===t);Y&&(sessionStorage.setItem("deckforge_clipboard",JSON.stringify(Y)),J.success("Copied to clipboard"));return}if(pe&&ce==="v"){q.preventDefault();const Y=sessionStorage.getItem("deckforge_clipboard");if(Y)try{const ue=JSON.parse(Y),{id:Re,...$e}=ue;g({...$e,x:ue.x+20,y:ue.y+20}),J.success("Pasted from clipboard")}catch{J.error("Failed to paste")}else J.error("Nothing to paste");return}if(pe&&ce==="a"){q.preventDefault(),m.length>0&&(x(m[m.length-1].id),J.success(`Selected top object (${m.length} total)`));return}if(pe&&ce==="0"){q.preventDefault(),N(1),J.success("Zoom reset to 100%");return}if(pe&&ce==="1"){q.preventDefault(),N(.8),J.success("Zoom to fit");return}if(pe&&(ce==="="||ce==="+")){q.preventDefault();const Y=Math.min(3,k*1.2);N(Y),J.success(`Zoom: ${Math.round(Y*100)}%`);return}if(pe&&(ce==="-"||ce==="_")){q.preventDefault();const Y=Math.max(.25,k/1.2);N(Y),J.success(`Zoom: ${Math.round(Y*100)}%`);return}if(t){const Y=m.findIndex(ue=>ue.id===t);if(Y===-1)return;if(pe&&!ge&&ce==="]"){if(q.preventDefault(),Y<m.length-1){const ue=[...m];[ue[Y],ue[Y+1]]=[ue[Y+1],ue[Y]],Ee.setState({objects:ue}),J.success("Brought forward")}return}if(pe&&!ge&&ce==="["){if(q.preventDefault(),Y>0){const ue=[...m];[ue[Y],ue[Y-1]]=[ue[Y-1],ue[Y]],Ee.setState({objects:ue}),J.success("Sent backward")}return}if(pe&&ge&&ce==="]"){q.preventDefault();const ue=m.filter(Re=>Re.id!==t);ue.push(m[Y]),Ee.setState({objects:ue}),J.success("Brought to front");return}if(pe&&ge&&ce==="["){q.preventDefault();const ue=m.filter(Re=>Re.id!==t);ue.unshift(m[Y]),Ee.setState({objects:ue}),J.success("Sent to back");return}}if(t&&Te){const Y=m.find($e=>$e.id===t);if(!Y)return;const ue=(Jt-Y.width*Y.scaleX)/2,Re=(Qt-Y.height*Y.scaleY)/2;if(ce==="l"){q.preventDefault(),d(t,{x:0}),J.success("Aligned left");return}if(ce==="r"){q.preventDefault(),d(t,{x:Jt-Y.width*Y.scaleX}),J.success("Aligned right");return}if(ce==="c"){q.preventDefault(),d(t,{x:ue}),J.success("Aligned center");return}if(ce==="t"){q.preventDefault(),d(t,{y:0}),J.success("Aligned top");return}if(ce==="b"){q.preventDefault(),d(t,{y:Qt-Y.height*Y.scaleY}),J.success("Aligned bottom");return}if(ce==="m"){q.preventDefault(),d(t,{y:Re}),J.success("Aligned middle");return}}};return window.addEventListener("keydown",oe),()=>window.removeEventListener("keydown",oe)},[t,s,n,a,m,ne,te,g,x,j,d,k,N]),e.jsxs("div",{className:"h-screen w-screen flex flex-col bg-background overflow-hidden",children:[e.jsxs("header",{className:be("border-b border-border flex items-center px-4 bg-card shrink-0","h-12"),children:[e.jsxs("h1",{className:be("font-display uppercase tracking-widest text-foreground",D?"text-base":"text-lg"),children:["Deck",e.jsx("span",{className:"text-primary",children:"Forge"})]}),!D&&e.jsx("div",{className:"ml-4 flex items-center gap-2",children:e.jsx("span",{className:"tag-brutal",children:"v1.0"})}),e.jsxs("div",{className:"ml-auto flex items-center gap-2",children:[!D&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-[10px] text-muted-foreground uppercase tracking-widest hidden md:block mr-4",children:"Fingerboard Graphics Editor"}),y&&e.jsx("span",{className:"text-xs text-primary",children:y}),e.jsxs("div",{className:"flex items-center gap-1 border border-border rounded",children:[e.jsxs(X,{size:"sm",variant:"ghost",onClick:n,disabled:h.length===0,className:"gap-1.5 rounded-r-none border-r border-border",title:`Undo (Ctrl+Z) - ${h.length} action${h.length!==1?"s":""} available`,children:[e.jsx(La,{className:"w-4 h-4"}),e.jsx("span",{className:"text-[10px] text-muted-foreground font-mono",children:h.length})]}),e.jsxs(X,{size:"sm",variant:"ghost",onClick:a,disabled:w.length===0,className:"gap-1.5 rounded-l-none",title:`Redo (Ctrl+Shift+Z) - ${w.length} action${w.length!==1?"s":""} available`,children:[e.jsx(Ma,{className:"w-4 h-4"}),e.jsx("span",{className:"text-[10px] text-muted-foreground font-mono",children:w.length})]})]}),e.jsxs(X,{size:"sm",variant:"outline",onClick:ne,disabled:f,className:"gap-2",children:[e.jsx($a,{className:"w-4 h-4"}),f?"Saving...":"Save"]}),e.jsxs("div",{className:"relative",children:[e.jsxs(X,{size:"sm",variant:"outline",onClick:()=>V(!Z),disabled:ee,className:"gap-2",children:[e.jsx(lt,{className:"w-4 h-4"}),ee?"Exporting...":"Export",e.jsx(Ia,{className:"w-3 h-3"})]}),Z&&!ee&&e.jsxs("div",{className:"absolute top-full mt-1 right-0 z-50 bg-card border border-border shadow-lg min-w-[180px] rounded-lg overflow-hidden",children:[e.jsxs("button",{onClick:()=>{V(!1),H(!0)},className:"w-full px-4 py-2.5 text-left text-sm hover:bg-secondary transition-colors font-medium flex items-center gap-2",children:[e.jsx(Qe,{className:"w-4 h-4 text-primary"}),"Quick Export",e.jsx("span",{className:"ml-auto text-[9px] text-primary",children:"NEW"})]}),e.jsxs("button",{onClick:()=>{V(!1),Pe(!0)},className:"w-full px-4 py-2 text-left text-sm hover:bg-secondary transition-colors border-t border-border",children:["PNG (High-Res)",e.jsx("span",{className:"ml-2 text-[9px] text-muted-foreground",children:"Preview first"})]}),e.jsxs("button",{onClick:de,className:"w-full px-4 py-2 text-left text-sm hover:bg-secondary transition-colors border-t border-border",children:["SVG (Vector)",e.jsx("span",{className:"ml-2 text-[10px] text-accent",children:"PRO"})]})]})]}),e.jsxs(X,{size:"sm",variant:"outline",onClick:()=>_e(!0),className:"gap-2",children:[e.jsx(Fa,{className:"w-4 h-4"}),"Brand Kits",e.jsx("span",{className:"ml-1 text-[9px] text-accent",children:"PRO"})]}),e.jsxs(X,{size:"sm",variant:"outline",onClick:()=>me(!0),className:"gap-2",children:[e.jsx(Wr,{className:"w-4 h-4"}),"Custom Fonts"]}),l&&e.jsxs(X,{size:"sm",variant:"outline",onClick:()=>le(!0),className:"gap-2",children:[e.jsx(Ba,{className:"w-4 h-4"}),"Share"]}),e.jsxs(X,{size:"sm",variant:"outline",onClick:()=>L(!0),className:"gap-2",children:[e.jsx(Ws,{className:"w-4 h-4"}),"History"]}),e.jsxs(X,{size:"sm",variant:"outline",onClick:()=>re(!0),className:"gap-2",children:[e.jsx(qc,{className:"w-4 h-4"}),"Preview"]}),e.jsxs(X,{size:"sm",variant:"outline",onClick:()=>E(!0),className:"gap-2",children:[e.jsx(Qe,{className:"w-4 h-4"}),"Templates",e.jsx("span",{className:"ml-1 text-[9px] text-primary",children:"NEW"})]}),e.jsxs(X,{size:"sm",variant:"ghost",onClick:()=>_("/gallery"),className:"gap-2",children:[e.jsx(Qe,{className:"w-4 h-4"}),"Gallery"]}),e.jsxs(X,{size:"sm",variant:"ghost",onClick:()=>_(K?"/designs":"/auth"),className:"gap-2",children:[e.jsx(An,{className:"w-4 h-4"}),K?"My Designs":"Login"]}),e.jsx(X,{size:"sm",variant:A?"default":"ghost",onClick:()=>{F(),J.success(A?"Rulers hidden":"Rulers visible")},className:"gap-2",title:"Toggle rulers (Ctrl+Shift+R)",children:e.jsx(Kc,{className:"w-4 h-4"})}),e.jsx(nm,{})]}),D&&e.jsx(X,{size:"sm",variant:"ghost",onClick:()=>Q(!0),className:"gap-2",children:e.jsx(za,{className:"w-5 h-5"})})]})]}),e.jsxs("div",{className:be("flex-1 flex overflow-hidden",D&&"pb-14"),children:[!D&&e.jsxs(e.Fragment,{children:[e.jsx(na,{}),e.jsx(ia,{}),e.jsx(bs,{}),e.jsx(ca,{})]}),D&&e.jsxs(e.Fragment,{children:[e.jsx(na,{}),e.jsx(ia,{}),e.jsx(bs,{})]})]}),D&&e.jsx(rm,{onSave:ne,onExport:te,onOpenHistory:()=>L(!0),onOpenInspector:()=>T(!0),onOpenLayers:()=>G(!0),isSaving:f,isExporting:ee}),e.jsx(ys,{isOpen:S,onClose:()=>T(!1),title:"Properties",children:e.jsx(ca,{})}),e.jsx(ys,{isOpen:W,onClose:()=>G(!1),title:"Layers",children:e.jsx(xo,{})}),e.jsx(ys,{isOpen:I,onClose:()=>Q(!1),title:"Menu",children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("button",{onClick:()=>{_("/templates"),Q(!1)},className:"w-full btn-brutal text-left py-3 flex items-center gap-2",children:[e.jsx(Qe,{className:"w-4 h-4"}),"Templates"]}),e.jsxs("button",{onClick:()=>{_(K?"/designs":"/auth"),Q(!1)},className:"w-full btn-brutal text-left py-3 flex items-center gap-2",children:[e.jsx(An,{className:"w-4 h-4"}),K?"My Designs":"Login"]}),y&&e.jsx("p",{className:"text-xs text-primary text-center py-2",children:y})]})}),e.jsxs(C.Suspense,{fallback:null,children:[e.jsx(im,{isOpen:ie,onClose:()=>L(!1)}),l&&e.jsx(om,{isOpen:z,onClose:()=>le(!1),designId:l,designName:p}),e.jsx(lm,{isOpen:se,onClose:()=>re(!1)}),e.jsx(dm,{isOpen:fe,onClose:()=>me(!1),onFontUploaded:oe=>{J.success(`${oe.name} is now available!`,{description:"You can now use this font in your text objects."})}}),e.jsx(um,{open:Ce,onClose:()=>je(!1),onDuplicate:(oe,q,ce,pe)=>{if(t){P(t,oe,q,ce,pe);const ge=oe*q-1;J.success(`Created ${ge} ${ge===1?"copy":"copies"} in ${oe}${q} grid`)}}})]}),e.jsx(cm,{isOpen:Ne,onClose:()=>_e(!1),currentColors:(()=>{const oe=new Set;return m.forEach(q=>{q.fill&&oe.add(q.fill),q.stroke&&oe.add(q.stroke),q.colorize&&oe.add(q.colorize)}),Array.from(oe)})(),onApplyKit:oe=>{const q=new Set;m.forEach(Y=>{Y.fill&&Y.fill!=="none"&&q.add(Y.fill),Y.stroke&&q.add(Y.stroke),Y.colorize&&q.add(Y.colorize)});const ce=Array.from(q),pe=oe.colors,ge=new Map;ce.forEach((Y,ue)=>{const Re=pe[ue%pe.length];ge.set(Y,Re)}),u();let Te=0;m.forEach(Y=>{const ue={};Y.fill&&ge.has(Y.fill)&&(ue.fill=ge.get(Y.fill),Te++),Y.stroke&&ge.has(Y.stroke)&&(ue.stroke=ge.get(Y.stroke),Te++),Y.colorize&&ge.has(Y.colorize)&&(ue.colorize=ge.get(Y.colorize),Te++),Object.keys(ue).length>0&&d(Y.id,ue)}),Te>0?J.success(`Applied "${oe.name}" - ${Te} color${Te!==1?"s":""} changed`):J.info(`Applied "${oe.name}" - No matching colors found`)}}),e.jsxs(C.Suspense,{fallback:null,children:[e.jsx(hm,{isOpen:Me,onClose:()=>Pe(!1),objects:m,designName:p,onConfirmExport:()=>{J.success("Design exported successfully")}}),e.jsx(fm,{open:v,onClose:()=>H(!1)}),e.jsx(pm,{isOpen:$,onClose:()=>E(!1)})]}),e.jsx(tm,{})]})}function xm(){const[t,r]=C.useState(!0),[s,n]=C.useState(""),[a,i]=C.useState(""),[l,o]=C.useState(""),{signup:c,login:f,isLoading:m,error:p}=gt(),b=qe(),h=async w=>{w.preventDefault();try{t?await f(s,a):await c(s,a,l),b("/")}catch(d){console.error(d)}};return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-background p-4",children:e.jsxs("div",{className:"w-full max-w-md space-y-8",children:[e.jsxs("div",{className:"text-center",children:[e.jsxs("h1",{className:"font-display text-4xl uppercase tracking-widest",children:["Deck",e.jsx("span",{className:"text-primary",children:"Forge"})]}),e.jsx("p",{className:"mt-2 text-sm text-muted-foreground uppercase tracking-widest",children:"Fingerboard Graphics Editor"})]}),e.jsxs("div",{className:"border border-border bg-card p-8 space-y-6",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(X,{variant:t?"default":"outline",className:"flex-1",onClick:()=>r(!0),children:"Login"}),e.jsx(X,{variant:t?"outline":"default",className:"flex-1",onClick:()=>r(!1),children:"Sign Up"})]}),e.jsxs("form",{onSubmit:h,className:"space-y-4",children:[!t&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(ae,{htmlFor:"username",children:"Username"}),e.jsx(Ae,{id:"username",type:"text",value:l,onChange:w=>o(w.target.value),placeholder:"fingerboarder123",required:!t})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(ae,{htmlFor:"email",children:"Email"}),e.jsx(Ae,{id:"email",type:"email",value:s,onChange:w=>n(w.target.value),placeholder:"you@example.com",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(ae,{htmlFor:"password",children:"Password"}),e.jsx(Ae,{id:"password",type:"password",value:a,onChange:w=>i(w.target.value),placeholder:"",required:!0,minLength:6})]}),p&&e.jsx("div",{className:"text-sm text-destructive bg-destructive/10 border border-destructive/20 p-3 rounded",children:p}),e.jsx(X,{type:"submit",className:"w-full",disabled:m,children:m?"Loading...":t?"Login":"Create Account"})]}),e.jsx("div",{className:"text-center",children:e.jsx(X,{variant:"link",onClick:()=>b("/"),className:"text-xs uppercase tracking-widest",children:"Continue as Guest"})})]})]})})}function Ar(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var al={exports:{}};/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/(function(t,r){(function(s){t.exports=s()})(function(){return function s(n,a,i){function l(f,m){if(!a[f]){if(!n[f]){var p=typeof Ar=="function"&&Ar;if(!m&&p)return p(f,!0);if(o)return o(f,!0);var b=new Error("Cannot find module '"+f+"'");throw b.code="MODULE_NOT_FOUND",b}var h=a[f]={exports:{}};n[f][0].call(h.exports,function(w){var d=n[f][1][w];return l(d||w)},h,h.exports,s,n,a,i)}return a[f].exports}for(var o=typeof Ar=="function"&&Ar,c=0;c<i.length;c++)l(i[c]);return l}({1:[function(s,n,a){var i=s("./utils"),l=s("./support"),o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";a.encode=function(c){for(var f,m,p,b,h,w,d,u=[],g=0,x=c.length,j=x,k=i.getTypeOf(c)!=="string";g<c.length;)j=x-g,p=k?(f=c[g++],m=g<x?c[g++]:0,g<x?c[g++]:0):(f=c.charCodeAt(g++),m=g<x?c.charCodeAt(g++):0,g<x?c.charCodeAt(g++):0),b=f>>2,h=(3&f)<<4|m>>4,w=1<j?(15&m)<<2|p>>6:64,d=2<j?63&p:64,u.push(o.charAt(b)+o.charAt(h)+o.charAt(w)+o.charAt(d));return u.join("")},a.decode=function(c){var f,m,p,b,h,w,d=0,u=0,g="data:";if(c.substr(0,g.length)===g)throw new Error("Invalid base64 input, it looks like a data url.");var x,j=3*(c=c.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(c.charAt(c.length-1)===o.charAt(64)&&j--,c.charAt(c.length-2)===o.charAt(64)&&j--,j%1!=0)throw new Error("Invalid base64 input, bad content length.");for(x=l.uint8array?new Uint8Array(0|j):new Array(0|j);d<c.length;)f=o.indexOf(c.charAt(d++))<<2|(b=o.indexOf(c.charAt(d++)))>>4,m=(15&b)<<4|(h=o.indexOf(c.charAt(d++)))>>2,p=(3&h)<<6|(w=o.indexOf(c.charAt(d++))),x[u++]=f,h!==64&&(x[u++]=m),w!==64&&(x[u++]=p);return x}},{"./support":30,"./utils":32}],2:[function(s,n,a){var i=s("./external"),l=s("./stream/DataWorker"),o=s("./stream/Crc32Probe"),c=s("./stream/DataLengthProbe");function f(m,p,b,h,w){this.compressedSize=m,this.uncompressedSize=p,this.crc32=b,this.compression=h,this.compressedContent=w}f.prototype={getContentWorker:function(){var m=new l(i.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new c("data_length")),p=this;return m.on("end",function(){if(this.streamInfo.data_length!==p.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),m},getCompressedWorker:function(){return new l(i.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},f.createWorkerFrom=function(m,p,b){return m.pipe(new o).pipe(new c("uncompressedSize")).pipe(p.compressWorker(b)).pipe(new c("compressedSize")).withStreamInfo("compression",p)},n.exports=f},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(s,n,a){var i=s("./stream/GenericWorker");a.STORE={magic:"\0\0",compressWorker:function(){return new i("STORE compression")},uncompressWorker:function(){return new i("STORE decompression")}},a.DEFLATE=s("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(s,n,a){var i=s("./utils"),l=function(){for(var o,c=[],f=0;f<256;f++){o=f;for(var m=0;m<8;m++)o=1&o?3988292384^o>>>1:o>>>1;c[f]=o}return c}();n.exports=function(o,c){return o!==void 0&&o.length?i.getTypeOf(o)!=="string"?function(f,m,p,b){var h=l,w=b+p;f^=-1;for(var d=b;d<w;d++)f=f>>>8^h[255&(f^m[d])];return-1^f}(0|c,o,o.length,0):function(f,m,p,b){var h=l,w=b+p;f^=-1;for(var d=b;d<w;d++)f=f>>>8^h[255&(f^m.charCodeAt(d))];return-1^f}(0|c,o,o.length,0):0}},{"./utils":32}],5:[function(s,n,a){a.base64=!1,a.binary=!1,a.dir=!1,a.createFolders=!0,a.date=null,a.compression=null,a.compressionOptions=null,a.comment=null,a.unixPermissions=null,a.dosPermissions=null},{}],6:[function(s,n,a){var i=null;i=typeof Promise<"u"?Promise:s("lie"),n.exports={Promise:i}},{lie:37}],7:[function(s,n,a){var i=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",l=s("pako"),o=s("./utils"),c=s("./stream/GenericWorker"),f=i?"uint8array":"array";function m(p,b){c.call(this,"FlateWorker/"+p),this._pako=null,this._pakoAction=p,this._pakoOptions=b,this.meta={}}a.magic="\b\0",o.inherits(m,c),m.prototype.processChunk=function(p){this.meta=p.meta,this._pako===null&&this._createPako(),this._pako.push(o.transformTo(f,p.data),!1)},m.prototype.flush=function(){c.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},m.prototype.cleanUp=function(){c.prototype.cleanUp.call(this),this._pako=null},m.prototype._createPako=function(){this._pako=new l[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var p=this;this._pako.onData=function(b){p.push({data:b,meta:p.meta})}},a.compressWorker=function(p){return new m("Deflate",p)},a.uncompressWorker=function(){return new m("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(s,n,a){function i(h,w){var d,u="";for(d=0;d<w;d++)u+=String.fromCharCode(255&h),h>>>=8;return u}function l(h,w,d,u,g,x){var j,k,N=h.file,P=h.compression,A=x!==f.utf8encode,F=o.transformTo("string",x(N.name)),R=o.transformTo("string",f.utf8encode(N.name)),B=N.comment,K=o.transformTo("string",x(B)),_=o.transformTo("string",f.utf8encode(B)),D=R.length!==N.name.length,y=_.length!==B.length,O="",ee="",M="",Z=N.dir,V=N.date,ie={crc32:0,compressedSize:0,uncompressedSize:0};w&&!d||(ie.crc32=h.crc32,ie.compressedSize=h.compressedSize,ie.uncompressedSize=h.uncompressedSize);var L=0;w&&(L|=8),A||!D&&!y||(L|=2048);var z=0,le=0;Z&&(z|=16),g==="UNIX"?(le=798,z|=function(re,Ne){var _e=re;return re||(_e=Ne?16893:33204),(65535&_e)<<16}(N.unixPermissions,Z)):(le=20,z|=function(re){return 63&(re||0)}(N.dosPermissions)),j=V.getUTCHours(),j<<=6,j|=V.getUTCMinutes(),j<<=5,j|=V.getUTCSeconds()/2,k=V.getUTCFullYear()-1980,k<<=4,k|=V.getUTCMonth()+1,k<<=5,k|=V.getUTCDate(),D&&(ee=i(1,1)+i(m(F),4)+R,O+="up"+i(ee.length,2)+ee),y&&(M=i(1,1)+i(m(K),4)+_,O+="uc"+i(M.length,2)+M);var se="";return se+=`
\0`,se+=i(L,2),se+=P.magic,se+=i(j,2),se+=i(k,2),se+=i(ie.crc32,4),se+=i(ie.compressedSize,4),se+=i(ie.uncompressedSize,4),se+=i(F.length,2),se+=i(O.length,2),{fileRecord:p.LOCAL_FILE_HEADER+se+F+O,dirRecord:p.CENTRAL_FILE_HEADER+i(le,2)+se+i(K.length,2)+"\0\0\0\0"+i(z,4)+i(u,4)+F+O+K}}var o=s("../utils"),c=s("../stream/GenericWorker"),f=s("../utf8"),m=s("../crc32"),p=s("../signature");function b(h,w,d,u){c.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=w,this.zipPlatform=d,this.encodeFileName=u,this.streamFiles=h,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}o.inherits(b,c),b.prototype.push=function(h){var w=h.meta.percent||0,d=this.entriesCount,u=this._sources.length;this.accumulate?this.contentBuffer.push(h):(this.bytesWritten+=h.data.length,c.prototype.push.call(this,{data:h.data,meta:{currentFile:this.currentFile,percent:d?(w+100*(d-u-1))/d:100}}))},b.prototype.openedSource=function(h){this.currentSourceOffset=this.bytesWritten,this.currentFile=h.file.name;var w=this.streamFiles&&!h.file.dir;if(w){var d=l(h,w,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:d.fileRecord,meta:{percent:0}})}else this.accumulate=!0},b.prototype.closedSource=function(h){this.accumulate=!1;var w=this.streamFiles&&!h.file.dir,d=l(h,w,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(d.dirRecord),w)this.push({data:function(u){return p.DATA_DESCRIPTOR+i(u.crc32,4)+i(u.compressedSize,4)+i(u.uncompressedSize,4)}(h),meta:{percent:100}});else for(this.push({data:d.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},b.prototype.flush=function(){for(var h=this.bytesWritten,w=0;w<this.dirRecords.length;w++)this.push({data:this.dirRecords[w],meta:{percent:100}});var d=this.bytesWritten-h,u=function(g,x,j,k,N){var P=o.transformTo("string",N(k));return p.CENTRAL_DIRECTORY_END+"\0\0\0\0"+i(g,2)+i(g,2)+i(x,4)+i(j,4)+i(P.length,2)+P}(this.dirRecords.length,d,h,this.zipComment,this.encodeFileName);this.push({data:u,meta:{percent:100}})},b.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},b.prototype.registerPrevious=function(h){this._sources.push(h);var w=this;return h.on("data",function(d){w.processChunk(d)}),h.on("end",function(){w.closedSource(w.previous.streamInfo),w._sources.length?w.prepareNextSource():w.end()}),h.on("error",function(d){w.error(d)}),this},b.prototype.resume=function(){return!!c.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},b.prototype.error=function(h){var w=this._sources;if(!c.prototype.error.call(this,h))return!1;for(var d=0;d<w.length;d++)try{w[d].error(h)}catch{}return!0},b.prototype.lock=function(){c.prototype.lock.call(this);for(var h=this._sources,w=0;w<h.length;w++)h[w].lock()},n.exports=b},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(s,n,a){var i=s("../compressions"),l=s("./ZipFileWorker");a.generateWorker=function(o,c,f){var m=new l(c.streamFiles,f,c.platform,c.encodeFileName),p=0;try{o.forEach(function(b,h){p++;var w=function(x,j){var k=x||j,N=i[k];if(!N)throw new Error(k+" is not a valid compression method !");return N}(h.options.compression,c.compression),d=h.options.compressionOptions||c.compressionOptions||{},u=h.dir,g=h.date;h._compressWorker(w,d).withStreamInfo("file",{name:b,dir:u,date:g,comment:h.comment||"",unixPermissions:h.unixPermissions,dosPermissions:h.dosPermissions}).pipe(m)}),m.entriesCount=p}catch(b){m.error(b)}return m}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(s,n,a){function i(){if(!(this instanceof i))return new i;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var l=new i;for(var o in this)typeof this[o]!="function"&&(l[o]=this[o]);return l}}(i.prototype=s("./object")).loadAsync=s("./load"),i.support=s("./support"),i.defaults=s("./defaults"),i.version="3.10.1",i.loadAsync=function(l,o){return new i().loadAsync(l,o)},i.external=s("./external"),n.exports=i},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(s,n,a){var i=s("./utils"),l=s("./external"),o=s("./utf8"),c=s("./zipEntries"),f=s("./stream/Crc32Probe"),m=s("./nodejsUtils");function p(b){return new l.Promise(function(h,w){var d=b.decompressed.getContentWorker().pipe(new f);d.on("error",function(u){w(u)}).on("end",function(){d.streamInfo.crc32!==b.decompressed.crc32?w(new Error("Corrupted zip : CRC32 mismatch")):h()}).resume()})}n.exports=function(b,h){var w=this;return h=i.extend(h||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:o.utf8decode}),m.isNode&&m.isStream(b)?l.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):i.prepareContent("the loaded zip file",b,!0,h.optimizedBinaryString,h.base64).then(function(d){var u=new c(h);return u.load(d),u}).then(function(d){var u=[l.Promise.resolve(d)],g=d.files;if(h.checkCRC32)for(var x=0;x<g.length;x++)u.push(p(g[x]));return l.Promise.all(u)}).then(function(d){for(var u=d.shift(),g=u.files,x=0;x<g.length;x++){var j=g[x],k=j.fileNameStr,N=i.resolve(j.fileNameStr);w.file(N,j.decompressed,{binary:!0,optimizedBinaryString:!0,date:j.date,dir:j.dir,comment:j.fileCommentStr.length?j.fileCommentStr:null,unixPermissions:j.unixPermissions,dosPermissions:j.dosPermissions,createFolders:h.createFolders}),j.dir||(w.file(N).unsafeOriginalName=k)}return u.zipComment.length&&(w.comment=u.zipComment),w})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(s,n,a){var i=s("../utils"),l=s("../stream/GenericWorker");function o(c,f){l.call(this,"Nodejs stream input adapter for "+c),this._upstreamEnded=!1,this._bindStream(f)}i.inherits(o,l),o.prototype._bindStream=function(c){var f=this;(this._stream=c).pause(),c.on("data",function(m){f.push({data:m,meta:{percent:0}})}).on("error",function(m){f.isPaused?this.generatedError=m:f.error(m)}).on("end",function(){f.isPaused?f._upstreamEnded=!0:f.end()})},o.prototype.pause=function(){return!!l.prototype.pause.call(this)&&(this._stream.pause(),!0)},o.prototype.resume=function(){return!!l.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},n.exports=o},{"../stream/GenericWorker":28,"../utils":32}],13:[function(s,n,a){var i=s("readable-stream").Readable;function l(o,c,f){i.call(this,c),this._helper=o;var m=this;o.on("data",function(p,b){m.push(p)||m._helper.pause(),f&&f(b)}).on("error",function(p){m.emit("error",p)}).on("end",function(){m.push(null)})}s("../utils").inherits(l,i),l.prototype._read=function(){this._helper.resume()},n.exports=l},{"../utils":32,"readable-stream":16}],14:[function(s,n,a){n.exports={isNode:typeof Buffer<"u",newBufferFrom:function(i,l){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(i,l);if(typeof i=="number")throw new Error('The "data" argument must not be a number');return new Buffer(i,l)},allocBuffer:function(i){if(Buffer.alloc)return Buffer.alloc(i);var l=new Buffer(i);return l.fill(0),l},isBuffer:function(i){return Buffer.isBuffer(i)},isStream:function(i){return i&&typeof i.on=="function"&&typeof i.pause=="function"&&typeof i.resume=="function"}}},{}],15:[function(s,n,a){function i(N,P,A){var F,R=o.getTypeOf(P),B=o.extend(A||{},m);B.date=B.date||new Date,B.compression!==null&&(B.compression=B.compression.toUpperCase()),typeof B.unixPermissions=="string"&&(B.unixPermissions=parseInt(B.unixPermissions,8)),B.unixPermissions&&16384&B.unixPermissions&&(B.dir=!0),B.dosPermissions&&16&B.dosPermissions&&(B.dir=!0),B.dir&&(N=g(N)),B.createFolders&&(F=u(N))&&x.call(this,F,!0);var K=R==="string"&&B.binary===!1&&B.base64===!1;A&&A.binary!==void 0||(B.binary=!K),(P instanceof p&&P.uncompressedSize===0||B.dir||!P||P.length===0)&&(B.base64=!1,B.binary=!0,P="",B.compression="STORE",R="string");var _=null;_=P instanceof p||P instanceof c?P:w.isNode&&w.isStream(P)?new d(N,P):o.prepareContent(N,P,B.binary,B.optimizedBinaryString,B.base64);var D=new b(N,_,B);this.files[N]=D}var l=s("./utf8"),o=s("./utils"),c=s("./stream/GenericWorker"),f=s("./stream/StreamHelper"),m=s("./defaults"),p=s("./compressedObject"),b=s("./zipObject"),h=s("./generate"),w=s("./nodejsUtils"),d=s("./nodejs/NodejsStreamInputAdapter"),u=function(N){N.slice(-1)==="/"&&(N=N.substring(0,N.length-1));var P=N.lastIndexOf("/");return 0<P?N.substring(0,P):""},g=function(N){return N.slice(-1)!=="/"&&(N+="/"),N},x=function(N,P){return P=P!==void 0?P:m.createFolders,N=g(N),this.files[N]||i.call(this,N,null,{dir:!0,createFolders:P}),this.files[N]};function j(N){return Object.prototype.toString.call(N)==="[object RegExp]"}var k={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(N){var P,A,F;for(P in this.files)F=this.files[P],(A=P.slice(this.root.length,P.length))&&P.slice(0,this.root.length)===this.root&&N(A,F)},filter:function(N){var P=[];return this.forEach(function(A,F){N(A,F)&&P.push(F)}),P},file:function(N,P,A){if(arguments.length!==1)return N=this.root+N,i.call(this,N,P,A),this;if(j(N)){var F=N;return this.filter(function(B,K){return!K.dir&&F.test(B)})}var R=this.files[this.root+N];return R&&!R.dir?R:null},folder:function(N){if(!N)return this;if(j(N))return this.filter(function(R,B){return B.dir&&N.test(R)});var P=this.root+N,A=x.call(this,P),F=this.clone();return F.root=A.name,F},remove:function(N){N=this.root+N;var P=this.files[N];if(P||(N.slice(-1)!=="/"&&(N+="/"),P=this.files[N]),P&&!P.dir)delete this.files[N];else for(var A=this.filter(function(R,B){return B.name.slice(0,N.length)===N}),F=0;F<A.length;F++)delete this.files[A[F].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(N){var P,A={};try{if((A=o.extend(N||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:l.utf8encode})).type=A.type.toLowerCase(),A.compression=A.compression.toUpperCase(),A.type==="binarystring"&&(A.type="string"),!A.type)throw new Error("No output type specified.");o.checkSupport(A.type),A.platform!=="darwin"&&A.platform!=="freebsd"&&A.platform!=="linux"&&A.platform!=="sunos"||(A.platform="UNIX"),A.platform==="win32"&&(A.platform="DOS");var F=A.comment||this.comment||"";P=h.generateWorker(this,A,F)}catch(R){(P=new c("error")).error(R)}return new f(P,A.type||"string",A.mimeType)},generateAsync:function(N,P){return this.generateInternalStream(N).accumulate(P)},generateNodeStream:function(N,P){return(N=N||{}).type||(N.type="nodebuffer"),this.generateInternalStream(N).toNodejsStream(P)}};n.exports=k},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(s,n,a){n.exports=s("stream")},{stream:void 0}],17:[function(s,n,a){var i=s("./DataReader");function l(o){i.call(this,o);for(var c=0;c<this.data.length;c++)o[c]=255&o[c]}s("../utils").inherits(l,i),l.prototype.byteAt=function(o){return this.data[this.zero+o]},l.prototype.lastIndexOfSignature=function(o){for(var c=o.charCodeAt(0),f=o.charCodeAt(1),m=o.charCodeAt(2),p=o.charCodeAt(3),b=this.length-4;0<=b;--b)if(this.data[b]===c&&this.data[b+1]===f&&this.data[b+2]===m&&this.data[b+3]===p)return b-this.zero;return-1},l.prototype.readAndCheckSignature=function(o){var c=o.charCodeAt(0),f=o.charCodeAt(1),m=o.charCodeAt(2),p=o.charCodeAt(3),b=this.readData(4);return c===b[0]&&f===b[1]&&m===b[2]&&p===b[3]},l.prototype.readData=function(o){if(this.checkOffset(o),o===0)return[];var c=this.data.slice(this.zero+this.index,this.zero+this.index+o);return this.index+=o,c},n.exports=l},{"../utils":32,"./DataReader":18}],18:[function(s,n,a){var i=s("../utils");function l(o){this.data=o,this.length=o.length,this.index=0,this.zero=0}l.prototype={checkOffset:function(o){this.checkIndex(this.index+o)},checkIndex:function(o){if(this.length<this.zero+o||o<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+o+"). Corrupted zip ?")},setIndex:function(o){this.checkIndex(o),this.index=o},skip:function(o){this.setIndex(this.index+o)},byteAt:function(){},readInt:function(o){var c,f=0;for(this.checkOffset(o),c=this.index+o-1;c>=this.index;c--)f=(f<<8)+this.byteAt(c);return this.index+=o,f},readString:function(o){return i.transformTo("string",this.readData(o))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var o=this.readInt(4);return new Date(Date.UTC(1980+(o>>25&127),(o>>21&15)-1,o>>16&31,o>>11&31,o>>5&63,(31&o)<<1))}},n.exports=l},{"../utils":32}],19:[function(s,n,a){var i=s("./Uint8ArrayReader");function l(o){i.call(this,o)}s("../utils").inherits(l,i),l.prototype.readData=function(o){this.checkOffset(o);var c=this.data.slice(this.zero+this.index,this.zero+this.index+o);return this.index+=o,c},n.exports=l},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(s,n,a){var i=s("./DataReader");function l(o){i.call(this,o)}s("../utils").inherits(l,i),l.prototype.byteAt=function(o){return this.data.charCodeAt(this.zero+o)},l.prototype.lastIndexOfSignature=function(o){return this.data.lastIndexOf(o)-this.zero},l.prototype.readAndCheckSignature=function(o){return o===this.readData(4)},l.prototype.readData=function(o){this.checkOffset(o);var c=this.data.slice(this.zero+this.index,this.zero+this.index+o);return this.index+=o,c},n.exports=l},{"../utils":32,"./DataReader":18}],21:[function(s,n,a){var i=s("./ArrayReader");function l(o){i.call(this,o)}s("../utils").inherits(l,i),l.prototype.readData=function(o){if(this.checkOffset(o),o===0)return new Uint8Array(0);var c=this.data.subarray(this.zero+this.index,this.zero+this.index+o);return this.index+=o,c},n.exports=l},{"../utils":32,"./ArrayReader":17}],22:[function(s,n,a){var i=s("../utils"),l=s("../support"),o=s("./ArrayReader"),c=s("./StringReader"),f=s("./NodeBufferReader"),m=s("./Uint8ArrayReader");n.exports=function(p){var b=i.getTypeOf(p);return i.checkSupport(b),b!=="string"||l.uint8array?b==="nodebuffer"?new f(p):l.uint8array?new m(i.transformTo("uint8array",p)):new o(i.transformTo("array",p)):new c(p)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(s,n,a){a.LOCAL_FILE_HEADER="PK",a.CENTRAL_FILE_HEADER="PK",a.CENTRAL_DIRECTORY_END="PK",a.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",a.ZIP64_CENTRAL_DIRECTORY_END="PK",a.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(s,n,a){var i=s("./GenericWorker"),l=s("../utils");function o(c){i.call(this,"ConvertWorker to "+c),this.destType=c}l.inherits(o,i),o.prototype.processChunk=function(c){this.push({data:l.transformTo(this.destType,c.data),meta:c.meta})},n.exports=o},{"../utils":32,"./GenericWorker":28}],25:[function(s,n,a){var i=s("./GenericWorker"),l=s("../crc32");function o(){i.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}s("../utils").inherits(o,i),o.prototype.processChunk=function(c){this.streamInfo.crc32=l(c.data,this.streamInfo.crc32||0),this.push(c)},n.exports=o},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(s,n,a){var i=s("../utils"),l=s("./GenericWorker");function o(c){l.call(this,"DataLengthProbe for "+c),this.propName=c,this.withStreamInfo(c,0)}i.inherits(o,l),o.prototype.processChunk=function(c){if(c){var f=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=f+c.data.length}l.prototype.processChunk.call(this,c)},n.exports=o},{"../utils":32,"./GenericWorker":28}],27:[function(s,n,a){var i=s("../utils"),l=s("./GenericWorker");function o(c){l.call(this,"DataWorker");var f=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,c.then(function(m){f.dataIsReady=!0,f.data=m,f.max=m&&m.length||0,f.type=i.getTypeOf(m),f.isPaused||f._tickAndRepeat()},function(m){f.error(m)})}i.inherits(o,l),o.prototype.cleanUp=function(){l.prototype.cleanUp.call(this),this.data=null},o.prototype.resume=function(){return!!l.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,i.delay(this._tickAndRepeat,[],this)),!0)},o.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(i.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},o.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var c=null,f=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":c=this.data.substring(this.index,f);break;case"uint8array":c=this.data.subarray(this.index,f);break;case"array":case"nodebuffer":c=this.data.slice(this.index,f)}return this.index=f,this.push({data:c,meta:{percent:this.max?this.index/this.max*100:0}})},n.exports=o},{"../utils":32,"./GenericWorker":28}],28:[function(s,n,a){function i(l){this.name=l||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}i.prototype={push:function(l){this.emit("data",l)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(l){this.emit("error",l)}return!0},error:function(l){return!this.isFinished&&(this.isPaused?this.generatedError=l:(this.isFinished=!0,this.emit("error",l),this.previous&&this.previous.error(l),this.cleanUp()),!0)},on:function(l,o){return this._listeners[l].push(o),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(l,o){if(this._listeners[l])for(var c=0;c<this._listeners[l].length;c++)this._listeners[l][c].call(this,o)},pipe:function(l){return l.registerPrevious(this)},registerPrevious:function(l){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=l.streamInfo,this.mergeStreamInfo(),this.previous=l;var o=this;return l.on("data",function(c){o.processChunk(c)}),l.on("end",function(){o.end()}),l.on("error",function(c){o.error(c)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var l=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),l=!0),this.previous&&this.previous.resume(),!l},flush:function(){},processChunk:function(l){this.push(l)},withStreamInfo:function(l,o){return this.extraStreamInfo[l]=o,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var l in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,l)&&(this.streamInfo[l]=this.extraStreamInfo[l])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var l="Worker "+this.name;return this.previous?this.previous+" -> "+l:l}},n.exports=i},{}],29:[function(s,n,a){var i=s("../utils"),l=s("./ConvertWorker"),o=s("./GenericWorker"),c=s("../base64"),f=s("../support"),m=s("../external"),p=null;if(f.nodestream)try{p=s("../nodejs/NodejsStreamOutputAdapter")}catch{}function b(w,d){return new m.Promise(function(u,g){var x=[],j=w._internalType,k=w._outputType,N=w._mimeType;w.on("data",function(P,A){x.push(P),d&&d(A)}).on("error",function(P){x=[],g(P)}).on("end",function(){try{var P=function(A,F,R){switch(A){case"blob":return i.newBlob(i.transformTo("arraybuffer",F),R);case"base64":return c.encode(F);default:return i.transformTo(A,F)}}(k,function(A,F){var R,B=0,K=null,_=0;for(R=0;R<F.length;R++)_+=F[R].length;switch(A){case"string":return F.join("");case"array":return Array.prototype.concat.apply([],F);case"uint8array":for(K=new Uint8Array(_),R=0;R<F.length;R++)K.set(F[R],B),B+=F[R].length;return K;case"nodebuffer":return Buffer.concat(F);default:throw new Error("concat : unsupported type '"+A+"'")}}(j,x),N);u(P)}catch(A){g(A)}x=[]}).resume()})}function h(w,d,u){var g=d;switch(d){case"blob":case"arraybuffer":g="uint8array";break;case"base64":g="string"}try{this._internalType=g,this._outputType=d,this._mimeType=u,i.checkSupport(g),this._worker=w.pipe(new l(g)),w.lock()}catch(x){this._worker=new o("error"),this._worker.error(x)}}h.prototype={accumulate:function(w){return b(this,w)},on:function(w,d){var u=this;return w==="data"?this._worker.on(w,function(g){d.call(u,g.data,g.meta)}):this._worker.on(w,function(){i.delay(d,arguments,u)}),this},resume:function(){return i.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(w){if(i.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new p(this,{objectMode:this._outputType!=="nodebuffer"},w)}},n.exports=h},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(s,n,a){if(a.base64=!0,a.array=!0,a.string=!0,a.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",a.nodebuffer=typeof Buffer<"u",a.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")a.blob=!1;else{var i=new ArrayBuffer(0);try{a.blob=new Blob([i],{type:"application/zip"}).size===0}catch{try{var l=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);l.append(i),a.blob=l.getBlob("application/zip").size===0}catch{a.blob=!1}}}try{a.nodestream=!!s("readable-stream").Readable}catch{a.nodestream=!1}},{"readable-stream":16}],31:[function(s,n,a){for(var i=s("./utils"),l=s("./support"),o=s("./nodejsUtils"),c=s("./stream/GenericWorker"),f=new Array(256),m=0;m<256;m++)f[m]=252<=m?6:248<=m?5:240<=m?4:224<=m?3:192<=m?2:1;f[254]=f[254]=1;function p(){c.call(this,"utf-8 decode"),this.leftOver=null}function b(){c.call(this,"utf-8 encode")}a.utf8encode=function(h){return l.nodebuffer?o.newBufferFrom(h,"utf-8"):function(w){var d,u,g,x,j,k=w.length,N=0;for(x=0;x<k;x++)(64512&(u=w.charCodeAt(x)))==55296&&x+1<k&&(64512&(g=w.charCodeAt(x+1)))==56320&&(u=65536+(u-55296<<10)+(g-56320),x++),N+=u<128?1:u<2048?2:u<65536?3:4;for(d=l.uint8array?new Uint8Array(N):new Array(N),x=j=0;j<N;x++)(64512&(u=w.charCodeAt(x)))==55296&&x+1<k&&(64512&(g=w.charCodeAt(x+1)))==56320&&(u=65536+(u-55296<<10)+(g-56320),x++),u<128?d[j++]=u:(u<2048?d[j++]=192|u>>>6:(u<65536?d[j++]=224|u>>>12:(d[j++]=240|u>>>18,d[j++]=128|u>>>12&63),d[j++]=128|u>>>6&63),d[j++]=128|63&u);return d}(h)},a.utf8decode=function(h){return l.nodebuffer?i.transformTo("nodebuffer",h).toString("utf-8"):function(w){var d,u,g,x,j=w.length,k=new Array(2*j);for(d=u=0;d<j;)if((g=w[d++])<128)k[u++]=g;else if(4<(x=f[g]))k[u++]=65533,d+=x-1;else{for(g&=x===2?31:x===3?15:7;1<x&&d<j;)g=g<<6|63&w[d++],x--;1<x?k[u++]=65533:g<65536?k[u++]=g:(g-=65536,k[u++]=55296|g>>10&1023,k[u++]=56320|1023&g)}return k.length!==u&&(k.subarray?k=k.subarray(0,u):k.length=u),i.applyFromCharCode(k)}(h=i.transformTo(l.uint8array?"uint8array":"array",h))},i.inherits(p,c),p.prototype.processChunk=function(h){var w=i.transformTo(l.uint8array?"uint8array":"array",h.data);if(this.leftOver&&this.leftOver.length){if(l.uint8array){var d=w;(w=new Uint8Array(d.length+this.leftOver.length)).set(this.leftOver,0),w.set(d,this.leftOver.length)}else w=this.leftOver.concat(w);this.leftOver=null}var u=function(x,j){var k;for((j=j||x.length)>x.length&&(j=x.length),k=j-1;0<=k&&(192&x[k])==128;)k--;return k<0||k===0?j:k+f[x[k]]>j?k:j}(w),g=w;u!==w.length&&(l.uint8array?(g=w.subarray(0,u),this.leftOver=w.subarray(u,w.length)):(g=w.slice(0,u),this.leftOver=w.slice(u,w.length))),this.push({data:a.utf8decode(g),meta:h.meta})},p.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:a.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},a.Utf8DecodeWorker=p,i.inherits(b,c),b.prototype.processChunk=function(h){this.push({data:a.utf8encode(h.data),meta:h.meta})},a.Utf8EncodeWorker=b},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(s,n,a){var i=s("./support"),l=s("./base64"),o=s("./nodejsUtils"),c=s("./external");function f(d){return d}function m(d,u){for(var g=0;g<d.length;++g)u[g]=255&d.charCodeAt(g);return u}s("setimmediate"),a.newBlob=function(d,u){a.checkSupport("blob");try{return new Blob([d],{type:u})}catch{try{var g=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return g.append(d),g.getBlob(u)}catch{throw new Error("Bug : can't construct the Blob.")}}};var p={stringifyByChunk:function(d,u,g){var x=[],j=0,k=d.length;if(k<=g)return String.fromCharCode.apply(null,d);for(;j<k;)u==="array"||u==="nodebuffer"?x.push(String.fromCharCode.apply(null,d.slice(j,Math.min(j+g,k)))):x.push(String.fromCharCode.apply(null,d.subarray(j,Math.min(j+g,k)))),j+=g;return x.join("")},stringifyByChar:function(d){for(var u="",g=0;g<d.length;g++)u+=String.fromCharCode(d[g]);return u},applyCanBeUsed:{uint8array:function(){try{return i.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return i.nodebuffer&&String.fromCharCode.apply(null,o.allocBuffer(1)).length===1}catch{return!1}}()}};function b(d){var u=65536,g=a.getTypeOf(d),x=!0;if(g==="uint8array"?x=p.applyCanBeUsed.uint8array:g==="nodebuffer"&&(x=p.applyCanBeUsed.nodebuffer),x)for(;1<u;)try{return p.stringifyByChunk(d,g,u)}catch{u=Math.floor(u/2)}return p.stringifyByChar(d)}function h(d,u){for(var g=0;g<d.length;g++)u[g]=d[g];return u}a.applyFromCharCode=b;var w={};w.string={string:f,array:function(d){return m(d,new Array(d.length))},arraybuffer:function(d){return w.string.uint8array(d).buffer},uint8array:function(d){return m(d,new Uint8Array(d.length))},nodebuffer:function(d){return m(d,o.allocBuffer(d.length))}},w.array={string:b,array:f,arraybuffer:function(d){return new Uint8Array(d).buffer},uint8array:function(d){return new Uint8Array(d)},nodebuffer:function(d){return o.newBufferFrom(d)}},w.arraybuffer={string:function(d){return b(new Uint8Array(d))},array:function(d){return h(new Uint8Array(d),new Array(d.byteLength))},arraybuffer:f,uint8array:function(d){return new Uint8Array(d)},nodebuffer:function(d){return o.newBufferFrom(new Uint8Array(d))}},w.uint8array={string:b,array:function(d){return h(d,new Array(d.length))},arraybuffer:function(d){return d.buffer},uint8array:f,nodebuffer:function(d){return o.newBufferFrom(d)}},w.nodebuffer={string:b,array:function(d){return h(d,new Array(d.length))},arraybuffer:function(d){return w.nodebuffer.uint8array(d).buffer},uint8array:function(d){return h(d,new Uint8Array(d.length))},nodebuffer:f},a.transformTo=function(d,u){if(u=u||"",!d)return u;a.checkSupport(d);var g=a.getTypeOf(u);return w[g][d](u)},a.resolve=function(d){for(var u=d.split("/"),g=[],x=0;x<u.length;x++){var j=u[x];j==="."||j===""&&x!==0&&x!==u.length-1||(j===".."?g.pop():g.push(j))}return g.join("/")},a.getTypeOf=function(d){return typeof d=="string"?"string":Object.prototype.toString.call(d)==="[object Array]"?"array":i.nodebuffer&&o.isBuffer(d)?"nodebuffer":i.uint8array&&d instanceof Uint8Array?"uint8array":i.arraybuffer&&d instanceof ArrayBuffer?"arraybuffer":void 0},a.checkSupport=function(d){if(!i[d.toLowerCase()])throw new Error(d+" is not supported by this platform")},a.MAX_VALUE_16BITS=65535,a.MAX_VALUE_32BITS=-1,a.pretty=function(d){var u,g,x="";for(g=0;g<(d||"").length;g++)x+="\\x"+((u=d.charCodeAt(g))<16?"0":"")+u.toString(16).toUpperCase();return x},a.delay=function(d,u,g){setImmediate(function(){d.apply(g||null,u||[])})},a.inherits=function(d,u){function g(){}g.prototype=u.prototype,d.prototype=new g},a.extend=function(){var d,u,g={};for(d=0;d<arguments.length;d++)for(u in arguments[d])Object.prototype.hasOwnProperty.call(arguments[d],u)&&g[u]===void 0&&(g[u]=arguments[d][u]);return g},a.prepareContent=function(d,u,g,x,j){return c.Promise.resolve(u).then(function(k){return i.blob&&(k instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(k))!==-1)&&typeof FileReader<"u"?new c.Promise(function(N,P){var A=new FileReader;A.onload=function(F){N(F.target.result)},A.onerror=function(F){P(F.target.error)},A.readAsArrayBuffer(k)}):k}).then(function(k){var N=a.getTypeOf(k);return N?(N==="arraybuffer"?k=a.transformTo("uint8array",k):N==="string"&&(j?k=l.decode(k):g&&x!==!0&&(k=function(P){return m(P,i.uint8array?new Uint8Array(P.length):new Array(P.length))}(k))),k):c.Promise.reject(new Error("Can't read the data of '"+d+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(s,n,a){var i=s("./reader/readerFor"),l=s("./utils"),o=s("./signature"),c=s("./zipEntry"),f=s("./support");function m(p){this.files=[],this.loadOptions=p}m.prototype={checkSignature:function(p){if(!this.reader.readAndCheckSignature(p)){this.reader.index-=4;var b=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+l.pretty(b)+", expected "+l.pretty(p)+")")}},isSignature:function(p,b){var h=this.reader.index;this.reader.setIndex(p);var w=this.reader.readString(4)===b;return this.reader.setIndex(h),w},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var p=this.reader.readData(this.zipCommentLength),b=f.uint8array?"uint8array":"array",h=l.transformTo(b,p);this.zipComment=this.loadOptions.decodeFileName(h)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var p,b,h,w=this.zip64EndOfCentralSize-44;0<w;)p=this.reader.readInt(2),b=this.reader.readInt(4),h=this.reader.readData(b),this.zip64ExtensibleData[p]={id:p,length:b,value:h}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var p,b;for(p=0;p<this.files.length;p++)b=this.files[p],this.reader.setIndex(b.localHeaderOffset),this.checkSignature(o.LOCAL_FILE_HEADER),b.readLocalPart(this.reader),b.handleUTF8(),b.processAttributes()},readCentralDir:function(){var p;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(o.CENTRAL_FILE_HEADER);)(p=new c({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(p);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var p=this.reader.lastIndexOfSignature(o.CENTRAL_DIRECTORY_END);if(p<0)throw this.isSignature(0,o.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(p);var b=p;if(this.checkSignature(o.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===l.MAX_VALUE_16BITS||this.diskWithCentralDirStart===l.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===l.MAX_VALUE_16BITS||this.centralDirRecords===l.MAX_VALUE_16BITS||this.centralDirSize===l.MAX_VALUE_32BITS||this.centralDirOffset===l.MAX_VALUE_32BITS){if(this.zip64=!0,(p=this.reader.lastIndexOfSignature(o.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(p),this.checkSignature(o.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,o.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(o.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(o.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var h=this.centralDirOffset+this.centralDirSize;this.zip64&&(h+=20,h+=12+this.zip64EndOfCentralSize);var w=b-h;if(0<w)this.isSignature(b,o.CENTRAL_FILE_HEADER)||(this.reader.zero=w);else if(w<0)throw new Error("Corrupted zip: missing "+Math.abs(w)+" bytes.")},prepareReader:function(p){this.reader=i(p)},load:function(p){this.prepareReader(p),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},n.exports=m},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(s,n,a){var i=s("./reader/readerFor"),l=s("./utils"),o=s("./compressedObject"),c=s("./crc32"),f=s("./utf8"),m=s("./compressions"),p=s("./support");function b(h,w){this.options=h,this.loadOptions=w}b.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(h){var w,d;if(h.skip(22),this.fileNameLength=h.readInt(2),d=h.readInt(2),this.fileName=h.readData(this.fileNameLength),h.skip(d),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((w=function(u){for(var g in m)if(Object.prototype.hasOwnProperty.call(m,g)&&m[g].magic===u)return m[g];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+l.pretty(this.compressionMethod)+" unknown (inner file : "+l.transformTo("string",this.fileName)+")");this.decompressed=new o(this.compressedSize,this.uncompressedSize,this.crc32,w,h.readData(this.compressedSize))},readCentralPart:function(h){this.versionMadeBy=h.readInt(2),h.skip(2),this.bitFlag=h.readInt(2),this.compressionMethod=h.readString(2),this.date=h.readDate(),this.crc32=h.readInt(4),this.compressedSize=h.readInt(4),this.uncompressedSize=h.readInt(4);var w=h.readInt(2);if(this.extraFieldsLength=h.readInt(2),this.fileCommentLength=h.readInt(2),this.diskNumberStart=h.readInt(2),this.internalFileAttributes=h.readInt(2),this.externalFileAttributes=h.readInt(4),this.localHeaderOffset=h.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");h.skip(w),this.readExtraFields(h),this.parseZIP64ExtraField(h),this.fileComment=h.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var h=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),h==0&&(this.dosPermissions=63&this.externalFileAttributes),h==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var h=i(this.extraFields[1].value);this.uncompressedSize===l.MAX_VALUE_32BITS&&(this.uncompressedSize=h.readInt(8)),this.compressedSize===l.MAX_VALUE_32BITS&&(this.compressedSize=h.readInt(8)),this.localHeaderOffset===l.MAX_VALUE_32BITS&&(this.localHeaderOffset=h.readInt(8)),this.diskNumberStart===l.MAX_VALUE_32BITS&&(this.diskNumberStart=h.readInt(4))}},readExtraFields:function(h){var w,d,u,g=h.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});h.index+4<g;)w=h.readInt(2),d=h.readInt(2),u=h.readData(d),this.extraFields[w]={id:w,length:d,value:u};h.setIndex(g)},handleUTF8:function(){var h=p.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=f.utf8decode(this.fileName),this.fileCommentStr=f.utf8decode(this.fileComment);else{var w=this.findExtraFieldUnicodePath();if(w!==null)this.fileNameStr=w;else{var d=l.transformTo(h,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(d)}var u=this.findExtraFieldUnicodeComment();if(u!==null)this.fileCommentStr=u;else{var g=l.transformTo(h,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(g)}}},findExtraFieldUnicodePath:function(){var h=this.extraFields[28789];if(h){var w=i(h.value);return w.readInt(1)!==1||c(this.fileName)!==w.readInt(4)?null:f.utf8decode(w.readData(h.length-5))}return null},findExtraFieldUnicodeComment:function(){var h=this.extraFields[25461];if(h){var w=i(h.value);return w.readInt(1)!==1||c(this.fileComment)!==w.readInt(4)?null:f.utf8decode(w.readData(h.length-5))}return null}},n.exports=b},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(s,n,a){function i(w,d,u){this.name=w,this.dir=u.dir,this.date=u.date,this.comment=u.comment,this.unixPermissions=u.unixPermissions,this.dosPermissions=u.dosPermissions,this._data=d,this._dataBinary=u.binary,this.options={compression:u.compression,compressionOptions:u.compressionOptions}}var l=s("./stream/StreamHelper"),o=s("./stream/DataWorker"),c=s("./utf8"),f=s("./compressedObject"),m=s("./stream/GenericWorker");i.prototype={internalStream:function(w){var d=null,u="string";try{if(!w)throw new Error("No output type specified.");var g=(u=w.toLowerCase())==="string"||u==="text";u!=="binarystring"&&u!=="text"||(u="string"),d=this._decompressWorker();var x=!this._dataBinary;x&&!g&&(d=d.pipe(new c.Utf8EncodeWorker)),!x&&g&&(d=d.pipe(new c.Utf8DecodeWorker))}catch(j){(d=new m("error")).error(j)}return new l(d,u,"")},async:function(w,d){return this.internalStream(w).accumulate(d)},nodeStream:function(w,d){return this.internalStream(w||"nodebuffer").toNodejsStream(d)},_compressWorker:function(w,d){if(this._data instanceof f&&this._data.compression.magic===w.magic)return this._data.getCompressedWorker();var u=this._decompressWorker();return this._dataBinary||(u=u.pipe(new c.Utf8EncodeWorker)),f.createWorkerFrom(u,w,d)},_decompressWorker:function(){return this._data instanceof f?this._data.getContentWorker():this._data instanceof m?this._data:new o(this._data)}};for(var p=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],b=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},h=0;h<p.length;h++)i.prototype[p[h]]=b;n.exports=i},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(s,n,a){(function(i){var l,o,c=i.MutationObserver||i.WebKitMutationObserver;if(c){var f=0,m=new c(w),p=i.document.createTextNode("");m.observe(p,{characterData:!0}),l=function(){p.data=f=++f%2}}else if(i.setImmediate||i.MessageChannel===void 0)l="document"in i&&"onreadystatechange"in i.document.createElement("script")?function(){var d=i.document.createElement("script");d.onreadystatechange=function(){w(),d.onreadystatechange=null,d.parentNode.removeChild(d),d=null},i.document.documentElement.appendChild(d)}:function(){setTimeout(w,0)};else{var b=new i.MessageChannel;b.port1.onmessage=w,l=function(){b.port2.postMessage(0)}}var h=[];function w(){var d,u;o=!0;for(var g=h.length;g;){for(u=h,h=[],d=-1;++d<g;)u[d]();g=h.length}o=!1}n.exports=function(d){h.push(d)!==1||o||l()}}).call(this,typeof Cr<"u"?Cr:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(s,n,a){var i=s("immediate");function l(){}var o={},c=["REJECTED"],f=["FULFILLED"],m=["PENDING"];function p(g){if(typeof g!="function")throw new TypeError("resolver must be a function");this.state=m,this.queue=[],this.outcome=void 0,g!==l&&d(this,g)}function b(g,x,j){this.promise=g,typeof x=="function"&&(this.onFulfilled=x,this.callFulfilled=this.otherCallFulfilled),typeof j=="function"&&(this.onRejected=j,this.callRejected=this.otherCallRejected)}function h(g,x,j){i(function(){var k;try{k=x(j)}catch(N){return o.reject(g,N)}k===g?o.reject(g,new TypeError("Cannot resolve promise with itself")):o.resolve(g,k)})}function w(g){var x=g&&g.then;if(g&&(typeof g=="object"||typeof g=="function")&&typeof x=="function")return function(){x.apply(g,arguments)}}function d(g,x){var j=!1;function k(A){j||(j=!0,o.reject(g,A))}function N(A){j||(j=!0,o.resolve(g,A))}var P=u(function(){x(N,k)});P.status==="error"&&k(P.value)}function u(g,x){var j={};try{j.value=g(x),j.status="success"}catch(k){j.status="error",j.value=k}return j}(n.exports=p).prototype.finally=function(g){if(typeof g!="function")return this;var x=this.constructor;return this.then(function(j){return x.resolve(g()).then(function(){return j})},function(j){return x.resolve(g()).then(function(){throw j})})},p.prototype.catch=function(g){return this.then(null,g)},p.prototype.then=function(g,x){if(typeof g!="function"&&this.state===f||typeof x!="function"&&this.state===c)return this;var j=new this.constructor(l);return this.state!==m?h(j,this.state===f?g:x,this.outcome):this.queue.push(new b(j,g,x)),j},b.prototype.callFulfilled=function(g){o.resolve(this.promise,g)},b.prototype.otherCallFulfilled=function(g){h(this.promise,this.onFulfilled,g)},b.prototype.callRejected=function(g){o.reject(this.promise,g)},b.prototype.otherCallRejected=function(g){h(this.promise,this.onRejected,g)},o.resolve=function(g,x){var j=u(w,x);if(j.status==="error")return o.reject(g,j.value);var k=j.value;if(k)d(g,k);else{g.state=f,g.outcome=x;for(var N=-1,P=g.queue.length;++N<P;)g.queue[N].callFulfilled(x)}return g},o.reject=function(g,x){g.state=c,g.outcome=x;for(var j=-1,k=g.queue.length;++j<k;)g.queue[j].callRejected(x);return g},p.resolve=function(g){return g instanceof this?g:o.resolve(new this(l),g)},p.reject=function(g){var x=new this(l);return o.reject(x,g)},p.all=function(g){var x=this;if(Object.prototype.toString.call(g)!=="[object Array]")return this.reject(new TypeError("must be an array"));var j=g.length,k=!1;if(!j)return this.resolve([]);for(var N=new Array(j),P=0,A=-1,F=new this(l);++A<j;)R(g[A],A);return F;function R(B,K){x.resolve(B).then(function(_){N[K]=_,++P!==j||k||(k=!0,o.resolve(F,N))},function(_){k||(k=!0,o.reject(F,_))})}},p.race=function(g){var x=this;if(Object.prototype.toString.call(g)!=="[object Array]")return this.reject(new TypeError("must be an array"));var j=g.length,k=!1;if(!j)return this.resolve([]);for(var N=-1,P=new this(l);++N<j;)A=g[N],x.resolve(A).then(function(F){k||(k=!0,o.resolve(P,F))},function(F){k||(k=!0,o.reject(P,F))});var A;return P}},{immediate:36}],38:[function(s,n,a){var i={};(0,s("./lib/utils/common").assign)(i,s("./lib/deflate"),s("./lib/inflate"),s("./lib/zlib/constants")),n.exports=i},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(s,n,a){var i=s("./zlib/deflate"),l=s("./utils/common"),o=s("./utils/strings"),c=s("./zlib/messages"),f=s("./zlib/zstream"),m=Object.prototype.toString,p=0,b=-1,h=0,w=8;function d(g){if(!(this instanceof d))return new d(g);this.options=l.assign({level:b,method:w,chunkSize:16384,windowBits:15,memLevel:8,strategy:h,to:""},g||{});var x=this.options;x.raw&&0<x.windowBits?x.windowBits=-x.windowBits:x.gzip&&0<x.windowBits&&x.windowBits<16&&(x.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new f,this.strm.avail_out=0;var j=i.deflateInit2(this.strm,x.level,x.method,x.windowBits,x.memLevel,x.strategy);if(j!==p)throw new Error(c[j]);if(x.header&&i.deflateSetHeader(this.strm,x.header),x.dictionary){var k;if(k=typeof x.dictionary=="string"?o.string2buf(x.dictionary):m.call(x.dictionary)==="[object ArrayBuffer]"?new Uint8Array(x.dictionary):x.dictionary,(j=i.deflateSetDictionary(this.strm,k))!==p)throw new Error(c[j]);this._dict_set=!0}}function u(g,x){var j=new d(x);if(j.push(g,!0),j.err)throw j.msg||c[j.err];return j.result}d.prototype.push=function(g,x){var j,k,N=this.strm,P=this.options.chunkSize;if(this.ended)return!1;k=x===~~x?x:x===!0?4:0,typeof g=="string"?N.input=o.string2buf(g):m.call(g)==="[object ArrayBuffer]"?N.input=new Uint8Array(g):N.input=g,N.next_in=0,N.avail_in=N.input.length;do{if(N.avail_out===0&&(N.output=new l.Buf8(P),N.next_out=0,N.avail_out=P),(j=i.deflate(N,k))!==1&&j!==p)return this.onEnd(j),!(this.ended=!0);N.avail_out!==0&&(N.avail_in!==0||k!==4&&k!==2)||(this.options.to==="string"?this.onData(o.buf2binstring(l.shrinkBuf(N.output,N.next_out))):this.onData(l.shrinkBuf(N.output,N.next_out)))}while((0<N.avail_in||N.avail_out===0)&&j!==1);return k===4?(j=i.deflateEnd(this.strm),this.onEnd(j),this.ended=!0,j===p):k!==2||(this.onEnd(p),!(N.avail_out=0))},d.prototype.onData=function(g){this.chunks.push(g)},d.prototype.onEnd=function(g){g===p&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=l.flattenChunks(this.chunks)),this.chunks=[],this.err=g,this.msg=this.strm.msg},a.Deflate=d,a.deflate=u,a.deflateRaw=function(g,x){return(x=x||{}).raw=!0,u(g,x)},a.gzip=function(g,x){return(x=x||{}).gzip=!0,u(g,x)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(s,n,a){var i=s("./zlib/inflate"),l=s("./utils/common"),o=s("./utils/strings"),c=s("./zlib/constants"),f=s("./zlib/messages"),m=s("./zlib/zstream"),p=s("./zlib/gzheader"),b=Object.prototype.toString;function h(d){if(!(this instanceof h))return new h(d);this.options=l.assign({chunkSize:16384,windowBits:0,to:""},d||{});var u=this.options;u.raw&&0<=u.windowBits&&u.windowBits<16&&(u.windowBits=-u.windowBits,u.windowBits===0&&(u.windowBits=-15)),!(0<=u.windowBits&&u.windowBits<16)||d&&d.windowBits||(u.windowBits+=32),15<u.windowBits&&u.windowBits<48&&!(15&u.windowBits)&&(u.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new m,this.strm.avail_out=0;var g=i.inflateInit2(this.strm,u.windowBits);if(g!==c.Z_OK)throw new Error(f[g]);this.header=new p,i.inflateGetHeader(this.strm,this.header)}function w(d,u){var g=new h(u);if(g.push(d,!0),g.err)throw g.msg||f[g.err];return g.result}h.prototype.push=function(d,u){var g,x,j,k,N,P,A=this.strm,F=this.options.chunkSize,R=this.options.dictionary,B=!1;if(this.ended)return!1;x=u===~~u?u:u===!0?c.Z_FINISH:c.Z_NO_FLUSH,typeof d=="string"?A.input=o.binstring2buf(d):b.call(d)==="[object ArrayBuffer]"?A.input=new Uint8Array(d):A.input=d,A.next_in=0,A.avail_in=A.input.length;do{if(A.avail_out===0&&(A.output=new l.Buf8(F),A.next_out=0,A.avail_out=F),(g=i.inflate(A,c.Z_NO_FLUSH))===c.Z_NEED_DICT&&R&&(P=typeof R=="string"?o.string2buf(R):b.call(R)==="[object ArrayBuffer]"?new Uint8Array(R):R,g=i.inflateSetDictionary(this.strm,P)),g===c.Z_BUF_ERROR&&B===!0&&(g=c.Z_OK,B=!1),g!==c.Z_STREAM_END&&g!==c.Z_OK)return this.onEnd(g),!(this.ended=!0);A.next_out&&(A.avail_out!==0&&g!==c.Z_STREAM_END&&(A.avail_in!==0||x!==c.Z_FINISH&&x!==c.Z_SYNC_FLUSH)||(this.options.to==="string"?(j=o.utf8border(A.output,A.next_out),k=A.next_out-j,N=o.buf2string(A.output,j),A.next_out=k,A.avail_out=F-k,k&&l.arraySet(A.output,A.output,j,k,0),this.onData(N)):this.onData(l.shrinkBuf(A.output,A.next_out)))),A.avail_in===0&&A.avail_out===0&&(B=!0)}while((0<A.avail_in||A.avail_out===0)&&g!==c.Z_STREAM_END);return g===c.Z_STREAM_END&&(x=c.Z_FINISH),x===c.Z_FINISH?(g=i.inflateEnd(this.strm),this.onEnd(g),this.ended=!0,g===c.Z_OK):x!==c.Z_SYNC_FLUSH||(this.onEnd(c.Z_OK),!(A.avail_out=0))},h.prototype.onData=function(d){this.chunks.push(d)},h.prototype.onEnd=function(d){d===c.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=l.flattenChunks(this.chunks)),this.chunks=[],this.err=d,this.msg=this.strm.msg},a.Inflate=h,a.inflate=w,a.inflateRaw=function(d,u){return(u=u||{}).raw=!0,w(d,u)},a.ungzip=w},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(s,n,a){var i=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";a.assign=function(c){for(var f=Array.prototype.slice.call(arguments,1);f.length;){var m=f.shift();if(m){if(typeof m!="object")throw new TypeError(m+"must be non-object");for(var p in m)m.hasOwnProperty(p)&&(c[p]=m[p])}}return c},a.shrinkBuf=function(c,f){return c.length===f?c:c.subarray?c.subarray(0,f):(c.length=f,c)};var l={arraySet:function(c,f,m,p,b){if(f.subarray&&c.subarray)c.set(f.subarray(m,m+p),b);else for(var h=0;h<p;h++)c[b+h]=f[m+h]},flattenChunks:function(c){var f,m,p,b,h,w;for(f=p=0,m=c.length;f<m;f++)p+=c[f].length;for(w=new Uint8Array(p),f=b=0,m=c.length;f<m;f++)h=c[f],w.set(h,b),b+=h.length;return w}},o={arraySet:function(c,f,m,p,b){for(var h=0;h<p;h++)c[b+h]=f[m+h]},flattenChunks:function(c){return[].concat.apply([],c)}};a.setTyped=function(c){c?(a.Buf8=Uint8Array,a.Buf16=Uint16Array,a.Buf32=Int32Array,a.assign(a,l)):(a.Buf8=Array,a.Buf16=Array,a.Buf32=Array,a.assign(a,o))},a.setTyped(i)},{}],42:[function(s,n,a){var i=s("./common"),l=!0,o=!0;try{String.fromCharCode.apply(null,[0])}catch{l=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{o=!1}for(var c=new i.Buf8(256),f=0;f<256;f++)c[f]=252<=f?6:248<=f?5:240<=f?4:224<=f?3:192<=f?2:1;function m(p,b){if(b<65537&&(p.subarray&&o||!p.subarray&&l))return String.fromCharCode.apply(null,i.shrinkBuf(p,b));for(var h="",w=0;w<b;w++)h+=String.fromCharCode(p[w]);return h}c[254]=c[254]=1,a.string2buf=function(p){var b,h,w,d,u,g=p.length,x=0;for(d=0;d<g;d++)(64512&(h=p.charCodeAt(d)))==55296&&d+1<g&&(64512&(w=p.charCodeAt(d+1)))==56320&&(h=65536+(h-55296<<10)+(w-56320),d++),x+=h<128?1:h<2048?2:h<65536?3:4;for(b=new i.Buf8(x),d=u=0;u<x;d++)(64512&(h=p.charCodeAt(d)))==55296&&d+1<g&&(64512&(w=p.charCodeAt(d+1)))==56320&&(h=65536+(h-55296<<10)+(w-56320),d++),h<128?b[u++]=h:(h<2048?b[u++]=192|h>>>6:(h<65536?b[u++]=224|h>>>12:(b[u++]=240|h>>>18,b[u++]=128|h>>>12&63),b[u++]=128|h>>>6&63),b[u++]=128|63&h);return b},a.buf2binstring=function(p){return m(p,p.length)},a.binstring2buf=function(p){for(var b=new i.Buf8(p.length),h=0,w=b.length;h<w;h++)b[h]=p.charCodeAt(h);return b},a.buf2string=function(p,b){var h,w,d,u,g=b||p.length,x=new Array(2*g);for(h=w=0;h<g;)if((d=p[h++])<128)x[w++]=d;else if(4<(u=c[d]))x[w++]=65533,h+=u-1;else{for(d&=u===2?31:u===3?15:7;1<u&&h<g;)d=d<<6|63&p[h++],u--;1<u?x[w++]=65533:d<65536?x[w++]=d:(d-=65536,x[w++]=55296|d>>10&1023,x[w++]=56320|1023&d)}return m(x,w)},a.utf8border=function(p,b){var h;for((b=b||p.length)>p.length&&(b=p.length),h=b-1;0<=h&&(192&p[h])==128;)h--;return h<0||h===0?b:h+c[p[h]]>b?h:b}},{"./common":41}],43:[function(s,n,a){n.exports=function(i,l,o,c){for(var f=65535&i|0,m=i>>>16&65535|0,p=0;o!==0;){for(o-=p=2e3<o?2e3:o;m=m+(f=f+l[c++]|0)|0,--p;);f%=65521,m%=65521}return f|m<<16|0}},{}],44:[function(s,n,a){n.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(s,n,a){var i=function(){for(var l,o=[],c=0;c<256;c++){l=c;for(var f=0;f<8;f++)l=1&l?3988292384^l>>>1:l>>>1;o[c]=l}return o}();n.exports=function(l,o,c,f){var m=i,p=f+c;l^=-1;for(var b=f;b<p;b++)l=l>>>8^m[255&(l^o[b])];return-1^l}},{}],46:[function(s,n,a){var i,l=s("../utils/common"),o=s("./trees"),c=s("./adler32"),f=s("./crc32"),m=s("./messages"),p=0,b=4,h=0,w=-2,d=-1,u=4,g=2,x=8,j=9,k=286,N=30,P=19,A=2*k+1,F=15,R=3,B=258,K=B+R+1,_=42,D=113,y=1,O=2,ee=3,M=4;function Z(v,H){return v.msg=m[H],H}function V(v){return(v<<1)-(4<v?9:0)}function ie(v){for(var H=v.length;0<=--H;)v[H]=0}function L(v){var H=v.state,$=H.pending;$>v.avail_out&&($=v.avail_out),$!==0&&(l.arraySet(v.output,H.pending_buf,H.pending_out,$,v.next_out),v.next_out+=$,H.pending_out+=$,v.total_out+=$,v.avail_out-=$,H.pending-=$,H.pending===0&&(H.pending_out=0))}function z(v,H){o._tr_flush_block(v,0<=v.block_start?v.block_start:-1,v.strstart-v.block_start,H),v.block_start=v.strstart,L(v.strm)}function le(v,H){v.pending_buf[v.pending++]=H}function se(v,H){v.pending_buf[v.pending++]=H>>>8&255,v.pending_buf[v.pending++]=255&H}function re(v,H){var $,E,S=v.max_chain_length,T=v.strstart,W=v.prev_length,G=v.nice_match,I=v.strstart>v.w_size-K?v.strstart-(v.w_size-K):0,Q=v.window,ne=v.w_mask,te=v.prev,de=v.strstart+B,oe=Q[T+W-1],q=Q[T+W];v.prev_length>=v.good_match&&(S>>=2),G>v.lookahead&&(G=v.lookahead);do if(Q[($=H)+W]===q&&Q[$+W-1]===oe&&Q[$]===Q[T]&&Q[++$]===Q[T+1]){T+=2,$++;do;while(Q[++T]===Q[++$]&&Q[++T]===Q[++$]&&Q[++T]===Q[++$]&&Q[++T]===Q[++$]&&Q[++T]===Q[++$]&&Q[++T]===Q[++$]&&Q[++T]===Q[++$]&&Q[++T]===Q[++$]&&T<de);if(E=B-(de-T),T=de-B,W<E){if(v.match_start=H,G<=(W=E))break;oe=Q[T+W-1],q=Q[T+W]}}while((H=te[H&ne])>I&&--S!=0);return W<=v.lookahead?W:v.lookahead}function Ne(v){var H,$,E,S,T,W,G,I,Q,ne,te=v.w_size;do{if(S=v.window_size-v.lookahead-v.strstart,v.strstart>=te+(te-K)){for(l.arraySet(v.window,v.window,te,te,0),v.match_start-=te,v.strstart-=te,v.block_start-=te,H=$=v.hash_size;E=v.head[--H],v.head[H]=te<=E?E-te:0,--$;);for(H=$=te;E=v.prev[--H],v.prev[H]=te<=E?E-te:0,--$;);S+=te}if(v.strm.avail_in===0)break;if(W=v.strm,G=v.window,I=v.strstart+v.lookahead,Q=S,ne=void 0,ne=W.avail_in,Q<ne&&(ne=Q),$=ne===0?0:(W.avail_in-=ne,l.arraySet(G,W.input,W.next_in,ne,I),W.state.wrap===1?W.adler=c(W.adler,G,ne,I):W.state.wrap===2&&(W.adler=f(W.adler,G,ne,I)),W.next_in+=ne,W.total_in+=ne,ne),v.lookahead+=$,v.lookahead+v.insert>=R)for(T=v.strstart-v.insert,v.ins_h=v.window[T],v.ins_h=(v.ins_h<<v.hash_shift^v.window[T+1])&v.hash_mask;v.insert&&(v.ins_h=(v.ins_h<<v.hash_shift^v.window[T+R-1])&v.hash_mask,v.prev[T&v.w_mask]=v.head[v.ins_h],v.head[v.ins_h]=T,T++,v.insert--,!(v.lookahead+v.insert<R)););}while(v.lookahead<K&&v.strm.avail_in!==0)}function _e(v,H){for(var $,E;;){if(v.lookahead<K){if(Ne(v),v.lookahead<K&&H===p)return y;if(v.lookahead===0)break}if($=0,v.lookahead>=R&&(v.ins_h=(v.ins_h<<v.hash_shift^v.window[v.strstart+R-1])&v.hash_mask,$=v.prev[v.strstart&v.w_mask]=v.head[v.ins_h],v.head[v.ins_h]=v.strstart),$!==0&&v.strstart-$<=v.w_size-K&&(v.match_length=re(v,$)),v.match_length>=R)if(E=o._tr_tally(v,v.strstart-v.match_start,v.match_length-R),v.lookahead-=v.match_length,v.match_length<=v.max_lazy_match&&v.lookahead>=R){for(v.match_length--;v.strstart++,v.ins_h=(v.ins_h<<v.hash_shift^v.window[v.strstart+R-1])&v.hash_mask,$=v.prev[v.strstart&v.w_mask]=v.head[v.ins_h],v.head[v.ins_h]=v.strstart,--v.match_length!=0;);v.strstart++}else v.strstart+=v.match_length,v.match_length=0,v.ins_h=v.window[v.strstart],v.ins_h=(v.ins_h<<v.hash_shift^v.window[v.strstart+1])&v.hash_mask;else E=o._tr_tally(v,0,v.window[v.strstart]),v.lookahead--,v.strstart++;if(E&&(z(v,!1),v.strm.avail_out===0))return y}return v.insert=v.strstart<R-1?v.strstart:R-1,H===b?(z(v,!0),v.strm.avail_out===0?ee:M):v.last_lit&&(z(v,!1),v.strm.avail_out===0)?y:O}function fe(v,H){for(var $,E,S;;){if(v.lookahead<K){if(Ne(v),v.lookahead<K&&H===p)return y;if(v.lookahead===0)break}if($=0,v.lookahead>=R&&(v.ins_h=(v.ins_h<<v.hash_shift^v.window[v.strstart+R-1])&v.hash_mask,$=v.prev[v.strstart&v.w_mask]=v.head[v.ins_h],v.head[v.ins_h]=v.strstart),v.prev_length=v.match_length,v.prev_match=v.match_start,v.match_length=R-1,$!==0&&v.prev_length<v.max_lazy_match&&v.strstart-$<=v.w_size-K&&(v.match_length=re(v,$),v.match_length<=5&&(v.strategy===1||v.match_length===R&&4096<v.strstart-v.match_start)&&(v.match_length=R-1)),v.prev_length>=R&&v.match_length<=v.prev_length){for(S=v.strstart+v.lookahead-R,E=o._tr_tally(v,v.strstart-1-v.prev_match,v.prev_length-R),v.lookahead-=v.prev_length-1,v.prev_length-=2;++v.strstart<=S&&(v.ins_h=(v.ins_h<<v.hash_shift^v.window[v.strstart+R-1])&v.hash_mask,$=v.prev[v.strstart&v.w_mask]=v.head[v.ins_h],v.head[v.ins_h]=v.strstart),--v.prev_length!=0;);if(v.match_available=0,v.match_length=R-1,v.strstart++,E&&(z(v,!1),v.strm.avail_out===0))return y}else if(v.match_available){if((E=o._tr_tally(v,0,v.window[v.strstart-1]))&&z(v,!1),v.strstart++,v.lookahead--,v.strm.avail_out===0)return y}else v.match_available=1,v.strstart++,v.lookahead--}return v.match_available&&(E=o._tr_tally(v,0,v.window[v.strstart-1]),v.match_available=0),v.insert=v.strstart<R-1?v.strstart:R-1,H===b?(z(v,!0),v.strm.avail_out===0?ee:M):v.last_lit&&(z(v,!1),v.strm.avail_out===0)?y:O}function me(v,H,$,E,S){this.good_length=v,this.max_lazy=H,this.nice_length=$,this.max_chain=E,this.func=S}function Ce(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=x,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new l.Buf16(2*A),this.dyn_dtree=new l.Buf16(2*(2*N+1)),this.bl_tree=new l.Buf16(2*(2*P+1)),ie(this.dyn_ltree),ie(this.dyn_dtree),ie(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new l.Buf16(F+1),this.heap=new l.Buf16(2*k+1),ie(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new l.Buf16(2*k+1),ie(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function je(v){var H;return v&&v.state?(v.total_in=v.total_out=0,v.data_type=g,(H=v.state).pending=0,H.pending_out=0,H.wrap<0&&(H.wrap=-H.wrap),H.status=H.wrap?_:D,v.adler=H.wrap===2?0:1,H.last_flush=p,o._tr_init(H),h):Z(v,w)}function Me(v){var H=je(v);return H===h&&function($){$.window_size=2*$.w_size,ie($.head),$.max_lazy_match=i[$.level].max_lazy,$.good_match=i[$.level].good_length,$.nice_match=i[$.level].nice_length,$.max_chain_length=i[$.level].max_chain,$.strstart=0,$.block_start=0,$.lookahead=0,$.insert=0,$.match_length=$.prev_length=R-1,$.match_available=0,$.ins_h=0}(v.state),H}function Pe(v,H,$,E,S,T){if(!v)return w;var W=1;if(H===d&&(H=6),E<0?(W=0,E=-E):15<E&&(W=2,E-=16),S<1||j<S||$!==x||E<8||15<E||H<0||9<H||T<0||u<T)return Z(v,w);E===8&&(E=9);var G=new Ce;return(v.state=G).strm=v,G.wrap=W,G.gzhead=null,G.w_bits=E,G.w_size=1<<G.w_bits,G.w_mask=G.w_size-1,G.hash_bits=S+7,G.hash_size=1<<G.hash_bits,G.hash_mask=G.hash_size-1,G.hash_shift=~~((G.hash_bits+R-1)/R),G.window=new l.Buf8(2*G.w_size),G.head=new l.Buf16(G.hash_size),G.prev=new l.Buf16(G.w_size),G.lit_bufsize=1<<S+6,G.pending_buf_size=4*G.lit_bufsize,G.pending_buf=new l.Buf8(G.pending_buf_size),G.d_buf=1*G.lit_bufsize,G.l_buf=3*G.lit_bufsize,G.level=H,G.strategy=T,G.method=$,Me(v)}i=[new me(0,0,0,0,function(v,H){var $=65535;for($>v.pending_buf_size-5&&($=v.pending_buf_size-5);;){if(v.lookahead<=1){if(Ne(v),v.lookahead===0&&H===p)return y;if(v.lookahead===0)break}v.strstart+=v.lookahead,v.lookahead=0;var E=v.block_start+$;if((v.strstart===0||v.strstart>=E)&&(v.lookahead=v.strstart-E,v.strstart=E,z(v,!1),v.strm.avail_out===0)||v.strstart-v.block_start>=v.w_size-K&&(z(v,!1),v.strm.avail_out===0))return y}return v.insert=0,H===b?(z(v,!0),v.strm.avail_out===0?ee:M):(v.strstart>v.block_start&&(z(v,!1),v.strm.avail_out),y)}),new me(4,4,8,4,_e),new me(4,5,16,8,_e),new me(4,6,32,32,_e),new me(4,4,16,16,fe),new me(8,16,32,32,fe),new me(8,16,128,128,fe),new me(8,32,128,256,fe),new me(32,128,258,1024,fe),new me(32,258,258,4096,fe)],a.deflateInit=function(v,H){return Pe(v,H,x,15,8,0)},a.deflateInit2=Pe,a.deflateReset=Me,a.deflateResetKeep=je,a.deflateSetHeader=function(v,H){return v&&v.state?v.state.wrap!==2?w:(v.state.gzhead=H,h):w},a.deflate=function(v,H){var $,E,S,T;if(!v||!v.state||5<H||H<0)return v?Z(v,w):w;if(E=v.state,!v.output||!v.input&&v.avail_in!==0||E.status===666&&H!==b)return Z(v,v.avail_out===0?-5:w);if(E.strm=v,$=E.last_flush,E.last_flush=H,E.status===_)if(E.wrap===2)v.adler=0,le(E,31),le(E,139),le(E,8),E.gzhead?(le(E,(E.gzhead.text?1:0)+(E.gzhead.hcrc?2:0)+(E.gzhead.extra?4:0)+(E.gzhead.name?8:0)+(E.gzhead.comment?16:0)),le(E,255&E.gzhead.time),le(E,E.gzhead.time>>8&255),le(E,E.gzhead.time>>16&255),le(E,E.gzhead.time>>24&255),le(E,E.level===9?2:2<=E.strategy||E.level<2?4:0),le(E,255&E.gzhead.os),E.gzhead.extra&&E.gzhead.extra.length&&(le(E,255&E.gzhead.extra.length),le(E,E.gzhead.extra.length>>8&255)),E.gzhead.hcrc&&(v.adler=f(v.adler,E.pending_buf,E.pending,0)),E.gzindex=0,E.status=69):(le(E,0),le(E,0),le(E,0),le(E,0),le(E,0),le(E,E.level===9?2:2<=E.strategy||E.level<2?4:0),le(E,3),E.status=D);else{var W=x+(E.w_bits-8<<4)<<8;W|=(2<=E.strategy||E.level<2?0:E.level<6?1:E.level===6?2:3)<<6,E.strstart!==0&&(W|=32),W+=31-W%31,E.status=D,se(E,W),E.strstart!==0&&(se(E,v.adler>>>16),se(E,65535&v.adler)),v.adler=1}if(E.status===69)if(E.gzhead.extra){for(S=E.pending;E.gzindex<(65535&E.gzhead.extra.length)&&(E.pending!==E.pending_buf_size||(E.gzhead.hcrc&&E.pending>S&&(v.adler=f(v.adler,E.pending_buf,E.pending-S,S)),L(v),S=E.pending,E.pending!==E.pending_buf_size));)le(E,255&E.gzhead.extra[E.gzindex]),E.gzindex++;E.gzhead.hcrc&&E.pending>S&&(v.adler=f(v.adler,E.pending_buf,E.pending-S,S)),E.gzindex===E.gzhead.extra.length&&(E.gzindex=0,E.status=73)}else E.status=73;if(E.status===73)if(E.gzhead.name){S=E.pending;do{if(E.pending===E.pending_buf_size&&(E.gzhead.hcrc&&E.pending>S&&(v.adler=f(v.adler,E.pending_buf,E.pending-S,S)),L(v),S=E.pending,E.pending===E.pending_buf_size)){T=1;break}T=E.gzindex<E.gzhead.name.length?255&E.gzhead.name.charCodeAt(E.gzindex++):0,le(E,T)}while(T!==0);E.gzhead.hcrc&&E.pending>S&&(v.adler=f(v.adler,E.pending_buf,E.pending-S,S)),T===0&&(E.gzindex=0,E.status=91)}else E.status=91;if(E.status===91)if(E.gzhead.comment){S=E.pending;do{if(E.pending===E.pending_buf_size&&(E.gzhead.hcrc&&E.pending>S&&(v.adler=f(v.adler,E.pending_buf,E.pending-S,S)),L(v),S=E.pending,E.pending===E.pending_buf_size)){T=1;break}T=E.gzindex<E.gzhead.comment.length?255&E.gzhead.comment.charCodeAt(E.gzindex++):0,le(E,T)}while(T!==0);E.gzhead.hcrc&&E.pending>S&&(v.adler=f(v.adler,E.pending_buf,E.pending-S,S)),T===0&&(E.status=103)}else E.status=103;if(E.status===103&&(E.gzhead.hcrc?(E.pending+2>E.pending_buf_size&&L(v),E.pending+2<=E.pending_buf_size&&(le(E,255&v.adler),le(E,v.adler>>8&255),v.adler=0,E.status=D)):E.status=D),E.pending!==0){if(L(v),v.avail_out===0)return E.last_flush=-1,h}else if(v.avail_in===0&&V(H)<=V($)&&H!==b)return Z(v,-5);if(E.status===666&&v.avail_in!==0)return Z(v,-5);if(v.avail_in!==0||E.lookahead!==0||H!==p&&E.status!==666){var G=E.strategy===2?function(I,Q){for(var ne;;){if(I.lookahead===0&&(Ne(I),I.lookahead===0)){if(Q===p)return y;break}if(I.match_length=0,ne=o._tr_tally(I,0,I.window[I.strstart]),I.lookahead--,I.strstart++,ne&&(z(I,!1),I.strm.avail_out===0))return y}return I.insert=0,Q===b?(z(I,!0),I.strm.avail_out===0?ee:M):I.last_lit&&(z(I,!1),I.strm.avail_out===0)?y:O}(E,H):E.strategy===3?function(I,Q){for(var ne,te,de,oe,q=I.window;;){if(I.lookahead<=B){if(Ne(I),I.lookahead<=B&&Q===p)return y;if(I.lookahead===0)break}if(I.match_length=0,I.lookahead>=R&&0<I.strstart&&(te=q[de=I.strstart-1])===q[++de]&&te===q[++de]&&te===q[++de]){oe=I.strstart+B;do;while(te===q[++de]&&te===q[++de]&&te===q[++de]&&te===q[++de]&&te===q[++de]&&te===q[++de]&&te===q[++de]&&te===q[++de]&&de<oe);I.match_length=B-(oe-de),I.match_length>I.lookahead&&(I.match_length=I.lookahead)}if(I.match_length>=R?(ne=o._tr_tally(I,1,I.match_length-R),I.lookahead-=I.match_length,I.strstart+=I.match_length,I.match_length=0):(ne=o._tr_tally(I,0,I.window[I.strstart]),I.lookahead--,I.strstart++),ne&&(z(I,!1),I.strm.avail_out===0))return y}return I.insert=0,Q===b?(z(I,!0),I.strm.avail_out===0?ee:M):I.last_lit&&(z(I,!1),I.strm.avail_out===0)?y:O}(E,H):i[E.level].func(E,H);if(G!==ee&&G!==M||(E.status=666),G===y||G===ee)return v.avail_out===0&&(E.last_flush=-1),h;if(G===O&&(H===1?o._tr_align(E):H!==5&&(o._tr_stored_block(E,0,0,!1),H===3&&(ie(E.head),E.lookahead===0&&(E.strstart=0,E.block_start=0,E.insert=0))),L(v),v.avail_out===0))return E.last_flush=-1,h}return H!==b?h:E.wrap<=0?1:(E.wrap===2?(le(E,255&v.adler),le(E,v.adler>>8&255),le(E,v.adler>>16&255),le(E,v.adler>>24&255),le(E,255&v.total_in),le(E,v.total_in>>8&255),le(E,v.total_in>>16&255),le(E,v.total_in>>24&255)):(se(E,v.adler>>>16),se(E,65535&v.adler)),L(v),0<E.wrap&&(E.wrap=-E.wrap),E.pending!==0?h:1)},a.deflateEnd=function(v){var H;return v&&v.state?(H=v.state.status)!==_&&H!==69&&H!==73&&H!==91&&H!==103&&H!==D&&H!==666?Z(v,w):(v.state=null,H===D?Z(v,-3):h):w},a.deflateSetDictionary=function(v,H){var $,E,S,T,W,G,I,Q,ne=H.length;if(!v||!v.state||(T=($=v.state).wrap)===2||T===1&&$.status!==_||$.lookahead)return w;for(T===1&&(v.adler=c(v.adler,H,ne,0)),$.wrap=0,ne>=$.w_size&&(T===0&&(ie($.head),$.strstart=0,$.block_start=0,$.insert=0),Q=new l.Buf8($.w_size),l.arraySet(Q,H,ne-$.w_size,$.w_size,0),H=Q,ne=$.w_size),W=v.avail_in,G=v.next_in,I=v.input,v.avail_in=ne,v.next_in=0,v.input=H,Ne($);$.lookahead>=R;){for(E=$.strstart,S=$.lookahead-(R-1);$.ins_h=($.ins_h<<$.hash_shift^$.window[E+R-1])&$.hash_mask,$.prev[E&$.w_mask]=$.head[$.ins_h],$.head[$.ins_h]=E,E++,--S;);$.strstart=E,$.lookahead=R-1,Ne($)}return $.strstart+=$.lookahead,$.block_start=$.strstart,$.insert=$.lookahead,$.lookahead=0,$.match_length=$.prev_length=R-1,$.match_available=0,v.next_in=G,v.input=I,v.avail_in=W,$.wrap=T,h},a.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(s,n,a){n.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(s,n,a){n.exports=function(i,l){var o,c,f,m,p,b,h,w,d,u,g,x,j,k,N,P,A,F,R,B,K,_,D,y,O;o=i.state,c=i.next_in,y=i.input,f=c+(i.avail_in-5),m=i.next_out,O=i.output,p=m-(l-i.avail_out),b=m+(i.avail_out-257),h=o.dmax,w=o.wsize,d=o.whave,u=o.wnext,g=o.window,x=o.hold,j=o.bits,k=o.lencode,N=o.distcode,P=(1<<o.lenbits)-1,A=(1<<o.distbits)-1;e:do{j<15&&(x+=y[c++]<<j,j+=8,x+=y[c++]<<j,j+=8),F=k[x&P];t:for(;;){if(x>>>=R=F>>>24,j-=R,(R=F>>>16&255)===0)O[m++]=65535&F;else{if(!(16&R)){if(!(64&R)){F=k[(65535&F)+(x&(1<<R)-1)];continue t}if(32&R){o.mode=12;break e}i.msg="invalid literal/length code",o.mode=30;break e}B=65535&F,(R&=15)&&(j<R&&(x+=y[c++]<<j,j+=8),B+=x&(1<<R)-1,x>>>=R,j-=R),j<15&&(x+=y[c++]<<j,j+=8,x+=y[c++]<<j,j+=8),F=N[x&A];r:for(;;){if(x>>>=R=F>>>24,j-=R,!(16&(R=F>>>16&255))){if(!(64&R)){F=N[(65535&F)+(x&(1<<R)-1)];continue r}i.msg="invalid distance code",o.mode=30;break e}if(K=65535&F,j<(R&=15)&&(x+=y[c++]<<j,(j+=8)<R&&(x+=y[c++]<<j,j+=8)),h<(K+=x&(1<<R)-1)){i.msg="invalid distance too far back",o.mode=30;break e}if(x>>>=R,j-=R,(R=m-p)<K){if(d<(R=K-R)&&o.sane){i.msg="invalid distance too far back",o.mode=30;break e}if(D=g,(_=0)===u){if(_+=w-R,R<B){for(B-=R;O[m++]=g[_++],--R;);_=m-K,D=O}}else if(u<R){if(_+=w+u-R,(R-=u)<B){for(B-=R;O[m++]=g[_++],--R;);if(_=0,u<B){for(B-=R=u;O[m++]=g[_++],--R;);_=m-K,D=O}}}else if(_+=u-R,R<B){for(B-=R;O[m++]=g[_++],--R;);_=m-K,D=O}for(;2<B;)O[m++]=D[_++],O[m++]=D[_++],O[m++]=D[_++],B-=3;B&&(O[m++]=D[_++],1<B&&(O[m++]=D[_++]))}else{for(_=m-K;O[m++]=O[_++],O[m++]=O[_++],O[m++]=O[_++],2<(B-=3););B&&(O[m++]=O[_++],1<B&&(O[m++]=O[_++]))}break}}break}}while(c<f&&m<b);c-=B=j>>3,x&=(1<<(j-=B<<3))-1,i.next_in=c,i.next_out=m,i.avail_in=c<f?f-c+5:5-(c-f),i.avail_out=m<b?b-m+257:257-(m-b),o.hold=x,o.bits=j}},{}],49:[function(s,n,a){var i=s("../utils/common"),l=s("./adler32"),o=s("./crc32"),c=s("./inffast"),f=s("./inftrees"),m=1,p=2,b=0,h=-2,w=1,d=852,u=592;function g(_){return(_>>>24&255)+(_>>>8&65280)+((65280&_)<<8)+((255&_)<<24)}function x(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new i.Buf16(320),this.work=new i.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function j(_){var D;return _&&_.state?(D=_.state,_.total_in=_.total_out=D.total=0,_.msg="",D.wrap&&(_.adler=1&D.wrap),D.mode=w,D.last=0,D.havedict=0,D.dmax=32768,D.head=null,D.hold=0,D.bits=0,D.lencode=D.lendyn=new i.Buf32(d),D.distcode=D.distdyn=new i.Buf32(u),D.sane=1,D.back=-1,b):h}function k(_){var D;return _&&_.state?((D=_.state).wsize=0,D.whave=0,D.wnext=0,j(_)):h}function N(_,D){var y,O;return _&&_.state?(O=_.state,D<0?(y=0,D=-D):(y=1+(D>>4),D<48&&(D&=15)),D&&(D<8||15<D)?h:(O.window!==null&&O.wbits!==D&&(O.window=null),O.wrap=y,O.wbits=D,k(_))):h}function P(_,D){var y,O;return _?(O=new x,(_.state=O).window=null,(y=N(_,D))!==b&&(_.state=null),y):h}var A,F,R=!0;function B(_){if(R){var D;for(A=new i.Buf32(512),F=new i.Buf32(32),D=0;D<144;)_.lens[D++]=8;for(;D<256;)_.lens[D++]=9;for(;D<280;)_.lens[D++]=7;for(;D<288;)_.lens[D++]=8;for(f(m,_.lens,0,288,A,0,_.work,{bits:9}),D=0;D<32;)_.lens[D++]=5;f(p,_.lens,0,32,F,0,_.work,{bits:5}),R=!1}_.lencode=A,_.lenbits=9,_.distcode=F,_.distbits=5}function K(_,D,y,O){var ee,M=_.state;return M.window===null&&(M.wsize=1<<M.wbits,M.wnext=0,M.whave=0,M.window=new i.Buf8(M.wsize)),O>=M.wsize?(i.arraySet(M.window,D,y-M.wsize,M.wsize,0),M.wnext=0,M.whave=M.wsize):(O<(ee=M.wsize-M.wnext)&&(ee=O),i.arraySet(M.window,D,y-O,ee,M.wnext),(O-=ee)?(i.arraySet(M.window,D,y-O,O,0),M.wnext=O,M.whave=M.wsize):(M.wnext+=ee,M.wnext===M.wsize&&(M.wnext=0),M.whave<M.wsize&&(M.whave+=ee))),0}a.inflateReset=k,a.inflateReset2=N,a.inflateResetKeep=j,a.inflateInit=function(_){return P(_,15)},a.inflateInit2=P,a.inflate=function(_,D){var y,O,ee,M,Z,V,ie,L,z,le,se,re,Ne,_e,fe,me,Ce,je,Me,Pe,v,H,$,E,S=0,T=new i.Buf8(4),W=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!_||!_.state||!_.output||!_.input&&_.avail_in!==0)return h;(y=_.state).mode===12&&(y.mode=13),Z=_.next_out,ee=_.output,ie=_.avail_out,M=_.next_in,O=_.input,V=_.avail_in,L=y.hold,z=y.bits,le=V,se=ie,H=b;e:for(;;)switch(y.mode){case w:if(y.wrap===0){y.mode=13;break}for(;z<16;){if(V===0)break e;V--,L+=O[M++]<<z,z+=8}if(2&y.wrap&&L===35615){T[y.check=0]=255&L,T[1]=L>>>8&255,y.check=o(y.check,T,2,0),z=L=0,y.mode=2;break}if(y.flags=0,y.head&&(y.head.done=!1),!(1&y.wrap)||(((255&L)<<8)+(L>>8))%31){_.msg="incorrect header check",y.mode=30;break}if((15&L)!=8){_.msg="unknown compression method",y.mode=30;break}if(z-=4,v=8+(15&(L>>>=4)),y.wbits===0)y.wbits=v;else if(v>y.wbits){_.msg="invalid window size",y.mode=30;break}y.dmax=1<<v,_.adler=y.check=1,y.mode=512&L?10:12,z=L=0;break;case 2:for(;z<16;){if(V===0)break e;V--,L+=O[M++]<<z,z+=8}if(y.flags=L,(255&y.flags)!=8){_.msg="unknown compression method",y.mode=30;break}if(57344&y.flags){_.msg="unknown header flags set",y.mode=30;break}y.head&&(y.head.text=L>>8&1),512&y.flags&&(T[0]=255&L,T[1]=L>>>8&255,y.check=o(y.check,T,2,0)),z=L=0,y.mode=3;case 3:for(;z<32;){if(V===0)break e;V--,L+=O[M++]<<z,z+=8}y.head&&(y.head.time=L),512&y.flags&&(T[0]=255&L,T[1]=L>>>8&255,T[2]=L>>>16&255,T[3]=L>>>24&255,y.check=o(y.check,T,4,0)),z=L=0,y.mode=4;case 4:for(;z<16;){if(V===0)break e;V--,L+=O[M++]<<z,z+=8}y.head&&(y.head.xflags=255&L,y.head.os=L>>8),512&y.flags&&(T[0]=255&L,T[1]=L>>>8&255,y.check=o(y.check,T,2,0)),z=L=0,y.mode=5;case 5:if(1024&y.flags){for(;z<16;){if(V===0)break e;V--,L+=O[M++]<<z,z+=8}y.length=L,y.head&&(y.head.extra_len=L),512&y.flags&&(T[0]=255&L,T[1]=L>>>8&255,y.check=o(y.check,T,2,0)),z=L=0}else y.head&&(y.head.extra=null);y.mode=6;case 6:if(1024&y.flags&&(V<(re=y.length)&&(re=V),re&&(y.head&&(v=y.head.extra_len-y.length,y.head.extra||(y.head.extra=new Array(y.head.extra_len)),i.arraySet(y.head.extra,O,M,re,v)),512&y.flags&&(y.check=o(y.check,O,re,M)),V-=re,M+=re,y.length-=re),y.length))break e;y.length=0,y.mode=7;case 7:if(2048&y.flags){if(V===0)break e;for(re=0;v=O[M+re++],y.head&&v&&y.length<65536&&(y.head.name+=String.fromCharCode(v)),v&&re<V;);if(512&y.flags&&(y.check=o(y.check,O,re,M)),V-=re,M+=re,v)break e}else y.head&&(y.head.name=null);y.length=0,y.mode=8;case 8:if(4096&y.flags){if(V===0)break e;for(re=0;v=O[M+re++],y.head&&v&&y.length<65536&&(y.head.comment+=String.fromCharCode(v)),v&&re<V;);if(512&y.flags&&(y.check=o(y.check,O,re,M)),V-=re,M+=re,v)break e}else y.head&&(y.head.comment=null);y.mode=9;case 9:if(512&y.flags){for(;z<16;){if(V===0)break e;V--,L+=O[M++]<<z,z+=8}if(L!==(65535&y.check)){_.msg="header crc mismatch",y.mode=30;break}z=L=0}y.head&&(y.head.hcrc=y.flags>>9&1,y.head.done=!0),_.adler=y.check=0,y.mode=12;break;case 10:for(;z<32;){if(V===0)break e;V--,L+=O[M++]<<z,z+=8}_.adler=y.check=g(L),z=L=0,y.mode=11;case 11:if(y.havedict===0)return _.next_out=Z,_.avail_out=ie,_.next_in=M,_.avail_in=V,y.hold=L,y.bits=z,2;_.adler=y.check=1,y.mode=12;case 12:if(D===5||D===6)break e;case 13:if(y.last){L>>>=7&z,z-=7&z,y.mode=27;break}for(;z<3;){if(V===0)break e;V--,L+=O[M++]<<z,z+=8}switch(y.last=1&L,z-=1,3&(L>>>=1)){case 0:y.mode=14;break;case 1:if(B(y),y.mode=20,D!==6)break;L>>>=2,z-=2;break e;case 2:y.mode=17;break;case 3:_.msg="invalid block type",y.mode=30}L>>>=2,z-=2;break;case 14:for(L>>>=7&z,z-=7&z;z<32;){if(V===0)break e;V--,L+=O[M++]<<z,z+=8}if((65535&L)!=(L>>>16^65535)){_.msg="invalid stored block lengths",y.mode=30;break}if(y.length=65535&L,z=L=0,y.mode=15,D===6)break e;case 15:y.mode=16;case 16:if(re=y.length){if(V<re&&(re=V),ie<re&&(re=ie),re===0)break e;i.arraySet(ee,O,M,re,Z),V-=re,M+=re,ie-=re,Z+=re,y.length-=re;break}y.mode=12;break;case 17:for(;z<14;){if(V===0)break e;V--,L+=O[M++]<<z,z+=8}if(y.nlen=257+(31&L),L>>>=5,z-=5,y.ndist=1+(31&L),L>>>=5,z-=5,y.ncode=4+(15&L),L>>>=4,z-=4,286<y.nlen||30<y.ndist){_.msg="too many length or distance symbols",y.mode=30;break}y.have=0,y.mode=18;case 18:for(;y.have<y.ncode;){for(;z<3;){if(V===0)break e;V--,L+=O[M++]<<z,z+=8}y.lens[W[y.have++]]=7&L,L>>>=3,z-=3}for(;y.have<19;)y.lens[W[y.have++]]=0;if(y.lencode=y.lendyn,y.lenbits=7,$={bits:y.lenbits},H=f(0,y.lens,0,19,y.lencode,0,y.work,$),y.lenbits=$.bits,H){_.msg="invalid code lengths set",y.mode=30;break}y.have=0,y.mode=19;case 19:for(;y.have<y.nlen+y.ndist;){for(;me=(S=y.lencode[L&(1<<y.lenbits)-1])>>>16&255,Ce=65535&S,!((fe=S>>>24)<=z);){if(V===0)break e;V--,L+=O[M++]<<z,z+=8}if(Ce<16)L>>>=fe,z-=fe,y.lens[y.have++]=Ce;else{if(Ce===16){for(E=fe+2;z<E;){if(V===0)break e;V--,L+=O[M++]<<z,z+=8}if(L>>>=fe,z-=fe,y.have===0){_.msg="invalid bit length repeat",y.mode=30;break}v=y.lens[y.have-1],re=3+(3&L),L>>>=2,z-=2}else if(Ce===17){for(E=fe+3;z<E;){if(V===0)break e;V--,L+=O[M++]<<z,z+=8}z-=fe,v=0,re=3+(7&(L>>>=fe)),L>>>=3,z-=3}else{for(E=fe+7;z<E;){if(V===0)break e;V--,L+=O[M++]<<z,z+=8}z-=fe,v=0,re=11+(127&(L>>>=fe)),L>>>=7,z-=7}if(y.have+re>y.nlen+y.ndist){_.msg="invalid bit length repeat",y.mode=30;break}for(;re--;)y.lens[y.have++]=v}}if(y.mode===30)break;if(y.lens[256]===0){_.msg="invalid code -- missing end-of-block",y.mode=30;break}if(y.lenbits=9,$={bits:y.lenbits},H=f(m,y.lens,0,y.nlen,y.lencode,0,y.work,$),y.lenbits=$.bits,H){_.msg="invalid literal/lengths set",y.mode=30;break}if(y.distbits=6,y.distcode=y.distdyn,$={bits:y.distbits},H=f(p,y.lens,y.nlen,y.ndist,y.distcode,0,y.work,$),y.distbits=$.bits,H){_.msg="invalid distances set",y.mode=30;break}if(y.mode=20,D===6)break e;case 20:y.mode=21;case 21:if(6<=V&&258<=ie){_.next_out=Z,_.avail_out=ie,_.next_in=M,_.avail_in=V,y.hold=L,y.bits=z,c(_,se),Z=_.next_out,ee=_.output,ie=_.avail_out,M=_.next_in,O=_.input,V=_.avail_in,L=y.hold,z=y.bits,y.mode===12&&(y.back=-1);break}for(y.back=0;me=(S=y.lencode[L&(1<<y.lenbits)-1])>>>16&255,Ce=65535&S,!((fe=S>>>24)<=z);){if(V===0)break e;V--,L+=O[M++]<<z,z+=8}if(me&&!(240&me)){for(je=fe,Me=me,Pe=Ce;me=(S=y.lencode[Pe+((L&(1<<je+Me)-1)>>je)])>>>16&255,Ce=65535&S,!(je+(fe=S>>>24)<=z);){if(V===0)break e;V--,L+=O[M++]<<z,z+=8}L>>>=je,z-=je,y.back+=je}if(L>>>=fe,z-=fe,y.back+=fe,y.length=Ce,me===0){y.mode=26;break}if(32&me){y.back=-1,y.mode=12;break}if(64&me){_.msg="invalid literal/length code",y.mode=30;break}y.extra=15&me,y.mode=22;case 22:if(y.extra){for(E=y.extra;z<E;){if(V===0)break e;V--,L+=O[M++]<<z,z+=8}y.length+=L&(1<<y.extra)-1,L>>>=y.extra,z-=y.extra,y.back+=y.extra}y.was=y.length,y.mode=23;case 23:for(;me=(S=y.distcode[L&(1<<y.distbits)-1])>>>16&255,Ce=65535&S,!((fe=S>>>24)<=z);){if(V===0)break e;V--,L+=O[M++]<<z,z+=8}if(!(240&me)){for(je=fe,Me=me,Pe=Ce;me=(S=y.distcode[Pe+((L&(1<<je+Me)-1)>>je)])>>>16&255,Ce=65535&S,!(je+(fe=S>>>24)<=z);){if(V===0)break e;V--,L+=O[M++]<<z,z+=8}L>>>=je,z-=je,y.back+=je}if(L>>>=fe,z-=fe,y.back+=fe,64&me){_.msg="invalid distance code",y.mode=30;break}y.offset=Ce,y.extra=15&me,y.mode=24;case 24:if(y.extra){for(E=y.extra;z<E;){if(V===0)break e;V--,L+=O[M++]<<z,z+=8}y.offset+=L&(1<<y.extra)-1,L>>>=y.extra,z-=y.extra,y.back+=y.extra}if(y.offset>y.dmax){_.msg="invalid distance too far back",y.mode=30;break}y.mode=25;case 25:if(ie===0)break e;if(re=se-ie,y.offset>re){if((re=y.offset-re)>y.whave&&y.sane){_.msg="invalid distance too far back",y.mode=30;break}Ne=re>y.wnext?(re-=y.wnext,y.wsize-re):y.wnext-re,re>y.length&&(re=y.length),_e=y.window}else _e=ee,Ne=Z-y.offset,re=y.length;for(ie<re&&(re=ie),ie-=re,y.length-=re;ee[Z++]=_e[Ne++],--re;);y.length===0&&(y.mode=21);break;case 26:if(ie===0)break e;ee[Z++]=y.length,ie--,y.mode=21;break;case 27:if(y.wrap){for(;z<32;){if(V===0)break e;V--,L|=O[M++]<<z,z+=8}if(se-=ie,_.total_out+=se,y.total+=se,se&&(_.adler=y.check=y.flags?o(y.check,ee,se,Z-se):l(y.check,ee,se,Z-se)),se=ie,(y.flags?L:g(L))!==y.check){_.msg="incorrect data check",y.mode=30;break}z=L=0}y.mode=28;case 28:if(y.wrap&&y.flags){for(;z<32;){if(V===0)break e;V--,L+=O[M++]<<z,z+=8}if(L!==(4294967295&y.total)){_.msg="incorrect length check",y.mode=30;break}z=L=0}y.mode=29;case 29:H=1;break e;case 30:H=-3;break e;case 31:return-4;case 32:default:return h}return _.next_out=Z,_.avail_out=ie,_.next_in=M,_.avail_in=V,y.hold=L,y.bits=z,(y.wsize||se!==_.avail_out&&y.mode<30&&(y.mode<27||D!==4))&&K(_,_.output,_.next_out,se-_.avail_out)?(y.mode=31,-4):(le-=_.avail_in,se-=_.avail_out,_.total_in+=le,_.total_out+=se,y.total+=se,y.wrap&&se&&(_.adler=y.check=y.flags?o(y.check,ee,se,_.next_out-se):l(y.check,ee,se,_.next_out-se)),_.data_type=y.bits+(y.last?64:0)+(y.mode===12?128:0)+(y.mode===20||y.mode===15?256:0),(le==0&&se===0||D===4)&&H===b&&(H=-5),H)},a.inflateEnd=function(_){if(!_||!_.state)return h;var D=_.state;return D.window&&(D.window=null),_.state=null,b},a.inflateGetHeader=function(_,D){var y;return _&&_.state&&2&(y=_.state).wrap?((y.head=D).done=!1,b):h},a.inflateSetDictionary=function(_,D){var y,O=D.length;return _&&_.state?(y=_.state).wrap!==0&&y.mode!==11?h:y.mode===11&&l(1,D,O,0)!==y.check?-3:K(_,D,O,O)?(y.mode=31,-4):(y.havedict=1,b):h},a.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(s,n,a){var i=s("../utils/common"),l=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],o=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],c=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],f=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];n.exports=function(m,p,b,h,w,d,u,g){var x,j,k,N,P,A,F,R,B,K=g.bits,_=0,D=0,y=0,O=0,ee=0,M=0,Z=0,V=0,ie=0,L=0,z=null,le=0,se=new i.Buf16(16),re=new i.Buf16(16),Ne=null,_e=0;for(_=0;_<=15;_++)se[_]=0;for(D=0;D<h;D++)se[p[b+D]]++;for(ee=K,O=15;1<=O&&se[O]===0;O--);if(O<ee&&(ee=O),O===0)return w[d++]=20971520,w[d++]=20971520,g.bits=1,0;for(y=1;y<O&&se[y]===0;y++);for(ee<y&&(ee=y),_=V=1;_<=15;_++)if(V<<=1,(V-=se[_])<0)return-1;if(0<V&&(m===0||O!==1))return-1;for(re[1]=0,_=1;_<15;_++)re[_+1]=re[_]+se[_];for(D=0;D<h;D++)p[b+D]!==0&&(u[re[p[b+D]]++]=D);if(A=m===0?(z=Ne=u,19):m===1?(z=l,le-=257,Ne=o,_e-=257,256):(z=c,Ne=f,-1),_=y,P=d,Z=D=L=0,k=-1,N=(ie=1<<(M=ee))-1,m===1&&852<ie||m===2&&592<ie)return 1;for(;;){for(F=_-Z,B=u[D]<A?(R=0,u[D]):u[D]>A?(R=Ne[_e+u[D]],z[le+u[D]]):(R=96,0),x=1<<_-Z,y=j=1<<M;w[P+(L>>Z)+(j-=x)]=F<<24|R<<16|B|0,j!==0;);for(x=1<<_-1;L&x;)x>>=1;if(x!==0?(L&=x-1,L+=x):L=0,D++,--se[_]==0){if(_===O)break;_=p[b+u[D]]}if(ee<_&&(L&N)!==k){for(Z===0&&(Z=ee),P+=y,V=1<<(M=_-Z);M+Z<O&&!((V-=se[M+Z])<=0);)M++,V<<=1;if(ie+=1<<M,m===1&&852<ie||m===2&&592<ie)return 1;w[k=L&N]=ee<<24|M<<16|P-d|0}}return L!==0&&(w[P+L]=_-Z<<24|64<<16|0),g.bits=ee,0}},{"../utils/common":41}],51:[function(s,n,a){n.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(s,n,a){var i=s("../utils/common"),l=0,o=1;function c(S){for(var T=S.length;0<=--T;)S[T]=0}var f=0,m=29,p=256,b=p+1+m,h=30,w=19,d=2*b+1,u=15,g=16,x=7,j=256,k=16,N=17,P=18,A=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],F=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],R=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],B=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],K=new Array(2*(b+2));c(K);var _=new Array(2*h);c(_);var D=new Array(512);c(D);var y=new Array(256);c(y);var O=new Array(m);c(O);var ee,M,Z,V=new Array(h);function ie(S,T,W,G,I){this.static_tree=S,this.extra_bits=T,this.extra_base=W,this.elems=G,this.max_length=I,this.has_stree=S&&S.length}function L(S,T){this.dyn_tree=S,this.max_code=0,this.stat_desc=T}function z(S){return S<256?D[S]:D[256+(S>>>7)]}function le(S,T){S.pending_buf[S.pending++]=255&T,S.pending_buf[S.pending++]=T>>>8&255}function se(S,T,W){S.bi_valid>g-W?(S.bi_buf|=T<<S.bi_valid&65535,le(S,S.bi_buf),S.bi_buf=T>>g-S.bi_valid,S.bi_valid+=W-g):(S.bi_buf|=T<<S.bi_valid&65535,S.bi_valid+=W)}function re(S,T,W){se(S,W[2*T],W[2*T+1])}function Ne(S,T){for(var W=0;W|=1&S,S>>>=1,W<<=1,0<--T;);return W>>>1}function _e(S,T,W){var G,I,Q=new Array(u+1),ne=0;for(G=1;G<=u;G++)Q[G]=ne=ne+W[G-1]<<1;for(I=0;I<=T;I++){var te=S[2*I+1];te!==0&&(S[2*I]=Ne(Q[te]++,te))}}function fe(S){var T;for(T=0;T<b;T++)S.dyn_ltree[2*T]=0;for(T=0;T<h;T++)S.dyn_dtree[2*T]=0;for(T=0;T<w;T++)S.bl_tree[2*T]=0;S.dyn_ltree[2*j]=1,S.opt_len=S.static_len=0,S.last_lit=S.matches=0}function me(S){8<S.bi_valid?le(S,S.bi_buf):0<S.bi_valid&&(S.pending_buf[S.pending++]=S.bi_buf),S.bi_buf=0,S.bi_valid=0}function Ce(S,T,W,G){var I=2*T,Q=2*W;return S[I]<S[Q]||S[I]===S[Q]&&G[T]<=G[W]}function je(S,T,W){for(var G=S.heap[W],I=W<<1;I<=S.heap_len&&(I<S.heap_len&&Ce(T,S.heap[I+1],S.heap[I],S.depth)&&I++,!Ce(T,G,S.heap[I],S.depth));)S.heap[W]=S.heap[I],W=I,I<<=1;S.heap[W]=G}function Me(S,T,W){var G,I,Q,ne,te=0;if(S.last_lit!==0)for(;G=S.pending_buf[S.d_buf+2*te]<<8|S.pending_buf[S.d_buf+2*te+1],I=S.pending_buf[S.l_buf+te],te++,G===0?re(S,I,T):(re(S,(Q=y[I])+p+1,T),(ne=A[Q])!==0&&se(S,I-=O[Q],ne),re(S,Q=z(--G),W),(ne=F[Q])!==0&&se(S,G-=V[Q],ne)),te<S.last_lit;);re(S,j,T)}function Pe(S,T){var W,G,I,Q=T.dyn_tree,ne=T.stat_desc.static_tree,te=T.stat_desc.has_stree,de=T.stat_desc.elems,oe=-1;for(S.heap_len=0,S.heap_max=d,W=0;W<de;W++)Q[2*W]!==0?(S.heap[++S.heap_len]=oe=W,S.depth[W]=0):Q[2*W+1]=0;for(;S.heap_len<2;)Q[2*(I=S.heap[++S.heap_len]=oe<2?++oe:0)]=1,S.depth[I]=0,S.opt_len--,te&&(S.static_len-=ne[2*I+1]);for(T.max_code=oe,W=S.heap_len>>1;1<=W;W--)je(S,Q,W);for(I=de;W=S.heap[1],S.heap[1]=S.heap[S.heap_len--],je(S,Q,1),G=S.heap[1],S.heap[--S.heap_max]=W,S.heap[--S.heap_max]=G,Q[2*I]=Q[2*W]+Q[2*G],S.depth[I]=(S.depth[W]>=S.depth[G]?S.depth[W]:S.depth[G])+1,Q[2*W+1]=Q[2*G+1]=I,S.heap[1]=I++,je(S,Q,1),2<=S.heap_len;);S.heap[--S.heap_max]=S.heap[1],function(q,ce){var pe,ge,Te,Y,ue,Re,$e=ce.dyn_tree,jn=ce.max_code,il=ce.stat_desc.static_tree,ol=ce.stat_desc.has_stree,ll=ce.stat_desc.extra_bits,Nn=ce.stat_desc.extra_base,ir=ce.stat_desc.max_length,Nr=0;for(Y=0;Y<=u;Y++)q.bl_count[Y]=0;for($e[2*q.heap[q.heap_max]+1]=0,pe=q.heap_max+1;pe<d;pe++)ir<(Y=$e[2*$e[2*(ge=q.heap[pe])+1]+1]+1)&&(Y=ir,Nr++),$e[2*ge+1]=Y,jn<ge||(q.bl_count[Y]++,ue=0,Nn<=ge&&(ue=ll[ge-Nn]),Re=$e[2*ge],q.opt_len+=Re*(Y+ue),ol&&(q.static_len+=Re*(il[2*ge+1]+ue)));if(Nr!==0){do{for(Y=ir-1;q.bl_count[Y]===0;)Y--;q.bl_count[Y]--,q.bl_count[Y+1]+=2,q.bl_count[ir]--,Nr-=2}while(0<Nr);for(Y=ir;Y!==0;Y--)for(ge=q.bl_count[Y];ge!==0;)jn<(Te=q.heap[--pe])||($e[2*Te+1]!==Y&&(q.opt_len+=(Y-$e[2*Te+1])*$e[2*Te],$e[2*Te+1]=Y),ge--)}}(S,T),_e(Q,oe,S.bl_count)}function v(S,T,W){var G,I,Q=-1,ne=T[1],te=0,de=7,oe=4;for(ne===0&&(de=138,oe=3),T[2*(W+1)+1]=65535,G=0;G<=W;G++)I=ne,ne=T[2*(G+1)+1],++te<de&&I===ne||(te<oe?S.bl_tree[2*I]+=te:I!==0?(I!==Q&&S.bl_tree[2*I]++,S.bl_tree[2*k]++):te<=10?S.bl_tree[2*N]++:S.bl_tree[2*P]++,Q=I,oe=(te=0)===ne?(de=138,3):I===ne?(de=6,3):(de=7,4))}function H(S,T,W){var G,I,Q=-1,ne=T[1],te=0,de=7,oe=4;for(ne===0&&(de=138,oe=3),G=0;G<=W;G++)if(I=ne,ne=T[2*(G+1)+1],!(++te<de&&I===ne)){if(te<oe)for(;re(S,I,S.bl_tree),--te!=0;);else I!==0?(I!==Q&&(re(S,I,S.bl_tree),te--),re(S,k,S.bl_tree),se(S,te-3,2)):te<=10?(re(S,N,S.bl_tree),se(S,te-3,3)):(re(S,P,S.bl_tree),se(S,te-11,7));Q=I,oe=(te=0)===ne?(de=138,3):I===ne?(de=6,3):(de=7,4)}}c(V);var $=!1;function E(S,T,W,G){se(S,(f<<1)+(G?1:0),3),function(I,Q,ne,te){me(I),le(I,ne),le(I,~ne),i.arraySet(I.pending_buf,I.window,Q,ne,I.pending),I.pending+=ne}(S,T,W)}a._tr_init=function(S){$||(function(){var T,W,G,I,Q,ne=new Array(u+1);for(I=G=0;I<m-1;I++)for(O[I]=G,T=0;T<1<<A[I];T++)y[G++]=I;for(y[G-1]=I,I=Q=0;I<16;I++)for(V[I]=Q,T=0;T<1<<F[I];T++)D[Q++]=I;for(Q>>=7;I<h;I++)for(V[I]=Q<<7,T=0;T<1<<F[I]-7;T++)D[256+Q++]=I;for(W=0;W<=u;W++)ne[W]=0;for(T=0;T<=143;)K[2*T+1]=8,T++,ne[8]++;for(;T<=255;)K[2*T+1]=9,T++,ne[9]++;for(;T<=279;)K[2*T+1]=7,T++,ne[7]++;for(;T<=287;)K[2*T+1]=8,T++,ne[8]++;for(_e(K,b+1,ne),T=0;T<h;T++)_[2*T+1]=5,_[2*T]=Ne(T,5);ee=new ie(K,A,p+1,b,u),M=new ie(_,F,0,h,u),Z=new ie(new Array(0),R,0,w,x)}(),$=!0),S.l_desc=new L(S.dyn_ltree,ee),S.d_desc=new L(S.dyn_dtree,M),S.bl_desc=new L(S.bl_tree,Z),S.bi_buf=0,S.bi_valid=0,fe(S)},a._tr_stored_block=E,a._tr_flush_block=function(S,T,W,G){var I,Q,ne=0;0<S.level?(S.strm.data_type===2&&(S.strm.data_type=function(te){var de,oe=4093624447;for(de=0;de<=31;de++,oe>>>=1)if(1&oe&&te.dyn_ltree[2*de]!==0)return l;if(te.dyn_ltree[18]!==0||te.dyn_ltree[20]!==0||te.dyn_ltree[26]!==0)return o;for(de=32;de<p;de++)if(te.dyn_ltree[2*de]!==0)return o;return l}(S)),Pe(S,S.l_desc),Pe(S,S.d_desc),ne=function(te){var de;for(v(te,te.dyn_ltree,te.l_desc.max_code),v(te,te.dyn_dtree,te.d_desc.max_code),Pe(te,te.bl_desc),de=w-1;3<=de&&te.bl_tree[2*B[de]+1]===0;de--);return te.opt_len+=3*(de+1)+5+5+4,de}(S),I=S.opt_len+3+7>>>3,(Q=S.static_len+3+7>>>3)<=I&&(I=Q)):I=Q=W+5,W+4<=I&&T!==-1?E(S,T,W,G):S.strategy===4||Q===I?(se(S,2+(G?1:0),3),Me(S,K,_)):(se(S,4+(G?1:0),3),function(te,de,oe,q){var ce;for(se(te,de-257,5),se(te,oe-1,5),se(te,q-4,4),ce=0;ce<q;ce++)se(te,te.bl_tree[2*B[ce]+1],3);H(te,te.dyn_ltree,de-1),H(te,te.dyn_dtree,oe-1)}(S,S.l_desc.max_code+1,S.d_desc.max_code+1,ne+1),Me(S,S.dyn_ltree,S.dyn_dtree)),fe(S),G&&me(S)},a._tr_tally=function(S,T,W){return S.pending_buf[S.d_buf+2*S.last_lit]=T>>>8&255,S.pending_buf[S.d_buf+2*S.last_lit+1]=255&T,S.pending_buf[S.l_buf+S.last_lit]=255&W,S.last_lit++,T===0?S.dyn_ltree[2*W]++:(S.matches++,T--,S.dyn_ltree[2*(y[W]+p+1)]++,S.dyn_dtree[2*z(T)]++),S.last_lit===S.lit_bufsize-1},a._tr_align=function(S){se(S,2,3),re(S,j,K),function(T){T.bi_valid===16?(le(T,T.bi_buf),T.bi_buf=0,T.bi_valid=0):8<=T.bi_valid&&(T.pending_buf[T.pending++]=255&T.bi_buf,T.bi_buf>>=8,T.bi_valid-=8)}(S)}},{"../utils/common":41}],53:[function(s,n,a){n.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(s,n,a){(function(i){(function(l,o){if(!l.setImmediate){var c,f,m,p,b=1,h={},w=!1,d=l.document,u=Object.getPrototypeOf&&Object.getPrototypeOf(l);u=u&&u.setTimeout?u:l,c={}.toString.call(l.process)==="[object process]"?function(k){process.nextTick(function(){x(k)})}:function(){if(l.postMessage&&!l.importScripts){var k=!0,N=l.onmessage;return l.onmessage=function(){k=!1},l.postMessage("","*"),l.onmessage=N,k}}()?(p="setImmediate$"+Math.random()+"$",l.addEventListener?l.addEventListener("message",j,!1):l.attachEvent("onmessage",j),function(k){l.postMessage(p+k,"*")}):l.MessageChannel?((m=new MessageChannel).port1.onmessage=function(k){x(k.data)},function(k){m.port2.postMessage(k)}):d&&"onreadystatechange"in d.createElement("script")?(f=d.documentElement,function(k){var N=d.createElement("script");N.onreadystatechange=function(){x(k),N.onreadystatechange=null,f.removeChild(N),N=null},f.appendChild(N)}):function(k){setTimeout(x,0,k)},u.setImmediate=function(k){typeof k!="function"&&(k=new Function(""+k));for(var N=new Array(arguments.length-1),P=0;P<N.length;P++)N[P]=arguments[P+1];var A={callback:k,args:N};return h[b]=A,c(b),b++},u.clearImmediate=g}function g(k){delete h[k]}function x(k){if(w)setTimeout(x,0,k);else{var N=h[k];if(N){w=!0;try{(function(P){var A=P.callback,F=P.args;switch(F.length){case 0:A();break;case 1:A(F[0]);break;case 2:A(F[0],F[1]);break;case 3:A(F[0],F[1],F[2]);break;default:A.apply(o,F)}})(N)}finally{g(k),w=!1}}}}function j(k){k.source===l&&typeof k.data=="string"&&k.data.indexOf(p)===0&&x(+k.data.slice(p.length))}})(typeof self>"u"?i===void 0?this:i:self)}).call(this,typeof Cr<"u"?Cr:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})})(al);var gm=al.exports;const ym=Yc(gm);async function vm(t,r){const s=new ym,n=s.folder("deckforge-designs");if(!n)throw new Error("Failed to create ZIP folder");for(let i=0;i<t.length;i++){const l=t[i];r==null||r(i+1,t.length);try{const o=await Sa(l.canvas_data.objects,{scale:3,format:"png",includeBackground:!0}),f=`${l.name.replace(/[^a-z0-9]/gi,"_").toLowerCase()}_${l.id.slice(0,8)}.png`;n.file(f,o)}catch(o){console.error(`Failed to export design ${l.name}:`,o)}}return await s.generateAsync({type:"blob",compression:"DEFLATE",compressionOptions:{level:6}})}function bm(t,r){const s=URL.createObjectURL(t),n=document.createElement("a");n.href=s,n.download=r,document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(s)}const Ut="http://localhost:3000",Pr={async list(){const t=localStorage.getItem("token");return(await Ue.get(`${Ut}/folders`,{headers:{Authorization:`Bearer ${t}`}})).data.folders},async create(t,r){const s=localStorage.getItem("token");return(await Ue.post(`${Ut}/folders`,{name:t,color:r},{headers:{Authorization:`Bearer ${s}`}})).data.folder},async update(t,r){const s=localStorage.getItem("token");return(await Ue.patch(`${Ut}/folders/${t}`,r,{headers:{Authorization:`Bearer ${s}`}})).data.folder},async delete(t){const r=localStorage.getItem("token");await Ue.delete(`${Ut}/folders/${t}`,{headers:{Authorization:`Bearer ${r}`}})},async moveDesign(t,r){const s=localStorage.getItem("token");await Ue.post(`${Ut}/folders/${t}/designs/${r}`,{},{headers:{Authorization:`Bearer ${s}`}})},async removeDesign(t,r){const s=localStorage.getItem("token");await Ue.delete(`${Ut}/folders/${t}/designs/${r}`,{headers:{Authorization:`Bearer ${s}`}})}},ua=["#ccff00","#00ffff","#ff00ff","#ff6600","#00ff00","#ff0000","#0000ff","#ffff00"];function wm({selectedFolder:t,onFolderSelect:r}){const[s,n]=C.useState([]),[a,i]=C.useState(!0),[l,o]=C.useState(!1),[c,f]=C.useState(""),[m,p]=C.useState(null),[b,h]=C.useState("");C.useEffect(()=>{w()},[]);const w=async()=>{i(!0);try{const x=await Pr.list();n(x)}catch(x){console.error("Failed to load folders:",x)}finally{i(!1)}},d=async()=>{var x,j;if(c.trim())try{const k=ua[Math.floor(Math.random()*ua.length)],N=await Pr.create(c.trim(),k);n([...s,N]),f(""),o(!1),Fe({title:" Folder created",description:`${N.name} is ready`})}catch(k){Fe({title:"Failed to create folder",description:((j=(x=k.response)==null?void 0:x.data)==null?void 0:j.error)||"Please try again",variant:"destructive"})}},u=async x=>{if(b.trim())try{const j=await Pr.update(x,{name:b.trim()});n(s.map(k=>k.id===x?j:k)),p(null),Fe({title:" Folder renamed"})}catch{Fe({title:"Failed to rename",variant:"destructive"})}},g=async(x,j)=>{if(confirm(`Delete folder "${j}"? Designs will be moved to "All Designs".`))try{await Pr.delete(x),n(s.filter(k=>k.id!==x)),t===x&&r(null),Fe({title:" Folder deleted"})}catch{Fe({title:"Failed to delete",variant:"destructive"})}};return e.jsxs("div",{className:"w-64 bg-card border-r border-border h-full flex flex-col",children:[e.jsxs("div",{className:"p-3 border-b border-border",children:[e.jsx("h3",{className:"font-display text-xs uppercase tracking-wider mb-3",children:"Folders"}),e.jsxs(X,{size:"sm",variant:"outline",onClick:()=>o(!l),className:"w-full gap-2",children:[e.jsx(Zc,{className:"w-4 h-4"}),"New Folder"]})]}),e.jsx(_t,{className:"flex-1",children:e.jsxs("div",{className:"p-3 space-y-1",children:[e.jsxs("button",{onClick:()=>r(null),className:`w-full flex items-center gap-2 px-3 py-2 text-sm transition-colors ${t===null?"bg-primary/10 text-primary border border-primary":"hover:bg-secondary border border-transparent"}`,children:[e.jsx(Xc,{className:"w-4 h-4"}),e.jsx("span",{className:"flex-1 text-left",children:"All Designs"})]}),l&&e.jsxs("div",{className:"py-2 space-y-2",children:[e.jsx(Ae,{placeholder:"Folder name...",value:c,onChange:x=>f(x.target.value),onKeyDown:x=>{x.key==="Enter"&&d(),x.key==="Escape"&&o(!1)},autoFocus:!0,className:"h-8 text-sm"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(X,{size:"sm",onClick:d,disabled:!c.trim(),className:"flex-1",children:"Create"}),e.jsx(X,{size:"sm",variant:"ghost",onClick:()=>o(!1),children:"Cancel"})]})]}),a&&e.jsx("div",{className:"flex justify-center py-4",children:e.jsx(We,{className:"w-5 h-5 animate-spin text-muted-foreground"})}),s.map(x=>e.jsx("div",{className:`group flex items-center gap-2 px-3 py-2 text-sm transition-colors ${t===x.id?"bg-primary/10 text-primary border border-primary":"hover:bg-secondary border border-transparent"}`,children:m===x.id?e.jsxs("div",{className:"flex-1 flex items-center gap-2",children:[e.jsx(Ae,{value:b,onChange:j=>h(j.target.value),onKeyDown:j=>{j.key==="Enter"&&u(x.id),j.key==="Escape"&&p(null)},className:"h-7 text-sm",autoFocus:!0}),e.jsx(X,{size:"sm",variant:"ghost",onClick:()=>u(x.id),className:"h-7 px-2",children:"Save"})]}):e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:()=>r(x.id),className:"flex-1 flex items-center gap-2",children:[e.jsx(Qc,{className:"w-4 h-4",style:{color:x.color}}),e.jsx("span",{className:"truncate",children:x.name})]}),e.jsxs("div",{className:"opacity-0 group-hover:opacity-100 flex gap-1",children:[e.jsx("button",{onClick:()=>{p(x.id),h(x.name)},className:"p-1 hover:bg-secondary",children:e.jsx($s,{className:"w-3 h-3"})}),e.jsx("button",{onClick:()=>g(x.id,x.name),className:"p-1 hover:bg-destructive/10 text-destructive",children:e.jsx(Pt,{className:"w-3 h-3"})})]})]})},x.id))]})})]})}function jm(){const[t,r]=C.useState([]),[s,n]=C.useState(!0),[a,i]=C.useState(new Set),[l,o]=C.useState(!1),[c,f]=C.useState({current:0,total:0}),[m,p]=C.useState(null),{isAuthenticated:b,logout:h}=gt(),{loadDesign:w,resetCanvas:d}=Ee(),u=qe(),g=m?t.filter(_=>_.folder_id===m):t;C.useEffect(()=>{if(!b){u("/auth");return}x()},[b]);const x=async()=>{n(!0);try{const _=await Or.list();r(_.designs||[])}catch(_){console.error("Failed to load designs:",_)}finally{n(!1)}},j=_=>{w(_.canvas_data),u("/")},k=async(_,D)=>{if(D.stopPropagation(),!!confirm("Delete this design? This cannot be undone."))try{await Or.delete(_),i(y=>{const O=new Set(y);return O.delete(_),O}),await x()}catch(y){console.error("Delete failed:",y),alert("Failed to delete design")}},N=(_,D)=>{D.stopPropagation(),i(y=>{const O=new Set(y);return O.has(_)?O.delete(_):O.add(_),O})},P=()=>{a.size===g.length?i(new Set):i(new Set(g.map(_=>_.id)))},A=async(_,D,y)=>{y.stopPropagation();const O="http://localhost:3000",ee=localStorage.getItem("token");try{await Ue.patch(`${O}/gallery/${_}/visibility`,{is_public:!D},{headers:{Authorization:`Bearer ${ee}`}}),r(M=>M.map(Z=>Z.id===_?{...Z,is_public:!D}:Z)),Fe({title:D?" Design unpublished":" Design published",description:D?"Your design has been removed from the gallery":"Your design is now visible in the public gallery"})}catch(M){console.error("Toggle public failed:",M),Fe({title:"Failed to update visibility",description:"Please try again",variant:"destructive"})}},F=async()=>{const _=t.filter(D=>a.has(D.id));if(_.length===0){Fe({title:"No designs selected",description:"Please select at least one design to export.",variant:"destructive"});return}o(!0),f({current:0,total:_.length});try{const D=await vm(_,(ee,M)=>{f({current:ee,total:M})}),O=`deckforge_designs_${Date.now()}.zip`;bm(D,O),Fe({title:" Batch export complete",description:`${_.length} design${_.length!==1?"s":""} exported successfully.`}),i(new Set)}catch(D){console.error("Batch export failed:",D),Fe({title:"Export failed",description:"Failed to export designs. Please try again.",variant:"destructive"})}finally{o(!1),f({current:0,total:0})}},R=()=>{d(),u("/")},B=async()=>{await h(),u("/auth")};if(!b)return null;const K=a.size>0;return e.jsxs("div",{className:"min-h-screen bg-background flex flex-col",children:[e.jsxs("header",{className:"h-16 border-b border-border flex items-center px-6 bg-card shrink-0",children:[e.jsxs("h1",{className:"font-display text-xl uppercase tracking-widest",children:["My ",e.jsx("span",{className:"text-primary",children:"Designs"})]}),e.jsxs("div",{className:"ml-auto flex items-center gap-4",children:[K&&e.jsxs(e.Fragment,{children:[e.jsxs("span",{className:"text-sm text-muted-foreground",children:[a.size," selected"]}),e.jsx(X,{size:"sm",variant:"outline",onClick:F,disabled:l,className:"gap-2",children:l?e.jsxs(e.Fragment,{children:[e.jsx(We,{className:"w-4 h-4 animate-spin"}),"Exporting ",c.current,"/",c.total]}):e.jsxs(e.Fragment,{children:[e.jsx(lt,{className:"w-4 h-4"}),"Export Selected"]})})]}),e.jsxs(X,{size:"sm",variant:"outline",onClick:R,className:"gap-2",children:[e.jsx(dr,{className:"w-4 h-4"}),"New Design"]}),e.jsx(X,{size:"sm",variant:"ghost",onClick:B,children:"Logout"})]})]}),e.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[e.jsx(wm,{selectedFolder:m,onFolderSelect:p}),e.jsx("div",{className:"flex-1 overflow-auto",children:e.jsx("div",{className:"container mx-auto px-6 py-8",children:s?e.jsx("div",{className:"flex items-center justify-center py-20",children:e.jsx(We,{className:"w-8 h-8 animate-spin text-muted-foreground"})}):g.length===0?e.jsxs("div",{className:"text-center py-20 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-display uppercase tracking-widest mb-2",children:"No Designs Yet"}),e.jsx("p",{className:"text-muted-foreground",children:"Create your first custom deck design!"})]}),e.jsxs(X,{onClick:R,size:"lg",className:"gap-2",children:[e.jsx(dr,{className:"w-5 h-5"}),"Create Design"]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-4 flex items-center gap-3",children:[e.jsx(X,{size:"sm",variant:"outline",onClick:P,className:"gap-2",children:a.size===g.length?e.jsxs(e.Fragment,{children:[e.jsx(Pn,{className:"w-4 h-4"}),"Deselect All"]}):e.jsxs(e.Fragment,{children:[e.jsx(zr,{className:"w-4 h-4"}),"Select All"]})}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[g.length," design",g.length!==1?"s":"",m&&" in folder"]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:g.map(_=>{const D=a.has(_.id);return e.jsxs("div",{className:`group border transition-colors bg-card overflow-hidden cursor-pointer relative ${D?"border-primary ring-2 ring-primary/20":"border-border hover:border-primary"}`,onClick:()=>j(_),children:[e.jsx("div",{className:"absolute top-2 left-2 z-10",onClick:y=>N(_.id,y),children:e.jsx("div",{className:`w-6 h-6 border-2 flex items-center justify-center transition-colors cursor-pointer ${D?"bg-primary border-primary":"bg-background border-border hover:border-primary"}`,children:D&&e.jsx(Pn,{className:"w-5 h-5 text-primary-foreground"})})}),e.jsx("div",{className:"aspect-[32/98] bg-muted flex items-center justify-center overflow-hidden",children:_.thumbnail_url?e.jsx("img",{src:_.thumbnail_url,alt:_.name,className:"w-full h-full object-cover"}):e.jsx("div",{className:"text-muted-foreground text-sm uppercase tracking-widest",children:_.name})}),_.is_public&&e.jsx("div",{className:"absolute top-2 right-2 z-10",children:e.jsxs("div",{className:"bg-primary text-primary-foreground px-2 py-1 rounded text-[10px] uppercase tracking-wider flex items-center gap-1",children:[e.jsx(Tn,{className:"w-3 h-3"}),"Public"]})}),e.jsxs("div",{className:"p-4 space-y-3",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-display text-sm uppercase tracking-widest truncate",children:_.name}),_.description&&e.jsx("p",{className:"text-xs text-muted-foreground truncate mt-1",children:_.description}),e.jsx("p",{className:"text-[10px] text-muted-foreground mt-1 uppercase tracking-widest",children:new Date(_.updated_at).toLocaleDateString()})]}),e.jsx("div",{className:"space-y-2",children:e.jsxs("div",{className:"flex gap-2 opacity-0 group-hover:opacity-100 transition-opacity",children:[e.jsxs(X,{size:"sm",variant:"outline",className:"flex-1 gap-1",onClick:y=>{y.stopPropagation(),j(_)},children:[e.jsx($t,{className:"w-3 h-3"}),"Open"]}),e.jsx(X,{size:"sm",variant:_.is_public?"default":"outline",onClick:y=>A(_.id,_.is_public,y),title:_.is_public?"Make Private":"Publish to Gallery",children:_.is_public?e.jsx(Tn,{className:"w-3 h-3"}):e.jsx(Vs,{className:"w-3 h-3"})}),e.jsx(X,{size:"sm",variant:"destructive",onClick:y=>k(_.id,y),children:e.jsx(Pt,{className:"w-3 h-3"})})]})})]})]},_.id)})})]})})})]})]})}const zs=[{id:"skull-flames",name:"Skull & Flames",description:"Classic skate punk aesthetic with skull and flame stickers",tags:["punk","edgy","classic"],objects:[{type:"shape",shapeType:"rect",x:0,y:0,width:96,height:294,rotation:0,opacity:1,scaleX:1,scaleY:1,fill:"#000000"},{type:"shape",shapeType:"rect",x:0,y:120,width:96,height:54,rotation:0,opacity:1,scaleX:1,scaleY:1,fill:"#ff0000"},{type:"sticker",x:28,y:80,width:40,height:40,rotation:0,opacity:1,scaleX:1,scaleY:1,iconName:"Skull",fill:"#ffffff",strokeWidth:0,solidFill:!0},{type:"sticker",x:10,y:200,width:30,height:30,rotation:-15,opacity:1,scaleX:1,scaleY:1,iconName:"Flame",fill:"#ff4500",strokeWidth:0,solidFill:!0},{type:"sticker",x:56,y:200,width:30,height:30,rotation:15,opacity:1,scaleX:1,scaleY:1,iconName:"Flame",fill:"#ff4500",strokeWidth:0,solidFill:!0}]},{id:"gradient-fade",name:"Gradient Fade",description:"Modern gradient design with smooth color transitions",tags:["modern","gradient","clean"],objects:[{type:"shape",shapeType:"rect",x:0,y:0,width:96,height:294,rotation:0,opacity:1,scaleX:1,scaleY:1,fillType:"linear-gradient",gradientStops:[{offset:0,color:"#667eea"},{offset:.5,color:"#764ba2"},{offset:1,color:"#f093fb"}],gradientAngle:180},{type:"shape",shapeType:"circle",x:23,y:122,width:50,height:50,rotation:0,opacity:1,scaleX:1,scaleY:1,fill:"#ffffff",glow:{enabled:!0,radius:20,color:"#ffffff",intensity:.8}}]},{id:"retro-vinyl",name:"Retro Vinyl",description:"Vintage music-inspired design with record and music icons",tags:["retro","music","vintage"],objects:[{type:"shape",shapeType:"rect",x:0,y:0,width:96,height:294,rotation:0,opacity:1,scaleX:1,scaleY:1,fill:"#f4e8d8"},{type:"shape",shapeType:"rect",x:0,y:140,width:96,height:14,rotation:0,opacity:1,scaleX:1,scaleY:1,fill:"#8b4513"},{type:"sticker",x:23,y:60,width:50,height:50,rotation:0,opacity:1,scaleX:1,scaleY:1,iconName:"Disc",fill:"#2c2c2c",strokeWidth:0,solidFill:!0},{type:"sticker",x:12,y:200,width:25,height:25,rotation:-10,opacity:1,scaleX:1,scaleY:1,iconName:"Music",fill:"#8b4513",strokeWidth:0,solidFill:!0},{type:"sticker",x:59,y:195,width:25,height:25,rotation:10,opacity:1,scaleX:1,scaleY:1,iconName:"Music",fill:"#8b4513",strokeWidth:0,solidFill:!0}]},{id:"neon-lightning",name:"Neon Lightning",description:"Electric neon design with lightning bolts",tags:["neon","electric","bold"],objects:[{type:"shape",shapeType:"rect",x:0,y:0,width:96,height:294,rotation:0,opacity:1,scaleX:1,scaleY:1,fill:"#1a1a2e"},{type:"sticker",x:18,y:90,width:60,height:60,rotation:15,opacity:1,scaleX:1,scaleY:1,iconName:"Zap",fill:"#00ff88",strokeWidth:0,solidFill:!0,glow:{enabled:!0,radius:15,color:"#00ff88",intensity:1}},{type:"sticker",x:8,y:180,width:40,height:40,rotation:-25,opacity:.7,scaleX:1,scaleY:1,iconName:"Zap",fill:"#ff00ff",strokeWidth:0,solidFill:!0,glow:{enabled:!0,radius:12,color:"#ff00ff",intensity:.9}},{type:"sticker",x:48,y:170,width:40,height:40,rotation:30,opacity:.7,scaleX:1,scaleY:1,iconName:"Zap",fill:"#00ddff",strokeWidth:0,solidFill:!0,glow:{enabled:!0,radius:12,color:"#00ddff",intensity:.9}}]},{id:"minimalist-shapes",name:"Minimalist Shapes",description:"Clean geometric design with simple shapes",tags:["minimal","geometric","clean"],objects:[{type:"shape",shapeType:"rect",x:0,y:0,width:96,height:294,rotation:0,opacity:1,scaleX:1,scaleY:1,fill:"#ffffff"},{type:"shape",shapeType:"circle",x:8,y:70,width:80,height:80,rotation:0,opacity:1,scaleX:1,scaleY:1,fill:"#000000"},{type:"sticker",x:28,y:180,width:40,height:40,rotation:0,opacity:1,scaleX:1,scaleY:1,iconName:"Triangle",fill:"#ff0000",strokeWidth:0,solidFill:!0}]},{id:"blank",name:"Blank Canvas",description:"Start from scratch with a clean white deck",tags:["blank","custom"],objects:[{type:"shape",shapeType:"rect",x:0,y:0,width:96,height:294,rotation:0,opacity:1,scaleX:1,scaleY:1,fill:"#ffffff"}]}];function Nm(t){if(!t)return zs;const r=t.toLowerCase();return zs.filter(s=>s.name.toLowerCase().includes(r)||s.description.toLowerCase().includes(r)||s.tags.some(n=>n.toLowerCase().includes(r)))}function km(){const[t,r]=C.useState(""),{loadDesign:s}=Ee(),n=qe(),a=Nm(t),i=l=>{const o=zs.find(c=>c.id===l);o&&(s({objects:o.objects,name:o.name}),n("/"))};return e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsxs("header",{className:"h-16 border-b border-border flex items-center px-6 bg-card",children:[e.jsxs("h1",{className:"font-display text-xl uppercase tracking-widest flex items-center gap-2",children:[e.jsx(Qe,{className:"w-5 h-5 text-primary"}),e.jsx("span",{children:"Templates"})]}),e.jsx("div",{className:"ml-auto flex items-center gap-4",children:e.jsx(X,{size:"sm",variant:"outline",onClick:()=>n("/"),children:"Back to Editor"})})]}),e.jsxs("div",{className:"container mx-auto px-6 py-8",children:[e.jsx("div",{className:"max-w-md mb-8",children:e.jsxs("div",{className:"relative",children:[e.jsx(Ua,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground"}),e.jsx(Ae,{type:"text",placeholder:"Search templates...",value:t,onChange:l=>r(l.target.value),className:"pl-10"})]})}),a.length===0?e.jsx("div",{className:"text-center py-20",children:e.jsx("p",{className:"text-muted-foreground",children:"No templates found"})}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:a.map(l=>e.jsxs("div",{className:"group border border-border hover:border-primary transition-colors bg-card overflow-hidden cursor-pointer",onClick:()=>i(l.id),children:[e.jsxs("div",{className:"aspect-[32/98] bg-muted flex items-center justify-center overflow-hidden relative",children:[l.thumbnail?e.jsx("img",{src:l.thumbnail,alt:l.name,className:"w-full h-full object-cover"}):e.jsxs("div",{className:"text-center p-4",children:[e.jsx(Qe,{className:"w-8 h-8 mx-auto mb-2 text-primary"}),e.jsx("p",{className:"text-xs text-muted-foreground uppercase tracking-widest",children:l.name})]}),e.jsx("div",{className:"absolute inset-0 bg-black/60 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center",children:e.jsx(X,{size:"sm",variant:"default",children:"Use Template"})})]}),e.jsxs("div",{className:"p-4 space-y-2",children:[e.jsx("h3",{className:"font-display text-sm uppercase tracking-widest",children:l.name}),e.jsx("p",{className:"text-xs text-muted-foreground",children:l.description}),e.jsx("div",{className:"flex flex-wrap gap-1 pt-2",children:l.tags.map(o=>e.jsx("span",{className:"px-2 py-0.5 text-[10px] uppercase tracking-wider bg-primary/10 text-primary rounded",children:o},o))})]})]},l.id))})]})]})}const vs="http://localhost:3000";function Cm({designId:t}){const[r,s]=C.useState([]),[n,a]=C.useState(""),[i,l]=C.useState(!0),[o,c]=C.useState(!1),{isAuthenticated:f}=gt();C.useEffect(()=>{m()},[t]);const m=async()=>{l(!0);try{const h=await Ue.get(`${vs}/comments/${t}`);s(h.data.comments||[])}catch(h){console.error("Failed to load comments:",h)}finally{l(!1)}},p=async h=>{var w,d;if(h.preventDefault(),!f){Fe({title:"Login required",description:"Please login to comment",variant:"destructive"});return}if(n.trim()){c(!0);try{const u=localStorage.getItem("token"),g=await Ue.post(`${vs}/comments/${t}`,{content:n},{headers:{Authorization:`Bearer ${u}`}});s([...r,g.data.comment]),a(""),Fe({title:" Comment posted",description:"Your comment has been added"})}catch(u){console.error("Failed to post comment:",u),Fe({title:"Failed to post comment",description:((d=(w=u.response)==null?void 0:w.data)==null?void 0:d.error)||"Please try again",variant:"destructive"})}finally{c(!1)}}},b=async h=>{if(confirm("Delete this comment?"))try{const w=localStorage.getItem("token");await Ue.delete(`${vs}/comments/${h}`,{headers:{Authorization:`Bearer ${w}`}}),s(r.filter(d=>d.id!==h)),Fe({title:" Comment deleted",description:"Your comment has been removed"})}catch(w){console.error("Failed to delete comment:",w),Fe({title:"Failed to delete",description:"Please try again",variant:"destructive"})}};return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Jc,{className:"w-5 h-5"}),e.jsxs("h3",{className:"font-display text-sm uppercase tracking-wider",children:["Comments (",r.length,")"]})]}),f?e.jsxs("form",{onSubmit:p,className:"space-y-2",children:[e.jsx(Ea,{value:n,onChange:h=>a(h.target.value),placeholder:"Add a comment...",className:"min-h-[80px] resize-none",disabled:o}),e.jsx("div",{className:"flex justify-end",children:e.jsx(X,{type:"submit",size:"sm",disabled:!n.trim()||o,className:"gap-2",children:o?e.jsxs(e.Fragment,{children:[e.jsx(We,{className:"w-3 h-3 animate-spin"}),"Posting..."]}):e.jsxs(e.Fragment,{children:[e.jsx(ed,{className:"w-3 h-3"}),"Post Comment"]})})})]}):e.jsx("div",{className:"border border-border p-4 text-center text-sm text-muted-foreground",children:"Please login to comment"}),e.jsx("div",{className:"space-y-3",children:i?e.jsx("div",{className:"flex justify-center py-8",children:e.jsx(We,{className:"w-6 h-6 animate-spin text-muted-foreground"})}):r.length===0?e.jsx("div",{className:"text-center py-8 text-sm text-muted-foreground",children:"No comments yet. Be the first to comment!"}):r.map(h=>e.jsxs("div",{className:"border border-border p-3 space-y-2 bg-secondary/50",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsx("div",{className:"flex-1",children:e.jsx("p",{className:"text-sm whitespace-pre-wrap break-words",children:h.content})}),f&&h.user_id===localStorage.getItem("userId")&&e.jsx(X,{size:"sm",variant:"ghost",onClick:()=>b(h.id),className:"shrink-0",children:e.jsx(Pt,{className:"w-3 h-3"})})]}),e.jsx("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:e.jsx("span",{children:new Date(h.created_at).toLocaleString()})})]},h.id))})]})}const Tr="http://localhost:3000";function _m(){const[t,r]=C.useState([]),[s,n]=C.useState(!0),[a,i]=C.useState("recent"),[l,o]=C.useState(new Set),[c,f]=C.useState(null),{isAuthenticated:m}=gt(),{loadDesign:p}=Ee(),b=qe();C.useEffect(()=>{h()},[a]);const h=async()=>{n(!0);try{const u=await Ue.get(`${Tr}/gallery?sort=${a}&limit=50`);if(r(u.data.designs||[]),m){const g=new Set;for(const x of u.data.designs||[])try{const j=localStorage.getItem("token");(await Ue.get(`${Tr}/gallery/${x.id}/liked`,{headers:{Authorization:`Bearer ${j}`}})).data.liked&&g.add(x.id)}catch{}o(g)}}catch(u){console.error("Failed to load gallery:",u)}finally{n(!1)}},w=async(u,g)=>{var k,N;if(g.stopPropagation(),!m){Fe({title:"Login required",description:"Please login to like designs",variant:"destructive"}),b("/auth");return}const x=localStorage.getItem("token"),j=l.has(u);try{j?(await Ue.delete(`${Tr}/gallery/${u}/like`,{headers:{Authorization:`Bearer ${x}`}}),o(P=>{const A=new Set(P);return A.delete(u),A}),r(P=>P.map(A=>A.id===u?{...A,like_count:A.like_count-1}:A))):(await Ue.post(`${Tr}/gallery/${u}/like`,{},{headers:{Authorization:`Bearer ${x}`}}),o(P=>new Set(P).add(u)),r(P=>P.map(A=>A.id===u?{...A,like_count:A.like_count+1}:A)))}catch(P){console.error("Like failed:",P),Fe({title:"Action failed",description:((N=(k=P.response)==null?void 0:k.data)==null?void 0:N.error)||"Please try again",variant:"destructive"})}},d=(u,g)=>{g.stopPropagation(),p(u.canvas_data),b("/"),Fe({title:" Design loaded",description:"Remix and make it your own!"})};return e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsxs("header",{className:"h-16 border-b border-border flex items-center px-6 bg-card",children:[e.jsxs("h1",{className:"font-display text-xl uppercase tracking-widest",children:["Design ",e.jsx("span",{className:"text-primary",children:"Gallery"})]}),e.jsxs("div",{className:"ml-auto flex items-center gap-4",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(X,{size:"sm",variant:a==="recent"?"default":"outline",onClick:()=>i("recent"),className:"gap-2",children:[e.jsx(Ws,{className:"w-4 h-4"}),"Recent"]}),e.jsxs(X,{size:"sm",variant:a==="popular"?"default":"outline",onClick:()=>i("popular"),className:"gap-2",children:[e.jsx(Gs,{className:"w-4 h-4"}),"Popular"]}),e.jsxs(X,{size:"sm",variant:a==="liked"?"default":"outline",onClick:()=>i("liked"),className:"gap-2",children:[e.jsx(td,{className:"w-4 h-4"}),"Most Liked"]})]}),e.jsx(X,{size:"sm",variant:"outline",onClick:()=>b("/"),children:"Create Design"}),!m&&e.jsx(X,{size:"sm",variant:"ghost",onClick:()=>b("/auth"),children:"Login"})]})]}),e.jsx("div",{className:"container mx-auto px-6 py-8",children:s?e.jsx("div",{className:"flex items-center justify-center py-20",children:e.jsx(We,{className:"w-8 h-8 animate-spin text-muted-foreground"})}):t.length===0?e.jsxs("div",{className:"text-center py-20 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-display uppercase tracking-widest mb-2",children:"No Public Designs Yet"}),e.jsx("p",{className:"text-muted-foreground",children:"Be the first to share a design with the community!"})]}),e.jsx(X,{onClick:()=>b("/"),size:"lg",children:"Create & Share"})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"mb-6",children:e.jsxs("p",{className:"text-sm text-muted-foreground",children:[t.length," design",t.length!==1?"s":"","  Community creations"]})}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:t.map(u=>{const g=l.has(u.id);return e.jsxs("div",{className:"group border border-border hover:border-primary transition-colors bg-card overflow-hidden cursor-pointer",onClick:()=>f(u),children:[e.jsxs("div",{className:"aspect-[32/98] bg-muted flex items-center justify-center overflow-hidden relative",children:[u.thumbnail_url?e.jsx("img",{src:u.thumbnail_url,alt:u.name,className:"w-full h-full object-cover"}):e.jsx("div",{className:"text-muted-foreground text-sm uppercase tracking-widest",children:u.name}),e.jsxs("div",{className:"absolute bottom-2 right-2 flex gap-2",children:[e.jsxs("div",{className:"bg-black/80 backdrop-blur-sm px-2 py-1 rounded text-xs text-white flex items-center gap-1",children:[e.jsx($t,{className:"w-3 h-3"}),u.view_count]}),e.jsxs("div",{className:"bg-black/80 backdrop-blur-sm px-2 py-1 rounded text-xs text-white flex items-center gap-1",children:[e.jsx(at,{className:"w-3 h-3"}),u.like_count]})]})]}),e.jsxs("div",{className:"p-4 space-y-3",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-display text-sm uppercase tracking-widest truncate",children:u.name}),u.description&&e.jsx("p",{className:"text-xs text-muted-foreground truncate mt-1",children:u.description}),e.jsx("p",{className:"text-[10px] text-muted-foreground mt-1 uppercase tracking-widest",children:new Date(u.created_at).toLocaleDateString()})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(X,{size:"sm",variant:"outline",className:"flex-1 gap-1",onClick:x=>d(u,x),children:[e.jsx(Rn,{className:"w-3 h-3"}),"Remix"]}),e.jsx(X,{size:"sm",variant:g?"default":"outline",onClick:x=>w(u.id,x),className:g?"text-red-500":"",children:e.jsx(at,{className:`w-3 h-3 ${g?"fill-current":""}`})})]})]})]},u.id)})})]})}),c&&e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[e.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm",onClick:()=>f(null)}),e.jsxs("div",{className:"relative bg-card border-2 border-border shadow-xl w-full max-w-4xl max-h-[90vh] overflow-auto",children:[e.jsxs("div",{className:"sticky top-0 bg-card border-b border-border p-4 flex items-center justify-between z-10",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"font-display text-lg uppercase tracking-wider",children:c.name}),c.description&&e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:c.description})]}),e.jsx("button",{onClick:()=>f(null),className:"text-muted-foreground hover:text-foreground transition-colors",children:e.jsx(vr,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsx("div",{className:"aspect-[32/98] bg-muted flex items-center justify-center overflow-hidden border border-border",children:c.thumbnail_url?e.jsx("img",{src:c.thumbnail_url,alt:c.name,className:"w-full h-full object-cover"}):e.jsx("div",{className:"text-muted-foreground text-sm uppercase tracking-widest",children:c.name})}),e.jsxs("div",{className:"flex items-center justify-between pb-6 border-b border-border",children:[e.jsxs("div",{className:"flex gap-4 text-sm text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx($t,{className:"w-4 h-4"}),c.view_count," views"]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(at,{className:"w-4 h-4"}),c.like_count," likes"]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(X,{size:"sm",variant:"outline",onClick:u=>{u.stopPropagation(),d(c,u),f(null)},className:"gap-2",children:[e.jsx(Rn,{className:"w-4 h-4"}),"Remix"]}),e.jsx(X,{size:"sm",variant:l.has(c.id)?"default":"outline",onClick:u=>w(c.id,u),children:e.jsx(at,{className:`w-4 h-4 ${l.has(c.id)?"fill-current":""}`})})]})]}),e.jsx(Cm,{designId:c.id})]})]})]})]})}function Sm(){const{token:t}=Va(),r=qe(),{loadDesign:s}=Ee(),[n,a]=C.useState(null),[i,l]=C.useState(!0),[o,c]=C.useState(null);C.useEffect(()=>{t&&f()},[t]);const f=async()=>{var m,p;if(t){l(!0),c(null);try{const b=await Al.getSharedDesign(t);a(b),s(b.canvas_data)}catch(b){console.error("Failed to load shared design:",b),c(((p=(m=b.response)==null?void 0:m.data)==null?void 0:p.error)||"Failed to load shared design")}finally{l(!1)}}};return i?e.jsx("div",{className:"h-screen w-screen flex items-center justify-center bg-background",children:e.jsxs("div",{className:"text-center space-y-3",children:[e.jsx(We,{className:"w-12 h-12 mx-auto animate-spin text-primary"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Loading shared design..."})]})}):o||!n?e.jsx("div",{className:"h-screen w-screen flex items-center justify-center bg-background",children:e.jsxs("div",{className:"text-center space-y-4 max-w-md",children:[e.jsx(rd,{className:"w-12 h-12 mx-auto text-destructive"}),e.jsx("h2",{className:"font-display text-xl uppercase tracking-wider",children:"Design Not Found"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:o||"This shared design link may have been revoked or does not exist."}),e.jsxs(X,{onClick:()=>r("/"),className:"gap-2",children:[e.jsx(sd,{className:"w-4 h-4"}),"Go to DeckForge"]})]})}):e.jsxs("div",{className:"h-screen w-screen flex flex-col bg-background overflow-hidden",children:[e.jsxs("header",{className:"h-12 border-b border-border flex items-center px-4 bg-card shrink-0",children:[e.jsxs("h1",{className:"font-display text-lg uppercase tracking-widest text-foreground",children:["Deck",e.jsx("span",{className:"text-primary",children:"Forge"})]}),e.jsx("div",{className:"ml-4 flex items-center gap-2",children:e.jsx("span",{className:"tag-brutal",children:"Shared"})}),e.jsxs("div",{className:"ml-auto flex items-center gap-3",children:[e.jsxs("div",{className:"text-right hidden sm:block",children:[e.jsx("h2",{className:"text-sm font-medium",children:n.name}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["View only  Created ",new Date(n.created_at).toLocaleDateString()]})]}),e.jsx(X,{size:"sm",variant:"outline",onClick:()=>r("/"),className:"gap-2",children:"Create Your Own"})]})]}),e.jsx("div",{className:"flex-1 flex overflow-hidden",children:e.jsx(bs,{})}),e.jsx("footer",{className:"h-10 border-t border-border flex items-center justify-center px-4 bg-card shrink-0",children:e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Made with ",e.jsx("span",{className:"text-primary",children:"DeckForge"}),"  Fingerboard Graphics Editor"]})})]})}const ot={async browseDesigns(t){let r=we.from("marketplace_designs").select(`
        *,
        designer:designer_profiles!inner(bio, verified)
      `).eq("published",!0);t.category&&t.category!=="all"&&(r=r.eq("category",t.category)),t.search&&(r=r.or(`title.ilike.%${t.search}%,description.ilike.%${t.search}%`)),t.priceMin!==void 0&&(r=r.gte("price",t.priceMin)),t.priceMax!==void 0&&(r=r.lte("price",t.priceMax)),t.tags&&t.tags.length>0&&(r=r.contains("tags",t.tags)),t.sortBy==="newest"?r=r.order("created_at",{ascending:!1}):t.sortBy==="popular"?r=r.order("downloads",{ascending:!1}):t.sortBy==="trending"&&(r=r.gte("created_at",new Date(Date.now()-7*24*60*60*1e3).toISOString()).order("downloads",{ascending:!1})),r=r.range(t.offset||0,(t.offset||0)+(t.limit||20)-1);const{data:s,error:n}=await r;if(n)throw n;return s},async getDesign(t){const{data:r,error:s}=await we.from("marketplace_designs").select(`
        *,
        designer:designer_profiles!inner(bio, verified)
      `).eq("id",t).single();if(s)throw s;await we.rpc("increment_views",{design_id:t});const{data:n}=await we.auth.getSession();if(n.session){const{data:a}=await we.from("marketplace_favorites").select("design_id").eq("user_id",n.session.user.id).eq("design_id",t).single();r.is_favorited=!!a;const{data:i}=await we.from("marketplace_purchases").select("design_id").eq("buyer_id",n.session.user.id).eq("design_id",t).single();r.is_purchased=!!i}return r},async uploadDesign(t){const{data:r}=await we.auth.getSession();if(!r.session)throw new Error("Not authenticated");const n=`${r.session.user.id}/${Date.now()}.deckforge`,{data:a,error:i}=await we.storage.from("marketplace-designs").upload(n,t.file);if(i)throw i;const o=`${r.session.user.id}/${Date.now()}_thumb.png`,{data:c,error:f}=await we.storage.from("marketplace-designs").upload(o,t.thumbnail);if(f)throw f;const{data:{publicUrl:m}}=we.storage.from("marketplace-designs").getPublicUrl(n),{data:{publicUrl:p}}=we.storage.from("marketplace-designs").getPublicUrl(o),{data:b,error:h}=await we.from("marketplace_designs").insert({user_id:r.session.user.id,title:t.title,description:t.description,file_url:m,thumbnail_url:p,price:t.price,license_type:t.license_type,tags:t.tags,category:t.category,published:!0}).select().single();if(h)throw h;return b},async purchaseDesign(t){const{data:r}=await we.auth.getSession();if(!r.session)throw new Error("Not authenticated");const{data:s,error:n}=await we.from("marketplace_designs").select("price, user_id").eq("id",t).single();if(n)throw n;if(s.user_id===r.session.user.id)throw new Error("Cannot purchase your own design");const{data:a}=await we.from("marketplace_purchases").select("id").eq("buyer_id",r.session.user.id).eq("design_id",t).single();if(a)throw new Error("Already purchased");const{data:i,error:l}=await we.from("marketplace_purchases").insert({design_id:t,buyer_id:r.session.user.id,price_paid:s.price}).select().single();if(l)throw l;return i},async getMyPurchases(){const{data:t}=await we.auth.getSession();if(!t.session)throw new Error("Not authenticated");const{data:r,error:s}=await we.from("marketplace_purchases").select(`
        *,
        design:marketplace_designs(*)
      `).eq("buyer_id",t.session.user.id).order("purchased_at",{ascending:!1});if(s)throw s;return r},async toggleFavorite(t){const{data:r}=await we.auth.getSession();if(!r.session)throw new Error("Not authenticated");const{data:s}=await we.from("marketplace_favorites").select("design_id").eq("user_id",r.session.user.id).eq("design_id",t).single();if(s){const{error:n}=await we.from("marketplace_favorites").delete().eq("user_id",r.session.user.id).eq("design_id",t);if(n)throw n;return!1}else{const{error:n}=await we.from("marketplace_favorites").insert({user_id:r.session.user.id,design_id:t});if(n)throw n;return!0}},async getDesignerProfile(t){const{data:r,error:s}=await we.from("designer_profiles").select("*").eq("user_id",t).single();if(s)throw s;return r},async updateDesignerProfile(t){const{data:r}=await we.auth.getSession();if(!r.session)throw new Error("Not authenticated");const{data:s}=await we.from("designer_profiles").select("id").eq("user_id",r.session.user.id).single();if(s){const{data:n,error:a}=await we.from("designer_profiles").update(t).eq("user_id",r.session.user.id).select().single();if(a)throw a;return n}else{const{data:n,error:a}=await we.from("designer_profiles").insert({user_id:r.session.user.id,...t}).select().single();if(a)throw a;return n}},async getDesignerDesigns(t){const{data:r,error:s}=await we.from("marketplace_designs").select("*").eq("user_id",t).eq("published",!0).order("created_at",{ascending:!1});if(s)throw s;return r}};function Em(){const t=qe(),[r,s]=C.useState([]),[n,a]=C.useState(!0),[i,l]=C.useState(""),[o,c]=C.useState("all"),[f,m]=C.useState("trending"),[p,b]=C.useState("all");C.useEffect(()=>{h()},[o,f,p]);const h=async()=>{a(!0);try{const u={category:o!=="all"?o:void 0,sortBy:f,limit:50};p==="free"?(u.priceMin=0,u.priceMax=0):p==="paid"&&(u.priceMin=.01),i&&(u.search=i);const g=await ot.browseDesigns(u);s(g)}catch(u){J.error("Failed to load designs"),console.error(u)}finally{a(!1)}},w=u=>{u.preventDefault(),h()},d=[{value:"all",label:"All",icon:""},{value:"street",label:"Street",icon:""},{value:"edgy",label:"Edgy",icon:""},{value:"retro",label:"Retro",icon:""},{value:"minimal",label:"Minimal",icon:""},{value:"pro",label:"Pro",icon:""}];return e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx("div",{className:"border-b border-border bg-card",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-foreground",children:"Design Marketplace"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Discover and download custom fingerboard graphics"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(X,{onClick:()=>t("/marketplace/dashboard"),variant:"outline",className:"gap-2",children:[e.jsx(Gs,{className:"w-4 h-4"}),"Dashboard"]}),e.jsxs(X,{onClick:()=>t("/marketplace/upload"),className:"gap-2",children:[e.jsx(Qe,{className:"w-4 h-4"}),"Upload Design"]})]})]}),e.jsx("form",{onSubmit:w,className:"mb-4",children:e.jsxs("div",{className:"relative",children:[e.jsx(Ua,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-muted-foreground"}),e.jsx(Ae,{type:"text",placeholder:"Search designs...",value:i,onChange:u=>l(u.target.value),className:"pl-10"})]})}),e.jsxs("div",{className:"flex flex-wrap gap-4 items-center",children:[e.jsx("div",{className:"flex gap-2 flex-wrap",children:d.map(u=>e.jsxs("button",{onClick:()=>c(u.value),className:`px-3 py-1.5 rounded-lg text-sm font-medium transition-colors flex items-center gap-2 ${o===u.value?"bg-primary text-primary-foreground":"bg-secondary text-secondary-foreground hover:bg-secondary/80"}`,children:[e.jsx("span",{children:u.icon}),u.label]},u.value))}),e.jsxs("div",{className:"flex items-center gap-2 ml-auto",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Sort:"}),e.jsxs("select",{value:f,onChange:u=>m(u.target.value),className:"px-3 py-1.5 rounded-lg text-sm bg-secondary border-border",children:[e.jsx("option",{value:"trending",children:" Trending"}),e.jsx("option",{value:"newest",children:" Newest"}),e.jsx("option",{value:"popular",children:" Popular"})]})]}),e.jsxs("select",{value:p,onChange:u=>b(u.target.value),className:"px-3 py-1.5 rounded-lg text-sm bg-secondary border-border",children:[e.jsx("option",{value:"all",children:"All Prices"}),e.jsx("option",{value:"free",children:"Free"}),e.jsx("option",{value:"paid",children:"Paid"})]})]})]})}),e.jsx("div",{className:"max-w-7xl mx-auto px-4 py-8",children:n?e.jsxs("div",{className:"text-center py-20",children:[e.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-primary"}),e.jsx("p",{className:"mt-4 text-muted-foreground",children:"Loading designs..."})]}):r.length===0?e.jsxs("div",{className:"text-center py-20",children:[e.jsx("p",{className:"text-lg text-muted-foreground",children:"No designs found"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:"Try adjusting your filters"})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:r.map(u=>e.jsx(Am,{design:u},u.id))})})]})}function Am({design:t}){const r=qe(),[s,n]=C.useState(t.is_favorited||!1),a=async i=>{i.stopPropagation();try{const l=await ot.toggleFavorite(t.id);n(l),J.success(l?"Added to favorites":"Removed from favorites")}catch(l){J.error(l.message||"Failed to toggle favorite")}};return e.jsxs("div",{onClick:()=>r(`/marketplace/design/${t.id}`),className:"group border border-border rounded-lg overflow-hidden hover:shadow-lg transition-all cursor-pointer bg-card",children:[e.jsxs("div",{className:"aspect-[3/8] bg-gradient-to-br from-muted to-muted/50 relative",children:[t.thumbnail_url?e.jsx("img",{src:t.thumbnail_url,alt:t.title,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center text-6xl",children:""}),e.jsx("button",{onClick:a,className:"absolute top-2 right-2 w-8 h-8 rounded-full bg-background/80 backdrop-blur-sm flex items-center justify-center hover:bg-background transition-colors",children:e.jsx(at,{className:`w-4 h-4 ${s?"fill-red-500 text-red-500":"text-foreground"}`})}),t.featured_until&&new Date(t.featured_until)>new Date&&e.jsxs("div",{className:"absolute top-2 left-2 bg-yellow-400 text-yellow-900 px-2 py-1 rounded-full flex items-center gap-1 text-xs font-bold",children:[e.jsx(Qe,{className:"w-3 h-3"}),"Featured"]})]}),e.jsxs("div",{className:"p-4",children:[e.jsx("h3",{className:"font-bold text-foreground group-hover:text-primary transition-colors truncate",children:t.title}),t.description&&e.jsx("p",{className:"text-sm text-muted-foreground mt-1 line-clamp-2",children:t.description}),e.jsxs("div",{className:"flex items-center gap-3 mt-3 text-xs text-muted-foreground",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(lt,{className:"w-3 h-3"}),t.downloads]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(at,{className:"w-3 h-3"}),t.favorites]})]}),e.jsxs("div",{className:"flex items-center justify-between mt-4 pt-4 border-t border-border",children:[t.price===0?e.jsx("span",{className:"text-sm font-bold text-green-600",children:"FREE"}):e.jsxs("span",{className:"text-sm font-bold text-foreground flex items-center gap-1",children:[e.jsx(qs,{className:"w-4 h-4"}),t.price.toFixed(2)]}),t.designer&&t.designer.verified&&e.jsx("span",{className:"text-xs bg-blue-500/10 text-blue-500 px-2 py-1 rounded-full font-medium",children:"Verified"})]})]})]})}function Pm(){var g,x;const{id:t}=Va(),r=qe(),{isAuthenticated:s}=gt(),[n,a]=C.useState(null),[i,l]=C.useState(!0),[o,c]=C.useState(!1),[f,m]=C.useState(!1);C.useEffect(()=>{p()},[t]);const p=async()=>{if(t){l(!0);try{const j=await ot.getDesign(t);a(j),m(j.is_favorited||!1)}catch(j){J.error("Failed to load design"),console.error(j)}finally{l(!1)}}},b=async()=>{if(!s){J.error("Please sign in to favorite designs"),r("/auth");return}try{const j=await ot.toggleFavorite(t);m(j),J.success(j?"Added to favorites":"Removed from favorites"),n&&a({...n,favorites:j?n.favorites+1:n.favorites-1})}catch(j){J.error(j.message||"Failed to toggle favorite")}},h=async()=>{if(!s){J.error("Please sign in to purchase"),r("/auth");return}if(n){if(n.price===0){w();return}c(!0);try{await ot.purchaseDesign(t),J.success("Purchase successful! Downloading now..."),w(),p()}catch(j){J.error(j.message||"Purchase failed")}finally{c(!1)}}},w=()=>{if(!n)return;const j=document.createElement("a");j.href=n.file_url,j.download=`${n.title}.deckforge`,document.body.appendChild(j),j.click(),document.body.removeChild(j),J.success("Design downloaded!")},d=()=>{n&&J.info("Opening in editor...",{description:"This feature is coming soon!"})},u=()=>{navigator.share?navigator.share({title:n==null?void 0:n.title,text:(n==null?void 0:n.description)||"",url:window.location.href}):(navigator.clipboard.writeText(window.location.href),J.success("Link copied to clipboard!"))};return i?e.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:e.jsx(We,{className:"w-8 h-8 animate-spin text-primary"})}):n?e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx("div",{className:"border-b border-border bg-card",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 py-4",children:e.jsx(X,{variant:"ghost",onClick:()=>r("/marketplace"),className:"mb-4",children:" Back to Marketplace"})})}),e.jsx("div",{className:"max-w-7xl mx-auto px-4 py-8",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs("div",{className:"aspect-[3/8] bg-gradient-to-br from-muted to-muted/50 rounded-lg overflow-hidden relative",children:[n.thumbnail_url?e.jsx("img",{src:n.thumbnail_url,alt:n.title,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center text-8xl",children:""}),n.featured_until&&new Date(n.featured_until)>new Date&&e.jsxs("div",{className:"absolute top-4 left-4 bg-yellow-400 text-yellow-900 px-3 py-1.5 rounded-full flex items-center gap-2 text-sm font-bold",children:[e.jsx(Hs,{className:"w-4 h-4 fill-current"}),"Featured"]})]}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-foreground",children:n.title}),e.jsxs("div",{className:"flex items-center gap-4 mt-3 text-sm text-muted-foreground",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx($t,{className:"w-4 h-4"}),n.views," views"]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(lt,{className:"w-4 h-4"}),n.downloads," downloads"]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(at,{className:"w-4 h-4"}),n.favorites," favorites"]})]}),n.description&&e.jsx("p",{className:"text-muted-foreground mt-4 whitespace-pre-wrap",children:n.description})]}),n.tags&&n.tags.length>0&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-foreground mb-2",children:"Tags"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:n.tags.map(j=>e.jsx("span",{className:"px-3 py-1 rounded-full bg-secondary text-secondary-foreground text-sm",children:j},j))})]}),e.jsxs("div",{className:"border border-border rounded-lg p-4 bg-card",children:[e.jsx("h3",{className:"text-sm font-semibold text-foreground mb-2",children:"License"}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[n.license_type==="personal"&&e.jsx("p",{children:"Personal use only. Cannot be used for commercial purposes."}),n.license_type==="commercial"&&e.jsx("p",{children:"Commercial use allowed. Can be used for business purposes."}),n.license_type==="unlimited"&&e.jsx("p",{children:"Unlimited use. Use however you want, including resale."})]})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"border border-border rounded-lg p-6 bg-card sticky top-4",children:[e.jsxs("div",{className:"mb-6",children:[n.price===0?e.jsx("div",{className:"text-3xl font-bold text-green-600",children:"FREE"}):e.jsxs("div",{className:"flex items-baseline gap-2",children:[e.jsxs("span",{className:"text-3xl font-bold text-foreground",children:["$",n.price.toFixed(2)]}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"USD"})]}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[n.license_type.charAt(0).toUpperCase()+n.license_type.slice(1)," License"]})]}),e.jsxs("div",{className:"space-y-3",children:[n.is_purchased?e.jsxs(e.Fragment,{children:[e.jsxs(X,{onClick:w,className:"w-full gap-2",size:"lg",children:[e.jsx(lt,{className:"w-4 h-4"}),"Download Again"]}),e.jsxs(X,{onClick:d,variant:"outline",className:"w-full gap-2",size:"lg",children:[e.jsx(nd,{className:"w-4 h-4"}),"Open in Editor"]})]}):e.jsxs(e.Fragment,{children:[e.jsx(X,{onClick:h,className:"w-full gap-2",size:"lg",disabled:o,children:o?e.jsxs(e.Fragment,{children:[e.jsx(We,{className:"w-4 h-4 animate-spin"}),"Processing..."]}):e.jsx(e.Fragment,{children:n.price===0?e.jsxs(e.Fragment,{children:[e.jsx(lt,{className:"w-4 h-4"}),"Download Free"]}):e.jsxs(e.Fragment,{children:[e.jsx(ad,{className:"w-4 h-4"}),"Purchase & Download"]})})}),e.jsxs(X,{onClick:b,variant:"outline",className:"w-full gap-2",size:"lg",children:[e.jsx(at,{className:`w-4 h-4 ${f?"fill-red-500 text-red-500":""}`}),f?"Favorited":"Add to Favorites"]})]}),e.jsxs(X,{onClick:u,variant:"ghost",className:"w-full gap-2",size:"sm",children:[e.jsx(Ba,{className:"w-4 h-4"}),"Share"]})]})]}),n.designer&&e.jsxs("div",{className:"border border-border rounded-lg p-4 bg-card",children:[e.jsx("h3",{className:"text-sm font-semibold text-foreground mb-3",children:"Designer"}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-gradient-to-br from-primary to-primary/50 flex items-center justify-center text-xl font-bold text-primary-foreground",children:((x=(g=n.designer.email)==null?void 0:g[0])==null?void 0:x.toUpperCase())||"D"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium text-foreground truncate",children:n.designer.email}),n.designer.verified&&e.jsx("span",{className:"text-xs bg-blue-500/10 text-blue-500 px-2 py-0.5 rounded-full font-medium",children:"Verified"})]}),n.designer.bio&&e.jsx("p",{className:"text-sm text-muted-foreground mt-1 line-clamp-2",children:n.designer.bio})]})]}),e.jsx(X,{onClick:()=>r(`/marketplace/designer/${n.user_id}`),variant:"outline",className:"w-full mt-4",size:"sm",children:"View Profile"})]}),e.jsxs("div",{className:"border border-border rounded-lg p-4 bg-card",children:[e.jsx("h3",{className:"text-sm font-semibold text-foreground mb-2",children:"Category"}),e.jsx("span",{className:"inline-block px-3 py-1.5 rounded-lg bg-primary/10 text-primary text-sm font-medium",children:n.category.charAt(0).toUpperCase()+n.category.slice(1)})]})]})]})})]}):e.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-2xl font-bold text-foreground",children:"Design not found"}),e.jsx(X,{onClick:()=>r("/marketplace"),className:"mt-4",children:"Back to Marketplace"})]})})}function Tm(){const t=qe(),{isAuthenticated:r}=gt(),[s,n]=C.useState(!1),[a,i]=C.useState(""),[l,o]=C.useState(""),[c,f]=C.useState("0"),[m,p]=C.useState("personal"),[b,h]=C.useState("street"),[w,d]=C.useState(""),[u,g]=C.useState(null),[x,j]=C.useState(null),k=A=>{var R;const F=(R=A.target.files)==null?void 0:R[0];if(F){if(!F.name.endsWith(".deckforge")){J.error("Please upload a .deckforge file");return}g(F)}},N=A=>{var R;const F=(R=A.target.files)==null?void 0:R[0];if(F){if(!F.type.startsWith("image/")){J.error("Please upload an image file");return}j(F)}},P=async A=>{if(A.preventDefault(),!r){J.error("Please sign in to upload designs"),t("/auth");return}if(!a.trim()){J.error("Please enter a title");return}if(!u){J.error("Please upload a design file");return}if(!x){J.error("Please upload a thumbnail image");return}const F=parseFloat(c);if(isNaN(F)||F<0){J.error("Please enter a valid price");return}if(F>100){J.error("Maximum price is $100");return}n(!0);try{const R=w.split(",").map(B=>B.trim()).filter(B=>B.length>0);await ot.uploadDesign({title:a.trim(),description:l.trim(),file:u,thumbnail:x,price:F,license_type:m,tags:R,category:b}),J.success("Design uploaded successfully!"),t("/marketplace")}catch(R){J.error(R.message||"Failed to upload design"),console.error(R)}finally{n(!1)}};return e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx("div",{className:"border-b border-border bg-card",children:e.jsxs("div",{className:"max-w-3xl mx-auto px-4 py-6",children:[e.jsx(X,{variant:"ghost",onClick:()=>t("/marketplace"),className:"mb-4",children:" Back to Marketplace"}),e.jsx("h1",{className:"text-3xl font-bold text-foreground",children:"Upload Design"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Share your design with the community"})]})}),e.jsx("div",{className:"max-w-3xl mx-auto px-4 py-8",children:e.jsxs("form",{onSubmit:P,className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(ae,{htmlFor:"title",children:"Title *"}),e.jsx(Ae,{id:"title",placeholder:"My Awesome Deck Design",value:a,onChange:A=>i(A.target.value),maxLength:100}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[a.length,"/100 characters"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(ae,{htmlFor:"description",children:"Description"}),e.jsx(Ea,{id:"description",placeholder:"Tell people about your design...",value:l,onChange:A=>o(A.target.value),rows:4,maxLength:500}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[l.length,"/500 characters"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(ae,{htmlFor:"design-file",children:"Design File (.deckforge) *"}),e.jsxs("div",{className:"border-2 border-dashed border-border rounded-lg p-6 hover:border-primary transition-colors",children:[e.jsx("input",{type:"file",id:"design-file",accept:".deckforge",onChange:k,className:"hidden"}),e.jsxs("label",{htmlFor:"design-file",className:"flex flex-col items-center cursor-pointer",children:[e.jsx(Fr,{className:"w-8 h-8 text-muted-foreground mb-2"}),u?e.jsx("p",{className:"text-sm text-foreground font-medium",children:u.name}):e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-sm text-foreground font-medium",children:"Click to upload design file"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:".deckforge file from DeckForge editor"})]})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(ae,{htmlFor:"thumbnail",children:"Preview Image *"}),e.jsxs("div",{className:"border-2 border-dashed border-border rounded-lg p-6 hover:border-primary transition-colors",children:[e.jsx("input",{type:"file",id:"thumbnail",accept:"image/png,image/jpeg,image/jpg",onChange:N,className:"hidden"}),e.jsxs("label",{htmlFor:"thumbnail",className:"flex flex-col items-center cursor-pointer",children:[e.jsx(Us,{className:"w-8 h-8 text-muted-foreground mb-2"}),x?e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-sm text-foreground font-medium",children:x.name}),e.jsx("img",{src:URL.createObjectURL(x),alt:"Preview",className:"mt-4 max-h-48 rounded-lg"})]}):e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-sm text-foreground font-medium",children:"Click to upload preview image"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"PNG or JPG, recommended 750x2450px"})]})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(ae,{htmlFor:"category",children:"Category *"}),e.jsxs("select",{id:"category",value:b,onChange:A=>h(A.target.value),className:"w-full h-10 px-3 rounded-md border border-border bg-background",children:[e.jsx("option",{value:"street",children:"Street"}),e.jsx("option",{value:"edgy",children:"Edgy"}),e.jsx("option",{value:"retro",children:"Retro"}),e.jsx("option",{value:"minimal",children:"Minimal"}),e.jsx("option",{value:"pro",children:"Pro"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(ae,{htmlFor:"tags",children:"Tags"}),e.jsx(Ae,{id:"tags",placeholder:"graffiti, urban, colorful (comma separated)",value:w,onChange:A=>d(A.target.value)}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Separate tags with commas. Max 10 tags."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(ae,{htmlFor:"price",children:"Price (USD) *"}),e.jsxs("div",{className:"relative",children:[e.jsx(qs,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground"}),e.jsx(Ae,{id:"price",type:"number",step:"0.01",min:"0",max:"100",placeholder:"0.00",value:c,onChange:A=>f(A.target.value),className:"pl-8"})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Set to $0.00 for free. You'll receive 80% of paid sales."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(ae,{children:"License Type *"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("label",{className:"flex items-start gap-3 p-4 border border-border rounded-lg cursor-pointer hover:border-primary transition-colors",children:[e.jsx("input",{type:"radio",name:"license",value:"personal",checked:m==="personal",onChange:A=>p(A.target.value),className:"mt-1"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium text-foreground",children:"Personal Use"}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Buyer can use for personal projects only"})]})]}),e.jsxs("label",{className:"flex items-start gap-3 p-4 border border-border rounded-lg cursor-pointer hover:border-primary transition-colors",children:[e.jsx("input",{type:"radio",name:"license",value:"commercial",checked:m==="commercial",onChange:A=>p(A.target.value),className:"mt-1"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium text-foreground",children:"Commercial Use"}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Buyer can use for commercial projects"})]})]}),e.jsxs("label",{className:"flex items-start gap-3 p-4 border border-border rounded-lg cursor-pointer hover:border-primary transition-colors",children:[e.jsx("input",{type:"radio",name:"license",value:"unlimited",checked:m==="unlimited",onChange:A=>p(A.target.value),className:"mt-1"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium text-foreground",children:"Unlimited"}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Buyer can use however they want, including resale"})]})]})]})]}),e.jsxs("div",{className:"border border-blue-500/20 bg-blue-500/10 rounded-lg p-4 flex gap-3",children:[e.jsx(Oa,{className:"w-5 h-5 text-blue-500 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"text-sm text-foreground",children:[e.jsx("p",{className:"font-medium mb-1",children:"Before uploading:"}),e.jsxs("ul",{className:"list-disc list-inside space-y-1 text-muted-foreground",children:[e.jsx("li",{children:"Ensure your design is original or you have rights to sell it"}),e.jsx("li",{children:"No copyrighted logos or trademarks without permission"}),e.jsx("li",{children:"Create a high-quality preview image"}),e.jsx("li",{children:"Choose appropriate tags for discoverability"})]})]})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx(X,{type:"submit",disabled:s,className:"flex-1",size:"lg",children:s?e.jsxs(e.Fragment,{children:[e.jsx(We,{className:"w-4 h-4 mr-2 animate-spin"}),"Uploading..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Fr,{className:"w-4 h-4 mr-2"}),"Upload Design"]})}),e.jsx(X,{type:"button",variant:"outline",onClick:()=>t("/marketplace"),disabled:s,size:"lg",children:"Cancel"})]})]})})]})}function Rm(){const t=qe(),{isAuthenticated:r,user:s}=gt(),[n,a]=C.useState(null),[i,l]=C.useState([]),[o,c]=C.useState(!0);C.useEffect(()=>{if(!r){t("/auth");return}f()},[r]);const f=async()=>{c(!0);try{if(s!=null&&s.id){try{const u=await ot.getDesignerProfile(s.id);a(u)}catch{const g=await ot.updateDesignerProfile({bio:"",social_links:{}});a(g)}const d=await ot.getDesignerDesigns(s.id);l(d)}}catch(d){J.error("Failed to load dashboard"),console.error(d)}finally{c(!1)}},m=async d=>{if(confirm("Are you sure you want to delete this design?"))try{await fetch(`undefined/rest/v1/marketplace_designs?id=eq.${d}`,{method:"DELETE",headers:{apikey:void 0,Authorization:`Bearer ${(await ot).supabase.auth.getSession()}`}}),J.success("Design deleted"),f()}catch{J.error("Failed to delete design")}};if(o)return e.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:e.jsx(We,{className:"w-8 h-8 animate-spin text-primary"})});const p=(n==null?void 0:n.total_earnings)||0,b=(n==null?void 0:n.total_sales)||0,h=i.length,w=i.reduce((d,u)=>d+u.downloads,0);return e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx("div",{className:"border-b border-border bg-card",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-foreground",children:"Designer Dashboard"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Manage your designs and track your earnings"})]}),e.jsxs(X,{onClick:()=>t("/marketplace/upload"),className:"gap-2",children:[e.jsx(dr,{className:"w-4 h-4"}),"Upload New Design"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx(Rr,{icon:qs,label:"Total Earnings",value:`$${p.toFixed(2)}`,description:"80% of sales",color:"text-green-600"}),e.jsx(Rr,{icon:Gs,label:"Total Sales",value:b.toString(),description:"Completed purchases",color:"text-blue-600"}),e.jsx(Rr,{icon:Dn,label:"Designs",value:h.toString(),description:"Published designs",color:"text-purple-600"}),e.jsx(Rr,{icon:lt,label:"Downloads",value:w.toString(),description:"All-time downloads",color:"text-orange-600"})]})]})}),e.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-foreground",children:"Your Designs"}),e.jsx(X,{variant:"outline",onClick:()=>t("/marketplace"),children:"View Marketplace"})]}),i.length===0?e.jsxs("div",{className:"text-center py-20 border border-dashed border-border rounded-lg",children:[e.jsx(Dn,{className:"w-12 h-12 mx-auto text-muted-foreground mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-foreground mb-2",children:"No designs yet"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-6",children:"Upload your first design to start earning"}),e.jsxs(X,{onClick:()=>t("/marketplace/upload"),children:[e.jsx(dr,{className:"w-4 h-4 mr-2"}),"Upload Design"]})]}):e.jsx("div",{className:"space-y-4",children:i.map(d=>e.jsx(Dm,{design:d,onDelete:()=>m(d.id)},d.id))})]})]})}function Rr({icon:t,label:r,value:s,description:n,color:a}){return e.jsx("div",{className:"border border-border rounded-lg p-4 bg-card",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-10 h-10 rounded-full bg-muted flex items-center justify-center ${a}`,children:e.jsx(t,{className:"w-5 h-5"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:r}),e.jsx("p",{className:"text-2xl font-bold text-foreground",children:s}),e.jsx("p",{className:"text-xs text-muted-foreground",children:n})]})]})})}function Dm({design:t,onDelete:r}){const s=qe();return e.jsx("div",{className:"border border-border rounded-lg p-4 bg-card hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-24 h-32 bg-gradient-to-br from-muted to-muted/50 rounded overflow-hidden flex-shrink-0 cursor-pointer",onClick:()=>s(`/marketplace/design/${t.id}`),children:t.thumbnail_url?e.jsx("img",{src:t.thumbnail_url,alt:t.title,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center text-3xl",children:""})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-bold text-foreground truncate cursor-pointer hover:text-primary",onClick:()=>s(`/marketplace/design/${t.id}`),children:t.title}),t.description&&e.jsx("p",{className:"text-sm text-muted-foreground line-clamp-1",children:t.description})]}),e.jsxs("div",{className:"ml-4 text-right",children:[t.price===0?e.jsx("span",{className:"text-sm font-bold text-green-600",children:"FREE"}):e.jsxs("span",{className:"text-sm font-bold text-foreground",children:["$",t.price.toFixed(2)]}),e.jsx("div",{className:"text-xs text-muted-foreground",children:t.license_type})]})]}),e.jsxs("div",{className:"flex items-center gap-4 text-xs text-muted-foreground mb-3",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx($t,{className:"w-3 h-3"}),t.views]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(lt,{className:"w-3 h-3"}),t.downloads]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(at,{className:"w-3 h-3"}),t.favorites]}),e.jsx("span",{className:"px-2 py-0.5 rounded-full bg-primary/10 text-primary text-[10px] font-medium",children:t.category}),!t.published&&e.jsx("span",{className:"px-2 py-0.5 rounded-full bg-yellow-500/10 text-yellow-600 text-[10px] font-medium",children:"Draft"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(X,{variant:"outline",size:"sm",onClick:()=>s(`/marketplace/design/${t.id}`),className:"gap-1",children:[e.jsx($t,{className:"w-3 h-3"}),"View"]}),e.jsxs(X,{variant:"outline",size:"sm",onClick:()=>J.info("Edit feature coming soon!"),className:"gap-1",children:[e.jsx(id,{className:"w-3 h-3"}),"Edit"]}),e.jsxs(X,{variant:"outline",size:"sm",onClick:r,className:"gap-1 text-red-600 hover:text-red-700 hover:border-red-600",children:[e.jsx(Pt,{className:"w-3 h-3"}),"Delete"]})]})]})]})})}const Om=()=>{const t=od();return C.useEffect(()=>{console.error("404 Error: User attempted to access non-existent route:",t.pathname)},[t.pathname]),e.jsx("div",{className:"flex min-h-screen items-center justify-center bg-muted",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"mb-4 text-4xl font-bold",children:"404"}),e.jsx("p",{className:"mb-4 text-xl text-muted-foreground",children:"Oops! Page not found"}),e.jsx("a",{href:"/",className:"text-primary underline hover:text-primary/90",children:"Return to Home"})]})})},Fm=new nf,Im=()=>e.jsx(lf,{children:e.jsx(of,{client:Fm,children:e.jsxs(Th,{children:[e.jsx(Md,{}),e.jsx(Hd,{}),e.jsx(ld,{children:e.jsxs(cd,{children:[e.jsx(Ke,{path:"/",element:e.jsx(mm,{})}),e.jsx(Ke,{path:"/auth",element:e.jsx(xm,{})}),e.jsx(Ke,{path:"/designs",element:e.jsx(jm,{})}),e.jsx(Ke,{path:"/templates",element:e.jsx(km,{})}),e.jsx(Ke,{path:"/gallery",element:e.jsx(_m,{})}),e.jsx(Ke,{path:"/marketplace",element:e.jsx(Em,{})}),e.jsx(Ke,{path:"/marketplace/design/:id",element:e.jsx(Pm,{})}),e.jsx(Ke,{path:"/marketplace/upload",element:e.jsx(Tm,{})}),e.jsx(Ke,{path:"/marketplace/dashboard",element:e.jsx(Rm,{})}),e.jsx(Ke,{path:"/share/:token",element:e.jsx(Sm,{})}),e.jsx(Ke,{path:"*",element:e.jsx(Om,{})})]})})]})})});Ha(document.getElementById("root")).render(e.jsx(Im,{}));export{ve as S};
