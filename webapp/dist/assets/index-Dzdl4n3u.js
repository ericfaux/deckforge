const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/modals-Bz7BD7F1.js","assets/vendor-ui-Cq8k3voL.js","assets/vendor-supabase-CoxeBSpk.js","assets/AnimationPreview-WWyVeN8z.js","assets/vendor-react-Bkg-76Ue.js","assets/ColorExtractorModal-DslJf5Jb.js","assets/SmartDuplicateModal-BK1lFbzl.js","assets/TemplateGalleryModal-CBbshATX.js","assets/DeckGenerator3D-DTHcJXw7.js"])))=>i.map(i=>d[i]);
var Nx=Object.defineProperty;var af=r=>{throw TypeError(r)};var jx=(r,e,t)=>e in r?Nx(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var Gi=(r,e,t)=>jx(r,typeof e!="symbol"?e+"":e,t),Fc=(r,e,t)=>e.has(r)||af("Cannot "+t);var ae=(r,e,t)=>(Fc(r,e,"read from private field"),t?t.call(r):e.get(r)),qe=(r,e,t)=>e.has(r)?af("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(r):e.set(r,t),Le=(r,e,t,n)=>(Fc(r,e,"write to private field"),n?n.call(r,t):e.set(r,t),t),Jt=(r,e,t)=>(Fc(r,e,"access private method"),t);var yo=(r,e,t,n)=>({set _(i){Le(r,e,i,t)},get _(){return ae(r,e,n)}});import{j as a,c as Bp,a as kn,u as Dt,P as vt,B as Ex,b as ts,d as va,e as nt,f as la,R as Px,g as Gp,h as ca,i as Ax,k as it,l as Tx,m as Rx,D as Hp,n as Zo,o as de,p as Ct,S as Qn,q as Up,r as Wp,s as hi,t as fi,v as Nn,w as zc,x as Dx,L as Ee,I as pt,y as Ox,z as Ix,A as Mx,F as Lx,C as Vp,E as Fx,G as zx,H as Bx,J as Gx,K as Hx,M as Ux,N as Wx,W as ed,O as Go,Q as $p,T as of,U as Vx,V as dr,X as Mt,Y as Yp,Z as $x,_ as lt}from"./modals-Bz7BD7F1.js";import{a as Td,r as T,b as Ke,X as wa,am as Yx,an as lf,ao as Xx,ap as qx,aa as Rd,aq as Xp,ar as qp,af as Dd,as as Od,at as Id,ae as Jo,a5 as Ho,au as Uo,av as Kx,aw as Qx,ax as Zx,ay as Jx,az as e2,aA as t2,aB as r2,V as cf,aC as n2,aD as s2,aE as i2,aF as a2,g as el,aG as o2,aH as l2,aI as c2,p as d2,D as u2,F as h2,B as f2,o as p2,n as m2,aJ as g2,aK as x2,z as y2,y as v2,x as Kp,w as Wo,t as Md,s as sn,q as cr,H as w2,Q as b2,P as _2,O as S2,N as C2,K as k2,J as N2,I as Qp,A as j2,aL as E2,aM as P2,aN as A2,aO as T2,a2 as R2,a1 as D2,a0 as O2,$ as I2,_ as M2,Y as L2,E as Zn,aP as F2,aQ as z2,aR as B2,aS as G2,u as ce,a3 as xr,T as jn,aT as Zp,aU as H2,h as U2,L as Jp,aV as W2,aW as V2,aX as da,ad as td,aY as $2,j as em,ah as Hr,aZ as Y2,a_ as X2,k as q2,l as K2,a9 as tm,a$ as rm,b0 as Q2,b1 as nm,b2 as sm,b3 as Z2,b4 as im,b5 as J2,b6 as ey,m as ty,G as ry,i as ny,b7 as am,U as om,c as lm,b8 as sy,a6 as Ld,a7 as cm,b9 as iy,ba as ay,bb as oy,bc as ly,ag as cy,bd as df,ab as dm,be as dy,bf as uf,bg as uy,bh as vo,bi as um,bj as hy,bk as fy,bl as py,bm as hf,bn as ff,bo as hm,bp as my,bq as gy,br as Fd,bs as xy,C as pf,bt as yy,bu as vy,bv as zd,bw as wy,bx as by,by as mf,bz as _y,bA as Lo}from"./vendor-ui-Cq8k3voL.js";import{u as Tr,a as fm,b as Sy,B as Cy,R as ky,c as Er}from"./vendor-react-Bkg-76Ue.js";import"./vendor-supabase-CoxeBSpk.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const l of i)if(l.type==="childList")for(const c of l.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&n(c)}).observe(document,{childList:!0,subtree:!0});function t(i){const l={};return i.integrity&&(l.integrity=i.integrity),i.referrerPolicy&&(l.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?l.credentials="include":i.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function n(i){if(i.ep)return;i.ep=!0;const l=t(i);fetch(i.href,l)}})();var pm,gf=Td;pm=gf.createRoot,gf.hydrateRoot;function xf(r){const e=Ny(r),t=T.forwardRef((n,i)=>{const{children:l,...c}=n,d=T.Children.toArray(l),u=d.find(Ey);if(u){const f=u.props.children,p=d.map(m=>m===u?T.Children.count(f)>1?T.Children.only(null):T.isValidElement(f)?f.props.children:null:m);return a.jsx(e,{...c,ref:i,children:T.isValidElement(f)?T.cloneElement(f,void 0,p):null})}return a.jsx(e,{...c,ref:i,children:l})});return t.displayName=`${r}.Slot`,t}function Ny(r){const e=T.forwardRef((t,n)=>{const{children:i,...l}=t;if(T.isValidElement(i)){const c=Ay(i),d=Py(l,i.props);return i.type!==T.Fragment&&(d.ref=n?Bp(n,c):c),T.cloneElement(i,d)}return T.Children.count(i)>1?T.Children.only(null):null});return e.displayName=`${r}.SlotClone`,e}var jy=Symbol("radix.slottable");function Ey(r){return T.isValidElement(r)&&typeof r.type=="function"&&"__radixId"in r.type&&r.type.__radixId===jy}function Py(r,e){const t={...e};for(const n in e){const i=r[n],l=e[n];/^on[A-Z]/.test(n)?i&&l?t[n]=(...d)=>{const u=l(...d);return i(...d),u}:i&&(t[n]=i):n==="style"?t[n]={...i,...l}:n==="className"&&(t[n]=[i,l].filter(Boolean).join(" "))}return{...r,...t}}function Ay(r){var n,i;let e=(n=Object.getOwnPropertyDescriptor(r.props,"ref"))==null?void 0:n.get,t=e&&"isReactWarning"in e&&e.isReactWarning;return t?r.ref:(e=(i=Object.getOwnPropertyDescriptor(r,"ref"))==null?void 0:i.get,t=e&&"isReactWarning"in e&&e.isReactWarning,t?r.props.ref:r.props.ref||r.ref)}function Bd(r){const e=r+"CollectionProvider",[t,n]=kn(e),[i,l]=t(e,{collectionRef:{current:null},itemMap:new Map}),c=x=>{const{scope:v,children:S}=x,C=Ke.useRef(null),k=Ke.useRef(new Map).current;return a.jsx(i,{scope:v,itemMap:k,collectionRef:C,children:S})};c.displayName=e;const d=r+"CollectionSlot",u=xf(d),f=Ke.forwardRef((x,v)=>{const{scope:S,children:C}=x,k=l(d,S),E=Dt(v,k.collectionRef);return a.jsx(u,{ref:E,children:C})});f.displayName=d;const p=r+"CollectionItemSlot",m="data-radix-collection-item",y=xf(p),w=Ke.forwardRef((x,v)=>{const{scope:S,children:C,...k}=x,E=Ke.useRef(null),P=Dt(v,E),D=l(p,S);return Ke.useEffect(()=>(D.itemMap.set(E,{ref:E,...k}),()=>void D.itemMap.delete(E))),a.jsx(y,{[m]:"",ref:P,children:C})});w.displayName=p;function _(x){const v=l(r+"CollectionConsumer",x);return Ke.useCallback(()=>{const C=v.collectionRef.current;if(!C)return[];const k=Array.from(C.querySelectorAll(`[${m}]`));return Array.from(v.itemMap.values()).sort((D,I)=>k.indexOf(D.ref.current)-k.indexOf(I.ref.current))},[v.collectionRef,v.itemMap])}return[{Provider:c,Slot:f,ItemSlot:w},_,n]}var Ty=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),Ry="VisuallyHidden",tl=T.forwardRef((r,e)=>a.jsx(vt.span,{...r,ref:e,style:{...Ty,...r.style}}));tl.displayName=Ry;var Dy=tl,Gd="ToastProvider",[Hd,Oy,Iy]=Bd("Toast"),[mm]=kn("Toast",[Iy]),[My,rl]=mm(Gd),gm=r=>{const{__scopeToast:e,label:t="Notification",duration:n=5e3,swipeDirection:i="right",swipeThreshold:l=50,children:c}=r,[d,u]=T.useState(null),[f,p]=T.useState(0),m=T.useRef(!1),y=T.useRef(!1);return t.trim()||console.error(`Invalid prop \`label\` supplied to \`${Gd}\`. Expected non-empty \`string\`.`),a.jsx(Hd.Provider,{scope:e,children:a.jsx(My,{scope:e,label:t,duration:n,swipeDirection:i,swipeThreshold:l,toastCount:f,viewport:d,onViewportChange:u,onToastAdd:T.useCallback(()=>p(w=>w+1),[]),onToastRemove:T.useCallback(()=>p(w=>w-1),[]),isFocusedToastEscapeKeyDownRef:m,isClosePausedRef:y,children:c})})};gm.displayName=Gd;var xm="ToastViewport",Ly=["F8"],rd="toast.viewportPause",nd="toast.viewportResume",ym=T.forwardRef((r,e)=>{const{__scopeToast:t,hotkey:n=Ly,label:i="Notifications ({hotkey})",...l}=r,c=rl(xm,t),d=Oy(t),u=T.useRef(null),f=T.useRef(null),p=T.useRef(null),m=T.useRef(null),y=Dt(e,m,c.onViewportChange),w=n.join("+").replace(/Key/g,"").replace(/Digit/g,""),_=c.toastCount>0;T.useEffect(()=>{const v=S=>{var k;n.length!==0&&n.every(E=>S[E]||S.code===E)&&((k=m.current)==null||k.focus())};return document.addEventListener("keydown",v),()=>document.removeEventListener("keydown",v)},[n]),T.useEffect(()=>{const v=u.current,S=m.current;if(_&&v&&S){const C=()=>{if(!c.isClosePausedRef.current){const D=new CustomEvent(rd);S.dispatchEvent(D),c.isClosePausedRef.current=!0}},k=()=>{if(c.isClosePausedRef.current){const D=new CustomEvent(nd);S.dispatchEvent(D),c.isClosePausedRef.current=!1}},E=D=>{!v.contains(D.relatedTarget)&&k()},P=()=>{v.contains(document.activeElement)||k()};return v.addEventListener("focusin",C),v.addEventListener("focusout",E),v.addEventListener("pointermove",C),v.addEventListener("pointerleave",P),window.addEventListener("blur",C),window.addEventListener("focus",k),()=>{v.removeEventListener("focusin",C),v.removeEventListener("focusout",E),v.removeEventListener("pointermove",C),v.removeEventListener("pointerleave",P),window.removeEventListener("blur",C),window.removeEventListener("focus",k)}}},[_,c.isClosePausedRef]);const x=T.useCallback(({tabbingDirection:v})=>{const C=d().map(k=>{const E=k.ref.current,P=[E,...Ky(E)];return v==="forwards"?P:P.reverse()});return(v==="forwards"?C.reverse():C).flat()},[d]);return T.useEffect(()=>{const v=m.current;if(v){const S=C=>{var P,D,I;const k=C.altKey||C.ctrlKey||C.metaKey;if(C.key==="Tab"&&!k){const B=document.activeElement,z=C.shiftKey;if(C.target===v&&z){(P=f.current)==null||P.focus();return}const R=x({tabbingDirection:z?"backwards":"forwards"}),H=R.findIndex(j=>j===B);Bc(R.slice(H+1))?C.preventDefault():z?(D=f.current)==null||D.focus():(I=p.current)==null||I.focus()}};return v.addEventListener("keydown",S),()=>v.removeEventListener("keydown",S)}},[d,x]),a.jsxs(Ex,{ref:u,role:"region","aria-label":i.replace("{hotkey}",w),tabIndex:-1,style:{pointerEvents:_?void 0:"none"},children:[_&&a.jsx(sd,{ref:f,onFocusFromOutsideViewport:()=>{const v=x({tabbingDirection:"forwards"});Bc(v)}}),a.jsx(Hd.Slot,{scope:t,children:a.jsx(vt.ol,{tabIndex:-1,...l,ref:y})}),_&&a.jsx(sd,{ref:p,onFocusFromOutsideViewport:()=>{const v=x({tabbingDirection:"backwards"});Bc(v)}})]})});ym.displayName=xm;var vm="ToastFocusProxy",sd=T.forwardRef((r,e)=>{const{__scopeToast:t,onFocusFromOutsideViewport:n,...i}=r,l=rl(vm,t);return a.jsx(tl,{tabIndex:0,...i,ref:e,style:{position:"fixed"},onFocus:c=>{var f;const d=c.relatedTarget;!((f=l.viewport)!=null&&f.contains(d))&&n()}})});sd.displayName=vm;var ba="Toast",Fy="toast.swipeStart",zy="toast.swipeMove",By="toast.swipeCancel",Gy="toast.swipeEnd",wm=T.forwardRef((r,e)=>{const{forceMount:t,open:n,defaultOpen:i,onOpenChange:l,...c}=r,[d,u]=ts({prop:n,defaultProp:i??!0,onChange:l,caller:ba});return a.jsx(va,{present:t||d,children:a.jsx(Wy,{open:d,...c,ref:e,onClose:()=>u(!1),onPause:la(r.onPause),onResume:la(r.onResume),onSwipeStart:nt(r.onSwipeStart,f=>{f.currentTarget.setAttribute("data-swipe","start")}),onSwipeMove:nt(r.onSwipeMove,f=>{const{x:p,y:m}=f.detail.delta;f.currentTarget.setAttribute("data-swipe","move"),f.currentTarget.style.setProperty("--radix-toast-swipe-move-x",`${p}px`),f.currentTarget.style.setProperty("--radix-toast-swipe-move-y",`${m}px`)}),onSwipeCancel:nt(r.onSwipeCancel,f=>{f.currentTarget.setAttribute("data-swipe","cancel"),f.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),f.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),f.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),f.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")}),onSwipeEnd:nt(r.onSwipeEnd,f=>{const{x:p,y:m}=f.detail.delta;f.currentTarget.setAttribute("data-swipe","end"),f.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),f.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),f.currentTarget.style.setProperty("--radix-toast-swipe-end-x",`${p}px`),f.currentTarget.style.setProperty("--radix-toast-swipe-end-y",`${m}px`),u(!1)})})})});wm.displayName=ba;var[Hy,Uy]=mm(ba,{onClose(){}}),Wy=T.forwardRef((r,e)=>{const{__scopeToast:t,type:n="foreground",duration:i,open:l,onClose:c,onEscapeKeyDown:d,onPause:u,onResume:f,onSwipeStart:p,onSwipeMove:m,onSwipeCancel:y,onSwipeEnd:w,..._}=r,x=rl(ba,t),[v,S]=T.useState(null),C=Dt(e,j=>S(j)),k=T.useRef(null),E=T.useRef(null),P=i||x.duration,D=T.useRef(0),I=T.useRef(P),B=T.useRef(0),{onToastAdd:z,onToastRemove:X}=x,se=la(()=>{var G;(v==null?void 0:v.contains(document.activeElement))&&((G=x.viewport)==null||G.focus()),c()}),R=T.useCallback(j=>{!j||j===1/0||(window.clearTimeout(B.current),D.current=new Date().getTime(),B.current=window.setTimeout(se,j))},[se]);T.useEffect(()=>{const j=x.viewport;if(j){const G=()=>{R(I.current),f==null||f()},Q=()=>{const K=new Date().getTime()-D.current;I.current=I.current-K,window.clearTimeout(B.current),u==null||u()};return j.addEventListener(rd,Q),j.addEventListener(nd,G),()=>{j.removeEventListener(rd,Q),j.removeEventListener(nd,G)}}},[x.viewport,P,u,f,R]),T.useEffect(()=>{l&&!x.isClosePausedRef.current&&R(P)},[l,P,x.isClosePausedRef,R]),T.useEffect(()=>(z(),()=>X()),[z,X]);const H=T.useMemo(()=>v?jm(v):null,[v]);return x.viewport?a.jsxs(a.Fragment,{children:[H&&a.jsx(Vy,{__scopeToast:t,role:"status","aria-live":n==="foreground"?"assertive":"polite",children:H}),a.jsx(Hy,{scope:t,onClose:se,children:Td.createPortal(a.jsx(Hd.ItemSlot,{scope:t,children:a.jsx(Px,{asChild:!0,onEscapeKeyDown:nt(d,()=>{x.isFocusedToastEscapeKeyDownRef.current||se(),x.isFocusedToastEscapeKeyDownRef.current=!1}),children:a.jsx(vt.li,{tabIndex:0,"data-state":l?"open":"closed","data-swipe-direction":x.swipeDirection,..._,ref:C,style:{userSelect:"none",touchAction:"none",...r.style},onKeyDown:nt(r.onKeyDown,j=>{j.key==="Escape"&&(d==null||d(j.nativeEvent),j.nativeEvent.defaultPrevented||(x.isFocusedToastEscapeKeyDownRef.current=!0,se()))}),onPointerDown:nt(r.onPointerDown,j=>{j.button===0&&(k.current={x:j.clientX,y:j.clientY})}),onPointerMove:nt(r.onPointerMove,j=>{if(!k.current)return;const G=j.clientX-k.current.x,Q=j.clientY-k.current.y,K=!!E.current,J=["left","right"].includes(x.swipeDirection),ee=["left","up"].includes(x.swipeDirection)?Math.min:Math.max,be=J?ee(0,G):0,V=J?0:ee(0,Q),Y=j.pointerType==="touch"?10:2,Se={x:be,y:V},Ce={originalEvent:j,delta:Se};K?(E.current=Se,wo(zy,m,Ce,{discrete:!1})):yf(Se,x.swipeDirection,Y)?(E.current=Se,wo(Fy,p,Ce,{discrete:!1}),j.target.setPointerCapture(j.pointerId)):(Math.abs(G)>Y||Math.abs(Q)>Y)&&(k.current=null)}),onPointerUp:nt(r.onPointerUp,j=>{const G=E.current,Q=j.target;if(Q.hasPointerCapture(j.pointerId)&&Q.releasePointerCapture(j.pointerId),E.current=null,k.current=null,G){const K=j.currentTarget,J={originalEvent:j,delta:G};yf(G,x.swipeDirection,x.swipeThreshold)?wo(Gy,w,J,{discrete:!0}):wo(By,y,J,{discrete:!0}),K.addEventListener("click",ee=>ee.preventDefault(),{once:!0})}})})})}),x.viewport)})]}):null}),Vy=r=>{const{__scopeToast:e,children:t,...n}=r,i=rl(ba,e),[l,c]=T.useState(!1),[d,u]=T.useState(!1);return Xy(()=>c(!0)),T.useEffect(()=>{const f=window.setTimeout(()=>u(!0),1e3);return()=>window.clearTimeout(f)},[]),d?null:a.jsx(Gp,{asChild:!0,children:a.jsx(tl,{...n,children:l&&a.jsxs(a.Fragment,{children:[i.label," ",t]})})})},$y="ToastTitle",bm=T.forwardRef((r,e)=>{const{__scopeToast:t,...n}=r;return a.jsx(vt.div,{...n,ref:e})});bm.displayName=$y;var Yy="ToastDescription",_m=T.forwardRef((r,e)=>{const{__scopeToast:t,...n}=r;return a.jsx(vt.div,{...n,ref:e})});_m.displayName=Yy;var Sm="ToastAction",Cm=T.forwardRef((r,e)=>{const{altText:t,...n}=r;return t.trim()?a.jsx(Nm,{altText:t,asChild:!0,children:a.jsx(Ud,{...n,ref:e})}):(console.error(`Invalid prop \`altText\` supplied to \`${Sm}\`. Expected non-empty \`string\`.`),null)});Cm.displayName=Sm;var km="ToastClose",Ud=T.forwardRef((r,e)=>{const{__scopeToast:t,...n}=r,i=Uy(km,t);return a.jsx(Nm,{asChild:!0,children:a.jsx(vt.button,{type:"button",...n,ref:e,onClick:nt(r.onClick,i.onClose)})})});Ud.displayName=km;var Nm=T.forwardRef((r,e)=>{const{__scopeToast:t,altText:n,...i}=r;return a.jsx(vt.div,{"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":n||void 0,...i,ref:e})});function jm(r){const e=[];return Array.from(r.childNodes).forEach(n=>{if(n.nodeType===n.TEXT_NODE&&n.textContent&&e.push(n.textContent),qy(n)){const i=n.ariaHidden||n.hidden||n.style.display==="none",l=n.dataset.radixToastAnnounceExclude==="";if(!i)if(l){const c=n.dataset.radixToastAnnounceAlt;c&&e.push(c)}else e.push(...jm(n))}}),e}function wo(r,e,t,{discrete:n}){const i=t.originalEvent.currentTarget,l=new CustomEvent(r,{bubbles:!0,cancelable:!0,detail:t});e&&i.addEventListener(r,e,{once:!0}),n?Ax(i,l):i.dispatchEvent(l)}var yf=(r,e,t=0)=>{const n=Math.abs(r.x),i=Math.abs(r.y),l=n>i;return e==="left"||e==="right"?l&&n>t:!l&&i>t};function Xy(r=()=>{}){const e=la(r);ca(()=>{let t=0,n=0;return t=window.requestAnimationFrame(()=>n=window.requestAnimationFrame(e)),()=>{window.cancelAnimationFrame(t),window.cancelAnimationFrame(n)}},[e])}function qy(r){return r.nodeType===r.ELEMENT_NODE}function Ky(r){const e=[],t=document.createTreeWalker(r,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>{const i=n.tagName==="INPUT"&&n.type==="hidden";return n.disabled||n.hidden||i?NodeFilter.FILTER_SKIP:n.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;t.nextNode();)e.push(t.currentNode);return e}function Bc(r){const e=document.activeElement;return r.some(t=>t===e?!0:(t.focus(),document.activeElement!==e))}var Qy=gm,Em=ym,Pm=wm,Am=bm,Tm=_m,Rm=Cm,Dm=Ud;const Zy=Qy,Om=T.forwardRef(({className:r,...e},t)=>a.jsx(Em,{ref:t,className:it("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",r),...e}));Om.displayName=Em.displayName;const Jy=Tx("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),Im=T.forwardRef(({className:r,variant:e,...t},n)=>a.jsx(Pm,{ref:n,className:it(Jy({variant:e}),r),...t}));Im.displayName=Pm.displayName;const ev=T.forwardRef(({className:r,...e},t)=>a.jsx(Rm,{ref:t,className:it("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors group-[.destructive]:border-muted/40 hover:bg-secondary group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 group-[.destructive]:focus:ring-destructive disabled:pointer-events-none disabled:opacity-50",r),...e}));ev.displayName=Rm.displayName;const Mm=T.forwardRef(({className:r,...e},t)=>a.jsx(Dm,{ref:t,className:it("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity group-hover:opacity-100 group-[.destructive]:text-red-300 hover:text-foreground group-[.destructive]:hover:text-red-50 focus:opacity-100 focus:outline-none focus:ring-2 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",r),"toast-close":"",...e,children:a.jsx(wa,{className:"h-4 w-4"})}));Mm.displayName=Dm.displayName;const Lm=T.forwardRef(({className:r,...e},t)=>a.jsx(Am,{ref:t,className:it("text-sm font-semibold",r),...e}));Lm.displayName=Am.displayName;const Fm=T.forwardRef(({className:r,...e},t)=>a.jsx(Tm,{ref:t,className:it("text-sm opacity-90",r),...e}));Fm.displayName=Tm.displayName;function tv(){const{toasts:r}=Rx();return a.jsxs(Zy,{children:[r.map(function({id:e,title:t,description:n,action:i,...l}){return a.jsxs(Im,{...l,children:[a.jsxs("div",{className:"grid gap-1",children:[t&&a.jsx(Lm,{children:t}),n&&a.jsx(Fm,{children:n})]}),i,a.jsx(Mm,{})]},e)}),a.jsx(Om,{})]})}var vf=["light","dark"],rv="(prefers-color-scheme: dark)",nv=T.createContext(void 0),sv={setTheme:r=>{},themes:[]},iv=()=>{var r;return(r=T.useContext(nv))!=null?r:sv};T.memo(({forcedTheme:r,storageKey:e,attribute:t,enableSystem:n,enableColorScheme:i,defaultTheme:l,value:c,attrs:d,nonce:u})=>{let f=l==="system",p=t==="class"?`var d=document.documentElement,c=d.classList;${`c.remove(${d.map(_=>`'${_}'`).join(",")})`};`:`var d=document.documentElement,n='${t}',s='setAttribute';`,m=i?vf.includes(l)&&l?`if(e==='light'||e==='dark'||!e)d.style.colorScheme=e||'${l}'`:"if(e==='light'||e==='dark')d.style.colorScheme=e":"",y=(_,x=!1,v=!0)=>{let S=c?c[_]:_,C=x?_+"|| ''":`'${S}'`,k="";return i&&v&&!x&&vf.includes(_)&&(k+=`d.style.colorScheme = '${_}';`),t==="class"?x||S?k+=`c.add(${C})`:k+="null":S&&(k+=`d[s](n,${C})`),k},w=r?`!function(){${p}${y(r)}}()`:n?`!function(){try{${p}var e=localStorage.getItem('${e}');if('system'===e||(!e&&${f})){var t='${rv}',m=window.matchMedia(t);if(m.media!==t||m.matches){${y("dark")}}else{${y("light")}}}else if(e){${c?`var x=${JSON.stringify(c)};`:""}${y(c?"x[e]":"e",!0)}}${f?"":"else{"+y(l,!1,!1)+"}"}${m}}catch(e){}}()`:`!function(){try{${p}var e=localStorage.getItem('${e}');if(e){${c?`var x=${JSON.stringify(c)};`:""}${y(c?"x[e]":"e",!0)}}else{${y(l,!1,!1)};}${m}}catch(t){}}();`;return T.createElement("script",{nonce:u,dangerouslySetInnerHTML:{__html:w}})});const av=({...r})=>{const{theme:e="system"}=iv();return a.jsx(Yx,{theme:e,className:"toaster group",toastOptions:{classNames:{toast:"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg",description:"group-[.toast]:text-muted-foreground",actionButton:"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground",cancelButton:"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground"}},...r})},ov=["top","right","bottom","left"],Jn=Math.min,fr=Math.max,Vo=Math.round,bo=Math.floor,ln=r=>({x:r,y:r}),lv={left:"right",right:"left",bottom:"top",top:"bottom"},cv={start:"end",end:"start"};function id(r,e,t){return fr(r,Jn(e,t))}function Sn(r,e){return typeof r=="function"?r(e):r}function Cn(r){return r.split("-")[0]}function yi(r){return r.split("-")[1]}function Wd(r){return r==="x"?"y":"x"}function Vd(r){return r==="y"?"height":"width"}const dv=new Set(["top","bottom"]);function an(r){return dv.has(Cn(r))?"y":"x"}function $d(r){return Wd(an(r))}function uv(r,e,t){t===void 0&&(t=!1);const n=yi(r),i=$d(r),l=Vd(i);let c=i==="x"?n===(t?"end":"start")?"right":"left":n==="start"?"bottom":"top";return e.reference[l]>e.floating[l]&&(c=$o(c)),[c,$o(c)]}function hv(r){const e=$o(r);return[ad(r),e,ad(e)]}function ad(r){return r.replace(/start|end/g,e=>cv[e])}const wf=["left","right"],bf=["right","left"],fv=["top","bottom"],pv=["bottom","top"];function mv(r,e,t){switch(r){case"top":case"bottom":return t?e?bf:wf:e?wf:bf;case"left":case"right":return e?fv:pv;default:return[]}}function gv(r,e,t,n){const i=yi(r);let l=mv(Cn(r),t==="start",n);return i&&(l=l.map(c=>c+"-"+i),e&&(l=l.concat(l.map(ad)))),l}function $o(r){return r.replace(/left|right|bottom|top/g,e=>lv[e])}function xv(r){return{top:0,right:0,bottom:0,left:0,...r}}function zm(r){return typeof r!="number"?xv(r):{top:r,right:r,bottom:r,left:r}}function Yo(r){const{x:e,y:t,width:n,height:i}=r;return{width:n,height:i,top:t,left:e,right:e+n,bottom:t+i,x:e,y:t}}function _f(r,e,t){let{reference:n,floating:i}=r;const l=an(e),c=$d(e),d=Vd(c),u=Cn(e),f=l==="y",p=n.x+n.width/2-i.width/2,m=n.y+n.height/2-i.height/2,y=n[d]/2-i[d]/2;let w;switch(u){case"top":w={x:p,y:n.y-i.height};break;case"bottom":w={x:p,y:n.y+n.height};break;case"right":w={x:n.x+n.width,y:m};break;case"left":w={x:n.x-i.width,y:m};break;default:w={x:n.x,y:n.y}}switch(yi(e)){case"start":w[c]-=y*(t&&f?-1:1);break;case"end":w[c]+=y*(t&&f?-1:1);break}return w}async function yv(r,e){var t;e===void 0&&(e={});const{x:n,y:i,platform:l,rects:c,elements:d,strategy:u}=r,{boundary:f="clippingAncestors",rootBoundary:p="viewport",elementContext:m="floating",altBoundary:y=!1,padding:w=0}=Sn(e,r),_=zm(w),v=d[y?m==="floating"?"reference":"floating":m],S=Yo(await l.getClippingRect({element:(t=await(l.isElement==null?void 0:l.isElement(v)))==null||t?v:v.contextElement||await(l.getDocumentElement==null?void 0:l.getDocumentElement(d.floating)),boundary:f,rootBoundary:p,strategy:u})),C=m==="floating"?{x:n,y:i,width:c.floating.width,height:c.floating.height}:c.reference,k=await(l.getOffsetParent==null?void 0:l.getOffsetParent(d.floating)),E=await(l.isElement==null?void 0:l.isElement(k))?await(l.getScale==null?void 0:l.getScale(k))||{x:1,y:1}:{x:1,y:1},P=Yo(l.convertOffsetParentRelativeRectToViewportRelativeRect?await l.convertOffsetParentRelativeRectToViewportRelativeRect({elements:d,rect:C,offsetParent:k,strategy:u}):C);return{top:(S.top-P.top+_.top)/E.y,bottom:(P.bottom-S.bottom+_.bottom)/E.y,left:(S.left-P.left+_.left)/E.x,right:(P.right-S.right+_.right)/E.x}}const vv=async(r,e,t)=>{const{placement:n="bottom",strategy:i="absolute",middleware:l=[],platform:c}=t,d=l.filter(Boolean),u=await(c.isRTL==null?void 0:c.isRTL(e));let f=await c.getElementRects({reference:r,floating:e,strategy:i}),{x:p,y:m}=_f(f,n,u),y=n,w={},_=0;for(let v=0;v<d.length;v++){var x;const{name:S,fn:C}=d[v],{x:k,y:E,data:P,reset:D}=await C({x:p,y:m,initialPlacement:n,placement:y,strategy:i,middlewareData:w,rects:f,platform:{...c,detectOverflow:(x=c.detectOverflow)!=null?x:yv},elements:{reference:r,floating:e}});p=k??p,m=E??m,w={...w,[S]:{...w[S],...P}},D&&_<=50&&(_++,typeof D=="object"&&(D.placement&&(y=D.placement),D.rects&&(f=D.rects===!0?await c.getElementRects({reference:r,floating:e,strategy:i}):D.rects),{x:p,y:m}=_f(f,y,u)),v=-1)}return{x:p,y:m,placement:y,strategy:i,middlewareData:w}},wv=r=>({name:"arrow",options:r,async fn(e){const{x:t,y:n,placement:i,rects:l,platform:c,elements:d,middlewareData:u}=e,{element:f,padding:p=0}=Sn(r,e)||{};if(f==null)return{};const m=zm(p),y={x:t,y:n},w=$d(i),_=Vd(w),x=await c.getDimensions(f),v=w==="y",S=v?"top":"left",C=v?"bottom":"right",k=v?"clientHeight":"clientWidth",E=l.reference[_]+l.reference[w]-y[w]-l.floating[_],P=y[w]-l.reference[w],D=await(c.getOffsetParent==null?void 0:c.getOffsetParent(f));let I=D?D[k]:0;(!I||!await(c.isElement==null?void 0:c.isElement(D)))&&(I=d.floating[k]||l.floating[_]);const B=E/2-P/2,z=I/2-x[_]/2-1,X=Jn(m[S],z),se=Jn(m[C],z),R=X,H=I-x[_]-se,j=I/2-x[_]/2+B,G=id(R,j,H),Q=!u.arrow&&yi(i)!=null&&j!==G&&l.reference[_]/2-(j<R?X:se)-x[_]/2<0,K=Q?j<R?j-R:j-H:0;return{[w]:y[w]+K,data:{[w]:G,centerOffset:j-G-K,...Q&&{alignmentOffset:K}},reset:Q}}}),bv=function(r){return r===void 0&&(r={}),{name:"flip",options:r,async fn(e){var t,n;const{placement:i,middlewareData:l,rects:c,initialPlacement:d,platform:u,elements:f}=e,{mainAxis:p=!0,crossAxis:m=!0,fallbackPlacements:y,fallbackStrategy:w="bestFit",fallbackAxisSideDirection:_="none",flipAlignment:x=!0,...v}=Sn(r,e);if((t=l.arrow)!=null&&t.alignmentOffset)return{};const S=Cn(i),C=an(d),k=Cn(d)===d,E=await(u.isRTL==null?void 0:u.isRTL(f.floating)),P=y||(k||!x?[$o(d)]:hv(d)),D=_!=="none";!y&&D&&P.push(...gv(d,x,_,E));const I=[d,...P],B=await u.detectOverflow(e,v),z=[];let X=((n=l.flip)==null?void 0:n.overflows)||[];if(p&&z.push(B[S]),m){const j=uv(i,c,E);z.push(B[j[0]],B[j[1]])}if(X=[...X,{placement:i,overflows:z}],!z.every(j=>j<=0)){var se,R;const j=(((se=l.flip)==null?void 0:se.index)||0)+1,G=I[j];if(G&&(!(m==="alignment"?C!==an(G):!1)||X.every(J=>an(J.placement)===C?J.overflows[0]>0:!0)))return{data:{index:j,overflows:X},reset:{placement:G}};let Q=(R=X.filter(K=>K.overflows[0]<=0).sort((K,J)=>K.overflows[1]-J.overflows[1])[0])==null?void 0:R.placement;if(!Q)switch(w){case"bestFit":{var H;const K=(H=X.filter(J=>{if(D){const ee=an(J.placement);return ee===C||ee==="y"}return!0}).map(J=>[J.placement,J.overflows.filter(ee=>ee>0).reduce((ee,be)=>ee+be,0)]).sort((J,ee)=>J[1]-ee[1])[0])==null?void 0:H[0];K&&(Q=K);break}case"initialPlacement":Q=d;break}if(i!==Q)return{reset:{placement:Q}}}return{}}}};function Sf(r,e){return{top:r.top-e.height,right:r.right-e.width,bottom:r.bottom-e.height,left:r.left-e.width}}function Cf(r){return ov.some(e=>r[e]>=0)}const _v=function(r){return r===void 0&&(r={}),{name:"hide",options:r,async fn(e){const{rects:t,platform:n}=e,{strategy:i="referenceHidden",...l}=Sn(r,e);switch(i){case"referenceHidden":{const c=await n.detectOverflow(e,{...l,elementContext:"reference"}),d=Sf(c,t.reference);return{data:{referenceHiddenOffsets:d,referenceHidden:Cf(d)}}}case"escaped":{const c=await n.detectOverflow(e,{...l,altBoundary:!0}),d=Sf(c,t.floating);return{data:{escapedOffsets:d,escaped:Cf(d)}}}default:return{}}}}},Bm=new Set(["left","top"]);async function Sv(r,e){const{placement:t,platform:n,elements:i}=r,l=await(n.isRTL==null?void 0:n.isRTL(i.floating)),c=Cn(t),d=yi(t),u=an(t)==="y",f=Bm.has(c)?-1:1,p=l&&u?-1:1,m=Sn(e,r);let{mainAxis:y,crossAxis:w,alignmentAxis:_}=typeof m=="number"?{mainAxis:m,crossAxis:0,alignmentAxis:null}:{mainAxis:m.mainAxis||0,crossAxis:m.crossAxis||0,alignmentAxis:m.alignmentAxis};return d&&typeof _=="number"&&(w=d==="end"?_*-1:_),u?{x:w*p,y:y*f}:{x:y*f,y:w*p}}const Cv=function(r){return r===void 0&&(r=0),{name:"offset",options:r,async fn(e){var t,n;const{x:i,y:l,placement:c,middlewareData:d}=e,u=await Sv(e,r);return c===((t=d.offset)==null?void 0:t.placement)&&(n=d.arrow)!=null&&n.alignmentOffset?{}:{x:i+u.x,y:l+u.y,data:{...u,placement:c}}}}},kv=function(r){return r===void 0&&(r={}),{name:"shift",options:r,async fn(e){const{x:t,y:n,placement:i,platform:l}=e,{mainAxis:c=!0,crossAxis:d=!1,limiter:u={fn:S=>{let{x:C,y:k}=S;return{x:C,y:k}}},...f}=Sn(r,e),p={x:t,y:n},m=await l.detectOverflow(e,f),y=an(Cn(i)),w=Wd(y);let _=p[w],x=p[y];if(c){const S=w==="y"?"top":"left",C=w==="y"?"bottom":"right",k=_+m[S],E=_-m[C];_=id(k,_,E)}if(d){const S=y==="y"?"top":"left",C=y==="y"?"bottom":"right",k=x+m[S],E=x-m[C];x=id(k,x,E)}const v=u.fn({...e,[w]:_,[y]:x});return{...v,data:{x:v.x-t,y:v.y-n,enabled:{[w]:c,[y]:d}}}}}},Nv=function(r){return r===void 0&&(r={}),{options:r,fn(e){const{x:t,y:n,placement:i,rects:l,middlewareData:c}=e,{offset:d=0,mainAxis:u=!0,crossAxis:f=!0}=Sn(r,e),p={x:t,y:n},m=an(i),y=Wd(m);let w=p[y],_=p[m];const x=Sn(d,e),v=typeof x=="number"?{mainAxis:x,crossAxis:0}:{mainAxis:0,crossAxis:0,...x};if(u){const k=y==="y"?"height":"width",E=l.reference[y]-l.floating[k]+v.mainAxis,P=l.reference[y]+l.reference[k]-v.mainAxis;w<E?w=E:w>P&&(w=P)}if(f){var S,C;const k=y==="y"?"width":"height",E=Bm.has(Cn(i)),P=l.reference[m]-l.floating[k]+(E&&((S=c.offset)==null?void 0:S[m])||0)+(E?0:v.crossAxis),D=l.reference[m]+l.reference[k]+(E?0:((C=c.offset)==null?void 0:C[m])||0)-(E?v.crossAxis:0);_<P?_=P:_>D&&(_=D)}return{[y]:w,[m]:_}}}},jv=function(r){return r===void 0&&(r={}),{name:"size",options:r,async fn(e){var t,n;const{placement:i,rects:l,platform:c,elements:d}=e,{apply:u=()=>{},...f}=Sn(r,e),p=await c.detectOverflow(e,f),m=Cn(i),y=yi(i),w=an(i)==="y",{width:_,height:x}=l.floating;let v,S;m==="top"||m==="bottom"?(v=m,S=y===(await(c.isRTL==null?void 0:c.isRTL(d.floating))?"start":"end")?"left":"right"):(S=m,v=y==="end"?"top":"bottom");const C=x-p.top-p.bottom,k=_-p.left-p.right,E=Jn(x-p[v],C),P=Jn(_-p[S],k),D=!e.middlewareData.shift;let I=E,B=P;if((t=e.middlewareData.shift)!=null&&t.enabled.x&&(B=k),(n=e.middlewareData.shift)!=null&&n.enabled.y&&(I=C),D&&!y){const X=fr(p.left,0),se=fr(p.right,0),R=fr(p.top,0),H=fr(p.bottom,0);w?B=_-2*(X!==0||se!==0?X+se:fr(p.left,p.right)):I=x-2*(R!==0||H!==0?R+H:fr(p.top,p.bottom))}await u({...e,availableWidth:B,availableHeight:I});const z=await c.getDimensions(d.floating);return _!==z.width||x!==z.height?{reset:{rects:!0}}:{}}}};function nl(){return typeof window<"u"}function vi(r){return Gm(r)?(r.nodeName||"").toLowerCase():"#document"}function mr(r){var e;return(r==null||(e=r.ownerDocument)==null?void 0:e.defaultView)||window}function dn(r){var e;return(e=(Gm(r)?r.ownerDocument:r.document)||window.document)==null?void 0:e.documentElement}function Gm(r){return nl()?r instanceof Node||r instanceof mr(r).Node:!1}function Ur(r){return nl()?r instanceof Element||r instanceof mr(r).Element:!1}function cn(r){return nl()?r instanceof HTMLElement||r instanceof mr(r).HTMLElement:!1}function kf(r){return!nl()||typeof ShadowRoot>"u"?!1:r instanceof ShadowRoot||r instanceof mr(r).ShadowRoot}const Ev=new Set(["inline","contents"]);function _a(r){const{overflow:e,overflowX:t,overflowY:n,display:i}=Wr(r);return/auto|scroll|overlay|hidden|clip/.test(e+n+t)&&!Ev.has(i)}const Pv=new Set(["table","td","th"]);function Av(r){return Pv.has(vi(r))}const Tv=[":popover-open",":modal"];function sl(r){return Tv.some(e=>{try{return r.matches(e)}catch{return!1}})}const Rv=["transform","translate","scale","rotate","perspective"],Dv=["transform","translate","scale","rotate","perspective","filter"],Ov=["paint","layout","strict","content"];function Yd(r){const e=Xd(),t=Ur(r)?Wr(r):r;return Rv.some(n=>t[n]?t[n]!=="none":!1)||(t.containerType?t.containerType!=="normal":!1)||!e&&(t.backdropFilter?t.backdropFilter!=="none":!1)||!e&&(t.filter?t.filter!=="none":!1)||Dv.some(n=>(t.willChange||"").includes(n))||Ov.some(n=>(t.contain||"").includes(n))}function Iv(r){let e=es(r);for(;cn(e)&&!pi(e);){if(Yd(e))return e;if(sl(e))return null;e=es(e)}return null}function Xd(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const Mv=new Set(["html","body","#document"]);function pi(r){return Mv.has(vi(r))}function Wr(r){return mr(r).getComputedStyle(r)}function il(r){return Ur(r)?{scrollLeft:r.scrollLeft,scrollTop:r.scrollTop}:{scrollLeft:r.scrollX,scrollTop:r.scrollY}}function es(r){if(vi(r)==="html")return r;const e=r.assignedSlot||r.parentNode||kf(r)&&r.host||dn(r);return kf(e)?e.host:e}function Hm(r){const e=es(r);return pi(e)?r.ownerDocument?r.ownerDocument.body:r.body:cn(e)&&_a(e)?e:Hm(e)}function ua(r,e,t){var n;e===void 0&&(e=[]),t===void 0&&(t=!0);const i=Hm(r),l=i===((n=r.ownerDocument)==null?void 0:n.body),c=mr(i);if(l){const d=od(c);return e.concat(c,c.visualViewport||[],_a(i)?i:[],d&&t?ua(d):[])}return e.concat(i,ua(i,[],t))}function od(r){return r.parent&&Object.getPrototypeOf(r.parent)?r.frameElement:null}function Um(r){const e=Wr(r);let t=parseFloat(e.width)||0,n=parseFloat(e.height)||0;const i=cn(r),l=i?r.offsetWidth:t,c=i?r.offsetHeight:n,d=Vo(t)!==l||Vo(n)!==c;return d&&(t=l,n=c),{width:t,height:n,$:d}}function qd(r){return Ur(r)?r:r.contextElement}function ri(r){const e=qd(r);if(!cn(e))return ln(1);const t=e.getBoundingClientRect(),{width:n,height:i,$:l}=Um(e);let c=(l?Vo(t.width):t.width)/n,d=(l?Vo(t.height):t.height)/i;return(!c||!Number.isFinite(c))&&(c=1),(!d||!Number.isFinite(d))&&(d=1),{x:c,y:d}}const Lv=ln(0);function Wm(r){const e=mr(r);return!Xd()||!e.visualViewport?Lv:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function Fv(r,e,t){return e===void 0&&(e=!1),!t||e&&t!==mr(r)?!1:e}function Es(r,e,t,n){e===void 0&&(e=!1),t===void 0&&(t=!1);const i=r.getBoundingClientRect(),l=qd(r);let c=ln(1);e&&(n?Ur(n)&&(c=ri(n)):c=ri(r));const d=Fv(l,t,n)?Wm(l):ln(0);let u=(i.left+d.x)/c.x,f=(i.top+d.y)/c.y,p=i.width/c.x,m=i.height/c.y;if(l){const y=mr(l),w=n&&Ur(n)?mr(n):n;let _=y,x=od(_);for(;x&&n&&w!==_;){const v=ri(x),S=x.getBoundingClientRect(),C=Wr(x),k=S.left+(x.clientLeft+parseFloat(C.paddingLeft))*v.x,E=S.top+(x.clientTop+parseFloat(C.paddingTop))*v.y;u*=v.x,f*=v.y,p*=v.x,m*=v.y,u+=k,f+=E,_=mr(x),x=od(_)}}return Yo({width:p,height:m,x:u,y:f})}function al(r,e){const t=il(r).scrollLeft;return e?e.left+t:Es(dn(r)).left+t}function Vm(r,e){const t=r.getBoundingClientRect(),n=t.left+e.scrollLeft-al(r,t),i=t.top+e.scrollTop;return{x:n,y:i}}function zv(r){let{elements:e,rect:t,offsetParent:n,strategy:i}=r;const l=i==="fixed",c=dn(n),d=e?sl(e.floating):!1;if(n===c||d&&l)return t;let u={scrollLeft:0,scrollTop:0},f=ln(1);const p=ln(0),m=cn(n);if((m||!m&&!l)&&((vi(n)!=="body"||_a(c))&&(u=il(n)),cn(n))){const w=Es(n);f=ri(n),p.x=w.x+n.clientLeft,p.y=w.y+n.clientTop}const y=c&&!m&&!l?Vm(c,u):ln(0);return{width:t.width*f.x,height:t.height*f.y,x:t.x*f.x-u.scrollLeft*f.x+p.x+y.x,y:t.y*f.y-u.scrollTop*f.y+p.y+y.y}}function Bv(r){return Array.from(r.getClientRects())}function Gv(r){const e=dn(r),t=il(r),n=r.ownerDocument.body,i=fr(e.scrollWidth,e.clientWidth,n.scrollWidth,n.clientWidth),l=fr(e.scrollHeight,e.clientHeight,n.scrollHeight,n.clientHeight);let c=-t.scrollLeft+al(r);const d=-t.scrollTop;return Wr(n).direction==="rtl"&&(c+=fr(e.clientWidth,n.clientWidth)-i),{width:i,height:l,x:c,y:d}}const Nf=25;function Hv(r,e){const t=mr(r),n=dn(r),i=t.visualViewport;let l=n.clientWidth,c=n.clientHeight,d=0,u=0;if(i){l=i.width,c=i.height;const p=Xd();(!p||p&&e==="fixed")&&(d=i.offsetLeft,u=i.offsetTop)}const f=al(n);if(f<=0){const p=n.ownerDocument,m=p.body,y=getComputedStyle(m),w=p.compatMode==="CSS1Compat"&&parseFloat(y.marginLeft)+parseFloat(y.marginRight)||0,_=Math.abs(n.clientWidth-m.clientWidth-w);_<=Nf&&(l-=_)}else f<=Nf&&(l+=f);return{width:l,height:c,x:d,y:u}}const Uv=new Set(["absolute","fixed"]);function Wv(r,e){const t=Es(r,!0,e==="fixed"),n=t.top+r.clientTop,i=t.left+r.clientLeft,l=cn(r)?ri(r):ln(1),c=r.clientWidth*l.x,d=r.clientHeight*l.y,u=i*l.x,f=n*l.y;return{width:c,height:d,x:u,y:f}}function jf(r,e,t){let n;if(e==="viewport")n=Hv(r,t);else if(e==="document")n=Gv(dn(r));else if(Ur(e))n=Wv(e,t);else{const i=Wm(r);n={x:e.x-i.x,y:e.y-i.y,width:e.width,height:e.height}}return Yo(n)}function $m(r,e){const t=es(r);return t===e||!Ur(t)||pi(t)?!1:Wr(t).position==="fixed"||$m(t,e)}function Vv(r,e){const t=e.get(r);if(t)return t;let n=ua(r,[],!1).filter(d=>Ur(d)&&vi(d)!=="body"),i=null;const l=Wr(r).position==="fixed";let c=l?es(r):r;for(;Ur(c)&&!pi(c);){const d=Wr(c),u=Yd(c);!u&&d.position==="fixed"&&(i=null),(l?!u&&!i:!u&&d.position==="static"&&!!i&&Uv.has(i.position)||_a(c)&&!u&&$m(r,c))?n=n.filter(p=>p!==c):i=d,c=es(c)}return e.set(r,n),n}function $v(r){let{element:e,boundary:t,rootBoundary:n,strategy:i}=r;const c=[...t==="clippingAncestors"?sl(e)?[]:Vv(e,this._c):[].concat(t),n],d=c[0],u=c.reduce((f,p)=>{const m=jf(e,p,i);return f.top=fr(m.top,f.top),f.right=Jn(m.right,f.right),f.bottom=Jn(m.bottom,f.bottom),f.left=fr(m.left,f.left),f},jf(e,d,i));return{width:u.right-u.left,height:u.bottom-u.top,x:u.left,y:u.top}}function Yv(r){const{width:e,height:t}=Um(r);return{width:e,height:t}}function Xv(r,e,t){const n=cn(e),i=dn(e),l=t==="fixed",c=Es(r,!0,l,e);let d={scrollLeft:0,scrollTop:0};const u=ln(0);function f(){u.x=al(i)}if(n||!n&&!l)if((vi(e)!=="body"||_a(i))&&(d=il(e)),n){const w=Es(e,!0,l,e);u.x=w.x+e.clientLeft,u.y=w.y+e.clientTop}else i&&f();l&&!n&&i&&f();const p=i&&!n&&!l?Vm(i,d):ln(0),m=c.left+d.scrollLeft-u.x-p.x,y=c.top+d.scrollTop-u.y-p.y;return{x:m,y,width:c.width,height:c.height}}function Gc(r){return Wr(r).position==="static"}function Ef(r,e){if(!cn(r)||Wr(r).position==="fixed")return null;if(e)return e(r);let t=r.offsetParent;return dn(r)===t&&(t=t.ownerDocument.body),t}function Ym(r,e){const t=mr(r);if(sl(r))return t;if(!cn(r)){let i=es(r);for(;i&&!pi(i);){if(Ur(i)&&!Gc(i))return i;i=es(i)}return t}let n=Ef(r,e);for(;n&&Av(n)&&Gc(n);)n=Ef(n,e);return n&&pi(n)&&Gc(n)&&!Yd(n)?t:n||Iv(r)||t}const qv=async function(r){const e=this.getOffsetParent||Ym,t=this.getDimensions,n=await t(r.floating);return{reference:Xv(r.reference,await e(r.floating),r.strategy),floating:{x:0,y:0,width:n.width,height:n.height}}};function Kv(r){return Wr(r).direction==="rtl"}const Qv={convertOffsetParentRelativeRectToViewportRelativeRect:zv,getDocumentElement:dn,getClippingRect:$v,getOffsetParent:Ym,getElementRects:qv,getClientRects:Bv,getDimensions:Yv,getScale:ri,isElement:Ur,isRTL:Kv};function Xm(r,e){return r.x===e.x&&r.y===e.y&&r.width===e.width&&r.height===e.height}function Zv(r,e){let t=null,n;const i=dn(r);function l(){var d;clearTimeout(n),(d=t)==null||d.disconnect(),t=null}function c(d,u){d===void 0&&(d=!1),u===void 0&&(u=1),l();const f=r.getBoundingClientRect(),{left:p,top:m,width:y,height:w}=f;if(d||e(),!y||!w)return;const _=bo(m),x=bo(i.clientWidth-(p+y)),v=bo(i.clientHeight-(m+w)),S=bo(p),k={rootMargin:-_+"px "+-x+"px "+-v+"px "+-S+"px",threshold:fr(0,Jn(1,u))||1};let E=!0;function P(D){const I=D[0].intersectionRatio;if(I!==u){if(!E)return c();I?c(!1,I):n=setTimeout(()=>{c(!1,1e-7)},1e3)}I===1&&!Xm(f,r.getBoundingClientRect())&&c(),E=!1}try{t=new IntersectionObserver(P,{...k,root:i.ownerDocument})}catch{t=new IntersectionObserver(P,k)}t.observe(r)}return c(!0),l}function Jv(r,e,t,n){n===void 0&&(n={});const{ancestorScroll:i=!0,ancestorResize:l=!0,elementResize:c=typeof ResizeObserver=="function",layoutShift:d=typeof IntersectionObserver=="function",animationFrame:u=!1}=n,f=qd(r),p=i||l?[...f?ua(f):[],...ua(e)]:[];p.forEach(S=>{i&&S.addEventListener("scroll",t,{passive:!0}),l&&S.addEventListener("resize",t)});const m=f&&d?Zv(f,t):null;let y=-1,w=null;c&&(w=new ResizeObserver(S=>{let[C]=S;C&&C.target===f&&w&&(w.unobserve(e),cancelAnimationFrame(y),y=requestAnimationFrame(()=>{var k;(k=w)==null||k.observe(e)})),t()}),f&&!u&&w.observe(f),w.observe(e));let _,x=u?Es(r):null;u&&v();function v(){const S=Es(r);x&&!Xm(x,S)&&t(),x=S,_=requestAnimationFrame(v)}return t(),()=>{var S;p.forEach(C=>{i&&C.removeEventListener("scroll",t),l&&C.removeEventListener("resize",t)}),m==null||m(),(S=w)==null||S.disconnect(),w=null,u&&cancelAnimationFrame(_)}}const e5=Cv,t5=kv,r5=bv,n5=jv,s5=_v,Pf=wv,i5=Nv,a5=(r,e,t)=>{const n=new Map,i={platform:Qv,...t},l={...i.platform,_c:n};return vv(r,e,{...i,platform:l})};var o5=typeof document<"u",l5=function(){},Fo=o5?T.useLayoutEffect:l5;function Xo(r,e){if(r===e)return!0;if(typeof r!=typeof e)return!1;if(typeof r=="function"&&r.toString()===e.toString())return!0;let t,n,i;if(r&&e&&typeof r=="object"){if(Array.isArray(r)){if(t=r.length,t!==e.length)return!1;for(n=t;n--!==0;)if(!Xo(r[n],e[n]))return!1;return!0}if(i=Object.keys(r),t=i.length,t!==Object.keys(e).length)return!1;for(n=t;n--!==0;)if(!{}.hasOwnProperty.call(e,i[n]))return!1;for(n=t;n--!==0;){const l=i[n];if(!(l==="_owner"&&r.$$typeof)&&!Xo(r[l],e[l]))return!1}return!0}return r!==r&&e!==e}function qm(r){return typeof window>"u"?1:(r.ownerDocument.defaultView||window).devicePixelRatio||1}function Af(r,e){const t=qm(r);return Math.round(e*t)/t}function Hc(r){const e=T.useRef(r);return Fo(()=>{e.current=r}),e}function c5(r){r===void 0&&(r={});const{placement:e="bottom",strategy:t="absolute",middleware:n=[],platform:i,elements:{reference:l,floating:c}={},transform:d=!0,whileElementsMounted:u,open:f}=r,[p,m]=T.useState({x:0,y:0,strategy:t,placement:e,middlewareData:{},isPositioned:!1}),[y,w]=T.useState(n);Xo(y,n)||w(n);const[_,x]=T.useState(null),[v,S]=T.useState(null),C=T.useCallback(J=>{J!==D.current&&(D.current=J,x(J))},[]),k=T.useCallback(J=>{J!==I.current&&(I.current=J,S(J))},[]),E=l||_,P=c||v,D=T.useRef(null),I=T.useRef(null),B=T.useRef(p),z=u!=null,X=Hc(u),se=Hc(i),R=Hc(f),H=T.useCallback(()=>{if(!D.current||!I.current)return;const J={placement:e,strategy:t,middleware:y};se.current&&(J.platform=se.current),a5(D.current,I.current,J).then(ee=>{const be={...ee,isPositioned:R.current!==!1};j.current&&!Xo(B.current,be)&&(B.current=be,Td.flushSync(()=>{m(be)}))})},[y,e,t,se,R]);Fo(()=>{f===!1&&B.current.isPositioned&&(B.current.isPositioned=!1,m(J=>({...J,isPositioned:!1})))},[f]);const j=T.useRef(!1);Fo(()=>(j.current=!0,()=>{j.current=!1}),[]),Fo(()=>{if(E&&(D.current=E),P&&(I.current=P),E&&P){if(X.current)return X.current(E,P,H);H()}},[E,P,H,X,z]);const G=T.useMemo(()=>({reference:D,floating:I,setReference:C,setFloating:k}),[C,k]),Q=T.useMemo(()=>({reference:E,floating:P}),[E,P]),K=T.useMemo(()=>{const J={position:t,left:0,top:0};if(!Q.floating)return J;const ee=Af(Q.floating,p.x),be=Af(Q.floating,p.y);return d?{...J,transform:"translate("+ee+"px, "+be+"px)",...qm(Q.floating)>=1.5&&{willChange:"transform"}}:{position:t,left:ee,top:be}},[t,d,Q.floating,p.x,p.y]);return T.useMemo(()=>({...p,update:H,refs:G,elements:Q,floatingStyles:K}),[p,H,G,Q,K])}const d5=r=>{function e(t){return{}.hasOwnProperty.call(t,"current")}return{name:"arrow",options:r,fn(t){const{element:n,padding:i}=typeof r=="function"?r(t):r;return n&&e(n)?n.current!=null?Pf({element:n.current,padding:i}).fn(t):{}:n?Pf({element:n,padding:i}).fn(t):{}}}},u5=(r,e)=>({...e5(r),options:[r,e]}),h5=(r,e)=>({...t5(r),options:[r,e]}),f5=(r,e)=>({...i5(r),options:[r,e]}),p5=(r,e)=>({...r5(r),options:[r,e]}),m5=(r,e)=>({...n5(r),options:[r,e]}),g5=(r,e)=>({...s5(r),options:[r,e]}),x5=(r,e)=>({...d5(r),options:[r,e]});var y5="Arrow",Km=T.forwardRef((r,e)=>{const{children:t,width:n=10,height:i=5,...l}=r;return a.jsx(vt.svg,{...l,ref:e,width:n,height:i,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:r.asChild?t:a.jsx("polygon",{points:"0,0 30,0 15,10"})})});Km.displayName=y5;var v5=Km;function Kd(r){const[e,t]=T.useState(void 0);return ca(()=>{if(r){t({width:r.offsetWidth,height:r.offsetHeight});const n=new ResizeObserver(i=>{if(!Array.isArray(i)||!i.length)return;const l=i[0];let c,d;if("borderBoxSize"in l){const u=l.borderBoxSize,f=Array.isArray(u)?u[0]:u;c=f.inlineSize,d=f.blockSize}else c=r.offsetWidth,d=r.offsetHeight;t({width:c,height:d})});return n.observe(r,{box:"border-box"}),()=>n.unobserve(r)}else t(void 0)},[r]),e}var Qd="Popper",[Qm,ol]=kn(Qd),[w5,Zm]=Qm(Qd),Jm=r=>{const{__scopePopper:e,children:t}=r,[n,i]=T.useState(null);return a.jsx(w5,{scope:e,anchor:n,onAnchorChange:i,children:t})};Jm.displayName=Qd;var eg="PopperAnchor",tg=T.forwardRef((r,e)=>{const{__scopePopper:t,virtualRef:n,...i}=r,l=Zm(eg,t),c=T.useRef(null),d=Dt(e,c),u=T.useRef(null);return T.useEffect(()=>{const f=u.current;u.current=(n==null?void 0:n.current)||c.current,f!==u.current&&l.onAnchorChange(u.current)}),n?null:a.jsx(vt.div,{...i,ref:d})});tg.displayName=eg;var Zd="PopperContent",[b5,_5]=Qm(Zd),rg=T.forwardRef((r,e)=>{var gt,Ge,He,ot,Ue,At;const{__scopePopper:t,side:n="bottom",sideOffset:i=0,align:l="center",alignOffset:c=0,arrowPadding:d=0,avoidCollisions:u=!0,collisionBoundary:f=[],collisionPadding:p=0,sticky:m="partial",hideWhenDetached:y=!1,updatePositionStrategy:w="optimized",onPlaced:_,...x}=r,v=Zm(Zd,t),[S,C]=T.useState(null),k=Dt(e,Qe=>C(Qe)),[E,P]=T.useState(null),D=Kd(E),I=(D==null?void 0:D.width)??0,B=(D==null?void 0:D.height)??0,z=n+(l!=="center"?"-"+l:""),X=typeof p=="number"?p:{top:0,right:0,bottom:0,left:0,...p},se=Array.isArray(f)?f:[f],R=se.length>0,H={padding:X,boundary:se.filter(C5),altBoundary:R},{refs:j,floatingStyles:G,placement:Q,isPositioned:K,middlewareData:J}=c5({strategy:"fixed",placement:z,whileElementsMounted:(...Qe)=>Jv(...Qe,{animationFrame:w==="always"}),elements:{reference:v.anchor},middleware:[u5({mainAxis:i+B,alignmentAxis:c}),u&&h5({mainAxis:!0,crossAxis:!1,limiter:m==="partial"?f5():void 0,...H}),u&&p5({...H}),m5({...H,apply:({elements:Qe,rects:A,availableWidth:oe,availableHeight:ne})=>{const{width:L,height:M}=A.reference,U=Qe.floating.style;U.setProperty("--radix-popper-available-width",`${oe}px`),U.setProperty("--radix-popper-available-height",`${ne}px`),U.setProperty("--radix-popper-anchor-width",`${L}px`),U.setProperty("--radix-popper-anchor-height",`${M}px`)}}),E&&x5({element:E,padding:d}),k5({arrowWidth:I,arrowHeight:B}),y&&g5({strategy:"referenceHidden",...H})]}),[ee,be]=ig(Q),V=la(_);ca(()=>{K&&(V==null||V())},[K,V]);const Y=(gt=J.arrow)==null?void 0:gt.x,Se=(Ge=J.arrow)==null?void 0:Ge.y,Ce=((He=J.arrow)==null?void 0:He.centerOffset)!==0,[ye,at]=T.useState();return ca(()=>{S&&at(window.getComputedStyle(S).zIndex)},[S]),a.jsx("div",{ref:j.setFloating,"data-radix-popper-content-wrapper":"",style:{...G,transform:K?G.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:ye,"--radix-popper-transform-origin":[(ot=J.transformOrigin)==null?void 0:ot.x,(Ue=J.transformOrigin)==null?void 0:Ue.y].join(" "),...((At=J.hide)==null?void 0:At.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:r.dir,children:a.jsx(b5,{scope:t,placedSide:ee,onArrowChange:P,arrowX:Y,arrowY:Se,shouldHideArrow:Ce,children:a.jsx(vt.div,{"data-side":ee,"data-align":be,...x,ref:k,style:{...x.style,animation:K?void 0:"none"}})})})});rg.displayName=Zd;var ng="PopperArrow",S5={top:"bottom",right:"left",bottom:"top",left:"right"},sg=T.forwardRef(function(e,t){const{__scopePopper:n,...i}=e,l=_5(ng,n),c=S5[l.placedSide];return a.jsx("span",{ref:l.onArrowChange,style:{position:"absolute",left:l.arrowX,top:l.arrowY,[c]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[l.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[l.placedSide],visibility:l.shouldHideArrow?"hidden":void 0},children:a.jsx(v5,{...i,ref:t,style:{...i.style,display:"block"}})})});sg.displayName=ng;function C5(r){return r!==null}var k5=r=>({name:"transformOrigin",options:r,fn(e){var v,S,C;const{placement:t,rects:n,middlewareData:i}=e,c=((v=i.arrow)==null?void 0:v.centerOffset)!==0,d=c?0:r.arrowWidth,u=c?0:r.arrowHeight,[f,p]=ig(t),m={start:"0%",center:"50%",end:"100%"}[p],y=(((S=i.arrow)==null?void 0:S.x)??0)+d/2,w=(((C=i.arrow)==null?void 0:C.y)??0)+u/2;let _="",x="";return f==="bottom"?(_=c?m:`${y}px`,x=`${-u}px`):f==="top"?(_=c?m:`${y}px`,x=`${n.floating.height+u}px`):f==="right"?(_=`${-u}px`,x=c?m:`${w}px`):f==="left"&&(_=`${n.floating.width+u}px`,x=c?m:`${w}px`),{data:{x:_,y:x}}}});function ig(r){const[e,t="center"]=r.split("-");return[e,t]}var ag=Jm,Jd=tg,og=rg,lg=sg,N5=Symbol("radix.slottable");function j5(r){const e=({children:t})=>a.jsx(a.Fragment,{children:t});return e.displayName=`${r}.Slottable`,e.__radixId=N5,e}var[ll]=kn("Tooltip",[ol]),cl=ol(),cg="TooltipProvider",E5=700,ld="tooltip.open",[P5,eu]=ll(cg),dg=r=>{const{__scopeTooltip:e,delayDuration:t=E5,skipDelayDuration:n=300,disableHoverableContent:i=!1,children:l}=r,c=T.useRef(!0),d=T.useRef(!1),u=T.useRef(0);return T.useEffect(()=>{const f=u.current;return()=>window.clearTimeout(f)},[]),a.jsx(P5,{scope:e,isOpenDelayedRef:c,delayDuration:t,onOpen:T.useCallback(()=>{window.clearTimeout(u.current),c.current=!1},[]),onClose:T.useCallback(()=>{window.clearTimeout(u.current),u.current=window.setTimeout(()=>c.current=!0,n)},[n]),isPointerInTransitRef:d,onPointerInTransitChange:T.useCallback(f=>{d.current=f},[]),disableHoverableContent:i,children:l})};dg.displayName=cg;var ha="Tooltip",[A5,dl]=ll(ha),ug=r=>{const{__scopeTooltip:e,children:t,open:n,defaultOpen:i,onOpenChange:l,disableHoverableContent:c,delayDuration:d}=r,u=eu(ha,r.__scopeTooltip),f=cl(e),[p,m]=T.useState(null),y=Zo(),w=T.useRef(0),_=c??u.disableHoverableContent,x=d??u.delayDuration,v=T.useRef(!1),[S,C]=ts({prop:n,defaultProp:i??!1,onChange:I=>{I?(u.onOpen(),document.dispatchEvent(new CustomEvent(ld))):u.onClose(),l==null||l(I)},caller:ha}),k=T.useMemo(()=>S?v.current?"delayed-open":"instant-open":"closed",[S]),E=T.useCallback(()=>{window.clearTimeout(w.current),w.current=0,v.current=!1,C(!0)},[C]),P=T.useCallback(()=>{window.clearTimeout(w.current),w.current=0,C(!1)},[C]),D=T.useCallback(()=>{window.clearTimeout(w.current),w.current=window.setTimeout(()=>{v.current=!0,C(!0),w.current=0},x)},[x,C]);return T.useEffect(()=>()=>{w.current&&(window.clearTimeout(w.current),w.current=0)},[]),a.jsx(ag,{...f,children:a.jsx(A5,{scope:e,contentId:y,open:S,stateAttribute:k,trigger:p,onTriggerChange:m,onTriggerEnter:T.useCallback(()=>{u.isOpenDelayedRef.current?D():E()},[u.isOpenDelayedRef,D,E]),onTriggerLeave:T.useCallback(()=>{_?P():(window.clearTimeout(w.current),w.current=0)},[P,_]),onOpen:E,onClose:P,disableHoverableContent:_,children:t})})};ug.displayName=ha;var cd="TooltipTrigger",hg=T.forwardRef((r,e)=>{const{__scopeTooltip:t,...n}=r,i=dl(cd,t),l=eu(cd,t),c=cl(t),d=T.useRef(null),u=Dt(e,d,i.onTriggerChange),f=T.useRef(!1),p=T.useRef(!1),m=T.useCallback(()=>f.current=!1,[]);return T.useEffect(()=>()=>document.removeEventListener("pointerup",m),[m]),a.jsx(Jd,{asChild:!0,...c,children:a.jsx(vt.button,{"aria-describedby":i.open?i.contentId:void 0,"data-state":i.stateAttribute,...n,ref:u,onPointerMove:nt(r.onPointerMove,y=>{y.pointerType!=="touch"&&!p.current&&!l.isPointerInTransitRef.current&&(i.onTriggerEnter(),p.current=!0)}),onPointerLeave:nt(r.onPointerLeave,()=>{i.onTriggerLeave(),p.current=!1}),onPointerDown:nt(r.onPointerDown,()=>{i.open&&i.onClose(),f.current=!0,document.addEventListener("pointerup",m,{once:!0})}),onFocus:nt(r.onFocus,()=>{f.current||i.onOpen()}),onBlur:nt(r.onBlur,i.onClose),onClick:nt(r.onClick,i.onClose)})})});hg.displayName=cd;var T5="TooltipPortal",[I_,R5]=ll(T5,{forceMount:void 0}),mi="TooltipContent",fg=T.forwardRef((r,e)=>{const t=R5(mi,r.__scopeTooltip),{forceMount:n=t.forceMount,side:i="top",...l}=r,c=dl(mi,r.__scopeTooltip);return a.jsx(va,{present:n||c.open,children:c.disableHoverableContent?a.jsx(pg,{side:i,...l,ref:e}):a.jsx(D5,{side:i,...l,ref:e})})}),D5=T.forwardRef((r,e)=>{const t=dl(mi,r.__scopeTooltip),n=eu(mi,r.__scopeTooltip),i=T.useRef(null),l=Dt(e,i),[c,d]=T.useState(null),{trigger:u,onClose:f}=t,p=i.current,{onPointerInTransitChange:m}=n,y=T.useCallback(()=>{d(null),m(!1)},[m]),w=T.useCallback((_,x)=>{const v=_.currentTarget,S={x:_.clientX,y:_.clientY},C=F5(S,v.getBoundingClientRect()),k=z5(S,C),E=B5(x.getBoundingClientRect()),P=H5([...k,...E]);d(P),m(!0)},[m]);return T.useEffect(()=>()=>y(),[y]),T.useEffect(()=>{if(u&&p){const _=v=>w(v,p),x=v=>w(v,u);return u.addEventListener("pointerleave",_),p.addEventListener("pointerleave",x),()=>{u.removeEventListener("pointerleave",_),p.removeEventListener("pointerleave",x)}}},[u,p,w,y]),T.useEffect(()=>{if(c){const _=x=>{const v=x.target,S={x:x.clientX,y:x.clientY},C=(u==null?void 0:u.contains(v))||(p==null?void 0:p.contains(v)),k=!G5(S,c);C?y():k&&(y(),f())};return document.addEventListener("pointermove",_),()=>document.removeEventListener("pointermove",_)}},[u,p,c,f,y]),a.jsx(pg,{...r,ref:l})}),[O5,I5]=ll(ha,{isInside:!1}),M5=j5("TooltipContent"),pg=T.forwardRef((r,e)=>{const{__scopeTooltip:t,children:n,"aria-label":i,onEscapeKeyDown:l,onPointerDownOutside:c,...d}=r,u=dl(mi,t),f=cl(t),{onClose:p}=u;return T.useEffect(()=>(document.addEventListener(ld,p),()=>document.removeEventListener(ld,p)),[p]),T.useEffect(()=>{if(u.trigger){const m=y=>{const w=y.target;w!=null&&w.contains(u.trigger)&&p()};return window.addEventListener("scroll",m,{capture:!0}),()=>window.removeEventListener("scroll",m,{capture:!0})}},[u.trigger,p]),a.jsx(Hp,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:l,onPointerDownOutside:c,onFocusOutside:m=>m.preventDefault(),onDismiss:p,children:a.jsxs(og,{"data-state":u.stateAttribute,...f,...d,ref:e,style:{...d.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[a.jsx(M5,{children:n}),a.jsx(O5,{scope:t,isInside:!0,children:a.jsx(Dy,{id:u.contentId,role:"tooltip",children:i||n})})]})})});fg.displayName=mi;var mg="TooltipArrow",L5=T.forwardRef((r,e)=>{const{__scopeTooltip:t,...n}=r,i=cl(t);return I5(mg,t).isInside?null:a.jsx(lg,{...i,...n,ref:e})});L5.displayName=mg;function F5(r,e){const t=Math.abs(e.top-r.y),n=Math.abs(e.bottom-r.y),i=Math.abs(e.right-r.x),l=Math.abs(e.left-r.x);switch(Math.min(t,n,i,l)){case l:return"left";case i:return"right";case t:return"top";case n:return"bottom";default:throw new Error("unreachable")}}function z5(r,e,t=5){const n=[];switch(e){case"top":n.push({x:r.x-t,y:r.y+t},{x:r.x+t,y:r.y+t});break;case"bottom":n.push({x:r.x-t,y:r.y-t},{x:r.x+t,y:r.y-t});break;case"left":n.push({x:r.x+t,y:r.y-t},{x:r.x+t,y:r.y+t});break;case"right":n.push({x:r.x-t,y:r.y-t},{x:r.x-t,y:r.y+t});break}return n}function B5(r){const{top:e,right:t,bottom:n,left:i}=r;return[{x:i,y:e},{x:t,y:e},{x:t,y:n},{x:i,y:n}]}function G5(r,e){const{x:t,y:n}=r;let i=!1;for(let l=0,c=e.length-1;l<e.length;c=l++){const d=e[l],u=e[c],f=d.x,p=d.y,m=u.x,y=u.y;p>n!=y>n&&t<(m-f)*(n-p)/(y-p)+f&&(i=!i)}return i}function H5(r){const e=r.slice();return e.sort((t,n)=>t.x<n.x?-1:t.x>n.x?1:t.y<n.y?-1:t.y>n.y?1:0),U5(e)}function U5(r){if(r.length<=1)return r.slice();const e=[];for(let n=0;n<r.length;n++){const i=r[n];for(;e.length>=2;){const l=e[e.length-1],c=e[e.length-2];if((l.x-c.x)*(i.y-c.y)>=(l.y-c.y)*(i.x-c.x))e.pop();else break}e.push(i)}e.pop();const t=[];for(let n=r.length-1;n>=0;n--){const i=r[n];for(;t.length>=2;){const l=t[t.length-1],c=t[t.length-2];if((l.x-c.x)*(i.y-c.y)>=(l.y-c.y)*(i.x-c.x))t.pop();else break}t.push(i)}return t.pop(),e.length===1&&t.length===1&&e[0].x===t[0].x&&e[0].y===t[0].y?e:e.concat(t)}var W5=dg,V5=ug,$5=hg,gg=fg;const Y5=W5,ra=V5,na=$5,ni=T.forwardRef(({className:r,sideOffset:e=4,...t},n)=>a.jsx(gg,{ref:n,sideOffset:e,className:it("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",r),...t}));ni.displayName=gg.displayName;var ul=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(r){return this.listeners.add(r),this.onSubscribe(),()=>{this.listeners.delete(r),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},X5={setTimeout:(r,e)=>setTimeout(r,e),clearTimeout:r=>clearTimeout(r),setInterval:(r,e)=>setInterval(r,e),clearInterval:r=>clearInterval(r)},Vn,Ad,Tp,q5=(Tp=class{constructor(){qe(this,Vn,X5);qe(this,Ad,!1)}setTimeoutProvider(r){Le(this,Vn,r)}setTimeout(r,e){return ae(this,Vn).setTimeout(r,e)}clearTimeout(r){ae(this,Vn).clearTimeout(r)}setInterval(r,e){return ae(this,Vn).setInterval(r,e)}clearInterval(r){ae(this,Vn).clearInterval(r)}},Vn=new WeakMap,Ad=new WeakMap,Tp),dd=new q5;function K5(r){setTimeout(r,0)}var hl=typeof window>"u"||"Deno"in globalThis;function zr(){}function Q5(r,e){return typeof r=="function"?r(e):r}function Z5(r){return typeof r=="number"&&r>=0&&r!==1/0}function J5(r,e){return Math.max(r+(e||0)-Date.now(),0)}function ud(r,e){return typeof r=="function"?r(e):r}function e3(r,e){return typeof r=="function"?r(e):r}function Tf(r,e){const{type:t="all",exact:n,fetchStatus:i,predicate:l,queryKey:c,stale:d}=r;if(c){if(n){if(e.queryHash!==tu(c,e.options))return!1}else if(!pa(e.queryKey,c))return!1}if(t!=="all"){const u=e.isActive();if(t==="active"&&!u||t==="inactive"&&u)return!1}return!(typeof d=="boolean"&&e.isStale()!==d||i&&i!==e.state.fetchStatus||l&&!l(e))}function Rf(r,e){const{exact:t,status:n,predicate:i,mutationKey:l}=r;if(l){if(!e.options.mutationKey)return!1;if(t){if(fa(e.options.mutationKey)!==fa(l))return!1}else if(!pa(e.options.mutationKey,l))return!1}return!(n&&e.state.status!==n||i&&!i(e))}function tu(r,e){return((e==null?void 0:e.queryKeyHashFn)||fa)(r)}function fa(r){return JSON.stringify(r,(e,t)=>hd(t)?Object.keys(t).sort().reduce((n,i)=>(n[i]=t[i],n),{}):t)}function pa(r,e){return r===e?!0:typeof r!=typeof e?!1:r&&e&&typeof r=="object"&&typeof e=="object"?Object.keys(e).every(t=>pa(r[t],e[t])):!1}var t3=Object.prototype.hasOwnProperty;function xg(r,e,t=0){if(r===e)return r;if(t>500)return e;const n=Df(r)&&Df(e);if(!n&&!(hd(r)&&hd(e)))return e;const l=(n?r:Object.keys(r)).length,c=n?e:Object.keys(e),d=c.length,u=n?new Array(d):{};let f=0;for(let p=0;p<d;p++){const m=n?p:c[p],y=r[m],w=e[m];if(y===w){u[m]=y,(n?p<l:t3.call(r,m))&&f++;continue}if(y===null||w===null||typeof y!="object"||typeof w!="object"){u[m]=w;continue}const _=xg(y,w,t+1);u[m]=_,_===y&&f++}return l===d&&f===l?r:u}function Df(r){return Array.isArray(r)&&r.length===Object.keys(r).length}function hd(r){if(!Of(r))return!1;const e=r.constructor;if(e===void 0)return!0;const t=e.prototype;return!(!Of(t)||!t.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(r)!==Object.prototype)}function Of(r){return Object.prototype.toString.call(r)==="[object Object]"}function r3(r){return new Promise(e=>{dd.setTimeout(e,r)})}function n3(r,e,t){return typeof t.structuralSharing=="function"?t.structuralSharing(r,e):t.structuralSharing!==!1?xg(r,e):e}function s3(r,e,t=0){const n=[...r,e];return t&&n.length>t?n.slice(1):n}function i3(r,e,t=0){const n=[e,...r];return t&&n.length>t?n.slice(0,-1):n}var ru=Symbol();function yg(r,e){return!r.queryFn&&(e!=null&&e.initialPromise)?()=>e.initialPromise:!r.queryFn||r.queryFn===ru?()=>Promise.reject(new Error(`Missing queryFn: '${r.queryHash}'`)):r.queryFn}function a3(r,e,t){let n=!1,i;return Object.defineProperty(r,"signal",{enumerable:!0,get:()=>(i??(i=e()),n||(n=!0,i.aborted?t():i.addEventListener("abort",t,{once:!0})),i)}),r}var _s,$n,si,Rp,o3=(Rp=class extends ul{constructor(){super();qe(this,_s);qe(this,$n);qe(this,si);Le(this,si,e=>{if(!hl&&window.addEventListener){const t=()=>e();return window.addEventListener("visibilitychange",t,!1),()=>{window.removeEventListener("visibilitychange",t)}}})}onSubscribe(){ae(this,$n)||this.setEventListener(ae(this,si))}onUnsubscribe(){var e;this.hasListeners()||((e=ae(this,$n))==null||e.call(this),Le(this,$n,void 0))}setEventListener(e){var t;Le(this,si,e),(t=ae(this,$n))==null||t.call(this),Le(this,$n,e(n=>{typeof n=="boolean"?this.setFocused(n):this.onFocus()}))}setFocused(e){ae(this,_s)!==e&&(Le(this,_s,e),this.onFocus())}onFocus(){const e=this.isFocused();this.listeners.forEach(t=>{t(e)})}isFocused(){var e;return typeof ae(this,_s)=="boolean"?ae(this,_s):((e=globalThis.document)==null?void 0:e.visibilityState)!=="hidden"}},_s=new WeakMap,$n=new WeakMap,si=new WeakMap,Rp),vg=new o3;function l3(){let r,e;const t=new Promise((i,l)=>{r=i,e=l});t.status="pending",t.catch(()=>{});function n(i){Object.assign(t,i),delete t.resolve,delete t.reject}return t.resolve=i=>{n({status:"fulfilled",value:i}),r(i)},t.reject=i=>{n({status:"rejected",reason:i}),e(i)},t}var c3=K5;function d3(){let r=[],e=0,t=d=>{d()},n=d=>{d()},i=c3;const l=d=>{e?r.push(d):i(()=>{t(d)})},c=()=>{const d=r;r=[],d.length&&i(()=>{n(()=>{d.forEach(u=>{t(u)})})})};return{batch:d=>{let u;e++;try{u=d()}finally{e--,e||c()}return u},batchCalls:d=>(...u)=>{l(()=>{d(...u)})},schedule:l,setNotifyFunction:d=>{t=d},setBatchNotifyFunction:d=>{n=d},setScheduler:d=>{i=d}}}var rr=d3(),ii,Yn,ai,Dp,u3=(Dp=class extends ul{constructor(){super();qe(this,ii,!0);qe(this,Yn);qe(this,ai);Le(this,ai,e=>{if(!hl&&window.addEventListener){const t=()=>e(!0),n=()=>e(!1);return window.addEventListener("online",t,!1),window.addEventListener("offline",n,!1),()=>{window.removeEventListener("online",t),window.removeEventListener("offline",n)}}})}onSubscribe(){ae(this,Yn)||this.setEventListener(ae(this,ai))}onUnsubscribe(){var e;this.hasListeners()||((e=ae(this,Yn))==null||e.call(this),Le(this,Yn,void 0))}setEventListener(e){var t;Le(this,ai,e),(t=ae(this,Yn))==null||t.call(this),Le(this,Yn,e(this.setOnline.bind(this)))}setOnline(e){ae(this,ii)!==e&&(Le(this,ii,e),this.listeners.forEach(n=>{n(e)}))}isOnline(){return ae(this,ii)}},ii=new WeakMap,Yn=new WeakMap,ai=new WeakMap,Dp),qo=new u3;function h3(r){return Math.min(1e3*2**r,3e4)}function wg(r){return(r??"online")==="online"?qo.isOnline():!0}var fd=class extends Error{constructor(r){super("CancelledError"),this.revert=r==null?void 0:r.revert,this.silent=r==null?void 0:r.silent}};function bg(r){let e=!1,t=0,n;const i=l3(),l=()=>i.status!=="pending",c=x=>{var v;if(!l()){const S=new fd(x);y(S),(v=r.onCancel)==null||v.call(r,S)}},d=()=>{e=!0},u=()=>{e=!1},f=()=>vg.isFocused()&&(r.networkMode==="always"||qo.isOnline())&&r.canRun(),p=()=>wg(r.networkMode)&&r.canRun(),m=x=>{l()||(n==null||n(),i.resolve(x))},y=x=>{l()||(n==null||n(),i.reject(x))},w=()=>new Promise(x=>{var v;n=S=>{(l()||f())&&x(S)},(v=r.onPause)==null||v.call(r)}).then(()=>{var x;n=void 0,l()||(x=r.onContinue)==null||x.call(r)}),_=()=>{if(l())return;let x;const v=t===0?r.initialPromise:void 0;try{x=v??r.fn()}catch(S){x=Promise.reject(S)}Promise.resolve(x).then(m).catch(S=>{var D;if(l())return;const C=r.retry??(hl?0:3),k=r.retryDelay??h3,E=typeof k=="function"?k(t,S):k,P=C===!0||typeof C=="number"&&t<C||typeof C=="function"&&C(t,S);if(e||!P){y(S);return}t++,(D=r.onFail)==null||D.call(r,t,S),r3(E).then(()=>f()?void 0:w()).then(()=>{e?y(S):_()})})};return{promise:i,status:()=>i.status,cancel:c,continue:()=>(n==null||n(),i),cancelRetry:d,continueRetry:u,canStart:p,start:()=>(p()?_():w().then(_),i)}}var Ss,Op,_g=(Op=class{constructor(){qe(this,Ss)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),Z5(this.gcTime)&&Le(this,Ss,dd.setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(r){this.gcTime=Math.max(this.gcTime||0,r??(hl?1/0:5*60*1e3))}clearGcTimeout(){ae(this,Ss)&&(dd.clearTimeout(ae(this,Ss)),Le(this,Ss,void 0))}},Ss=new WeakMap,Op),Cs,oi,Pr,ks,Ut,ga,Ns,Br,wn,Ip,f3=(Ip=class extends _g{constructor(e){super();qe(this,Br);qe(this,Cs);qe(this,oi);qe(this,Pr);qe(this,ks);qe(this,Ut);qe(this,ga);qe(this,Ns);Le(this,Ns,!1),Le(this,ga,e.defaultOptions),this.setOptions(e.options),this.observers=[],Le(this,ks,e.client),Le(this,Pr,ae(this,ks).getQueryCache()),this.queryKey=e.queryKey,this.queryHash=e.queryHash,Le(this,Cs,Mf(this.options)),this.state=e.state??ae(this,Cs),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var e;return(e=ae(this,Ut))==null?void 0:e.promise}setOptions(e){if(this.options={...ae(this,ga),...e},this.updateGcTime(this.options.gcTime),this.state&&this.state.data===void 0){const t=Mf(this.options);t.data!==void 0&&(this.setState(If(t.data,t.dataUpdatedAt)),Le(this,Cs,t))}}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&ae(this,Pr).remove(this)}setData(e,t){const n=n3(this.state.data,e,this.options);return Jt(this,Br,wn).call(this,{data:n,type:"success",dataUpdatedAt:t==null?void 0:t.updatedAt,manual:t==null?void 0:t.manual}),n}setState(e,t){Jt(this,Br,wn).call(this,{type:"setState",state:e,setStateOptions:t})}cancel(e){var n,i;const t=(n=ae(this,Ut))==null?void 0:n.promise;return(i=ae(this,Ut))==null||i.cancel(e),t?t.then(zr).catch(zr):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(ae(this,Cs))}isActive(){return this.observers.some(e=>e3(e.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===ru||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(e=>ud(e.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(e=>e.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(e=0){return this.state.data===void 0?!0:e==="static"?!1:this.state.isInvalidated?!0:!J5(this.state.dataUpdatedAt,e)}onFocus(){var t;const e=this.observers.find(n=>n.shouldFetchOnWindowFocus());e==null||e.refetch({cancelRefetch:!1}),(t=ae(this,Ut))==null||t.continue()}onOnline(){var t;const e=this.observers.find(n=>n.shouldFetchOnReconnect());e==null||e.refetch({cancelRefetch:!1}),(t=ae(this,Ut))==null||t.continue()}addObserver(e){this.observers.includes(e)||(this.observers.push(e),this.clearGcTimeout(),ae(this,Pr).notify({type:"observerAdded",query:this,observer:e}))}removeObserver(e){this.observers.includes(e)&&(this.observers=this.observers.filter(t=>t!==e),this.observers.length||(ae(this,Ut)&&(ae(this,Ns)?ae(this,Ut).cancel({revert:!0}):ae(this,Ut).cancelRetry()),this.scheduleGc()),ae(this,Pr).notify({type:"observerRemoved",query:this,observer:e}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||Jt(this,Br,wn).call(this,{type:"invalidate"})}async fetch(e,t){var u,f,p,m,y,w,_,x,v,S,C,k;if(this.state.fetchStatus!=="idle"&&((u=ae(this,Ut))==null?void 0:u.status())!=="rejected"){if(this.state.data!==void 0&&(t!=null&&t.cancelRefetch))this.cancel({silent:!0});else if(ae(this,Ut))return ae(this,Ut).continueRetry(),ae(this,Ut).promise}if(e&&this.setOptions(e),!this.options.queryFn){const E=this.observers.find(P=>P.options.queryFn);E&&this.setOptions(E.options)}const n=new AbortController,i=E=>{Object.defineProperty(E,"signal",{enumerable:!0,get:()=>(Le(this,Ns,!0),n.signal)})},l=()=>{const E=yg(this.options,t),D=(()=>{const I={client:ae(this,ks),queryKey:this.queryKey,meta:this.meta};return i(I),I})();return Le(this,Ns,!1),this.options.persister?this.options.persister(E,D,this):E(D)},d=(()=>{const E={fetchOptions:t,options:this.options,queryKey:this.queryKey,client:ae(this,ks),state:this.state,fetchFn:l};return i(E),E})();(f=this.options.behavior)==null||f.onFetch(d,this),Le(this,oi,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((p=d.fetchOptions)==null?void 0:p.meta))&&Jt(this,Br,wn).call(this,{type:"fetch",meta:(m=d.fetchOptions)==null?void 0:m.meta}),Le(this,Ut,bg({initialPromise:t==null?void 0:t.initialPromise,fn:d.fetchFn,onCancel:E=>{E instanceof fd&&E.revert&&this.setState({...ae(this,oi),fetchStatus:"idle"}),n.abort()},onFail:(E,P)=>{Jt(this,Br,wn).call(this,{type:"failed",failureCount:E,error:P})},onPause:()=>{Jt(this,Br,wn).call(this,{type:"pause"})},onContinue:()=>{Jt(this,Br,wn).call(this,{type:"continue"})},retry:d.options.retry,retryDelay:d.options.retryDelay,networkMode:d.options.networkMode,canRun:()=>!0}));try{const E=await ae(this,Ut).start();if(E===void 0)throw new Error(`${this.queryHash} data is undefined`);return this.setData(E),(w=(y=ae(this,Pr).config).onSuccess)==null||w.call(y,E,this),(x=(_=ae(this,Pr).config).onSettled)==null||x.call(_,E,this.state.error,this),E}catch(E){if(E instanceof fd){if(E.silent)return ae(this,Ut).promise;if(E.revert){if(this.state.data===void 0)throw E;return this.state.data}}throw Jt(this,Br,wn).call(this,{type:"error",error:E}),(S=(v=ae(this,Pr).config).onError)==null||S.call(v,E,this),(k=(C=ae(this,Pr).config).onSettled)==null||k.call(C,this.state.data,E,this),E}finally{this.scheduleGc()}}},Cs=new WeakMap,oi=new WeakMap,Pr=new WeakMap,ks=new WeakMap,Ut=new WeakMap,ga=new WeakMap,Ns=new WeakMap,Br=new WeakSet,wn=function(e){const t=n=>{switch(e.type){case"failed":return{...n,fetchFailureCount:e.failureCount,fetchFailureReason:e.error};case"pause":return{...n,fetchStatus:"paused"};case"continue":return{...n,fetchStatus:"fetching"};case"fetch":return{...n,...p3(n.data,this.options),fetchMeta:e.meta??null};case"success":const i={...n,...If(e.data,e.dataUpdatedAt),dataUpdateCount:n.dataUpdateCount+1,...!e.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return Le(this,oi,e.manual?i:void 0),i;case"error":const l=e.error;return{...n,error:l,errorUpdateCount:n.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:n.fetchFailureCount+1,fetchFailureReason:l,fetchStatus:"idle",status:"error",isInvalidated:!0};case"invalidate":return{...n,isInvalidated:!0};case"setState":return{...n,...e.state}}};this.state=t(this.state),rr.batch(()=>{this.observers.forEach(n=>{n.onQueryUpdate()}),ae(this,Pr).notify({query:this,type:"updated",action:e})})},Ip);function p3(r,e){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:wg(e.networkMode)?"fetching":"paused",...r===void 0&&{error:null,status:"pending"}}}function If(r,e){return{data:r,dataUpdatedAt:e??Date.now(),error:null,isInvalidated:!1,status:"success"}}function Mf(r){const e=typeof r.initialData=="function"?r.initialData():r.initialData,t=e!==void 0,n=t?typeof r.initialDataUpdatedAt=="function"?r.initialDataUpdatedAt():r.initialDataUpdatedAt:0;return{data:e,dataUpdateCount:0,dataUpdatedAt:t?n??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:t?"success":"pending",fetchStatus:"idle"}}function Lf(r){return{onFetch:(e,t)=>{var p,m,y,w,_;const n=e.options,i=(y=(m=(p=e.fetchOptions)==null?void 0:p.meta)==null?void 0:m.fetchMore)==null?void 0:y.direction,l=((w=e.state.data)==null?void 0:w.pages)||[],c=((_=e.state.data)==null?void 0:_.pageParams)||[];let d={pages:[],pageParams:[]},u=0;const f=async()=>{let x=!1;const v=k=>{a3(k,()=>e.signal,()=>x=!0)},S=yg(e.options,e.fetchOptions),C=async(k,E,P)=>{if(x)return Promise.reject();if(E==null&&k.pages.length)return Promise.resolve(k);const I=(()=>{const se={client:e.client,queryKey:e.queryKey,pageParam:E,direction:P?"backward":"forward",meta:e.options.meta};return v(se),se})(),B=await S(I),{maxPages:z}=e.options,X=P?i3:s3;return{pages:X(k.pages,B,z),pageParams:X(k.pageParams,E,z)}};if(i&&l.length){const k=i==="backward",E=k?m3:Ff,P={pages:l,pageParams:c},D=E(n,P);d=await C(P,D,k)}else{const k=r??l.length;do{const E=u===0?c[0]??n.initialPageParam:Ff(n,d);if(u>0&&E==null)break;d=await C(d,E),u++}while(u<k)}return d};e.options.persister?e.fetchFn=()=>{var x,v;return(v=(x=e.options).persister)==null?void 0:v.call(x,f,{client:e.client,queryKey:e.queryKey,meta:e.options.meta,signal:e.signal},t)}:e.fetchFn=f}}}function Ff(r,{pages:e,pageParams:t}){const n=e.length-1;return e.length>0?r.getNextPageParam(e[n],e,t[n],t):void 0}function m3(r,{pages:e,pageParams:t}){var n;return e.length>0?(n=r.getPreviousPageParam)==null?void 0:n.call(r,e[0],e,t[0],t):void 0}var xa,tn,er,js,rn,Gn,Mp,g3=(Mp=class extends _g{constructor(e){super();qe(this,rn);qe(this,xa);qe(this,tn);qe(this,er);qe(this,js);Le(this,xa,e.client),this.mutationId=e.mutationId,Le(this,er,e.mutationCache),Le(this,tn,[]),this.state=e.state||x3(),this.setOptions(e.options),this.scheduleGc()}setOptions(e){this.options=e,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(e){ae(this,tn).includes(e)||(ae(this,tn).push(e),this.clearGcTimeout(),ae(this,er).notify({type:"observerAdded",mutation:this,observer:e}))}removeObserver(e){Le(this,tn,ae(this,tn).filter(t=>t!==e)),this.scheduleGc(),ae(this,er).notify({type:"observerRemoved",mutation:this,observer:e})}optionalRemove(){ae(this,tn).length||(this.state.status==="pending"?this.scheduleGc():ae(this,er).remove(this))}continue(){var e;return((e=ae(this,js))==null?void 0:e.continue())??this.execute(this.state.variables)}async execute(e){var c,d,u,f,p,m,y,w,_,x,v,S,C,k,E,P,D,I;const t=()=>{Jt(this,rn,Gn).call(this,{type:"continue"})},n={client:ae(this,xa),meta:this.options.meta,mutationKey:this.options.mutationKey};Le(this,js,bg({fn:()=>this.options.mutationFn?this.options.mutationFn(e,n):Promise.reject(new Error("No mutationFn found")),onFail:(B,z)=>{Jt(this,rn,Gn).call(this,{type:"failed",failureCount:B,error:z})},onPause:()=>{Jt(this,rn,Gn).call(this,{type:"pause"})},onContinue:t,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>ae(this,er).canRun(this)}));const i=this.state.status==="pending",l=!ae(this,js).canStart();try{if(i)t();else{Jt(this,rn,Gn).call(this,{type:"pending",variables:e,isPaused:l}),ae(this,er).config.onMutate&&await ae(this,er).config.onMutate(e,this,n);const z=await((d=(c=this.options).onMutate)==null?void 0:d.call(c,e,n));z!==this.state.context&&Jt(this,rn,Gn).call(this,{type:"pending",context:z,variables:e,isPaused:l})}const B=await ae(this,js).start();return await((f=(u=ae(this,er).config).onSuccess)==null?void 0:f.call(u,B,e,this.state.context,this,n)),await((m=(p=this.options).onSuccess)==null?void 0:m.call(p,B,e,this.state.context,n)),await((w=(y=ae(this,er).config).onSettled)==null?void 0:w.call(y,B,null,this.state.variables,this.state.context,this,n)),await((x=(_=this.options).onSettled)==null?void 0:x.call(_,B,null,e,this.state.context,n)),Jt(this,rn,Gn).call(this,{type:"success",data:B}),B}catch(B){try{await((S=(v=ae(this,er).config).onError)==null?void 0:S.call(v,B,e,this.state.context,this,n))}catch(z){Promise.reject(z)}try{await((k=(C=this.options).onError)==null?void 0:k.call(C,B,e,this.state.context,n))}catch(z){Promise.reject(z)}try{await((P=(E=ae(this,er).config).onSettled)==null?void 0:P.call(E,void 0,B,this.state.variables,this.state.context,this,n))}catch(z){Promise.reject(z)}try{await((I=(D=this.options).onSettled)==null?void 0:I.call(D,void 0,B,e,this.state.context,n))}catch(z){Promise.reject(z)}throw Jt(this,rn,Gn).call(this,{type:"error",error:B}),B}finally{ae(this,er).runNext(this)}}},xa=new WeakMap,tn=new WeakMap,er=new WeakMap,js=new WeakMap,rn=new WeakSet,Gn=function(e){const t=n=>{switch(e.type){case"failed":return{...n,failureCount:e.failureCount,failureReason:e.error};case"pause":return{...n,isPaused:!0};case"continue":return{...n,isPaused:!1};case"pending":return{...n,context:e.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:e.isPaused,status:"pending",variables:e.variables,submittedAt:Date.now()};case"success":return{...n,data:e.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...n,data:void 0,error:e.error,failureCount:n.failureCount+1,failureReason:e.error,isPaused:!1,status:"error"}}};this.state=t(this.state),rr.batch(()=>{ae(this,tn).forEach(n=>{n.onMutationUpdate(e)}),ae(this,er).notify({mutation:this,type:"updated",action:e})})},Mp);function x3(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var _n,Gr,ya,Lp,y3=(Lp=class extends ul{constructor(e={}){super();qe(this,_n);qe(this,Gr);qe(this,ya);this.config=e,Le(this,_n,new Set),Le(this,Gr,new Map),Le(this,ya,0)}build(e,t,n){const i=new g3({client:e,mutationCache:this,mutationId:++yo(this,ya)._,options:e.defaultMutationOptions(t),state:n});return this.add(i),i}add(e){ae(this,_n).add(e);const t=_o(e);if(typeof t=="string"){const n=ae(this,Gr).get(t);n?n.push(e):ae(this,Gr).set(t,[e])}this.notify({type:"added",mutation:e})}remove(e){if(ae(this,_n).delete(e)){const t=_o(e);if(typeof t=="string"){const n=ae(this,Gr).get(t);if(n)if(n.length>1){const i=n.indexOf(e);i!==-1&&n.splice(i,1)}else n[0]===e&&ae(this,Gr).delete(t)}}this.notify({type:"removed",mutation:e})}canRun(e){const t=_o(e);if(typeof t=="string"){const n=ae(this,Gr).get(t),i=n==null?void 0:n.find(l=>l.state.status==="pending");return!i||i===e}else return!0}runNext(e){var n;const t=_o(e);if(typeof t=="string"){const i=(n=ae(this,Gr).get(t))==null?void 0:n.find(l=>l!==e&&l.state.isPaused);return(i==null?void 0:i.continue())??Promise.resolve()}else return Promise.resolve()}clear(){rr.batch(()=>{ae(this,_n).forEach(e=>{this.notify({type:"removed",mutation:e})}),ae(this,_n).clear(),ae(this,Gr).clear()})}getAll(){return Array.from(ae(this,_n))}find(e){const t={exact:!0,...e};return this.getAll().find(n=>Rf(t,n))}findAll(e={}){return this.getAll().filter(t=>Rf(e,t))}notify(e){rr.batch(()=>{this.listeners.forEach(t=>{t(e)})})}resumePausedMutations(){const e=this.getAll().filter(t=>t.state.isPaused);return rr.batch(()=>Promise.all(e.map(t=>t.continue().catch(zr))))}},_n=new WeakMap,Gr=new WeakMap,ya=new WeakMap,Lp);function _o(r){var e;return(e=r.options.scope)==null?void 0:e.id}var nn,Fp,v3=(Fp=class extends ul{constructor(e={}){super();qe(this,nn);this.config=e,Le(this,nn,new Map)}build(e,t,n){const i=t.queryKey,l=t.queryHash??tu(i,t);let c=this.get(l);return c||(c=new f3({client:e,queryKey:i,queryHash:l,options:e.defaultQueryOptions(t),state:n,defaultOptions:e.getQueryDefaults(i)}),this.add(c)),c}add(e){ae(this,nn).has(e.queryHash)||(ae(this,nn).set(e.queryHash,e),this.notify({type:"added",query:e}))}remove(e){const t=ae(this,nn).get(e.queryHash);t&&(e.destroy(),t===e&&ae(this,nn).delete(e.queryHash),this.notify({type:"removed",query:e}))}clear(){rr.batch(()=>{this.getAll().forEach(e=>{this.remove(e)})})}get(e){return ae(this,nn).get(e)}getAll(){return[...ae(this,nn).values()]}find(e){const t={exact:!0,...e};return this.getAll().find(n=>Tf(t,n))}findAll(e={}){const t=this.getAll();return Object.keys(e).length>0?t.filter(n=>Tf(e,n)):t}notify(e){rr.batch(()=>{this.listeners.forEach(t=>{t(e)})})}onFocus(){rr.batch(()=>{this.getAll().forEach(e=>{e.onFocus()})})}onOnline(){rr.batch(()=>{this.getAll().forEach(e=>{e.onOnline()})})}},nn=new WeakMap,Fp),jt,Xn,qn,li,ci,Kn,di,ui,zp,w3=(zp=class{constructor(r={}){qe(this,jt);qe(this,Xn);qe(this,qn);qe(this,li);qe(this,ci);qe(this,Kn);qe(this,di);qe(this,ui);Le(this,jt,r.queryCache||new v3),Le(this,Xn,r.mutationCache||new y3),Le(this,qn,r.defaultOptions||{}),Le(this,li,new Map),Le(this,ci,new Map),Le(this,Kn,0)}mount(){yo(this,Kn)._++,ae(this,Kn)===1&&(Le(this,di,vg.subscribe(async r=>{r&&(await this.resumePausedMutations(),ae(this,jt).onFocus())})),Le(this,ui,qo.subscribe(async r=>{r&&(await this.resumePausedMutations(),ae(this,jt).onOnline())})))}unmount(){var r,e;yo(this,Kn)._--,ae(this,Kn)===0&&((r=ae(this,di))==null||r.call(this),Le(this,di,void 0),(e=ae(this,ui))==null||e.call(this),Le(this,ui,void 0))}isFetching(r){return ae(this,jt).findAll({...r,fetchStatus:"fetching"}).length}isMutating(r){return ae(this,Xn).findAll({...r,status:"pending"}).length}getQueryData(r){var t;const e=this.defaultQueryOptions({queryKey:r});return(t=ae(this,jt).get(e.queryHash))==null?void 0:t.state.data}ensureQueryData(r){const e=this.defaultQueryOptions(r),t=ae(this,jt).build(this,e),n=t.state.data;return n===void 0?this.fetchQuery(r):(r.revalidateIfStale&&t.isStaleByTime(ud(e.staleTime,t))&&this.prefetchQuery(e),Promise.resolve(n))}getQueriesData(r){return ae(this,jt).findAll(r).map(({queryKey:e,state:t})=>{const n=t.data;return[e,n]})}setQueryData(r,e,t){const n=this.defaultQueryOptions({queryKey:r}),i=ae(this,jt).get(n.queryHash),l=i==null?void 0:i.state.data,c=Q5(e,l);if(c!==void 0)return ae(this,jt).build(this,n).setData(c,{...t,manual:!0})}setQueriesData(r,e,t){return rr.batch(()=>ae(this,jt).findAll(r).map(({queryKey:n})=>[n,this.setQueryData(n,e,t)]))}getQueryState(r){var t;const e=this.defaultQueryOptions({queryKey:r});return(t=ae(this,jt).get(e.queryHash))==null?void 0:t.state}removeQueries(r){const e=ae(this,jt);rr.batch(()=>{e.findAll(r).forEach(t=>{e.remove(t)})})}resetQueries(r,e){const t=ae(this,jt);return rr.batch(()=>(t.findAll(r).forEach(n=>{n.reset()}),this.refetchQueries({type:"active",...r},e)))}cancelQueries(r,e={}){const t={revert:!0,...e},n=rr.batch(()=>ae(this,jt).findAll(r).map(i=>i.cancel(t)));return Promise.all(n).then(zr).catch(zr)}invalidateQueries(r,e={}){return rr.batch(()=>(ae(this,jt).findAll(r).forEach(t=>{t.invalidate()}),(r==null?void 0:r.refetchType)==="none"?Promise.resolve():this.refetchQueries({...r,type:(r==null?void 0:r.refetchType)??(r==null?void 0:r.type)??"active"},e)))}refetchQueries(r,e={}){const t={...e,cancelRefetch:e.cancelRefetch??!0},n=rr.batch(()=>ae(this,jt).findAll(r).filter(i=>!i.isDisabled()&&!i.isStatic()).map(i=>{let l=i.fetch(void 0,t);return t.throwOnError||(l=l.catch(zr)),i.state.fetchStatus==="paused"?Promise.resolve():l}));return Promise.all(n).then(zr)}fetchQuery(r){const e=this.defaultQueryOptions(r);e.retry===void 0&&(e.retry=!1);const t=ae(this,jt).build(this,e);return t.isStaleByTime(ud(e.staleTime,t))?t.fetch(e):Promise.resolve(t.state.data)}prefetchQuery(r){return this.fetchQuery(r).then(zr).catch(zr)}fetchInfiniteQuery(r){return r.behavior=Lf(r.pages),this.fetchQuery(r)}prefetchInfiniteQuery(r){return this.fetchInfiniteQuery(r).then(zr).catch(zr)}ensureInfiniteQueryData(r){return r.behavior=Lf(r.pages),this.ensureQueryData(r)}resumePausedMutations(){return qo.isOnline()?ae(this,Xn).resumePausedMutations():Promise.resolve()}getQueryCache(){return ae(this,jt)}getMutationCache(){return ae(this,Xn)}getDefaultOptions(){return ae(this,qn)}setDefaultOptions(r){Le(this,qn,r)}setQueryDefaults(r,e){ae(this,li).set(fa(r),{queryKey:r,defaultOptions:e})}getQueryDefaults(r){const e=[...ae(this,li).values()],t={};return e.forEach(n=>{pa(r,n.queryKey)&&Object.assign(t,n.defaultOptions)}),t}setMutationDefaults(r,e){ae(this,ci).set(fa(r),{mutationKey:r,defaultOptions:e})}getMutationDefaults(r){const e=[...ae(this,ci).values()],t={};return e.forEach(n=>{pa(r,n.mutationKey)&&Object.assign(t,n.defaultOptions)}),t}defaultQueryOptions(r){if(r._defaulted)return r;const e={...ae(this,qn).queries,...this.getQueryDefaults(r.queryKey),...r,_defaulted:!0};return e.queryHash||(e.queryHash=tu(e.queryKey,e)),e.refetchOnReconnect===void 0&&(e.refetchOnReconnect=e.networkMode!=="always"),e.throwOnError===void 0&&(e.throwOnError=!!e.suspense),!e.networkMode&&e.persister&&(e.networkMode="offlineFirst"),e.queryFn===ru&&(e.enabled=!1),e}defaultMutationOptions(r){return r!=null&&r._defaulted?r:{...ae(this,qn).mutations,...(r==null?void 0:r.mutationKey)&&this.getMutationDefaults(r.mutationKey),...r,_defaulted:!0}}clear(){ae(this,jt).clear(),ae(this,Xn).clear()}},jt=new WeakMap,Xn=new WeakMap,qn=new WeakMap,li=new WeakMap,ci=new WeakMap,Kn=new WeakMap,di=new WeakMap,ui=new WeakMap,zp),b3=T.createContext(void 0),_3=({client:r,children:e})=>(T.useEffect(()=>(r.mount(),()=>{r.unmount()}),[r]),a.jsx(b3.Provider,{value:r,children:e}));class S3 extends T.Component{constructor(){super(...arguments);Gi(this,"state",{hasError:!1,error:null,errorInfo:null});Gi(this,"handleReload",()=>{window.location.reload()});Gi(this,"handleGoHome",()=>{window.location.href="/"});Gi(this,"handleReportBug",()=>{var i,l,c;const t=`Error: ${(i=this.state.error)==null?void 0:i.message}

Stack: ${(l=this.state.error)==null?void 0:l.stack}

Component Stack: ${(c=this.state.errorInfo)==null?void 0:c.componentStack}`,n=`mailto:support@deckforge.com?subject=DeckForge Error Report&body=${encodeURIComponent(t)}`;window.location.href=n})}static getDerivedStateFromError(t){return{hasError:!0,error:t,errorInfo:null}}componentDidCatch(t,n){console.error("ErrorBoundary caught an error:",t,n),this.setState({error:t,errorInfo:n});try{const i=localStorage.getItem("deckforge-autosave");if(i){const l={timestamp:new Date().toISOString(),state:i};localStorage.setItem("deckforge-crash-backup",JSON.stringify(l))}}catch(i){console.error("Failed to save crash backup:",i)}}render(){var t,n;return this.state.hasError?this.props.fallback?this.props.fallback:a.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center p-8",children:a.jsx("div",{className:"max-w-2xl w-full",children:a.jsxs("div",{className:"bg-card border-2 border-destructive p-8 space-y-6",children:[a.jsx("div",{className:"flex justify-center",children:a.jsx("div",{className:"w-20 h-20 rounded-full bg-destructive/20 flex items-center justify-center",children:a.jsx(lf,{className:"w-10 h-10 text-destructive"})})}),a.jsxs("div",{className:"text-center space-y-2",children:[a.jsx("h1",{className:"font-display text-2xl uppercase tracking-widest",children:"Something Went Wrong"}),a.jsx("p",{className:"text-muted-foreground",children:"DeckForge encountered an unexpected error"})]}),a.jsxs("details",{className:"bg-secondary p-4 rounded border border-border",children:[a.jsx("summary",{className:"cursor-pointer text-sm font-mono text-muted-foreground hover:text-foreground transition-colors",children:"Technical Details (click to expand)"}),a.jsx("div",{className:"mt-4 space-y-2",children:a.jsxs("div",{className:"text-xs font-mono bg-background p-3 rounded overflow-auto max-h-40",children:[a.jsx("p",{className:"text-destructive font-semibold",children:(t=this.state.error)==null?void 0:t.message}),((n=this.state.error)==null?void 0:n.stack)&&a.jsx("pre",{className:"mt-2 text-muted-foreground text-[10px] whitespace-pre-wrap",children:this.state.error.stack})]})})]}),a.jsx("div",{className:"bg-accent/10 border border-accent/30 p-4 rounded",children:a.jsxs("p",{className:"text-sm text-foreground flex items-start gap-2",children:[a.jsx("span",{className:"text-lg",children:""}),a.jsxs("span",{children:[a.jsx("strong",{children:"Your work may be saved!"})," We automatically backed up your design before the crash. Try reloading the page to recover it."]})]})}),a.jsxs("div",{className:"flex flex-wrap gap-3 justify-center",children:[a.jsxs(de,{onClick:this.handleReload,className:"gap-2",children:[a.jsx(Xx,{className:"w-4 h-4"}),"Reload Page"]}),a.jsxs(de,{onClick:this.handleGoHome,variant:"outline",className:"gap-2",children:[a.jsx(qx,{className:"w-4 h-4"}),"Go to Dashboard"]}),a.jsxs(de,{onClick:this.handleReportBug,variant:"outline",className:"gap-2",children:[a.jsx(lf,{className:"w-4 h-4"}),"Report Bug"]})]}),a.jsx("div",{className:"text-center",children:a.jsxs("p",{className:"text-xs text-muted-foreground",children:["If this keeps happening,"," ",a.jsx("a",{href:"/designs",className:"text-accent hover:underline",children:"try starting a new design"})," ","or"," ",a.jsx("a",{href:"mailto:support@deckforge.com",className:"text-accent hover:underline",children:"contact support"})]})})]})})}):this.props.children}}const C3="modulepreload",k3=function(r){return"/"+r},zf={},Rr=function(e,t,n){let i=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const c=document.querySelector("meta[property=csp-nonce]"),d=(c==null?void 0:c.nonce)||(c==null?void 0:c.getAttribute("nonce"));i=Promise.allSettled(t.map(u=>{if(u=k3(u),u in zf)return;zf[u]=!0;const f=u.endsWith(".css"),p=f?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${p}`))return;const m=document.createElement("link");if(m.rel=f?"stylesheet":C3,f||(m.as="script"),m.crossOrigin="",m.href=u,d&&m.setAttribute("nonce",d),document.head.appendChild(m),f)return new Promise((y,w)=>{m.addEventListener("load",y),m.addEventListener("error",()=>w(new Error(`Unable to preload CSS for ${u}`)))})}))}function l(c){const d=new Event("vite:preloadError",{cancelable:!0});if(d.payload=c,window.dispatchEvent(d),!d.defaultPrevented)throw c}return i.then(c=>{for(const d of c||[])d.status==="rejected"&&l(d.reason);return e().catch(l)})},Uc=[{id:"pen",icon:Rd,label:"Pen Tool",shortcut:"P",description:"Draw custom shapes with click-to-point or free draw"},{id:"stickers",icon:Xp,label:"Stickers",shortcut:"S",description:"Add vector icons and decals from library"},{id:"lines",icon:qp,label:"Lines",shortcut:"L",description:"Draw straight, curved, and decorative lines"},{id:"patterns",icon:Dd,label:"Patterns",description:"Apply procedural patterns (checkerboard, stripes, etc.)"},{id:"textures",icon:Od,label:"Textures",description:"Add realistic texture overlays (concrete, rust, graffiti)"},{id:"graphics",icon:Id,label:"Graphics",shortcut:"G",description:"Basic shapes (circle, square, star)"},{id:"text",icon:Jo,label:"Text",shortcut:"T",description:"Add text with custom fonts and styling"},{id:"uploads",icon:Ho,label:"Uploads",shortcut:"U",description:"Upload your own images, SVGs, and assets"},{id:"finishes",icon:Uo,label:"Finishes",description:"Apply print textures (scratched wood, grip tape, halftone)"}];function Bf(){const{activeTool:r,setActiveTool:e}=Ct();return T.useEffect(()=>{const t=n=>{if(n.target instanceof HTMLInputElement||n.target instanceof HTMLTextAreaElement||n.ctrlKey||n.metaKey||n.altKey)return;const i=n.key.toLowerCase(),l=Uc.find(c=>{var d;return((d=c.shortcut)==null?void 0:d.toLowerCase())===i});l&&(n.preventDefault(),e(r===l.id?null:l.id))};return window.addEventListener("keydown",t),()=>window.removeEventListener("keydown",t)},[r,e]),a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"hidden md:flex flex-col w-14 bg-card border-r border-border h-full",children:[a.jsx("div",{className:"py-4 px-2 border-b border-border",children:a.jsx("span",{className:"font-display text-[10px] uppercase tracking-widest text-muted-foreground block text-center",children:"Tools"})}),a.jsx(Qn,{className:"flex-1",children:a.jsx("div",{className:"flex flex-col gap-1 p-2",children:Uc.map(t=>{const n=t.icon,i=r===t.id;return a.jsxs(ra,{delayDuration:300,children:[a.jsx(na,{asChild:!0,children:a.jsx("button",{onClick:()=>e(i?null:t.id),className:it("w-10 h-10 flex items-center justify-center border border-transparent","hover:border-border hover:bg-secondary transition-colors duration-75",i&&"tool-active border-primary"),children:a.jsx(n,{className:"w-5 h-5",strokeWidth:1.5})})}),a.jsx(ni,{side:"right",className:"max-w-xs",children:a.jsxs("div",{className:"space-y-1",children:[a.jsxs("div",{className:"flex items-center justify-between gap-3",children:[a.jsx("span",{className:"font-semibold",children:t.label}),t.shortcut&&a.jsx("kbd",{className:"px-1.5 py-0.5 text-xs bg-muted border border-border rounded font-mono",children:t.shortcut})]}),a.jsx("p",{className:"text-xs text-muted-foreground",children:t.description})]})})]},t.id)})})})]}),a.jsx("div",{className:"md:hidden w-full bg-card border-b border-border",children:a.jsx(Qn,{className:"w-full",orientation:"horizontal",children:a.jsx("div",{className:"flex gap-1 p-2",children:Uc.map(t=>{const n=t.icon,i=r===t.id;return a.jsxs("button",{onClick:()=>e(i?null:t.id),className:it("min-w-[64px] h-16 flex flex-col items-center justify-center gap-1 border border-transparent shrink-0","active:bg-secondary/80 active:scale-95 transition-all duration-75 touch-manipulation",i&&"tool-active border-primary bg-primary/10"),children:[a.jsx(n,{className:"w-5 h-5",strokeWidth:1.5}),a.jsx("span",{className:"text-[9px] uppercase tracking-wider",children:t.label})]},t.id)})})})})]})}function Sg(r){const e=T.useRef({value:r,previous:r});return T.useMemo(()=>(e.current.value!==r&&(e.current.previous=e.current.value,e.current.value=r),e.current.previous),[r])}var Cg=["PageUp","PageDown"],kg=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],Ng={"from-left":["Home","PageDown","ArrowDown","ArrowLeft"],"from-right":["Home","PageDown","ArrowDown","ArrowRight"],"from-bottom":["Home","PageDown","ArrowDown","ArrowLeft"],"from-top":["Home","PageDown","ArrowUp","ArrowLeft"]},wi="Slider",[pd,N3,j3]=Bd(wi),[jg]=kn(wi,[j3]),[E3,fl]=jg(wi),Eg=T.forwardRef((r,e)=>{const{name:t,min:n=0,max:i=100,step:l=1,orientation:c="horizontal",disabled:d=!1,minStepsBetweenThumbs:u=0,defaultValue:f=[n],value:p,onValueChange:m=()=>{},onValueCommit:y=()=>{},inverted:w=!1,form:_,...x}=r,v=T.useRef(new Set),S=T.useRef(0),k=c==="horizontal"?P3:A3,[E=[],P]=ts({prop:p,defaultProp:f,onChange:se=>{var H;(H=[...v.current][S.current])==null||H.focus(),m(se)}}),D=T.useRef(E);function I(se){const R=I3(E,se);X(se,R)}function B(se){X(se,S.current)}function z(){const se=D.current[S.current];E[S.current]!==se&&y(E)}function X(se,R,{commit:H}={commit:!1}){const j=z3(l),G=B3(Math.round((se-n)/l)*l+n,j),Q=Wp(G,[n,i]);P((K=[])=>{const J=D3(K,Q,R);if(F3(J,u*l)){S.current=J.indexOf(Q);const ee=String(J)!==String(K);return ee&&H&&y(J),ee?J:K}else return K})}return a.jsx(E3,{scope:r.__scopeSlider,name:t,disabled:d,min:n,max:i,valueIndexToChangeRef:S,thumbs:v.current,values:E,orientation:c,form:_,children:a.jsx(pd.Provider,{scope:r.__scopeSlider,children:a.jsx(pd.Slot,{scope:r.__scopeSlider,children:a.jsx(k,{"aria-disabled":d,"data-disabled":d?"":void 0,...x,ref:e,onPointerDown:nt(x.onPointerDown,()=>{d||(D.current=E)}),min:n,max:i,inverted:w,onSlideStart:d?void 0:I,onSlideMove:d?void 0:B,onSlideEnd:d?void 0:z,onHomeKeyDown:()=>!d&&X(n,0,{commit:!0}),onEndKeyDown:()=>!d&&X(i,E.length-1,{commit:!0}),onStepKeyDown:({event:se,direction:R})=>{if(!d){const G=Cg.includes(se.key)||se.shiftKey&&kg.includes(se.key)?10:1,Q=S.current,K=E[Q],J=l*G*R;X(K+J,Q,{commit:!0})}}})})})})});Eg.displayName=wi;var[Pg,Ag]=jg(wi,{startEdge:"left",endEdge:"right",size:"width",direction:1}),P3=T.forwardRef((r,e)=>{const{min:t,max:n,dir:i,inverted:l,onSlideStart:c,onSlideMove:d,onSlideEnd:u,onStepKeyDown:f,...p}=r,[m,y]=T.useState(null),w=Dt(e,k=>y(k)),_=T.useRef(void 0),x=Up(i),v=x==="ltr",S=v&&!l||!v&&l;function C(k){const E=_.current||m.getBoundingClientRect(),P=[0,E.width],I=nu(P,S?[t,n]:[n,t]);return _.current=E,I(k-E.left)}return a.jsx(Pg,{scope:r.__scopeSlider,startEdge:S?"left":"right",endEdge:S?"right":"left",direction:S?1:-1,size:"width",children:a.jsx(Tg,{dir:x,"data-orientation":"horizontal",...p,ref:w,style:{...p.style,"--radix-slider-thumb-transform":"translateX(-50%)"},onSlideStart:k=>{const E=C(k.clientX);c==null||c(E)},onSlideMove:k=>{const E=C(k.clientX);d==null||d(E)},onSlideEnd:()=>{_.current=void 0,u==null||u()},onStepKeyDown:k=>{const P=Ng[S?"from-left":"from-right"].includes(k.key);f==null||f({event:k,direction:P?-1:1})}})})}),A3=T.forwardRef((r,e)=>{const{min:t,max:n,inverted:i,onSlideStart:l,onSlideMove:c,onSlideEnd:d,onStepKeyDown:u,...f}=r,p=T.useRef(null),m=Dt(e,p),y=T.useRef(void 0),w=!i;function _(x){const v=y.current||p.current.getBoundingClientRect(),S=[0,v.height],k=nu(S,w?[n,t]:[t,n]);return y.current=v,k(x-v.top)}return a.jsx(Pg,{scope:r.__scopeSlider,startEdge:w?"bottom":"top",endEdge:w?"top":"bottom",size:"height",direction:w?1:-1,children:a.jsx(Tg,{"data-orientation":"vertical",...f,ref:m,style:{...f.style,"--radix-slider-thumb-transform":"translateY(50%)"},onSlideStart:x=>{const v=_(x.clientY);l==null||l(v)},onSlideMove:x=>{const v=_(x.clientY);c==null||c(v)},onSlideEnd:()=>{y.current=void 0,d==null||d()},onStepKeyDown:x=>{const S=Ng[w?"from-bottom":"from-top"].includes(x.key);u==null||u({event:x,direction:S?-1:1})}})})}),Tg=T.forwardRef((r,e)=>{const{__scopeSlider:t,onSlideStart:n,onSlideMove:i,onSlideEnd:l,onHomeKeyDown:c,onEndKeyDown:d,onStepKeyDown:u,...f}=r,p=fl(wi,t);return a.jsx(vt.span,{...f,ref:e,onKeyDown:nt(r.onKeyDown,m=>{m.key==="Home"?(c(m),m.preventDefault()):m.key==="End"?(d(m),m.preventDefault()):Cg.concat(kg).includes(m.key)&&(u(m),m.preventDefault())}),onPointerDown:nt(r.onPointerDown,m=>{const y=m.target;y.setPointerCapture(m.pointerId),m.preventDefault(),p.thumbs.has(y)?y.focus():n(m)}),onPointerMove:nt(r.onPointerMove,m=>{m.target.hasPointerCapture(m.pointerId)&&i(m)}),onPointerUp:nt(r.onPointerUp,m=>{const y=m.target;y.hasPointerCapture(m.pointerId)&&(y.releasePointerCapture(m.pointerId),l(m))})})}),Rg="SliderTrack",Dg=T.forwardRef((r,e)=>{const{__scopeSlider:t,...n}=r,i=fl(Rg,t);return a.jsx(vt.span,{"data-disabled":i.disabled?"":void 0,"data-orientation":i.orientation,...n,ref:e})});Dg.displayName=Rg;var md="SliderRange",Og=T.forwardRef((r,e)=>{const{__scopeSlider:t,...n}=r,i=fl(md,t),l=Ag(md,t),c=T.useRef(null),d=Dt(e,c),u=i.values.length,f=i.values.map(y=>Lg(y,i.min,i.max)),p=u>1?Math.min(...f):0,m=100-Math.max(...f);return a.jsx(vt.span,{"data-orientation":i.orientation,"data-disabled":i.disabled?"":void 0,...n,ref:d,style:{...r.style,[l.startEdge]:p+"%",[l.endEdge]:m+"%"}})});Og.displayName=md;var gd="SliderThumb",Ig=T.forwardRef((r,e)=>{const t=N3(r.__scopeSlider),[n,i]=T.useState(null),l=Dt(e,d=>i(d)),c=T.useMemo(()=>n?t().findIndex(d=>d.ref.current===n):-1,[t,n]);return a.jsx(T3,{...r,ref:l,index:c})}),T3=T.forwardRef((r,e)=>{const{__scopeSlider:t,index:n,name:i,...l}=r,c=fl(gd,t),d=Ag(gd,t),[u,f]=T.useState(null),p=Dt(e,C=>f(C)),m=u?c.form||!!u.closest("form"):!0,y=Kd(u),w=c.values[n],_=w===void 0?0:Lg(w,c.min,c.max),x=O3(n,c.values.length),v=y==null?void 0:y[d.size],S=v?M3(v,_,d.direction):0;return T.useEffect(()=>{if(u)return c.thumbs.add(u),()=>{c.thumbs.delete(u)}},[u,c.thumbs]),a.jsxs("span",{style:{transform:"var(--radix-slider-thumb-transform)",position:"absolute",[d.startEdge]:`calc(${_}% + ${S}px)`},children:[a.jsx(pd.ItemSlot,{scope:r.__scopeSlider,children:a.jsx(vt.span,{role:"slider","aria-label":r["aria-label"]||x,"aria-valuemin":c.min,"aria-valuenow":w,"aria-valuemax":c.max,"aria-orientation":c.orientation,"data-orientation":c.orientation,"data-disabled":c.disabled?"":void 0,tabIndex:c.disabled?void 0:0,...l,ref:p,style:w===void 0?{display:"none"}:r.style,onFocus:nt(r.onFocus,()=>{c.valueIndexToChangeRef.current=n})})}),m&&a.jsx(Mg,{name:i??(c.name?c.name+(c.values.length>1?"[]":""):void 0),form:c.form,value:w},n)]})});Ig.displayName=gd;var R3="RadioBubbleInput",Mg=T.forwardRef(({__scopeSlider:r,value:e,...t},n)=>{const i=T.useRef(null),l=Dt(i,n),c=Sg(e);return T.useEffect(()=>{const d=i.current;if(!d)return;const u=window.HTMLInputElement.prototype,p=Object.getOwnPropertyDescriptor(u,"value").set;if(c!==e&&p){const m=new Event("input",{bubbles:!0});p.call(d,e),d.dispatchEvent(m)}},[c,e]),a.jsx(vt.input,{style:{display:"none"},...t,ref:l,defaultValue:e})});Mg.displayName=R3;function D3(r=[],e,t){const n=[...r];return n[t]=e,n.sort((i,l)=>i-l)}function Lg(r,e,t){const l=100/(t-e)*(r-e);return Wp(l,[0,100])}function O3(r,e){return e>2?`Value ${r+1} of ${e}`:e===2?["Minimum","Maximum"][r]:void 0}function I3(r,e){if(r.length===1)return 0;const t=r.map(i=>Math.abs(i-e)),n=Math.min(...t);return t.indexOf(n)}function M3(r,e,t){const n=r/2,l=nu([0,50],[0,n]);return(n-l(e)*t)*t}function L3(r){return r.slice(0,-1).map((e,t)=>r[t+1]-e)}function F3(r,e){if(e>0){const t=L3(r);return Math.min(...t)>=e}return!0}function nu(r,e){return t=>{if(r[0]===r[1]||e[0]===e[1])return e[0];const n=(e[1]-e[0])/(r[1]-r[0]);return e[0]+n*(t-r[0])}}function z3(r){return(String(r).split(".")[1]||"").length}function B3(r,e){const t=Math.pow(10,e);return Math.round(r*t)/t}var Fg=Eg,G3=Dg,H3=Og,U3=Ig;const st=T.forwardRef(({className:r,...e},t)=>a.jsxs(Fg,{ref:t,className:it("relative flex w-full touch-none select-none items-center",r),...e,children:[a.jsx(G3,{className:"relative h-2 w-full grow overflow-hidden rounded-full bg-secondary",children:a.jsx(H3,{className:"absolute h-full bg-primary"})}),a.jsx(U3,{className:"block h-5 w-5 rounded-full border-2 border-primary bg-background ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50"})]}));st.displayName=Fg.displayName;async function W3(r){const e=await r.text(),n=new DOMParser().parseFromString(e,"image/svg+xml");if(n.querySelector("parsererror"))throw new Error("Invalid SVG file");const l=n.querySelector("svg");if(!l)throw new Error("No SVG element found");const c=l.getAttribute("viewBox");let d=parseFloat(l.getAttribute("width")||"100"),u=parseFloat(l.getAttribute("height")||"100");if(c){const[,,m,y]=c.split(/\s+/).map(parseFloat);d=m||d,u=y||u}const f=[];if(l.querySelectorAll("rect, circle, ellipse, path, polygon, polyline, line").forEach(m=>{const y=V3(m,d,u);y&&f.push(y)}),f.length===0){const m=new XMLSerializer().serializeToString(l),y=new Blob([m],{type:"image/svg+xml"}),w=URL.createObjectURL(y);f.push({type:"image",x:0,y:0,width:Math.min(d,200),height:Math.min(u,200),rotation:0,opacity:1,scaleX:1,scaleY:1,src:w})}return f}function V3(r,e,t){const n=r.tagName.toLowerCase(),i=r.getAttribute("fill")||"#000000",l=r.getAttribute("stroke")||"",c=parseFloat(r.getAttribute("stroke-width")||"0"),d=parseFloat(r.getAttribute("opacity")||"1");if(i==="none"&&!l)return null;switch(n){case"rect":return $3(r,i,l,c,d);case"circle":return Y3(r,i,l,c,d);case"ellipse":return X3(r,i,l,c,d);case"line":return q3(r,l||i,c,d);case"path":case"polygon":case"polyline":return K3(r,e,t,d);default:return null}}function $3(r,e,t,n,i){const l=parseFloat(r.getAttribute("x")||"0"),c=parseFloat(r.getAttribute("y")||"0"),d=parseFloat(r.getAttribute("width")||"100"),u=parseFloat(r.getAttribute("height")||"100");return{type:"shape",shapeType:"rect",x:l,y:c,width:d,height:u,rotation:0,opacity:i,scaleX:1,scaleY:1,fill:e!=="none"?e:void 0,stroke:t||void 0,strokeWidth:n}}function Y3(r,e,t,n,i){const l=parseFloat(r.getAttribute("cx")||"50"),c=parseFloat(r.getAttribute("cy")||"50"),d=parseFloat(r.getAttribute("r")||"25");return{type:"shape",shapeType:"circle",x:l-d,y:c-d,width:d*2,height:d*2,rotation:0,opacity:i,scaleX:1,scaleY:1,fill:e!=="none"?e:void 0,stroke:t||void 0,strokeWidth:n}}function X3(r,e,t,n,i){const l=parseFloat(r.getAttribute("cx")||"50"),c=parseFloat(r.getAttribute("cy")||"50"),d=parseFloat(r.getAttribute("rx")||"25"),u=parseFloat(r.getAttribute("ry")||"25");return{type:"shape",shapeType:"circle",x:l-d,y:c-u,width:d*2,height:u*2,rotation:0,opacity:i,scaleX:1,scaleY:u/d,fill:e!=="none"?e:void 0,stroke:t||void 0,strokeWidth:n}}function q3(r,e,t,n){const i=parseFloat(r.getAttribute("x1")||"0"),l=parseFloat(r.getAttribute("y1")||"0"),c=parseFloat(r.getAttribute("x2")||"100"),d=parseFloat(r.getAttribute("y2")||"100");return{type:"line",x:i,y:l,width:Math.abs(c-i),height:Math.abs(d-l),rotation:0,opacity:n,scaleX:1,scaleY:1,lineType:"straight",lineEndX:c-i,lineEndY:d-l,stroke:e||"#000000",strokeWidth:t||2,lineCapStyle:"round"}}function K3(r,e,t,n){let i={x:0,y:0,width:100,height:100};try{const p=document.createElementNS("http://www.w3.org/2000/svg","svg");p.style.position="absolute",p.style.visibility="hidden";const m=r.cloneNode(!0);if(p.appendChild(m),document.body.appendChild(p),m.getBBox){const y=m.getBBox();i={x:y.x,y:y.y,width:y.width,height:y.height}}document.body.removeChild(p)}catch(p){console.warn("Failed to get accurate bounding box, using defaults",p)}const l=r.cloneNode(!0),c=document.createElementNS("http://www.w3.org/2000/svg","svg");c.setAttribute("xmlns","http://www.w3.org/2000/svg"),c.setAttribute("viewBox",`${i.x} ${i.y} ${i.width} ${i.height}`),c.setAttribute("width",String(i.width)),c.setAttribute("height",String(i.height)),c.appendChild(l);const d=new XMLSerializer().serializeToString(c),u=new Blob([d],{type:"image/svg+xml"}),f=URL.createObjectURL(u);return{type:"image",x:i.x,y:i.y,width:i.width,height:i.height,rotation:0,opacity:n,scaleX:1,scaleY:1,src:f}}function Q3(r){const e=["image/svg+xml","image/svg","text/xml"],t=[".svg"],n=e.includes(r.type),i=t.some(l=>r.name.toLowerCase().endsWith(l));return n||i}const Gf={edgy:[{name:"Skull",icon:R2},{name:"Flame",icon:D2},{name:"Zap",icon:O2},{name:"Sword",icon:I2},{name:"Ghost",icon:M2},{name:"Bug",icon:L2},{name:"Eye",icon:Zn},{name:"Target",icon:cf},{name:"Bomb",icon:F2},{name:"Swords",icon:z2},{name:"Shield",icon:B2},{name:"Crosshair",icon:G2}],retro:[{name:"Radio",icon:b2},{name:"Disc",icon:_2},{name:"Music",icon:S2},{name:"Rocket",icon:C2},{name:"Crown",icon:k2},{name:"Anchor",icon:N2},{name:"Sun",icon:Qp},{name:"Moon",icon:j2},{name:"Camera",icon:E2},{name:"Gamepad",icon:P2},{name:"Headphones",icon:A2},{name:"Watch",icon:T2}],shapes:[{name:"Triangle",icon:y2},{name:"Hexagon",icon:v2},{name:"Circle",icon:Kp},{name:"Square",icon:Wo},{name:"Star",icon:Md},{name:"Heart",icon:sn},{name:"Sparkles",icon:cr},{name:"Hand",icon:w2}],nature:[{name:"Cat",icon:d2},{name:"Dog",icon:u2},{name:"Fish",icon:h2},{name:"Bird",icon:f2},{name:"Leaf",icon:p2},{name:"Cloud",icon:m2},{name:"Mountain",icon:Od},{name:"Waves",icon:g2},{name:"Feather",icon:x2}],street:[{name:"Pizza",icon:n2},{name:"Coffee",icon:s2},{name:"Cherry",icon:i2},{name:"Glasses",icon:a2},{name:"Lock",icon:el},{name:"Key",icon:o2},{name:"Fingerprint",icon:l2},{name:"Compass",icon:c2}],sports:[{name:"Trophy",icon:Jx},{name:"Award",icon:e2},{name:"Medal",icon:t2},{name:"Dumbbell",icon:r2},{name:"Target",icon:cf}],emoji:[{name:"Laugh",icon:Kx},{name:"Smile",icon:Qx},{name:"Frown",icon:Zx}]},Z3=[{id:"checkerboard",name:"Checkerboard",description:"Vans style"},{id:"speed-lines",name:"Speed Lines",description:"Racing stripes"},{id:"halftone",name:"Halftone",description:"Comic book dots"},{id:"noise",name:"Noise",description:"Grainy texture"},{id:"tie-dye",name:"Tie-Dye",description:"Psychedelic swirl"},{id:"diagonal-stripes",name:"Diagonal Stripes",description:"Bold lines"},{id:"hexagons",name:"Hexagons",description:"Honeycomb pattern"},{id:"crosshatch",name:"Crosshatch",description:"Grid overlay"}],J3=[{id:"concrete",name:"Concrete",query:"concrete texture"},{id:"rust",name:"Rust",query:"rust metal texture"},{id:"graffiti",name:"Graffiti",query:"graffiti wall"},{id:"wood",name:"Wood Grain",query:"wood grain texture"},{id:"sticker-bomb",name:"Sticker Bomb",query:"sticker collage"},{id:"asphalt",name:"Asphalt",query:"asphalt pavement"},{id:"brick",name:"Brick Wall",query:"red brick wall"},{id:"marble",name:"Marble",query:"white marble texture"},{id:"carbon-fiber",name:"Carbon Fiber",query:"carbon fiber weave"},{id:"splatter",name:"Paint Splatter",query:"paint splatter drips"}],e4=[{id:"g1",label:"Circle",shapeType:"circle"},{id:"g2",label:"Square",shapeType:"rect"},{id:"g4",label:"Star",shapeType:"star"}],t4={"scratched-wood":"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='60' height='60' viewBox='0 0 60 60'%3E%3Crect fill='%23222'/%3E%3Cpath d='M5 10 L55 8 M10 25 L50 27 M8 40 L52 38 M15 52 L45 55' stroke='%23444' stroke-width='0.5' fill='none'/%3E%3Cpath d='M20 5 L22 55 M35 8 L37 52 M48 3 L50 57' stroke='%23333' stroke-width='0.3' fill='none'/%3E%3C/svg%3E","grip-tape-dust":"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='60' height='60' viewBox='0 0 60 60'%3E%3Crect fill='%23222'/%3E%3Ccircle cx='10' cy='15' r='1' fill='%23555'/%3E%3Ccircle cx='25' cy='8' r='0.5' fill='%23444'/%3E%3Ccircle cx='45' cy='20' r='1.5' fill='%23555'/%3E%3Ccircle cx='15' cy='35' r='0.8' fill='%23444'/%3E%3Ccircle cx='50' cy='45' r='1' fill='%23555'/%3E%3Ccircle cx='30' cy='50' r='0.6' fill='%23444'/%3E%3Ccircle cx='8' cy='55' r='1.2' fill='%23555'/%3E%3Ccircle cx='40' cy='30' r='0.7' fill='%23444'/%3E%3C/svg%3E","halftone-dots":"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='60' height='60' viewBox='0 0 60 60'%3E%3Crect fill='%23222'/%3E%3Ccircle cx='10' cy='10' r='3' fill='%23444'/%3E%3Ccircle cx='30' cy='10' r='2' fill='%23444'/%3E%3Ccircle cx='50' cy='10' r='3' fill='%23444'/%3E%3Ccircle cx='20' cy='30' r='2.5' fill='%23444'/%3E%3Ccircle cx='40' cy='30' r='2' fill='%23444'/%3E%3Ccircle cx='10' cy='50' r='2' fill='%23444'/%3E%3Ccircle cx='30' cy='50' r='3' fill='%23444'/%3E%3Ccircle cx='50' cy='50' r='2.5' fill='%23444'/%3E%3C/svg%3E"};function r4({onAddObject:r,deckCenterX:e,deckCenterY:t}){const[n,i]=T.useState("edgy"),l=c=>{r({type:"sticker",x:e-20,y:t-20,width:40,height:40,rotation:0,opacity:1,scaleX:1,scaleY:1,iconName:c,strokeWidth:3,stroke:"#ffffff",solidFill:!1})};return a.jsxs("div",{className:"space-y-4",children:[a.jsx("p",{className:"text-[10px] text-muted-foreground",children:"Vector stickers from Lucide icons. Click to add as large decals."}),a.jsx("div",{className:"flex flex-wrap gap-1",children:Object.keys(Gf).map(c=>a.jsx("button",{onClick:()=>i(c),className:it("px-2 py-1 text-[9px] uppercase tracking-wider border transition-colors",n===c?"border-primary bg-primary text-primary-foreground":"border-border hover:border-primary"),children:c},c))}),a.jsx("div",{className:"grid grid-cols-4 gap-2",children:Gf[n].map(c=>{const d=c.icon;return a.jsx("button",{onClick:()=>l(c.name),className:"aspect-square border border-border bg-secondary hover:border-primary transition-colors flex items-center justify-center",title:c.name,children:a.jsx(d,{className:"w-6 h-6",strokeWidth:3})},c.name)})}),a.jsx("p",{className:"text-[9px] text-muted-foreground",children:'Tip: Use the Inspector to toggle "Solid Fill" and adjust stroke width.'})]})}function n4({onAddObject:r,deckCenterX:e,deckCenterY:t}){const[n,i]=T.useState("#1e3a8a"),[l,c]=T.useState("#3b82f6"),[d,u]=T.useState(20),f=m=>{switch(m){case"checkerboard":return`conic-gradient(from 90deg at 1px 1px, ${l} 90deg, ${n} 0) 0 0/${d}px ${d}px`;case"speed-lines":return`repeating-linear-gradient(90deg, ${n} 0px, ${n} ${d/4}px, ${l} ${d/4}px, ${l} ${d/2}px)`;case"halftone":return`radial-gradient(${n} ${d/6}px, ${l} ${d/6}px)`;case"noise":return l;case"tie-dye":return`radial-gradient(ellipse at 30% 30%, ${n}, transparent 50%), radial-gradient(ellipse at 70% 70%, ${l}, transparent 50%), ${n}`;case"diagonal-stripes":return`repeating-linear-gradient(45deg, ${n} 0px, ${n} ${d}px, ${l} ${d}px, ${l} ${d*2}px)`;case"hexagons":return`repeating-conic-gradient(from 30deg, ${n} 0deg 60deg, ${l} 60deg 120deg, ${n} 120deg 180deg, ${l} 180deg 240deg, ${n} 240deg 300deg, ${l} 300deg 360deg) 0 0/${d*2}px ${d*2}px`;case"crosshatch":return`repeating-linear-gradient(0deg, transparent, transparent ${d}px, ${l} ${d}px, ${l} ${d+2}px), repeating-linear-gradient(90deg, transparent, transparent ${d}px, ${n} ${d}px, ${n} ${d+2}px)`;default:return n}},p=m=>{r({type:"shape",x:0,y:0,width:fi,height:hi,rotation:0,opacity:1,scaleX:1,scaleY:1,shapeType:"rect",patternType:m,patternPrimaryColor:n,patternSecondaryColor:l,patternScale:d,fill:n})};return a.jsxs("div",{className:"space-y-4",children:[a.jsx("p",{className:"text-[10px] text-muted-foreground",children:"Procedural patterns using CSS gradients. Infinite color combinations."}),a.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx("span",{className:"text-[9px] uppercase tracking-widest text-muted-foreground",children:"Primary"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"color",value:n,onChange:m=>i(m.target.value),className:"w-8 h-8 border border-border cursor-pointer bg-transparent"}),a.jsx("span",{className:"text-[9px] font-mono",children:n})]})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("span",{className:"text-[9px] uppercase tracking-widest text-muted-foreground",children:"Secondary"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"color",value:l,onChange:m=>c(m.target.value),className:"w-8 h-8 border border-border cursor-pointer bg-transparent"}),a.jsx("span",{className:"text-[9px] font-mono",children:l})]})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-[9px] uppercase tracking-widest text-muted-foreground",children:"Scale"}),a.jsxs("span",{className:"text-[10px] font-mono",children:[d,"px"]})]}),a.jsx(st,{value:[d],onValueChange:([m])=>u(m),min:5,max:50,step:5})]}),a.jsx("div",{className:"space-y-2",children:Z3.map(m=>a.jsxs("button",{onClick:()=>p(m.id),className:"w-full border border-border hover:border-primary transition-colors p-2 flex items-center gap-3",children:[a.jsx("div",{className:"w-10 h-10 border border-border flex-shrink-0",style:{background:f(m.id),backgroundSize:`${d}px ${d}px`}}),a.jsxs("div",{className:"text-left",children:[a.jsx("span",{className:"text-xs font-mono block",children:m.name}),a.jsx("span",{className:"text-[9px] text-muted-foreground",children:m.description})]})]},m.id))})]})}function s4({onAddObject:r,deckCenterX:e,deckCenterY:t}){const n=(i,l)=>{const c=`https://picsum.photos/seed/${i.replace(/\s/g,"")}-${l}/200/300`;r({type:"texture",x:0,y:0,width:fi,height:hi,rotation:0,opacity:.6,scaleX:1,scaleY:1,textureUrl:c,blendMode:"multiply"})};return a.jsxs("div",{className:"space-y-4",children:[a.jsx("p",{className:"text-[10px] text-muted-foreground",children:"Realistic textures applied with blend modes. Click to add as overlay."}),J3.map(i=>a.jsxs("div",{className:"space-y-2",children:[a.jsx("span",{className:"text-[10px] uppercase tracking-widest text-muted-foreground",children:i.name}),a.jsx("div",{className:"grid grid-cols-3 gap-1",children:[0,1,2].map(l=>a.jsx("button",{onClick:()=>n(i.query,l),className:"aspect-square border border-border hover:border-primary transition-colors overflow-hidden bg-secondary",children:a.jsx("img",{src:`https://picsum.photos/seed/${i.query.replace(/\s/g,"")}-${l}/100/100`,alt:i.name,className:"w-full h-full object-cover opacity-70 hover:opacity-100 transition-opacity",loading:"lazy"})},l))})]},i.id)),a.jsx("p",{className:"text-[9px] text-muted-foreground",children:"Textures use multiply blend by default. Change in Inspector."})]})}const i4=[{id:"straight",name:"Straight",description:"Clean straight line",icon:""},{id:"curved",name:"Curved",description:"Smooth bezier curve",icon:""},{id:"zigzag",name:"Zigzag",description:"Sharp angles",icon:""},{id:"dashed",name:"Dashed",description:"Dotted line",icon:""}];function a4({onAddObject:r,deckCenterX:e,deckCenterY:t}){const[n,i]=T.useState("#ffffff"),[l,c]=T.useState(3),d=u=>{r({type:"line",x:e-30,y:t,width:60,height:60,rotation:0,opacity:1,scaleX:1,scaleY:1,lineType:u,lineEndX:60,lineEndY:u==="curved"?-30:0,lineCurve:u==="curved"?50:0,strokeWidth:l,stroke:n,lineCapStyle:"round"})};return a.jsxs("div",{className:"space-y-4",children:[a.jsx("p",{className:"text-[10px] text-muted-foreground",children:"Draw lines and curves. Click to add, then drag endpoints in canvas."}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("span",{className:"text-[9px] uppercase tracking-widest text-muted-foreground",children:"Stroke Color"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"color",value:n,onChange:u=>i(u.target.value),className:"w-8 h-8 border border-border cursor-pointer bg-transparent"}),a.jsx("div",{className:"flex gap-1",children:["#ffffff","#ccff00","#ff6600","#00ffff","#ff00ff","#000000"].map(u=>a.jsx("button",{onClick:()=>i(u),className:`w-5 h-5 border ${n===u?"border-primary":"border-border"}`,style:{backgroundColor:u}},u))})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-[9px] uppercase tracking-widest text-muted-foreground",children:"Stroke Width"}),a.jsxs("span",{className:"text-[10px] font-mono",children:[l,"px"]})]}),a.jsx(st,{value:[l],onValueChange:([u])=>c(u),min:1,max:12,step:1})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("span",{className:"text-[9px] uppercase tracking-widest text-muted-foreground",children:"Line Types"}),a.jsx("div",{className:"grid grid-cols-2 gap-2",children:i4.map(u=>a.jsxs("button",{onClick:()=>d(u.id),className:"border border-border hover:border-primary transition-colors p-3 flex flex-col items-center gap-1",children:[a.jsx("span",{className:"text-2xl leading-none",style:{color:n},children:u.icon}),a.jsx("span",{className:"text-[9px] font-mono",children:u.name})]},u.id))})]}),a.jsx("p",{className:"text-[9px] text-muted-foreground",children:"Tip: Use Inspector to adjust curve amount and endpoints."})]})}function o4({onAddObject:r,deckCenterX:e,deckCenterY:t}){const[n,i]=T.useState([]),[l,c]=T.useState(!1),[d,u]=T.useState(!1),f=T.useRef(null),{isAuthenticated:p}=Nn();T.useState(()=>{p&&m()});const m=async()=>{if(p){c(!0);try{const x=await zc.list();i(x.assets||[])}catch(x){console.error("Failed to load assets:",x)}finally{c(!1)}}},y=async x=>{const v=x.target.files;if(!v||v.length===0)return;u(!0);let S=0,C=0,k=0;try{for(const E of Array.from(v))if(Q3(E))try{const P=await W3(E);P.forEach(D=>r(D)),S++,k+=P.length,P.length>0?ce.success(`Imported ${E.name}`,{description:`${P.length} shape${P.length!==1?"s":""} added to canvas`,duration:3e3}):ce.warning(`${E.name} imported but no shapes found`,{description:"The SVG may be empty or use unsupported features",duration:3e3})}catch(P){console.error("SVG import failed:",P),ce.error(`Failed to import ${E.name}`,{description:"Invalid SVG file or unsupported format",duration:4e3})}else try{const{url:P,width:D,height:I}=await zc.upload(E);C++,ce.success(`Uploaded ${E.name}`,{description:"Image added to your library"}),await m()}catch(P){console.error("Image upload failed:",P),ce.error(`Failed to upload ${E.name}`,{description:"Please try again or check file format"})}if(v.length>1){const E=[];S>0&&E.push(`${S} SVG${S!==1?"s":""} (${k} shapes)`),C>0&&E.push(`${C} image${C!==1?"s":""}`),E.length>0&&ce.success("Batch upload complete",{description:E.join(" + ")})}}catch(E){console.error("Upload failed:",E),ce.error("Upload failed",{description:"Please try again or check your files"})}finally{u(!1),f.current&&(f.current.value="")}},w=x=>{const S=Math.min(120/x.width,120/x.height),C=x.width*S,k=x.height*S;r({type:"image",x:e-C/2,y:t-k/2,width:x.width,height:x.height,rotation:0,opacity:1,scaleX:S,scaleY:S,src:x.file_url})},_=async x=>{if(confirm("Delete this asset?"))try{await zc.delete(x),await m()}catch(v){console.error("Delete failed:",v)}};return p?a.jsxs("div",{className:"space-y-4",children:[a.jsx("input",{ref:f,type:"file",accept:"image/*,.svg",multiple:!0,className:"hidden",onChange:y}),a.jsx("div",{onClick:()=>{var x;return(x=f.current)==null?void 0:x.click()},className:"border-2 border-dashed border-border p-6 text-center hover:border-primary transition-colors cursor-pointer",children:d?a.jsxs(a.Fragment,{children:[a.jsx(xr,{className:"w-6 h-6 mx-auto mb-2 animate-spin text-primary"}),a.jsx("span",{className:"text-[10px] uppercase tracking-widest text-muted-foreground",children:"Uploading..."})]}):a.jsxs(a.Fragment,{children:[a.jsx(Ho,{className:"w-6 h-6 mx-auto mb-2 text-muted-foreground"}),a.jsx("span",{className:"text-[10px] uppercase tracking-widest text-muted-foreground block mb-1",children:"Upload Images"}),a.jsx("span",{className:"text-xs text-muted-foreground",children:"PNG, JPG, SVG"})]})}),l?a.jsx("div",{className:"text-center py-4",children:a.jsx(xr,{className:"w-5 h-5 mx-auto animate-spin text-muted-foreground"})}):n.length>0?a.jsx("div",{className:"grid grid-cols-2 gap-2",children:n.map(x=>a.jsxs("div",{className:"relative group border border-border hover:border-primary transition-colors overflow-hidden aspect-square cursor-pointer",onClick:()=>w(x),children:[a.jsx("img",{src:x.file_url,alt:x.name,className:"w-full h-full object-cover"}),a.jsx("button",{onClick:v=>{v.stopPropagation(),_(x.id)},className:"absolute top-1 right-1 p-1 bg-destructive text-destructive-foreground rounded opacity-0 group-hover:opacity-100 transition-opacity",children:a.jsx(jn,{className:"w-3 h-3"})})]},x.id))}):a.jsx("p",{className:"text-center text-xs text-muted-foreground py-4",children:"No uploads yet. Click above to upload!"})]}):a.jsxs("div",{className:"text-center py-8 space-y-4",children:[a.jsx("p",{className:"text-xs text-muted-foreground",children:"Login to upload custom images"}),a.jsx(de,{size:"sm",onClick:()=>window.location.href="/auth",children:"Login"})]})}function l4(){const{textureOverlays:r,toggleTexture:e,updateTexture:t}=Ct();return a.jsxs("div",{className:"space-y-4",children:[a.jsx("span",{className:"text-[10px] uppercase tracking-widest text-muted-foreground block",children:"Texture Overlays"}),a.jsx("p",{className:"text-[10px] text-muted-foreground",children:"Add realistic print textures that blend over your design."}),r.map(n=>a.jsxs("div",{className:it("border p-3 space-y-3 transition-colors",n.enabled?"border-primary bg-secondary/50":"border-border"),children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("button",{onClick:()=>e(n.id),className:it("w-12 h-12 border flex-shrink-0 bg-cover bg-center",n.enabled?"border-primary":"border-border"),style:{backgroundImage:`url("${t4[n.id]}")`}}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"font-mono text-xs",children:n.name}),a.jsx("button",{onClick:()=>e(n.id),className:it("w-8 h-4 rounded-full transition-colors relative",n.enabled?"bg-primary":"bg-muted"),children:a.jsx("span",{className:it("absolute top-0.5 w-3 h-3 rounded-full bg-white transition-transform",n.enabled?"translate-x-4":"translate-x-0.5")})})]}),a.jsx("span",{className:"text-[9px] text-muted-foreground uppercase tracking-wider",children:n.blendMode})]})]}),n.enabled&&a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-[9px] uppercase tracking-widest text-muted-foreground",children:"Opacity"}),a.jsxs("span",{className:"font-mono text-[10px]",children:[Math.round(n.opacity*100),"%"]})]}),a.jsx(st,{value:[n.opacity*100],onValueChange:([i])=>t(n.id,{opacity:i/100}),min:5,max:100,step:5,className:"w-full"})]})]},n.id))]})}function c4({tool:r,onAddObject:e,deckCenterX:t,deckCenterY:n}){const i=(d,u)=>{d.dataTransfer.setData("application/json",JSON.stringify(u)),d.dataTransfer.effectAllowed="copy"},l=()=>{e({type:"text",x:t-25,y:n,width:50,height:24,rotation:0,opacity:1,scaleX:1,scaleY:1,text:"SKATE",fontSize:18,fontFamily:"Oswald",fill:"#ffffff"}),ce.success("Text added to center of deck",{description:"Double-click text to edit, or use Inspector panel to customize",duration:3e3})},c=d=>{e({type:"shape",x:t-15,y:n-15,width:30,height:30,rotation:0,opacity:1,scaleX:1,scaleY:1,shapeType:d,fill:"#ffffff"})};if(r==="stickers")return a.jsx(r4,{onAddObject:e,deckCenterX:t,deckCenterY:n});if(r==="patterns")return a.jsx(n4,{onAddObject:e,deckCenterX:t,deckCenterY:n});if(r==="textures")return a.jsx(s4,{onAddObject:e,deckCenterX:t,deckCenterY:n});if(r==="lines")return a.jsx(a4,{onAddObject:e,deckCenterX:t,deckCenterY:n});if(r==="graphics")return a.jsxs("div",{className:"space-y-3",children:[a.jsx("span",{className:"text-[10px] uppercase tracking-widest text-muted-foreground",children:"Click to add or drag to canvas"}),a.jsx("div",{className:"grid grid-cols-3 gap-2",children:e4.map(d=>a.jsxs("button",{draggable:!0,onDragStart:u=>i(u,{type:"shape",shapeType:d.shapeType,width:30,height:30,fill:"#ffffff"}),onClick:()=>c(d.shapeType),className:"aspect-square border border-border bg-secondary hover:border-primary transition-colors flex items-center justify-center cursor-grab active:cursor-grabbing",children:[d.shapeType==="circle"&&a.jsx("div",{className:"w-8 h-8 rounded-full bg-white"}),d.shapeType==="rect"&&a.jsx("div",{className:"w-8 h-8 bg-white"}),d.shapeType==="star"&&a.jsx("span",{className:"text-white text-2xl",children:""})]},d.id))})]});if(r==="pen"){const d=()=>{e({type:"path",x:t-30,y:n-30,width:60,height:60,rotation:0,opacity:1,scaleX:1,scaleY:1,stroke:"#ffffff",strokeWidth:3,solidFill:!1,pathPoints:[{x:0,y:30},{x:30,y:0,cp1x:10,cp1y:30,cp2x:20,cp2y:0},{x:60,y:30,cp1x:40,cp1y:0,cp2x:50,cp2y:30}],pathClosed:!1})},u=()=>{e({type:"path",x:t-25,y:n-25,width:50,height:50,rotation:0,opacity:1,scaleX:1,scaleY:1,fill:"#ccff00",stroke:"#ffffff",strokeWidth:2,solidFill:!0,pathPoints:[{x:25,y:0},{x:50,y:43,cp1x:50,cp1y:15,cp2x:50,cp2y:28},{x:0,y:43,cp1x:0,cp1y:28,cp2x:0,cp2y:15}],pathClosed:!0})};return a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx("span",{className:"text-[10px] uppercase tracking-widest text-muted-foreground",children:"Quick Start"}),a.jsx("button",{onClick:d,className:"w-full btn-brutal text-left",children:"+ Curved Path"}),a.jsx("button",{onClick:u,className:"w-full btn-brutal text-left",children:"+ Closed Shape"})]}),a.jsxs("div",{className:"space-y-2 pt-3 border-t border-border",children:[a.jsx("span",{className:"text-[10px] uppercase tracking-widest text-muted-foreground",children:"Instructions"}),a.jsxs("div",{className:"text-xs text-muted-foreground space-y-2",children:[a.jsxs("p",{children:[a.jsx("strong",{children:"Select a path"})," to see anchor points (blue) and control handles (orange)."]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Drag"})," the path to move it around the canvas."]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Edit points"})," in the Inspector panel to add/remove anchors or adjust curves."]}),a.jsxs("p",{children:["Use ",a.jsx("strong",{children:"Transform tools"})," to scale and rotate paths."]})]})]})]})}return r==="text"?a.jsxs("div",{className:"space-y-4",children:[a.jsx("p",{className:"text-[10px] text-muted-foreground",children:"Add custom text to your deck. Text appears in the center and is immediately selected for editing."}),a.jsxs("button",{onClick:l,className:"w-full btn-brutal text-left flex items-center justify-between group",children:[a.jsx("span",{children:"+ Add Text"}),a.jsx("span",{className:"text-[9px] text-muted-foreground group-hover:text-foreground transition-colors",children:"Click to add"})]}),a.jsx("div",{className:"p-3 border border-accent/30 bg-accent/10 space-y-2",children:a.jsxs("div",{className:"flex items-start gap-2",children:[a.jsx("span",{className:"text-accent text-lg",children:""}),a.jsxs("div",{className:"text-[10px] text-muted-foreground space-y-1",children:[a.jsx("p",{children:a.jsx("strong",{children:"After adding:"})}),a.jsx("p",{children:" Edit text in Inspector panel"}),a.jsx("p",{children:" Change font, size, color"}),a.jsx("p",{children:" Drag to reposition"}),a.jsx("p",{children:" Use transform handles to resize/rotate"})]})]})}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("span",{className:"text-[10px] uppercase tracking-widest text-muted-foreground",children:"Popular Styles"}),a.jsxs("div",{className:"space-y-1",children:[a.jsxs("div",{className:"p-2 border border-border bg-secondary",children:[a.jsx("span",{className:"font-display text-base font-bold",children:"BOLD IMPACT"}),a.jsx("p",{className:"text-[9px] text-muted-foreground mt-1",children:"High visibility branding"})]}),a.jsxs("div",{className:"p-2 border border-border bg-secondary",children:[a.jsx("span",{className:"font-display text-base italic",children:"Stylish Script"}),a.jsx("p",{className:"text-[9px] text-muted-foreground mt-1",children:"Elegant cursive look"})]}),a.jsxs("div",{className:"p-2 border border-border bg-secondary",children:[a.jsx("span",{className:"font-mono text-sm",children:"TECHNICAL MONO"}),a.jsx("p",{className:"text-[9px] text-muted-foreground mt-1",children:"Clean modern aesthetic"})]})]})]})]}):r==="uploads"?a.jsx(o4,{onAddObject:e,deckCenterX:t,deckCenterY:n}):r==="finishes"?a.jsx(l4,{}):a.jsx("div",{className:"text-center py-8",children:a.jsx("span",{className:"text-[10px] text-muted-foreground",children:"Use Stickers, Patterns, or Textures for assets."})})}const d4={templates:"Templates",graphics:"Graphics",text:"Text",uploads:"Uploads",background:"Background",finishes:"Finishes",stickers:"Stickers",patterns:"Patterns",textures:"Textures",lines:"Lines",pen:"Pen Tool"};function Hf(){const{activeTool:r,drawerOpen:e,toggleDrawer:t,addObject:n}=Ct();if(!e||!r||r==="pen")return null;const i=fi/2,l=hi/2;return a.jsxs("div",{className:"w-56 bg-card border-r border-border h-full flex flex-col",children:[a.jsxs("div",{className:"flex items-center justify-between py-3 px-3 border-b border-border",children:[a.jsx("span",{className:"font-display text-xs uppercase tracking-widest",children:d4[r]}),a.jsx("button",{onClick:()=>t(!1),className:"w-6 h-6 flex items-center justify-center hover:bg-secondary transition-colors",children:a.jsx(wa,{className:"w-4 h-4"})})]}),a.jsx(Qn,{className:"flex-1 p-3",children:a.jsx(c4,{tool:r,onAddObject:n,deckCenterX:i,deckCenterY:l})})]})}function u4(r){return r.type==="text"?Jo:r.type==="image"?Id:r.type==="sticker"?Xp:r.type==="line"?qp:r.type==="path"?Rd:r.type==="texture"?Od:r.type==="shape"?r.shapeType==="circle"?Kp:r.shapeType==="star"?Md:Wo:Wo}function Uf(r){return r.type==="text"&&r.text?r.text.length>15?r.text.slice(0,15)+"...":r.text:r.type==="sticker"&&r.iconName?`${r.iconName} Sticker`:r.type==="shape"&&r.shapeType?`${r.shapeType.charAt(0).toUpperCase()+r.shapeType.slice(1)} Shape`:r.type==="line"&&r.lineType?`${r.lineType.charAt(0).toUpperCase()+r.lineType.slice(1)} Line`:r.type==="path"?r.pathClosed?"Closed Path":"Open Path":r.type==="texture"?"Texture Overlay":r.type==="image"?"Image":r.type.charAt(0).toUpperCase()+r.type.slice(1)}function h4({obj:r,index:e,isSelected:t,onSelect:n,onDelete:i}){const l=u4(r),{updateObject:c}=Ct(),d=f=>{f.stopPropagation(),c(r.id,{hidden:!r.hidden}),ce.success(r.hidden?"Layer visible":"Layer hidden")},u=f=>{f.stopPropagation(),c(r.id,{locked:!r.locked}),ce.success(r.locked?"Layer unlocked":"Layer locked")};return a.jsxs("div",{onClick:n,className:it("flex items-center gap-1.5 px-2 py-1.5 border-b border-border cursor-pointer group","hover:bg-secondary transition-colors",t&&"bg-primary/10 border-l-2 border-l-primary",r.hidden&&"opacity-50"),children:[a.jsx(H2,{className:"w-3 h-3 text-muted-foreground cursor-grab"}),a.jsx(l,{className:"w-4 h-4 text-foreground"}),a.jsx("span",{className:"flex-1 text-xs truncate font-medium",children:Uf(r)}),a.jsxs(ra,{children:[a.jsx(na,{asChild:!0,children:a.jsx("button",{onClick:d,className:"w-6 h-6 flex items-center justify-center hover:bg-secondary transition-colors rounded",title:r.hidden?"Show layer":"Hide layer",children:r.hidden?a.jsx(U2,{className:"w-3.5 h-3.5 text-muted-foreground"}):a.jsx(Zn,{className:"w-3.5 h-3.5 text-muted-foreground"})})}),a.jsx(ni,{side:"left",children:a.jsxs("p",{className:"text-xs",children:[r.hidden?"Show":"Hide"," layer"]})})]}),a.jsxs(ra,{children:[a.jsx(na,{asChild:!0,children:a.jsx("button",{onClick:u,className:"w-6 h-6 flex items-center justify-center hover:bg-secondary transition-colors rounded",title:r.locked?"Unlock layer":"Lock layer",children:r.locked?a.jsx(el,{className:"w-3.5 h-3.5 text-orange-500"}):a.jsx(Jp,{className:"w-3.5 h-3.5 text-muted-foreground"})})}),a.jsx(ni,{side:"left",children:a.jsxs("p",{className:"text-xs",children:[r.locked?"Unlock":"Lock"," layer"]})})]}),a.jsxs(ra,{children:[a.jsx(na,{asChild:!0,children:a.jsx("button",{onClick:f=>{f.stopPropagation();const p=Uf(r);i(),ce.success(`Deleted "${p}"`,{description:"Use Layers panel to manage or remove items",duration:2e3})},className:"w-6 h-6 flex items-center justify-center hover:bg-destructive hover:text-destructive-foreground transition-colors rounded opacity-0 group-hover:opacity-100",title:"Delete layer",children:a.jsx(jn,{className:"w-3.5 h-3.5"})})}),a.jsx(ni,{side:"left",children:a.jsx("p",{className:"text-xs",children:"Delete this layer"})})]})]})}function zg(){const{objects:r,selectedId:e,selectObject:t,deleteObject:n,moveLayer:i}=Ct(),l=[...r].reverse();return a.jsxs("div",{className:"border-t border-border",children:[a.jsxs("div",{className:"py-2 px-3 border-b border-border bg-accent/10",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Uo,{className:"w-4 h-4 text-accent"}),a.jsxs("span",{className:"font-display text-xs uppercase tracking-widest text-foreground font-semibold",children:["Layers ",r.length>0&&`(${r.length})`]})]}),a.jsxs(ra,{children:[a.jsx(na,{asChild:!0,children:a.jsx("button",{className:"w-4 h-4 flex items-center justify-center text-muted-foreground hover:text-foreground transition-colors",children:a.jsx(Zp,{className:"w-3.5 h-3.5"})})}),a.jsxs(ni,{side:"left",className:"max-w-xs",children:[a.jsx("p",{className:"text-xs font-semibold mb-1",children:"Layers Panel"}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"Shows all elements on your deck. Click to select, hover to reveal delete button."})]})]})]}),r.length>0&&a.jsx("p",{className:"text-[9px] text-muted-foreground mt-1",children:"Click layer to select  Hover to delete"})]}),a.jsx(Qn,{className:"h-48",children:l.length===0?a.jsxs("div",{className:"p-6 text-center space-y-2",children:[a.jsx(Uo,{className:"w-8 h-8 mx-auto text-muted-foreground opacity-50"}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xs font-semibold text-muted-foreground uppercase tracking-wider",children:"No layers yet"}),a.jsx("p",{className:"text-[10px] text-muted-foreground mt-1",children:"Add text, shapes, or images to see them here"})]})]}):l.map((c,d)=>{const u=r.length-1-d;return a.jsx(h4,{obj:c,index:u,isSelected:e===c.id,onSelect:()=>t(c.id),onDelete:()=>n(c.id),onMoveUp:()=>i(c.id,"up"),onMoveDown:()=>i(c.id,"down"),isFirst:d===0,isLast:d===l.length-1},c.id)})})]})}var pl="Switch",[f4]=kn(pl),[p4,m4]=f4(pl),Bg=T.forwardRef((r,e)=>{const{__scopeSwitch:t,name:n,checked:i,defaultChecked:l,required:c,disabled:d,value:u="on",onCheckedChange:f,form:p,...m}=r,[y,w]=T.useState(null),_=Dt(e,k=>w(k)),x=T.useRef(!1),v=y?p||!!y.closest("form"):!0,[S,C]=ts({prop:i,defaultProp:l??!1,onChange:f,caller:pl});return a.jsxs(p4,{scope:t,checked:S,disabled:d,children:[a.jsx(vt.button,{type:"button",role:"switch","aria-checked":S,"aria-required":c,"data-state":Wg(S),"data-disabled":d?"":void 0,disabled:d,value:u,...m,ref:_,onClick:nt(r.onClick,k=>{C(E=>!E),v&&(x.current=k.isPropagationStopped(),x.current||k.stopPropagation())})}),v&&a.jsx(Ug,{control:y,bubbles:!x.current,name:n,value:u,checked:S,required:c,disabled:d,form:p,style:{transform:"translateX(-100%)"}})]})});Bg.displayName=pl;var Gg="SwitchThumb",Hg=T.forwardRef((r,e)=>{const{__scopeSwitch:t,...n}=r,i=m4(Gg,t);return a.jsx(vt.span,{"data-state":Wg(i.checked),"data-disabled":i.disabled?"":void 0,...n,ref:e})});Hg.displayName=Gg;var g4="SwitchBubbleInput",Ug=T.forwardRef(({__scopeSwitch:r,control:e,checked:t,bubbles:n=!0,...i},l)=>{const c=T.useRef(null),d=Dt(c,l),u=Sg(t),f=Kd(e);return T.useEffect(()=>{const p=c.current;if(!p)return;const m=window.HTMLInputElement.prototype,w=Object.getOwnPropertyDescriptor(m,"checked").set;if(u!==t&&w){const _=new Event("click",{bubbles:n});w.call(p,t),p.dispatchEvent(_)}},[u,t,n]),a.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:t,...i,tabIndex:-1,ref:d,style:{...i.style,...f,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});Ug.displayName=g4;function Wg(r){return r?"checked":"unchecked"}var Vg=Bg,x4=Hg;const ml=T.forwardRef(({className:r,...e},t)=>a.jsx(Vg,{className:it("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors data-[state=checked]:bg-primary data-[state=unchecked]:bg-input focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50",r),...e,ref:t,children:a.jsx(x4,{className:it("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})}));ml.displayName=Vg.displayName;var y4=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],v4=y4.reduce((r,e)=>{const t=Dx(`Primitive.${e}`),n=T.forwardRef((i,l)=>{const{asChild:c,...d}=i,u=c?t:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),a.jsx(u,{...d,ref:l})});return n.displayName=`Primitive.${e}`,{...r,[e]:n}},{}),w4="Separator",Wf="horizontal",b4=["horizontal","vertical"],$g=T.forwardRef((r,e)=>{const{decorative:t,orientation:n=Wf,...i}=r,l=_4(n)?n:Wf,d=t?{role:"none"}:{"aria-orientation":l==="vertical"?l:void 0,role:"separator"};return a.jsx(v4.div,{"data-orientation":l,...d,...i,ref:e})});$g.displayName=w4;function _4(r){return b4.includes(r)}var Yg=$g;const ws=T.forwardRef(({className:r,orientation:e="horizontal",decorative:t=!0,...n},i)=>a.jsx(Yg,{ref:i,decorative:t,orientation:e,className:it("shrink-0 bg-border",e==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",r),...n}));ws.displayName=Yg.displayName;function S4(){const{selectedId:r,objects:e,updateObject:t}=Ct(),[n,i]=T.useState("gradient"),l=e.find(c=>c.id===r);return!r||!l?a.jsx("div",{className:"p-4 text-center text-sm text-muted-foreground",children:"Select an object to add effects"}):l.type!=="shape"&&l.type!=="text"&&l.type!=="sticker"?a.jsx("div",{className:"p-4 text-center text-sm text-muted-foreground",children:"Effects only available for shapes, text, and stickers"}):a.jsx(Qn,{className:"h-full",children:a.jsxs("div",{className:"p-4 space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-2 border-b border-border pb-2",children:[a.jsxs(de,{variant:n==="gradient"?"default":"ghost",size:"sm",onClick:()=>i("gradient"),children:[a.jsx(cr,{className:"w-3 h-3 mr-1"}),"Gradient"]}),a.jsxs(de,{variant:n==="shadow"?"default":"ghost",size:"sm",onClick:()=>i("shadow"),children:[a.jsx(W2,{className:"w-3 h-3 mr-1"}),"Shadow"]}),a.jsxs(de,{variant:n==="glow"?"default":"ghost",size:"sm",onClick:()=>i("glow"),children:[a.jsx(Qp,{className:"w-3 h-3 mr-1"}),"Glow"]}),a.jsxs(de,{variant:n==="filters"?"default":"ghost",size:"sm",onClick:()=>i("filters"),children:[a.jsx(V2,{className:"w-3 h-3 mr-1"}),"Filters"]})]}),n==="gradient"&&a.jsx(C4,{object:l,updateObject:t}),n==="shadow"&&a.jsx(k4,{object:l,updateObject:t}),n==="glow"&&a.jsx(N4,{object:l,updateObject:t}),n==="filters"&&a.jsx(j4,{object:l,updateObject:t})]})})}function C4({object:r,updateObject:e}){const t=r.fillType||"solid",n=r.gradientStops||[{offset:0,color:"#ff0000"},{offset:1,color:"#0000ff"}],i=r.gradientAngle||0,l=f=>{e(r.id,{fillType:f,gradientStops:f!=="solid"?n:void 0,gradientAngle:f==="linear-gradient"?i:void 0})},c=(f,p)=>{const m=[...n];m[f]={...m[f],...p},e(r.id,{gradientStops:m})},d=()=>{const f=[...n,{offset:.5,color:"#00ff00"}].sort((p,m)=>p.offset-m.offset);e(r.id,{gradientStops:f})},u=f=>{if(n.length<=2)return;const p=n.filter((m,y)=>y!==f);e(r.id,{gradientStops:p})};return a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(Ee,{className:"text-xs",children:"Fill Type"}),a.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[a.jsx(de,{variant:t==="solid"?"default":"outline",size:"sm",onClick:()=>l("solid"),className:"text-xs",children:"Solid"}),a.jsx(de,{variant:t==="linear-gradient"?"default":"outline",size:"sm",onClick:()=>l("linear-gradient"),className:"text-xs",children:"Linear"}),a.jsx(de,{variant:t==="radial-gradient"?"default":"outline",size:"sm",onClick:()=>l("radial-gradient"),className:"text-xs",children:"Radial"})]})]}),t!=="solid"&&a.jsxs(a.Fragment,{children:[t==="linear-gradient"&&a.jsxs("div",{className:"space-y-2",children:[a.jsxs(Ee,{className:"text-xs",children:["Angle: ",i,""]}),a.jsx(st,{value:[i],onValueChange:([f])=>e(r.id,{gradientAngle:f}),min:0,max:360,step:1})]}),a.jsx(ws,{}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx(Ee,{className:"text-xs",children:"Color Stops"}),a.jsx(de,{size:"sm",variant:"ghost",onClick:d,children:a.jsx(da,{className:"w-3 h-3"})})]}),n.map((f,p)=>a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(pt,{type:"color",value:f.color,onChange:m=>c(p,{color:m.target.value}),className:"w-12 h-8 p-1 cursor-pointer"}),a.jsx(st,{value:[f.offset*100],onValueChange:([m])=>c(p,{offset:m/100}),min:0,max:100,step:1,className:"flex-1"}),a.jsxs("span",{className:"text-xs text-muted-foreground w-10 text-right",children:[Math.round(f.offset*100),"%"]}),n.length>2&&a.jsx(de,{size:"sm",variant:"ghost",onClick:()=>u(p),children:a.jsx(jn,{className:"w-3 h-3"})})]},p))]})]})]})}function k4({object:r,updateObject:e}){const t=r.dropShadow||{enabled:!1,offsetX:4,offsetY:4,blur:8,color:"#000000",opacity:.5},n=i=>{e(r.id,{dropShadow:{...t,...i}})};return a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx(Ee,{className:"text-xs",children:"Drop Shadow"}),a.jsx(ml,{checked:t.enabled,onCheckedChange:i=>n({enabled:i})})]}),t.enabled&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"space-y-2",children:[a.jsxs(Ee,{className:"text-xs",children:["Offset X: ",t.offsetX,"px"]}),a.jsx(st,{value:[t.offsetX],onValueChange:([i])=>n({offsetX:i}),min:-50,max:50,step:1})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs(Ee,{className:"text-xs",children:["Offset Y: ",t.offsetY,"px"]}),a.jsx(st,{value:[t.offsetY],onValueChange:([i])=>n({offsetY:i}),min:-50,max:50,step:1})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs(Ee,{className:"text-xs",children:["Blur: ",t.blur,"px"]}),a.jsx(st,{value:[t.blur],onValueChange:([i])=>n({blur:i}),min:0,max:50,step:1})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs(Ee,{className:"text-xs",children:["Opacity: ",Math.round(t.opacity*100),"%"]}),a.jsx(st,{value:[t.opacity*100],onValueChange:([i])=>n({opacity:i/100}),min:0,max:100,step:1})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Ee,{className:"text-xs",children:"Color"}),a.jsx(pt,{type:"color",value:t.color,onChange:i=>n({color:i.target.value}),className:"w-full h-10 cursor-pointer"})]})]})]})}function N4({object:r,updateObject:e}){const t=r.glow||{enabled:!1,radius:10,color:"#ffffff",intensity:.8},n=i=>{e(r.id,{glow:{...t,...i}})};return a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx(Ee,{className:"text-xs",children:"Glow Effect"}),a.jsx(ml,{checked:t.enabled,onCheckedChange:i=>n({enabled:i})})]}),t.enabled&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"space-y-2",children:[a.jsxs(Ee,{className:"text-xs",children:["Radius: ",t.radius,"px"]}),a.jsx(st,{value:[t.radius],onValueChange:([i])=>n({radius:i}),min:0,max:50,step:1})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs(Ee,{className:"text-xs",children:["Intensity: ",Math.round(t.intensity*100),"%"]}),a.jsx(st,{value:[t.intensity*100],onValueChange:([i])=>n({intensity:i/100}),min:0,max:100,step:1})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Ee,{className:"text-xs",children:"Color"}),a.jsx(pt,{type:"color",value:t.color,onChange:i=>n({color:i.target.value}),className:"w-full h-10 cursor-pointer"})]})]})]})}function j4({object:r,updateObject:e}){const t=r.duotone||{enabled:!1,color1:"#000000",color2:"#ccff00"},n=i=>{e(r.id,{duotone:{...t,...i}})};return a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsxs(Ee,{className:"text-xs",children:["Blur: ",r.blur||0,"px"]}),a.jsx(st,{value:[r.blur||0],onValueChange:([i])=>e(r.id,{blur:i}),min:0,max:20,step:.5}),a.jsx("p",{className:"text-[9px] text-muted-foreground",children:"Gaussian blur effect (0-20px)"})]}),a.jsx(ws,{}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs(Ee,{className:"text-xs",children:["Saturation: ",r.saturate||100,"%"]}),a.jsx(st,{value:[r.saturate||100],onValueChange:([i])=>e(r.id,{saturate:i}),min:0,max:200,step:5}),a.jsx("p",{className:"text-[9px] text-muted-foreground",children:"0% = grayscale, 100% = normal, 200% = hyper-saturated"})]}),a.jsx(ws,{}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs(Ee,{className:"text-xs",children:["Sepia: ",r.sepia||0,"%"]}),a.jsx(st,{value:[r.sepia||0],onValueChange:([i])=>e(r.id,{sepia:i}),min:0,max:100,step:5}),a.jsx("p",{className:"text-[9px] text-muted-foreground",children:"Vintage photo tone effect"})]}),a.jsx(ws,{}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs(Ee,{className:"text-xs",children:["Posterize: ",r.posterize||32," levels"]}),a.jsx(st,{value:[r.posterize||32],onValueChange:([i])=>e(r.id,{posterize:i}),min:2,max:32,step:1}),a.jsx("p",{className:"text-[9px] text-muted-foreground",children:"Reduce color levels (lower = more posterized)"})]}),a.jsx(ws,{}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx(Ee,{className:"text-xs",children:"Duotone Effect"}),a.jsx(ml,{checked:t.enabled,onCheckedChange:i=>n({enabled:i})})]}),t.enabled&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(Ee,{className:"text-xs",children:"Shadow Color"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx(pt,{type:"color",value:t.color1,onChange:i=>n({color1:i.target.value}),className:"w-16 h-10 cursor-pointer"}),a.jsx("div",{className:"flex gap-1 flex-1",children:["#000000","#1a1a1a","#0000ff","#ff0000"].map(i=>a.jsx("button",{onClick:()=>n({color1:i}),className:"w-8 h-8 border border-border hover:border-primary transition-colors",style:{backgroundColor:i}},i))})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Ee,{className:"text-xs",children:"Highlight Color"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx(pt,{type:"color",value:t.color2,onChange:i=>n({color2:i.target.value}),className:"w-16 h-10 cursor-pointer"}),a.jsx("div",{className:"flex gap-1 flex-1",children:["#ccff00","#00ffff","#ff00ff","#ffff00"].map(i=>a.jsx("button",{onClick:()=>n({color2:i}),className:"w-8 h-8 border border-border hover:border-primary transition-colors",style:{backgroundColor:i}},i))})]})]}),a.jsx("p",{className:"text-[9px] text-muted-foreground",children:"Classic punk/skate magazine effect"})]})]}),a.jsx(ws,{}),a.jsx(de,{onClick:()=>e(r.id,{blur:0,saturate:100,sepia:0,posterize:32,duotone:{enabled:!1,color1:"#000000",color2:"#ccff00"}}),variant:"outline",size:"sm",className:"w-full",children:"Reset All Filters"})]})}const E4=[{id:"sunset",name:"Sunset",gradient:"linear-gradient(135deg, #ff6b6b 0%, #feca57 50%, #ee5a6f 100%)",stops:[{offset:0,color:"#ff6b6b"},{offset:.5,color:"#feca57"},{offset:1,color:"#ee5a6f"}],angle:135},{id:"ocean",name:"Ocean",gradient:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",stops:[{offset:0,color:"#667eea"},{offset:1,color:"#764ba2"}],angle:135},{id:"fire",name:"Fire",gradient:"linear-gradient(135deg, #f12711 0%, #f5af19 100%)",stops:[{offset:0,color:"#f12711"},{offset:1,color:"#f5af19"}],angle:135},{id:"mint",name:"Mint",gradient:"linear-gradient(135deg, #00d2ff 0%, #3a7bd5 100%)",stops:[{offset:0,color:"#00d2ff"},{offset:1,color:"#3a7bd5"}],angle:135},{id:"purple",name:"Purple Haze",gradient:"linear-gradient(135deg, #8e2de2 0%, #4a00e0 100%)",stops:[{offset:0,color:"#8e2de2"},{offset:1,color:"#4a00e0"}],angle:135},{id:"neon",name:"Neon",gradient:"linear-gradient(135deg, #ccff00 0%, #00ffff 100%)",stops:[{offset:0,color:"#ccff00"},{offset:1,color:"#00ffff"}],angle:135}];function P4({currentFill:r,onApplyGradient:e,onApplySolid:t}){const[n,i]=T.useState(!1);return a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs("div",{className:"flex-1 flex items-center gap-2",children:[a.jsx("input",{type:"color",value:r||"#ffffff",onChange:l=>t(l.target.value),className:"w-8 h-8 border border-border cursor-pointer bg-transparent"}),a.jsx(pt,{type:"text",value:r||"#ffffff",onChange:l=>t(l.target.value),className:"h-8 text-xs font-mono bg-secondary border-border flex-1"})]}),a.jsxs(de,{size:"sm",variant:"outline",onClick:()=>i(!n),className:"gap-1.5 shrink-0",title:"Apply gradient fill",children:[a.jsx(cr,{className:"w-3.5 h-3.5"}),a.jsx("span",{className:"text-[10px]",children:"Gradient"})]})]}),n&&a.jsxs("div",{className:"p-3 border border-accent/30 bg-accent/5 rounded space-y-3",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("span",{className:"text-[10px] uppercase tracking-widest text-muted-foreground flex items-center gap-1.5",children:[a.jsx(td,{className:"w-3 h-3"}),"Gradient Presets"]}),a.jsx("button",{onClick:()=>i(!1),className:"text-[9px] text-muted-foreground hover:text-foreground",children:"Close"})]}),a.jsx("div",{className:"grid grid-cols-2 gap-2",children:E4.map(l=>a.jsxs("button",{onClick:()=>{e(l.stops,l.angle||0),ce.success(`Applied ${l.name} gradient`),i(!1)},className:"group space-y-1.5",children:[a.jsx("div",{className:it("h-12 rounded border border-border group-hover:border-primary transition-colors","group-hover:scale-105 transform transition-transform"),style:{background:l.gradient}}),a.jsx("span",{className:"text-[9px] text-muted-foreground group-hover:text-foreground transition-colors block text-center",children:l.name})]},l.id))}),a.jsx("div",{className:"pt-2 border-t border-border",children:a.jsx("p",{className:"text-[9px] text-muted-foreground",children:" Tip: After applying a gradient, adjust colors and angle in the Advanced panel below"})})]})]})}function A4(r){const e=T4(r),t=T.forwardRef((n,i)=>{const{children:l,...c}=n,d=T.Children.toArray(l),u=d.find(D4);if(u){const f=u.props.children,p=d.map(m=>m===u?T.Children.count(f)>1?T.Children.only(null):T.isValidElement(f)?f.props.children:null:m);return a.jsx(e,{...c,ref:i,children:T.isValidElement(f)?T.cloneElement(f,void 0,p):null})}return a.jsx(e,{...c,ref:i,children:l})});return t.displayName=`${r}.Slot`,t}function T4(r){const e=T.forwardRef((t,n)=>{const{children:i,...l}=t;if(T.isValidElement(i)){const c=I4(i),d=O4(l,i.props);return i.type!==T.Fragment&&(d.ref=n?Bp(n,c):c),T.cloneElement(i,d)}return T.Children.count(i)>1?T.Children.only(null):null});return e.displayName=`${r}.SlotClone`,e}var R4=Symbol("radix.slottable");function D4(r){return T.isValidElement(r)&&typeof r.type=="function"&&"__radixId"in r.type&&r.type.__radixId===R4}function O4(r,e){const t={...e};for(const n in e){const i=r[n],l=e[n];/^on[A-Z]/.test(n)?i&&l?t[n]=(...d)=>{const u=l(...d);return i(...d),u}:i&&(t[n]=i):n==="style"?t[n]={...i,...l}:n==="className"&&(t[n]=[i,l].filter(Boolean).join(" "))}return{...r,...t}}function I4(r){var n,i;let e=(n=Object.getOwnPropertyDescriptor(r.props,"ref"))==null?void 0:n.get,t=e&&"isReactWarning"in e&&e.isReactWarning;return t?r.ref:(e=(i=Object.getOwnPropertyDescriptor(r,"ref"))==null?void 0:i.get,t=e&&"isReactWarning"in e&&e.isReactWarning,t?r.props.ref:r.props.ref||r.ref)}var gl="Popover",[Xg]=kn(gl,[ol]),Sa=ol(),[M4,rs]=Xg(gl),qg=r=>{const{__scopePopover:e,children:t,open:n,defaultOpen:i,onOpenChange:l,modal:c=!1}=r,d=Sa(e),u=T.useRef(null),[f,p]=T.useState(!1),[m,y]=ts({prop:n,defaultProp:i??!1,onChange:l,caller:gl});return a.jsx(ag,{...d,children:a.jsx(M4,{scope:e,contentId:Zo(),triggerRef:u,open:m,onOpenChange:y,onOpenToggle:T.useCallback(()=>y(w=>!w),[y]),hasCustomAnchor:f,onCustomAnchorAdd:T.useCallback(()=>p(!0),[]),onCustomAnchorRemove:T.useCallback(()=>p(!1),[]),modal:c,children:t})})};qg.displayName=gl;var Kg="PopoverAnchor",L4=T.forwardRef((r,e)=>{const{__scopePopover:t,...n}=r,i=rs(Kg,t),l=Sa(t),{onCustomAnchorAdd:c,onCustomAnchorRemove:d}=i;return T.useEffect(()=>(c(),()=>d()),[c,d]),a.jsx(Jd,{...l,...n,ref:e})});L4.displayName=Kg;var Qg="PopoverTrigger",Zg=T.forwardRef((r,e)=>{const{__scopePopover:t,...n}=r,i=rs(Qg,t),l=Sa(t),c=Dt(e,i.triggerRef),d=a.jsx(vt.button,{type:"button","aria-haspopup":"dialog","aria-expanded":i.open,"aria-controls":i.contentId,"data-state":n0(i.open),...n,ref:c,onClick:nt(r.onClick,i.onOpenToggle)});return i.hasCustomAnchor?d:a.jsx(Jd,{asChild:!0,...l,children:d})});Zg.displayName=Qg;var su="PopoverPortal",[F4,z4]=Xg(su,{forceMount:void 0}),Jg=r=>{const{__scopePopover:e,forceMount:t,children:n,container:i}=r,l=rs(su,e);return a.jsx(F4,{scope:e,forceMount:t,children:a.jsx(va,{present:t||l.open,children:a.jsx(Gp,{asChild:!0,container:i,children:n})})})};Jg.displayName=su;var gi="PopoverContent",e0=T.forwardRef((r,e)=>{const t=z4(gi,r.__scopePopover),{forceMount:n=t.forceMount,...i}=r,l=rs(gi,r.__scopePopover);return a.jsx(va,{present:n||l.open,children:l.modal?a.jsx(G4,{...i,ref:e}):a.jsx(H4,{...i,ref:e})})});e0.displayName=gi;var B4=A4("PopoverContent.RemoveScroll"),G4=T.forwardRef((r,e)=>{const t=rs(gi,r.__scopePopover),n=T.useRef(null),i=Dt(e,n),l=T.useRef(!1);return T.useEffect(()=>{const c=n.current;if(c)return Ox(c)},[]),a.jsx(Ix,{as:B4,allowPinchZoom:!0,children:a.jsx(t0,{...r,ref:i,trapFocus:t.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:nt(r.onCloseAutoFocus,c=>{var d;c.preventDefault(),l.current||(d=t.triggerRef.current)==null||d.focus()}),onPointerDownOutside:nt(r.onPointerDownOutside,c=>{const d=c.detail.originalEvent,u=d.button===0&&d.ctrlKey===!0,f=d.button===2||u;l.current=f},{checkForDefaultPrevented:!1}),onFocusOutside:nt(r.onFocusOutside,c=>c.preventDefault(),{checkForDefaultPrevented:!1})})})}),H4=T.forwardRef((r,e)=>{const t=rs(gi,r.__scopePopover),n=T.useRef(!1),i=T.useRef(!1);return a.jsx(t0,{...r,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:l=>{var c,d;(c=r.onCloseAutoFocus)==null||c.call(r,l),l.defaultPrevented||(n.current||(d=t.triggerRef.current)==null||d.focus(),l.preventDefault()),n.current=!1,i.current=!1},onInteractOutside:l=>{var u,f;(u=r.onInteractOutside)==null||u.call(r,l),l.defaultPrevented||(n.current=!0,l.detail.originalEvent.type==="pointerdown"&&(i.current=!0));const c=l.target;((f=t.triggerRef.current)==null?void 0:f.contains(c))&&l.preventDefault(),l.detail.originalEvent.type==="focusin"&&i.current&&l.preventDefault()}})}),t0=T.forwardRef((r,e)=>{const{__scopePopover:t,trapFocus:n,onOpenAutoFocus:i,onCloseAutoFocus:l,disableOutsidePointerEvents:c,onEscapeKeyDown:d,onPointerDownOutside:u,onFocusOutside:f,onInteractOutside:p,...m}=r,y=rs(gi,t),w=Sa(t);return Mx(),a.jsx(Lx,{asChild:!0,loop:!0,trapped:n,onMountAutoFocus:i,onUnmountAutoFocus:l,children:a.jsx(Hp,{asChild:!0,disableOutsidePointerEvents:c,onInteractOutside:p,onEscapeKeyDown:d,onPointerDownOutside:u,onFocusOutside:f,onDismiss:()=>y.onOpenChange(!1),children:a.jsx(og,{"data-state":n0(y.open),role:"dialog",id:y.contentId,...w,...m,ref:e,style:{...m.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),r0="PopoverClose",U4=T.forwardRef((r,e)=>{const{__scopePopover:t,...n}=r,i=rs(r0,t);return a.jsx(vt.button,{type:"button",...n,ref:e,onClick:nt(r.onClick,()=>i.onOpenChange(!1))})});U4.displayName=r0;var W4="PopoverArrow",V4=T.forwardRef((r,e)=>{const{__scopePopover:t,...n}=r,i=Sa(t);return a.jsx(lg,{...i,...n,ref:e})});V4.displayName=W4;function n0(r){return r?"open":"closed"}var $4=qg,Y4=Zg,X4=Jg,s0=e0;const q4=$4,K4=Y4,i0=T.forwardRef(({className:r,align:e="center",sideOffset:t=4,...n},i)=>a.jsx(X4,{children:a.jsx(s0,{ref:i,align:e,sideOffset:t,className:it("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",r),...n})}));i0.displayName=s0.displayName;function ys({value:r,onChange:e,label:t,showEyedropper:n=!0}){const[i,l]=T.useState(!1),{objects:c}=Ct(),d=Array.from(new Set(c.flatMap(p=>[p.fill,p.stroke,p.colorize]).filter(p=>!!p&&p!=="none"))).slice(0,12),u=p=>{e(p),l(!1),ce.success("Color picked!",{description:p.toUpperCase()})},f=["#000000","#ffffff","#ccff00","#ff6600","#00ffff","#ff00ff","#ff0000","#00ff00"];return a.jsxs("div",{className:"space-y-2",children:[t&&a.jsx("label",{className:"text-[10px] uppercase tracking-widest text-muted-foreground font-medium block",children:t}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"w-10 h-10 rounded border-2 border-border shadow-sm cursor-pointer hover:scale-105 transition-transform shrink-0",style:{backgroundColor:r},title:r}),a.jsx("input",{type:"color",value:r,onChange:p=>e(p.target.value),className:"flex-1 h-10 border border-border rounded cursor-pointer min-w-0"}),n&&d.length>0&&a.jsxs(q4,{open:i,onOpenChange:l,children:[a.jsx(K4,{asChild:!0,children:a.jsx(de,{size:"sm",variant:"outline",className:"gap-2 shrink-0",title:"Pick color from canvas",children:a.jsx($2,{className:"w-4 h-4"})})}),a.jsx(i0,{className:"w-64 p-3",align:"end",children:a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("h4",{className:"text-sm font-medium",children:"Pick from canvas"}),a.jsx(de,{size:"sm",variant:"ghost",className:"h-6 w-6 p-0",onClick:()=>l(!1),children:a.jsx(wa,{className:"h-4 w-4"})})]}),a.jsx("div",{className:"grid grid-cols-6 gap-2",children:d.map((p,m)=>a.jsx("button",{onClick:()=>u(p),className:`w-9 h-9 rounded border-2 transition-all hover:scale-110 ${r.toLowerCase()===p.toLowerCase()?"border-accent ring-2 ring-accent/30":"border-border/50 hover:border-accent/50"}`,style:{backgroundColor:p},title:p},`${p}-${m}`))}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"Colors from your design"})]})})]})]}),a.jsx("div",{className:"grid grid-cols-8 gap-1.5",children:f.map(p=>a.jsx("button",{onClick:()=>e(p),className:`w-8 h-8 rounded border-2 transition-all hover:scale-110 ${r.toLowerCase()===p.toLowerCase()?"border-accent ring-2 ring-accent/30":"border-border/50"}`,style:{backgroundColor:p},title:p},p))}),a.jsx("div",{className:"flex items-center gap-2",children:a.jsx("input",{type:"text",value:r,onChange:p=>{const m=p.target.value;(/^#[0-9A-Fa-f]{0,6}$/.test(m)||m==="")&&e(m)},placeholder:"#000000",maxLength:7,className:"flex-1 h-8 px-2 text-xs font-mono border border-border rounded bg-background"})})]})}var xl="Collapsible",[Q4,a0]=kn(xl),[Z4,iu]=Q4(xl),o0=T.forwardRef((r,e)=>{const{__scopeCollapsible:t,open:n,defaultOpen:i,disabled:l,onOpenChange:c,...d}=r,[u,f]=ts({prop:n,defaultProp:i??!1,onChange:c,caller:xl});return a.jsx(Z4,{scope:t,disabled:l,contentId:Zo(),open:u,onOpenToggle:T.useCallback(()=>f(p=>!p),[f]),children:a.jsx(vt.div,{"data-state":ou(u),"data-disabled":l?"":void 0,...d,ref:e})})});o0.displayName=xl;var l0="CollapsibleTrigger",c0=T.forwardRef((r,e)=>{const{__scopeCollapsible:t,...n}=r,i=iu(l0,t);return a.jsx(vt.button,{type:"button","aria-controls":i.contentId,"aria-expanded":i.open||!1,"data-state":ou(i.open),"data-disabled":i.disabled?"":void 0,disabled:i.disabled,...n,ref:e,onClick:nt(r.onClick,i.onOpenToggle)})});c0.displayName=l0;var au="CollapsibleContent",d0=T.forwardRef((r,e)=>{const{forceMount:t,...n}=r,i=iu(au,r.__scopeCollapsible);return a.jsx(va,{present:t||i.open,children:({present:l})=>a.jsx(J4,{...n,ref:e,present:l})})});d0.displayName=au;var J4=T.forwardRef((r,e)=>{const{__scopeCollapsible:t,present:n,children:i,...l}=r,c=iu(au,t),[d,u]=T.useState(n),f=T.useRef(null),p=Dt(e,f),m=T.useRef(0),y=m.current,w=T.useRef(0),_=w.current,x=c.open||d,v=T.useRef(x),S=T.useRef(void 0);return T.useEffect(()=>{const C=requestAnimationFrame(()=>v.current=!1);return()=>cancelAnimationFrame(C)},[]),ca(()=>{const C=f.current;if(C){S.current=S.current||{transitionDuration:C.style.transitionDuration,animationName:C.style.animationName},C.style.transitionDuration="0s",C.style.animationName="none";const k=C.getBoundingClientRect();m.current=k.height,w.current=k.width,v.current||(C.style.transitionDuration=S.current.transitionDuration,C.style.animationName=S.current.animationName),u(n)}},[c.open,n]),a.jsx(vt.div,{"data-state":ou(c.open),"data-disabled":c.disabled?"":void 0,id:c.contentId,hidden:!x,...l,ref:p,style:{"--radix-collapsible-content-height":y?`${y}px`:void 0,"--radix-collapsible-content-width":_?`${_}px`:void 0,...r.style},children:x&&i})});function ou(r){return r?"open":"closed"}var ew=o0,tw=c0,rw=d0,Vr="Accordion",nw=["Home","End","ArrowDown","ArrowUp","ArrowLeft","ArrowRight"],[lu,sw,iw]=Bd(Vr),[yl]=kn(Vr,[iw,a0]),cu=a0(),u0=Ke.forwardRef((r,e)=>{const{type:t,...n}=r,i=n,l=n;return a.jsx(lu.Provider,{scope:r.__scopeAccordion,children:t==="multiple"?a.jsx(cw,{...l,ref:e}):a.jsx(lw,{...i,ref:e})})});u0.displayName=Vr;var[h0,aw]=yl(Vr),[f0,ow]=yl(Vr,{collapsible:!1}),lw=Ke.forwardRef((r,e)=>{const{value:t,defaultValue:n,onValueChange:i=()=>{},collapsible:l=!1,...c}=r,[d,u]=ts({prop:t,defaultProp:n??"",onChange:i,caller:Vr});return a.jsx(h0,{scope:r.__scopeAccordion,value:Ke.useMemo(()=>d?[d]:[],[d]),onItemOpen:u,onItemClose:Ke.useCallback(()=>l&&u(""),[l,u]),children:a.jsx(f0,{scope:r.__scopeAccordion,collapsible:l,children:a.jsx(p0,{...c,ref:e})})})}),cw=Ke.forwardRef((r,e)=>{const{value:t,defaultValue:n,onValueChange:i=()=>{},...l}=r,[c,d]=ts({prop:t,defaultProp:n??[],onChange:i,caller:Vr}),u=Ke.useCallback(p=>d((m=[])=>[...m,p]),[d]),f=Ke.useCallback(p=>d((m=[])=>m.filter(y=>y!==p)),[d]);return a.jsx(h0,{scope:r.__scopeAccordion,value:c,onItemOpen:u,onItemClose:f,children:a.jsx(f0,{scope:r.__scopeAccordion,collapsible:!0,children:a.jsx(p0,{...l,ref:e})})})}),[dw,vl]=yl(Vr),p0=Ke.forwardRef((r,e)=>{const{__scopeAccordion:t,disabled:n,dir:i,orientation:l="vertical",...c}=r,d=Ke.useRef(null),u=Dt(d,e),f=sw(t),m=Up(i)==="ltr",y=nt(r.onKeyDown,w=>{var B;if(!nw.includes(w.key))return;const _=w.target,x=f().filter(z=>{var X;return!((X=z.ref.current)!=null&&X.disabled)}),v=x.findIndex(z=>z.ref.current===_),S=x.length;if(v===-1)return;w.preventDefault();let C=v;const k=0,E=S-1,P=()=>{C=v+1,C>E&&(C=k)},D=()=>{C=v-1,C<k&&(C=E)};switch(w.key){case"Home":C=k;break;case"End":C=E;break;case"ArrowRight":l==="horizontal"&&(m?P():D());break;case"ArrowDown":l==="vertical"&&P();break;case"ArrowLeft":l==="horizontal"&&(m?D():P());break;case"ArrowUp":l==="vertical"&&D();break}const I=C%S;(B=x[I].ref.current)==null||B.focus()});return a.jsx(dw,{scope:t,disabled:n,direction:i,orientation:l,children:a.jsx(lu.Slot,{scope:t,children:a.jsx(vt.div,{...c,"data-orientation":l,ref:u,onKeyDown:n?void 0:y})})})}),Ko="AccordionItem",[uw,du]=yl(Ko),m0=Ke.forwardRef((r,e)=>{const{__scopeAccordion:t,value:n,...i}=r,l=vl(Ko,t),c=aw(Ko,t),d=cu(t),u=Zo(),f=n&&c.value.includes(n)||!1,p=l.disabled||r.disabled;return a.jsx(uw,{scope:t,open:f,disabled:p,triggerId:u,children:a.jsx(ew,{"data-orientation":l.orientation,"data-state":b0(f),...d,...i,ref:e,disabled:p,open:f,onOpenChange:m=>{m?c.onItemOpen(n):c.onItemClose(n)}})})});m0.displayName=Ko;var g0="AccordionHeader",x0=Ke.forwardRef((r,e)=>{const{__scopeAccordion:t,...n}=r,i=vl(Vr,t),l=du(g0,t);return a.jsx(vt.h3,{"data-orientation":i.orientation,"data-state":b0(l.open),"data-disabled":l.disabled?"":void 0,...n,ref:e})});x0.displayName=g0;var xd="AccordionTrigger",y0=Ke.forwardRef((r,e)=>{const{__scopeAccordion:t,...n}=r,i=vl(Vr,t),l=du(xd,t),c=ow(xd,t),d=cu(t);return a.jsx(lu.ItemSlot,{scope:t,children:a.jsx(tw,{"aria-disabled":l.open&&!c.collapsible||void 0,"data-orientation":i.orientation,id:l.triggerId,...d,...n,ref:e})})});y0.displayName=xd;var v0="AccordionContent",w0=Ke.forwardRef((r,e)=>{const{__scopeAccordion:t,...n}=r,i=vl(Vr,t),l=du(v0,t),c=cu(t);return a.jsx(rw,{role:"region","aria-labelledby":l.triggerId,"data-orientation":i.orientation,...c,...n,ref:e,style:{"--radix-accordion-content-height":"var(--radix-collapsible-content-height)","--radix-accordion-content-width":"var(--radix-collapsible-content-width)",...r.style}})});w0.displayName=v0;function b0(r){return r?"open":"closed"}var hw=u0,fw=m0,pw=x0,_0=y0,S0=w0;const mw=hw,C0=T.forwardRef(({className:r,...e},t)=>a.jsx(fw,{ref:t,className:it("border-b",r),...e}));C0.displayName="AccordionItem";const k0=T.forwardRef(({className:r,children:e,...t},n)=>a.jsx(pw,{className:"flex",children:a.jsxs(_0,{ref:n,className:it("flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180",r),...t,children:[e,a.jsx(em,{className:"h-4 w-4 shrink-0 transition-transform duration-200"})]})}));k0.displayName=_0.displayName;const N0=T.forwardRef(({className:r,children:e,...t},n)=>a.jsx(S0,{ref:n,className:"overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down",...t,children:a.jsx("div",{className:it("pb-4 pt-0",r),children:e})}));N0.displayName=S0.displayName;function Vf(){const{objects:r,selectedId:e,updateObject:t,saveToHistory:n,generatePattern:i,moveLayer:l,bringToFront:c,sendToBack:d}=Ct(),u=r.find(P=>P.id===e),[f,p]=T.useState(5),[m,y]=T.useState(0),[w,_]=T.useState(!1),[x,v]=T.useState([]);T.useEffect(()=>{Vp().then(v)},[]);const S=()=>{alert("Export feature coming soon! The deck design will be exported as a high-resolution PNG.")},C=P=>{e&&(n(),t(e,P))},{backgroundColor:k,setBackgroundColor:E}=Ct();return a.jsxs("div",{className:"w-64 bg-card border-l border-border h-full flex flex-col",children:[a.jsx("div",{className:"p-3 border-b border-border",children:a.jsxs("button",{onClick:S,className:"w-full bg-accent text-accent-foreground font-display text-sm uppercase tracking-wider py-2.5 px-4 border border-accent hover:bg-accent/90 transition-colors flex items-center justify-center gap-2",children:[a.jsx(Hr,{className:"w-4 h-4"}),"Export Print"]})}),a.jsx("div",{className:"p-3 border-b border-border space-y-2",children:a.jsx(ys,{label:"Deck Background",value:k,onChange:E,showEyedropper:!0})}),a.jsx("div",{className:"flex-1 overflow-auto",children:u?a.jsxs("div",{className:"p-3 space-y-4",children:[a.jsxs("div",{className:"py-2 border-b border-border flex items-center justify-between",children:[a.jsx("span",{className:"font-display text-[10px] uppercase tracking-widest text-muted-foreground",children:"Properties"}),a.jsx("button",{onClick:()=>C({locked:!u.locked}),className:`flex items-center gap-1.5 px-2 py-1 text-xs transition-colors ${u.locked?"bg-destructive/20 text-destructive hover:bg-destructive/30":"bg-secondary text-muted-foreground hover:bg-secondary/80"}`,title:u.locked?"Unlock object":"Lock object",children:u.locked?a.jsxs(a.Fragment,{children:[a.jsx(el,{className:"w-3 h-3"}),a.jsx("span",{className:"uppercase tracking-wider",children:"Locked"})]}):a.jsxs(a.Fragment,{children:[a.jsx(Jp,{className:"w-3 h-3"}),a.jsx("span",{className:"uppercase tracking-wider",children:"Unlocked"})]})})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Ee,{className:"text-[10px] uppercase tracking-widest text-muted-foreground",children:"Layer Order"}),a.jsxs("div",{className:"grid grid-cols-4 gap-1",children:[a.jsxs("button",{onClick:()=>{l(e,"up"),ce.success("Moved forward")},className:"flex items-center justify-center gap-1 px-2 py-1.5 text-xs bg-secondary hover:bg-secondary/80 border border-border transition-colors",title:"Bring forward (Ctrl+])",children:[a.jsx(Y2,{className:"w-3.5 h-3.5"}),a.jsx("span",{className:"text-[9px] uppercase",children:"Forward"})]}),a.jsxs("button",{onClick:()=>{l(e,"down"),ce.success("Moved backward")},className:"flex items-center justify-center gap-1 px-2 py-1.5 text-xs bg-secondary hover:bg-secondary/80 border border-border transition-colors",title:"Send backward (Ctrl+[)",children:[a.jsx(X2,{className:"w-3.5 h-3.5"}),a.jsx("span",{className:"text-[9px] uppercase",children:"Back"})]}),a.jsxs("button",{onClick:()=>{c(e),ce.success("Brought to front")},className:"flex items-center justify-center gap-1 px-2 py-1.5 text-xs bg-secondary hover:bg-secondary/80 border border-border transition-colors",title:"Bring to front (Ctrl+Shift+])",children:[a.jsx(q2,{className:"w-3.5 h-3.5"}),a.jsx("span",{className:"text-[9px] uppercase",children:"Front"})]}),a.jsxs("button",{onClick:()=>{d(e),ce.success("Sent to back")},className:"flex items-center justify-center gap-1 px-2 py-1.5 text-xs bg-secondary hover:bg-secondary/80 border border-border transition-colors",title:"Send to back (Ctrl+Shift+[)",children:[a.jsx(K2,{className:"w-3.5 h-3.5"}),a.jsx("span",{className:"text-[9px] uppercase",children:"Back"})]})]}),a.jsx("p",{className:"text-[9px] text-muted-foreground",children:"Move layer in front of or behind other objects"})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Ee,{className:"text-[10px] uppercase tracking-widest text-muted-foreground",children:"Opacity"}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(st,{value:[u.opacity*100],onValueChange:([P])=>C({opacity:P/100}),max:100,min:0,step:1,className:"flex-1"}),a.jsxs("span",{className:"text-[11px] font-mono w-10 text-right",children:[Math.round(u.opacity*100),"%"]})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Ee,{className:"text-[10px] uppercase tracking-widest text-muted-foreground",children:"Rotation"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(pt,{type:"number",value:Math.round(u.rotation),onChange:P=>C({rotation:Number(P.target.value)}),className:"h-8 text-xs font-mono bg-secondary border-border"}),a.jsx("span",{className:"text-[11px] text-muted-foreground",children:"deg"})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Ee,{className:"text-[10px] uppercase tracking-widest text-muted-foreground",children:"Scale"}),a.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[a.jsxs("div",{children:[a.jsx("span",{className:"text-[9px] text-muted-foreground",children:"X"}),a.jsx(pt,{type:"number",step:"0.1",value:u.scaleX.toFixed(2),onChange:P=>C({scaleX:Number(P.target.value)}),className:"h-8 text-xs font-mono bg-secondary border-border"})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-[9px] text-muted-foreground",children:"Y"}),a.jsx(pt,{type:"number",step:"0.1",value:u.scaleY.toFixed(2),onChange:P=>C({scaleY:Number(P.target.value)}),className:"h-8 text-xs font-mono bg-secondary border-border"})]})]})]}),(u.type==="text"||u.type==="shape")&&a.jsxs("div",{className:"space-y-2",children:[a.jsx(Ee,{className:"text-[10px] uppercase tracking-widest text-muted-foreground",children:"Color"}),a.jsx(P4,{currentFill:u.fill,onApplySolid:P=>C({fill:P}),onApplyGradient:(P,D)=>{C({gradientType:"linear",gradientStops:P,gradientAngle:D,fill:P[0].color})}})]}),u.type==="shape"&&u.patternType&&a.jsxs("div",{className:"pt-4 border-t border-border space-y-4",children:[a.jsx("div",{className:"py-2",children:a.jsx("span",{className:"font-display text-[10px] uppercase tracking-widest text-muted-foreground",children:"Pattern Settings"})}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Ee,{className:"text-[10px] uppercase tracking-widest text-muted-foreground",children:"Pattern Type"}),a.jsxs("select",{value:u.patternType,onChange:P=>C({patternType:P.target.value}),className:"w-full h-8 text-xs bg-secondary border-border rounded px-2",children:[a.jsx("option",{value:"checkerboard",children:"Checkerboard"}),a.jsx("option",{value:"speed-lines",children:"Speed Lines"}),a.jsx("option",{value:"halftone",children:"Halftone"}),a.jsx("option",{value:"diagonal-stripes",children:"Diagonal Stripes"}),a.jsx("option",{value:"hexagons",children:"Hexagons"}),a.jsx("option",{value:"crosshatch",children:"Crosshatch"})]})]}),a.jsx(ys,{label:"Primary Color",value:u.patternPrimaryColor||"#1e3a8a",onChange:P=>C({patternPrimaryColor:P}),showEyedropper:!0}),a.jsx(ys,{label:"Secondary Color",value:u.patternSecondaryColor||"#3b82f6",onChange:P=>C({patternSecondaryColor:P}),showEyedropper:!0}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Ee,{className:"text-[10px] uppercase tracking-widest text-muted-foreground",children:"Pattern Scale"}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(st,{value:[u.patternScale||20],onValueChange:([P])=>C({patternScale:P}),max:100,min:5,step:5,className:"flex-1"}),a.jsxs("span",{className:"text-[11px] font-mono w-10 text-right",children:[u.patternScale||20,"px"]})]})]})]}),(u.type==="image"||u.type==="path")&&a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx(Ee,{className:"text-[10px] uppercase tracking-widest text-muted-foreground",children:"Color Tint"}),a.jsx("button",{onClick:()=>C({colorize:u.colorize?null:"#ccff00"}),className:`px-2 py-1 text-[9px] uppercase tracking-wider border transition-colors rounded ${u.colorize?"bg-primary text-primary-foreground border-primary":"bg-secondary text-muted-foreground border-border hover:border-primary"}`,children:u.colorize?"On":"Off"})]}),u.colorize&&a.jsx(ys,{label:"",value:u.colorize,onChange:P=>C({colorize:P}),showEyedropper:!0}),a.jsxs("p",{className:"text-[9px] text-muted-foreground",children:["Apply a color overlay to the ",u.type]})]}),u.type==="sticker"&&a.jsxs("div",{className:"pt-4 border-t border-border space-y-4",children:[a.jsx("div",{className:"py-2",children:a.jsx("span",{className:"font-display text-[10px] uppercase tracking-widest text-muted-foreground",children:"Sticker Options"})}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx(Ee,{className:"text-[10px] uppercase tracking-widest text-muted-foreground",children:"Fill Color"}),a.jsx("button",{onClick:()=>C({colorize:u.colorize?null:"#ccff00"}),className:`px-2 py-1 text-[9px] uppercase tracking-wider border transition-colors rounded ${u.colorize?"bg-primary text-primary-foreground border-primary":"bg-secondary text-muted-foreground border-border hover:border-primary"}`,children:u.colorize?"On":"Off"})]}),u.colorize&&a.jsx(ys,{label:"",value:u.colorize,onChange:P=>C({colorize:P}),showEyedropper:!0}),a.jsx("p",{className:"text-[9px] text-muted-foreground",children:"Tint the sticker with a solid color"})]}),a.jsx(ys,{label:"Stroke Color",value:u.stroke||"#ffffff",onChange:P=>C({stroke:P}),showEyedropper:!0}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Ee,{className:"text-[10px] uppercase tracking-widest text-muted-foreground",children:"Stroke Width"}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(st,{value:[u.strokeWidth??3],onValueChange:([P])=>C({strokeWidth:P}),max:8,min:1,step:.5,className:"flex-1"}),a.jsxs("span",{className:"text-[11px] font-mono w-10 text-right",children:[u.strokeWidth??3,"px"]})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Ee,{className:"text-[10px] uppercase tracking-widest text-muted-foreground",children:"Line Style"}),a.jsx("div",{className:"grid grid-cols-3 gap-1",children:["solid","dashed","dotted"].map(P=>a.jsx("button",{onClick:()=>C({strokeDashStyle:P}),className:`px-2 py-1.5 text-[10px] uppercase tracking-wider border transition-colors ${(u.strokeDashStyle||"solid")===P?"bg-primary text-primary-foreground border-primary":"bg-secondary text-muted-foreground border-border hover:border-primary"}`,children:P==="solid"?"":P==="dashed"?"":""},P))})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx(Ee,{className:"text-[10px] uppercase tracking-widest text-muted-foreground",children:"Solid Fill"}),a.jsx("button",{onClick:()=>C({solidFill:!u.solidFill}),className:`w-10 h-5 rounded-full transition-colors relative ${u.solidFill?"bg-primary":"bg-muted"}`,children:a.jsx("span",{className:`absolute top-0.5 w-4 h-4 rounded-full bg-white transition-transform ${u.solidFill?"translate-x-5":"translate-x-0.5"}`})})]}),a.jsx("p",{className:"text-[9px] text-muted-foreground",children:"Fill the icon with solid color instead of outline"})]})]}),u.type==="texture"&&a.jsxs("div",{className:"pt-4 border-t border-border space-y-4",children:[a.jsx("div",{className:"py-2",children:a.jsx("span",{className:"font-display text-[10px] uppercase tracking-widest text-muted-foreground",children:"Texture Options"})}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Ee,{className:"text-[10px] uppercase tracking-widest text-muted-foreground",children:"Blend Mode"}),a.jsx("div",{className:"grid grid-cols-2 gap-1",children:["multiply","overlay","soft-light","color-burn","normal"].map(P=>a.jsx("button",{onClick:()=>C({blendMode:P}),className:`py-1.5 px-2 text-[9px] uppercase tracking-wider border transition-colors ${u.blendMode===P?"border-primary bg-primary text-primary-foreground":"border-border hover:border-primary"}`,children:P},P))})]})]}),u.type==="line"&&a.jsxs("div",{className:"pt-4 border-t border-border space-y-4",children:[a.jsx("div",{className:"py-2",children:a.jsx("span",{className:"font-display text-[10px] uppercase tracking-widest text-muted-foreground",children:"Line Options"})}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Ee,{className:"text-[10px] uppercase tracking-widest text-muted-foreground",children:"Line Type"}),a.jsx("div",{className:"grid grid-cols-2 gap-1",children:["straight","curved","zigzag","dashed"].map(P=>a.jsx("button",{onClick:()=>C({lineType:P}),className:`py-1.5 px-2 text-[9px] uppercase tracking-wider border transition-colors ${u.lineType===P?"border-primary bg-primary text-primary-foreground":"border-border hover:border-primary"}`,children:P},P))})]}),a.jsx(ys,{label:"Stroke Color",value:u.stroke||"#ffffff",onChange:P=>C({stroke:P}),showEyedropper:!0}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Ee,{className:"text-[10px] uppercase tracking-widest text-muted-foreground",children:"Stroke Width"}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(st,{value:[u.strokeWidth??3],onValueChange:([P])=>C({strokeWidth:P}),max:12,min:1,step:1,className:"flex-1"}),a.jsxs("span",{className:"text-[11px] font-mono w-10 text-right",children:[u.strokeWidth??3,"px"]})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Ee,{className:"text-[10px] uppercase tracking-widest text-muted-foreground",children:"Line Style"}),a.jsx("div",{className:"grid grid-cols-3 gap-1",children:["solid","dashed","dotted"].map(P=>a.jsx("button",{onClick:()=>C({strokeDashStyle:P}),className:`px-2 py-1.5 text-[10px] uppercase tracking-wider border transition-colors ${(u.strokeDashStyle||"solid")===P?"bg-primary text-primary-foreground border-primary":"bg-secondary text-muted-foreground border-border hover:border-primary"}`,children:P==="solid"?"":P==="dashed"?"":""},P))})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Ee,{className:"text-[10px] uppercase tracking-widest text-muted-foreground",children:"Length (X)"}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(st,{value:[u.lineEndX??60],onValueChange:([P])=>C({lineEndX:P}),max:200,min:-200,step:5,className:"flex-1"}),a.jsx("span",{className:"text-[11px] font-mono w-10 text-right",children:u.lineEndX??60})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Ee,{className:"text-[10px] uppercase tracking-widest text-muted-foreground",children:"Length (Y)"}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(st,{value:[u.lineEndY??0],onValueChange:([P])=>C({lineEndY:P}),max:200,min:-200,step:5,className:"flex-1"}),a.jsx("span",{className:"text-[11px] font-mono w-10 text-right",children:u.lineEndY??0})]})]}),u.lineType==="curved"&&a.jsxs("div",{className:"space-y-2",children:[a.jsx(Ee,{className:"text-[10px] uppercase tracking-widest text-muted-foreground",children:"Curve Amount"}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(st,{value:[u.lineCurve??50],onValueChange:([P])=>C({lineCurve:P}),max:100,min:-100,step:5,className:"flex-1"}),a.jsx("span",{className:"text-[11px] font-mono w-10 text-right",children:u.lineCurve??50})]}),a.jsx("p",{className:"text-[9px] text-muted-foreground",children:"Negative = curve down, Positive = curve up"})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Ee,{className:"text-[10px] uppercase tracking-widest text-muted-foreground",children:"Cap Style"}),a.jsx("div",{className:"grid grid-cols-3 gap-1",children:["butt","round","square"].map(P=>a.jsx("button",{onClick:()=>C({lineCapStyle:P}),className:`py-1.5 px-2 text-[9px] uppercase tracking-wider border transition-colors ${u.lineCapStyle===P?"border-primary bg-primary text-primary-foreground":"border-border hover:border-primary"}`,children:P},P))})]})]}),u.type==="text"&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(Ee,{className:"text-[10px] uppercase tracking-widest text-muted-foreground",children:"Text"}),a.jsx(pt,{type:"text",value:u.text||"",onChange:P=>C({text:P.target.value}),className:"h-8 text-xs font-mono bg-secondary border-border"})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs(Ee,{className:"text-[10px] uppercase tracking-widest text-muted-foreground",children:["Font Family ",x.length>0&&a.jsxs("span",{className:"text-accent font-normal",children:["(",x.length," custom)"]})]}),a.jsxs("button",{onClick:()=>_(!0),className:"text-[10px] uppercase tracking-widest text-accent hover:text-accent/80 transition-colors flex items-center gap-1",children:[a.jsx(Jo,{className:"w-3 h-3"}),x.length>0?"Manage":"Upload"]})]}),a.jsxs("select",{value:u.fontFamily||"Arial",onChange:P=>C({fontFamily:P.target.value}),className:"w-full h-8 text-xs bg-secondary border border-border px-2 cursor-pointer hover:border-primary transition-colors",children:[x.length>0&&a.jsx("optgroup",{label:" Your Custom Fonts",children:x.map(P=>a.jsx("option",{value:P.font_family,children:P.name},P.id))}),a.jsxs("optgroup",{label:"System Fonts",children:[a.jsx("option",{value:"Arial",children:"Arial"}),a.jsx("option",{value:"Helvetica",children:"Helvetica"}),a.jsx("option",{value:"Times New Roman",children:"Times New Roman"}),a.jsx("option",{value:"Courier New",children:"Courier New"}),a.jsx("option",{value:"Georgia",children:"Georgia"}),a.jsx("option",{value:"Verdana",children:"Verdana"}),a.jsx("option",{value:"Impact",children:"Impact"}),a.jsx("option",{value:"Comic Sans MS",children:"Comic Sans MS"})]})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Ee,{className:"text-[10px] uppercase tracking-widest text-muted-foreground",children:"Font Size"}),a.jsx(pt,{type:"number",value:u.fontSize||24,onChange:P=>C({fontSize:Number(P.target.value)}),className:"h-8 text-xs font-mono bg-secondary border-border"})]})]}),a.jsxs("div",{className:"pt-4 border-t border-border space-y-4",children:[a.jsx("div",{className:"py-2",children:a.jsx("span",{className:"font-display text-[10px] uppercase tracking-widest text-muted-foreground",children:"Filters"})}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Ee,{className:"text-[10px] uppercase tracking-widest text-muted-foreground",children:"Contrast"}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(st,{value:[u.contrast??100],onValueChange:([P])=>C({contrast:P}),max:200,min:0,step:5,className:"flex-1"}),a.jsxs("span",{className:"text-[11px] font-mono w-10 text-right",children:[u.contrast??100,"%"]})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Ee,{className:"text-[10px] uppercase tracking-widest text-muted-foreground",children:"Brightness"}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(st,{value:[u.brightness??100],onValueChange:([P])=>C({brightness:P}),max:200,min:0,step:5,className:"flex-1"}),a.jsxs("span",{className:"text-[11px] font-mono w-10 text-right",children:[u.brightness??100,"%"]})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Ee,{className:"text-[10px] uppercase tracking-widest text-muted-foreground",children:"Grayscale"}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(st,{value:[u.grayscale??0],onValueChange:([P])=>C({grayscale:P}),max:100,min:0,step:5,className:"flex-1"}),a.jsxs("span",{className:"text-[11px] font-mono w-10 text-right",children:[u.grayscale??0,"%"]})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx(Ee,{className:"text-[10px] uppercase tracking-widest text-muted-foreground",children:"Threshold"}),a.jsx("button",{onClick:()=>C({threshold:!u.threshold}),className:`w-10 h-5 rounded-full transition-colors relative ${u.threshold?"bg-primary":"bg-muted"}`,children:a.jsx("span",{className:`absolute top-0.5 w-4 h-4 rounded-full bg-white transition-transform ${u.threshold?"translate-x-5":"translate-x-0.5"}`})})]}),a.jsx("p",{className:"text-[9px] text-muted-foreground",children:"High-contrast black & white xerox effect"})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx(Ee,{className:"text-[10px] uppercase tracking-widest text-muted-foreground",children:"Colorize"}),a.jsx("button",{onClick:()=>C({colorize:u.colorize?null:"#00ff00"}),className:`w-10 h-5 rounded-full transition-colors relative ${u.colorize?"bg-primary":"bg-muted"}`,children:a.jsx("span",{className:`absolute top-0.5 w-4 h-4 rounded-full bg-white transition-transform ${u.colorize?"translate-x-5":"translate-x-0.5"}`})})]}),u.colorize&&a.jsxs("div",{className:"flex items-center gap-2 pt-1",children:[a.jsx("input",{type:"color",value:u.colorize,onChange:P=>C({colorize:P.target.value}),className:"w-8 h-8 border border-border cursor-pointer bg-transparent"}),a.jsx("div",{className:"flex gap-1",children:["#ccff00","#ff6600","#00ffff","#ff00ff","#ffffff"].map(P=>a.jsx("button",{onClick:()=>C({colorize:P}),className:`w-6 h-6 border ${u.colorize===P?"border-primary":"border-border"}`,style:{backgroundColor:P}},P))})]}),a.jsx("p",{className:"text-[9px] text-muted-foreground",children:"Cast in a single punk zine color"})]})]}),a.jsxs("div",{className:"pt-4 border-t border-border space-y-4",children:[a.jsx("div",{className:"py-2",children:a.jsx("span",{className:"font-display text-[10px] uppercase tracking-widest text-muted-foreground",children:"Remix Effects"})}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Ee,{className:"text-[10px] uppercase tracking-widest text-muted-foreground",children:"Hue Shift"}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(st,{value:[u.hueRotate??0],onValueChange:([P])=>C({hueRotate:P}),max:360,min:0,step:15,className:"flex-1"}),a.jsxs("span",{className:"text-[11px] font-mono w-10 text-right",children:[u.hueRotate??0,""]})]}),a.jsx("div",{className:"h-3 w-full rounded",style:{background:"linear-gradient(to right, #ff0000, #ffff00, #00ff00, #00ffff, #0000ff, #ff00ff, #ff0000)"}})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx(Ee,{className:"text-[10px] uppercase tracking-widest text-muted-foreground",children:"Invert"}),a.jsx("button",{onClick:()=>C({invert:!u.invert}),className:`w-10 h-5 rounded-full transition-colors relative ${u.invert?"bg-primary":"bg-muted"}`,children:a.jsx("span",{className:`absolute top-0.5 w-4 h-4 rounded-full bg-white transition-transform ${u.invert?"translate-x-5":"translate-x-0.5"}`})})]}),a.jsx("p",{className:"text-[9px] text-muted-foreground",children:"Flip colors to negative"})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx(Ee,{className:"text-[10px] uppercase tracking-widest text-muted-foreground",children:"Pixelate"}),a.jsx("button",{onClick:()=>C({pixelate:!u.pixelate}),className:`w-10 h-5 rounded-full transition-colors relative ${u.pixelate?"bg-primary":"bg-muted"}`,children:a.jsx("span",{className:`absolute top-0.5 w-4 h-4 rounded-full bg-white transition-transform ${u.pixelate?"translate-x-5":"translate-x-0.5"}`})})]}),a.jsx("p",{className:"text-[9px] text-muted-foreground",children:"Lo-fi 8-bit effect (images only)"})]}),a.jsxs("button",{onClick:()=>C({hueRotate:0,invert:!1,pixelate:!1,contrast:100,brightness:100,grayscale:0,threshold:!1,colorize:null}),className:"w-full border border-border hover:border-primary transition-colors py-1.5 px-3 text-[10px] uppercase tracking-wider flex items-center justify-center gap-2",children:[a.jsx(tm,{className:"w-3 h-3"}),"Reset All Filters"]})]}),a.jsx(mw,{type:"single",collapsible:!0,className:"border-t border-border",children:a.jsxs(C0,{value:"effects",className:"border-none",children:[a.jsx(k0,{className:"py-3 px-0 hover:no-underline",children:a.jsx("span",{className:"font-display text-[10px] uppercase tracking-widest text-muted-foreground",children:"Advanced Effects"})}),a.jsx(N0,{className:"pb-4",children:a.jsx(S4,{})})]})}),(u.type==="shape"||u.type==="image"||u.type==="sticker")&&a.jsxs("div",{className:"pt-4 border-t border-border space-y-4",children:[a.jsx("div",{className:"py-2",children:a.jsx("span",{className:"font-display text-[10px] uppercase tracking-widest text-muted-foreground",children:"Pattern Generator"})}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Ee,{className:"text-[10px] uppercase tracking-widest text-muted-foreground",children:"Gap (spacing)"}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(st,{value:[f],onValueChange:([P])=>p(P),max:30,min:0,step:1,className:"flex-1"}),a.jsxs("span",{className:"text-[11px] font-mono w-10 text-right",children:[f,"px"]})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Ee,{className:"text-[10px] uppercase tracking-widest text-muted-foreground",children:"Random Rotation"}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(st,{value:[m],onValueChange:([P])=>y(P),max:180,min:0,step:5,className:"flex-1"}),a.jsxs("span",{className:"text-[11px] font-mono w-10 text-right",children:[m,""]})]}),a.jsx("p",{className:"text-[9px] text-muted-foreground",children:"0 = neat grid, 180 = chaotic sticker bomb"})]}),a.jsxs("button",{onClick:()=>{e&&i(e,f,m,fi,hi)},className:"w-full bg-primary text-primary-foreground font-display text-sm uppercase tracking-wider py-2.5 px-4 border border-primary hover:bg-primary/90 transition-colors flex items-center justify-center gap-2",children:[a.jsx(Dd,{className:"w-4 h-4"}),"Make Pattern"]}),a.jsx("p",{className:"text-[9px] text-muted-foreground text-center",children:"Tiles the selected sticker across the entire deck"})]})]}):a.jsx("div",{className:"p-4 text-center",children:a.jsx("span",{className:"text-[10px] text-muted-foreground uppercase tracking-widest",children:"Select an object"})})}),a.jsx(zg,{}),a.jsx(Fx,{isOpen:w,onClose:()=>_(!1),onFontUploaded:async P=>{v([...x,P]);try{await zx(P),ce.success(`Font "${P.name}" ready to use`,{description:"Select it from the font dropdown",duration:3e3}),u&&u.type==="text"&&(C({fontFamily:P.font_family}),ce.info("Applied to selected text",{duration:2e3}))}catch(D){console.error("Failed to load font:",D),ce.error("Font uploaded but failed to load",{description:"Try refreshing the page"})}}})]})}function gw(){var f;const{selectedIds:r,objects:e,alignObjects:t,distributeObjects:n,groupObjects:i,ungroupObject:l}=Ct();if(r.length<2)return null;const c=r.length===1&&((f=e.find(p=>p.id===r[0]))==null?void 0:f.type)==="group",d=p=>{t(p);const m={left:"Left",center:"Center",right:"Right",top:"Top",middle:"Middle",bottom:"Bottom"};ce.success(`Aligned ${r.length} objects`,{description:m[p]})},u=p=>{if(r.length<3){ce.error("Need at least 3 objects to distribute");return}n(p),ce.success(`Distributed ${r.length} objects`,{description:p==="horizontal"?"Horizontally":"Vertically"})};return a.jsx("div",{className:"fixed bottom-4 left-1/2 -translate-x-1/2 z-50 bg-card border-2 border-primary shadow-2xl rounded-lg p-3 animate-in slide-in-from-bottom-4",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"px-3 py-1.5 bg-primary/10 rounded border border-primary/20",children:a.jsxs("span",{className:"text-sm font-medium text-primary",children:[r.length," selected"]})}),a.jsx("div",{className:"w-px h-8 bg-border"}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx("span",{className:"text-xs text-muted-foreground mr-1",children:"Align:"}),a.jsx(de,{size:"sm",variant:"outline",onClick:()=>d("left"),className:"h-8 w-8 p-0",title:"Align Left",children:a.jsx(rm,{className:"w-4 h-4"})}),a.jsx(de,{size:"sm",variant:"outline",onClick:()=>d("center"),className:"h-8 w-8 p-0",title:"Align Center",children:a.jsx(Q2,{className:"w-4 h-4"})}),a.jsx(de,{size:"sm",variant:"outline",onClick:()=>d("right"),className:"h-8 w-8 p-0",title:"Align Right",children:a.jsx(nm,{className:"w-4 h-4"})})]}),a.jsx("div",{className:"w-px h-8 bg-border"}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(de,{size:"sm",variant:"outline",onClick:()=>d("top"),className:"h-8 w-8 p-0",title:"Align Top",children:a.jsx(sm,{className:"w-4 h-4"})}),a.jsx(de,{size:"sm",variant:"outline",onClick:()=>d("middle"),className:"h-8 w-8 p-0",title:"Align Middle",children:a.jsx(Z2,{className:"w-4 h-4"})}),a.jsx(de,{size:"sm",variant:"outline",onClick:()=>d("bottom"),className:"h-8 w-8 p-0",title:"Align Bottom",children:a.jsx(im,{className:"w-4 h-4"})})]}),r.length>=3&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"w-px h-8 bg-border"}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx("span",{className:"text-xs text-muted-foreground mr-1",children:"Distribute:"}),a.jsx(de,{size:"sm",variant:"outline",onClick:()=>u("horizontal"),className:"h-8 w-8 p-0",title:"Distribute Horizontally",children:a.jsx(J2,{className:"w-4 h-4"})}),a.jsx(de,{size:"sm",variant:"outline",onClick:()=>u("vertical"),className:"h-8 w-8 p-0",title:"Distribute Vertically",children:a.jsx(ey,{className:"w-4 h-4"})})]})]}),a.jsx("div",{className:"w-px h-8 bg-border"}),c?a.jsxs(de,{size:"sm",variant:"outline",onClick:()=>{l(r[0]),ce.success("Ungrouped objects")},className:"gap-2",title:"Ungroup (Ctrl+Shift+G)",children:[a.jsx(ty,{className:"w-4 h-4"}),a.jsx("span",{className:"hidden sm:inline text-xs",children:"Ungroup"})]}):a.jsxs(de,{size:"sm",variant:"outline",onClick:()=>{i(r),ce.success(`Grouped ${r.length} objects`)},className:"gap-2",title:"Group (Ctrl+G)",children:[a.jsx(ry,{className:"w-4 h-4"}),a.jsx("span",{className:"hidden sm:inline text-xs",children:"Group"})]})]})})}function xw({onSave:r,onExport:e,onOpenHistory:t,onOpenInspector:n,onOpenLayers:i,isSaving:l,isExporting:c}){const{undo:d,redo:u,past:f,future:p,selectedId:m,deleteObject:y}=Ct(),[w,_]=T.useState(!1),x=(k=10)=>{"vibrate"in navigator&&navigator.vibrate(k)},v=()=>{x(10),d()},S=()=>{x(10),u()},C=()=>{m&&(x([10,50,10]),y(m))};return a.jsxs(a.Fragment,{children:[w&&a.jsx("div",{className:"fixed inset-0 bg-black/40 z-40",onClick:()=>_(!1)}),a.jsxs("div",{className:it("fixed bottom-0 left-0 right-0 bg-card border-t border-border z-50 transition-all duration-300",w?"h-48":"h-14"),children:[a.jsx("button",{onClick:()=>_(!w),className:"absolute -top-8 right-4 w-12 h-8 bg-card border border-border border-b-0 rounded-t-lg flex items-center justify-center hover:bg-secondary transition-colors",children:w?a.jsx(ny,{className:"w-4 h-4"}):a.jsx(am,{className:"w-4 h-4"})}),a.jsxs("div",{className:"h-14 flex items-center justify-around px-1",children:[a.jsxs("button",{onClick:v,disabled:f.length===0,className:"flex flex-col items-center gap-0.5 p-2 min-w-[56px] disabled:opacity-30 disabled:cursor-not-allowed active:scale-95 transition-transform",children:[a.jsx(om,{className:"w-5 h-5"}),a.jsx("span",{className:"text-[9px] uppercase tracking-wider",children:"Undo"})]}),a.jsxs("button",{onClick:S,disabled:p.length===0,className:"flex flex-col items-center gap-0.5 p-2 min-w-[56px] disabled:opacity-30 disabled:cursor-not-allowed active:scale-95 transition-transform",children:[a.jsx(lm,{className:"w-5 h-5"}),a.jsx("span",{className:"text-[9px] uppercase tracking-wider",children:"Redo"})]}),m&&a.jsxs("button",{onClick:C,className:"flex flex-col items-center gap-0.5 p-2 min-w-[56px] text-destructive active:scale-95 transition-transform",children:[a.jsx(jn,{className:"w-5 h-5"}),a.jsx("span",{className:"text-[9px] uppercase tracking-wider",children:"Delete"})]}),a.jsxs("button",{onClick:()=>{x(10),i()},className:"flex flex-col items-center gap-0.5 p-2 min-w-[56px] active:scale-95 transition-transform",children:[a.jsx(Uo,{className:"w-5 h-5"}),a.jsx("span",{className:"text-[9px] uppercase tracking-wider",children:"Layers"})]}),a.jsxs("button",{onClick:()=>{x(10),n()},className:"flex flex-col items-center gap-0.5 p-2 min-w-[56px] active:scale-95 transition-transform",children:[a.jsx(sy,{className:"w-5 h-5"}),a.jsx("span",{className:"text-[9px] uppercase tracking-wider",children:"Props"})]}),a.jsxs("button",{onClick:()=>{x(10),t()},className:"flex flex-col items-center gap-0.5 p-2 min-w-[56px] active:scale-95 transition-transform",children:[a.jsx(Ld,{className:"w-5 h-5"}),a.jsx("span",{className:"text-[9px] uppercase tracking-wider",children:"History"})]})]}),w&&a.jsxs("div",{className:"border-t border-border p-3 space-y-2",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[a.jsxs("button",{onClick:()=>{r(),_(!1)},disabled:l,className:"btn-brutal text-sm py-2.5 flex items-center justify-center gap-2",children:[a.jsx(cm,{className:"w-4 h-4"}),l?"Saving...":"Save"]}),a.jsxs("button",{onClick:()=>{e(),_(!1)},disabled:c,className:"btn-brutal text-sm py-2.5 flex items-center justify-center gap-2",children:[a.jsx(Hr,{className:"w-4 h-4"}),c?"Exporting...":"Export"]})]}),a.jsx("p",{className:"text-xs text-muted-foreground text-center",children:"Tap outside to close"})]})]})]})}function yw(){const{selectedIds:r,objects:e,updateObject:t,saveToHistory:n}=Ct(),i=e.filter(v=>r.includes(v.id));if(r.length<2)return null;const l=()=>{n();const v=Math.min(...i.map(S=>S.x));i.forEach(S=>{t(S.id,{x:v})}),ce.success("Aligned to left edge")},c=()=>{n();const v=Math.max(...i.map(S=>S.x+S.width));i.forEach(S=>{t(S.id,{x:v-S.width})}),ce.success("Aligned to right edge")},d=()=>{n();const v=Math.min(...i.map(k=>k.x)),S=Math.max(...i.map(k=>k.x+k.width)),C=(v+S)/2;i.forEach(k=>{t(k.id,{x:C-k.width/2})}),ce.success("Aligned horizontally")},u=()=>{n();const v=Math.min(...i.map(S=>S.y));i.forEach(S=>{t(S.id,{y:v})}),ce.success("Aligned to top edge")},f=()=>{n();const v=Math.max(...i.map(S=>S.y+S.height));i.forEach(S=>{t(S.id,{y:v-S.height})}),ce.success("Aligned to bottom edge")},p=()=>{n();const v=Math.min(...i.map(k=>k.y)),S=Math.max(...i.map(k=>k.y+k.height)),C=(v+S)/2;i.forEach(k=>{t(k.id,{y:C-k.height/2})}),ce.success("Aligned vertically")},m=()=>{n();const v=[...i].sort((D,I)=>D.x-I.x),S=v[0].x,C=v[v.length-1].x+v[v.length-1].width,k=v.reduce((D,I)=>D+I.width,0),E=(C-S-k)/(v.length-1);let P=S;v.forEach((D,I)=>{I>0&&(P+=v[I-1].width+E,t(D.id,{x:P}))}),ce.success("Distributed horizontally")},y=()=>{n();const v=[...i].sort((D,I)=>D.y-I.y),S=v[0].y,C=v[v.length-1].y+v[v.length-1].height,k=v.reduce((D,I)=>D+I.height,0),E=(C-S-k)/(v.length-1);let P=S;v.forEach((D,I)=>{I>0&&(P+=v[I-1].height+E,t(D.id,{y:P}))}),ce.success("Distributed vertically")},w=()=>{n();const v=i[0].width;i.slice(1).forEach(S=>{t(S.id,{width:v})}),ce.success("Matched widths")},_=()=>{n();const v=i[0].height;i.slice(1).forEach(S=>{t(S.id,{height:v})}),ce.success("Matched heights")},x=()=>{n();const v=i[0].width,S=i[0].height;i.slice(1).forEach(C=>{t(C.id,{width:v,height:S})}),ce.success("Matched sizes")};return a.jsx("div",{className:"fixed top-16 left-1/2 transform -translate-x-1/2 bg-gray-900 border border-gray-700 rounded-lg shadow-2xl p-3 z-40",children:a.jsxs("div",{className:"flex flex-col gap-2",children:[a.jsxs("div",{className:"text-xs text-gray-400 font-semibold mb-1 text-center",children:["Align (",r.length," selected)"]}),a.jsxs("div",{className:"flex gap-1",children:[a.jsx(de,{size:"sm",variant:"ghost",onClick:l,className:"flex-1 h-8",title:"Align Left (Ctrl+Shift+L)",children:a.jsx(rm,{className:"w-4 h-4"})}),a.jsx(de,{size:"sm",variant:"ghost",onClick:d,className:"flex-1 h-8",title:"Align Center Horizontal (Ctrl+Shift+C)",children:a.jsx(iy,{className:"w-4 h-4"})}),a.jsx(de,{size:"sm",variant:"ghost",onClick:c,className:"flex-1 h-8",title:"Align Right (Ctrl+Shift+R)",children:a.jsx(nm,{className:"w-4 h-4"})})]}),a.jsxs("div",{className:"flex gap-1",children:[a.jsx(de,{size:"sm",variant:"ghost",onClick:u,className:"flex-1 h-8",title:"Align Top (Ctrl+Shift+T)",children:a.jsx(sm,{className:"w-4 h-4"})}),a.jsx(de,{size:"sm",variant:"ghost",onClick:p,className:"flex-1 h-8",title:"Align Center Vertical (Ctrl+Shift+M)",children:a.jsx(ay,{className:"w-4 h-4"})}),a.jsx(de,{size:"sm",variant:"ghost",onClick:f,className:"flex-1 h-8",title:"Align Bottom (Ctrl+Shift+B)",children:a.jsx(im,{className:"w-4 h-4"})})]}),a.jsx("div",{className:"border-t border-gray-700 my-1"}),a.jsxs("div",{className:"flex gap-1",children:[a.jsx(de,{size:"sm",variant:"ghost",onClick:m,className:"flex-1 h-8",title:"Distribute Horizontally",children:a.jsx(oy,{className:"w-4 h-4"})}),a.jsx(de,{size:"sm",variant:"ghost",onClick:y,className:"flex-1 h-8",title:"Distribute Vertically",children:a.jsx(ly,{className:"w-4 h-4"})})]}),a.jsx("div",{className:"border-t border-gray-700 my-1"}),a.jsxs("div",{className:"flex gap-1",children:[a.jsx(de,{size:"sm",variant:"ghost",onClick:w,className:"flex-1 h-8 text-xs",title:"Match Width",children:"W"}),a.jsx(de,{size:"sm",variant:"ghost",onClick:_,className:"flex-1 h-8 text-xs",title:"Match Height",children:"H"}),a.jsx(de,{size:"sm",variant:"ghost",onClick:x,className:"flex-1 h-8",title:"Match Size",children:a.jsx(cy,{className:"w-4 h-4"})})]})]})})}function Wc({isOpen:r,onClose:e,title:t,children:n}){return r?a.jsxs("div",{className:"fixed inset-0 z-50 md:hidden",children:[a.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm",onClick:e}),a.jsxs("div",{className:it("absolute bottom-0 left-0 right-0 bg-card border-t-2 border-border max-h-[80vh] flex flex-col","animate-in slide-in-from-bottom duration-300"),children:[a.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-border shrink-0",children:[a.jsx("h2",{className:"font-display text-sm uppercase tracking-wider",children:t}),a.jsx("button",{onClick:e,className:"text-muted-foreground hover:text-foreground transition-colors",children:a.jsx(wa,{className:"w-5 h-5"})})]}),a.jsx(Qn,{className:"flex-1",children:a.jsx("div",{className:"p-4",children:n})})]})]}):null}const j0=[{keys:["Click"],description:"Select object",category:"Selection"},{keys:["Shift","Click"],description:"Multi-select",category:"Selection"},{keys:["Esc"],description:"Deselect all",category:"Selection"},{keys:["Tab"],description:"Select next object",category:"Selection"},{keys:["Shift","Tab"],description:"Select previous object",category:"Selection"},{keys:["Delete"],description:"Delete selected",category:"Editing"},{keys:["Backspace"],description:"Delete selected",category:"Editing"},{keys:["Ctrl","Z"],description:"Undo",category:"Editing"},{keys:["Ctrl","Shift","Z"],description:"Redo",category:"Editing"},{keys:["Ctrl","D"],description:"Duplicate",category:"Editing"},{keys:["Ctrl","Shift","D"],description:"Array duplicate (custom grid)",category:"Editing"},{keys:["Ctrl","C"],description:"Copy to clipboard",category:"Editing"},{keys:["Ctrl","V"],description:"Paste from clipboard",category:"Editing"},{keys:["Ctrl","A"],description:"Select all (top object)",category:"Editing"},{keys:["Ctrl","L"],description:"Lock/unlock object",category:"Editing"},{keys:["Ctrl","G"],description:"Group selected objects",category:"Editing"},{keys:["Ctrl","Shift","G"],description:"Ungroup selected group",category:"Editing"},{keys:["Drag"],description:"Move object",category:"Transform"},{keys:["Shift","Drag"],description:"Move with snapping disabled",category:"Transform"},{keys:["Corner","Drag"],description:"Scale object",category:"Transform"},{keys:["Shift","Scale"],description:"Scale proportionally",category:"Transform"},{keys:["Alt","Scale"],description:"Scale from center",category:"Transform"},{keys:["Rotate","Handle"],description:"Rotate object",category:"Transform"},{keys:["Shift","Rotate"],description:"Rotate in 15 increments",category:"Transform"},{keys:["Ctrl","]"],description:"Bring forward",category:"Layers"},{keys:["Ctrl","["],description:"Send backward",category:"Layers"},{keys:["Ctrl","Shift","]"],description:"Bring to front",category:"Layers"},{keys:["Ctrl","Shift","["],description:"Send to back",category:"Layers"},{keys:["Alt","L"],description:"Align left",category:"Alignment"},{keys:["Alt","R"],description:"Align right",category:"Alignment"},{keys:["Alt","C"],description:"Align center",category:"Alignment"},{keys:["Alt","T"],description:"Align top",category:"Alignment"},{keys:["Alt","B"],description:"Align bottom",category:"Alignment"},{keys:["Alt","M"],description:"Align middle",category:"Alignment"},{keys:["Space","Drag"],description:"Pan canvas",category:"View"},{keys:["Scroll"],description:"Zoom in/out",category:"View"},{keys:["Ctrl","0"],description:"Reset zoom to 100%",category:"View"},{keys:["Ctrl","1"],description:"Zoom to fit",category:"View"},{keys:["Ctrl","Shift","R"],description:"Toggle rulers",category:"View"},{keys:["H"],description:"Toggle hardware guide",category:"View"},{keys:["T"],description:"Select text tool",category:"Tools"},{keys:["R"],description:"Select rectangle tool",category:"Tools"},{keys:["C"],description:"Select circle tool",category:"Tools"},{keys:["L"],description:"Select line tool",category:"Tools"},{keys:["V"],description:"Select move tool (default)",category:"Tools"},{keys:["Ctrl","S"],description:"Save design",category:"File"},{keys:["Ctrl","E"],description:"Export PNG",category:"File"},{keys:["Ctrl","N"],description:"New design",category:"File"},{keys:["Ctrl","O"],description:"Open design",category:"File"}],vw=[...new Set(j0.map(r=>r.category))];function $f({text:r}){return a.jsx("kbd",{className:"px-2 py-1 text-xs font-mono bg-muted border border-border rounded",children:r})}function ww(){const[r,e]=T.useState(!1);return a.jsxs(Bx,{open:r,onOpenChange:e,children:[a.jsx(Gx,{asChild:!0,children:a.jsxs(de,{size:"sm",variant:"ghost",className:"gap-2",children:[a.jsx(df,{className:"w-4 h-4"}),a.jsx("span",{className:"hidden md:inline",children:"Shortcuts"})]})}),a.jsxs(Hx,{className:"max-w-3xl max-h-[80vh]",children:[a.jsx(Ux,{children:a.jsxs(Wx,{className:"font-display text-xl uppercase tracking-widest flex items-center gap-2",children:[a.jsx(df,{className:"w-5 h-5"}),"Keyboard Shortcuts"]})}),a.jsx(Qn,{className:"h-[60vh] pr-4",children:a.jsx("div",{className:"space-y-6",children:vw.map(t=>a.jsxs("div",{children:[a.jsx("h3",{className:"font-display text-sm uppercase tracking-widest text-primary mb-3",children:t}),a.jsx("div",{className:"space-y-2",children:j0.filter(n=>n.category===t).map((n,i)=>a.jsxs("div",{className:"flex items-center justify-between py-2 border-b border-border last:border-0",children:[a.jsx("span",{className:"text-sm text-foreground",children:n.description}),a.jsx("div",{className:"flex items-center gap-1",children:n.keys.map((l,c)=>a.jsxs("span",{className:"flex items-center gap-1",children:[a.jsx($f,{text:l}),c<n.keys.length-1&&a.jsx("span",{className:"text-xs text-muted-foreground",children:"+"})]},c))})]},i))})]},t))})}),a.jsxs("div",{className:"text-xs text-muted-foreground text-center pt-4 border-t",children:["Press ",a.jsx($f,{text:"?"})," anytime to view shortcuts"]})]})]})}function bw(){const[r,e]=T.useState(!1);return T.useEffect(()=>{const t=()=>{e(window.innerWidth<768)};return t(),window.addEventListener("resize",t),()=>window.removeEventListener("resize",t)},[]),r}const _w=T.lazy(()=>Rr(()=>import("./modals-Bz7BD7F1.js").then(r=>r.a0),__vite__mapDeps([0,1,2])).then(r=>({default:r.VersionHistory}))),Sw=T.lazy(()=>Rr(()=>import("./modals-Bz7BD7F1.js").then(r=>r.a1),__vite__mapDeps([0,1,2])).then(r=>({default:r.ShareModal}))),Cw=T.lazy(()=>Rr(()=>import("./AnimationPreview-WWyVeN8z.js"),__vite__mapDeps([3,0,1,2,4])).then(r=>({default:r.AnimationPreview}))),kw=T.lazy(()=>Rr(()=>import("./modals-Bz7BD7F1.js").then(r=>r.a2),__vite__mapDeps([0,1,2])).then(r=>({default:r.BrandKitModal}))),Nw=T.lazy(()=>Rr(()=>import("./modals-Bz7BD7F1.js").then(r=>r.$),__vite__mapDeps([0,1,2])).then(r=>({default:r.FontUploadModal}))),jw=T.lazy(()=>Rr(()=>import("./ColorExtractorModal-DslJf5Jb.js"),__vite__mapDeps([5,0,1,2])).then(r=>({default:r.ColorExtractorModal}))),Ew=T.lazy(()=>Rr(()=>import("./SmartDuplicateModal-BK1lFbzl.js"),__vite__mapDeps([6,0,1,2])).then(r=>({default:r.SmartDuplicateModal}))),Pw=T.lazy(()=>Rr(()=>import("./modals-Bz7BD7F1.js").then(r=>r.a3),__vite__mapDeps([0,1,2])).then(r=>({default:r.ArrayDuplicateModal}))),Aw=T.lazy(()=>Rr(()=>import("./modals-Bz7BD7F1.js").then(r=>r.a4),__vite__mapDeps([0,1,2])).then(r=>({default:r.ExportPreview}))),Tw=T.lazy(()=>Rr(()=>import("./modals-Bz7BD7F1.js").then(r=>r.a5),__vite__mapDeps([0,1,2])).then(r=>({default:r.ExportPresetsModal}))),Rw=T.lazy(()=>Rr(()=>import("./TemplateGalleryModal-CBbshATX.js"),__vite__mapDeps([7,0,1,2])).then(r=>({default:r.TemplateGalleryModal}))),Dw=T.lazy(()=>Rr(()=>import("./DeckGenerator3D-DTHcJXw7.js"),__vite__mapDeps([8,0,1,2,4])).then(r=>({default:r.default})));function Ow(){const{selectedId:r,selectedIds:e,deleteObject:t,undo:n,redo:i,getCanvasState:l,currentDesignId:c,setDesignId:d,setSaving:u,isSaving:f,objects:p,designName:m,createVersion:y,past:w,future:_,updateObject:x,saveToHistory:v,addObject:S,selectObject:C,setActiveTool:k,stageScale:E,setStageScale:P,arrayDuplicate:D,showRulers:I,toggleRulers:B,groupObjects:z,ungroupObject:X}=Ct(),{isAuthenticated:se}=Nn(),R=Tr(),H=bw(),[j,G]=T.useState(""),[Q,K]=T.useState(!1),[J,ee]=T.useState(!1),[be,V]=T.useState(!1),[Y,Se]=T.useState(!1),[Ce,ye]=T.useState(!1),[at,gt]=T.useState(!1),[Ge,He]=T.useState(!1),[ot,Ue]=T.useState(!1),[At,Qe]=T.useState(!1),[A,oe]=T.useState(!1),[ne,L]=T.useState(!1),[M,U]=T.useState(!1),[le,ue]=T.useState(!1),[Z,pe]=T.useState(!1),[ke,xe]=T.useState(!1),[Oe,tt]=T.useState(!1),[Ve,Et]=T.useState(!1),vr=async()=>{if(!se){R("/auth");return}u(!0),G("Saving...");try{const De=l();if(c)await Go.update(c,{canvas_data:De,name:De.name}),G("Saved!"),ce.success("Design saved successfully");else{const _e=await Go.create({name:De.name,canvas_data:De});d(_e.design.id),G("Saved!"),ce.success("Design created successfully")}setTimeout(()=>G(""),2e3)}catch(De){console.error("Save failed:",De),G("Save failed"),ce.error("Failed to save design. Please try again."),setTimeout(()=>G(""),2e3)}finally{u(!1)}},Yt=async()=>{K(!0),G("Exporting PNG..."),ee(!1);try{const De=await $p(p,{scale:3,format:"png",includeBackground:!0}),_e=`${m.replace(/[^a-z0-9]/gi,"_").toLowerCase()}_${Date.now()}.png`;of(De,_e),G("Exported PNG!"),ce.success(`Exported as ${_e}`),setTimeout(()=>G(""),2e3)}catch(De){console.error("Export failed:",De),G("Export failed"),ce.error("Failed to export PNG. Please try again."),setTimeout(()=>G(""),2e3)}finally{K(!1)}},hn=async()=>{K(!0),G("Exporting SVG..."),ee(!1);try{const De=await Vx(p,{includeBackground:!0}),_e=`${m.replace(/[^a-z0-9]/gi,"_").toLowerCase()}_${Date.now()}.svg`;of(De,_e),G("Exported SVG!"),ce.success(`Exported vector as ${_e}`),setTimeout(()=>G(""),2e3)}catch(De){console.error("SVG export failed:",De),G("Export failed"),ce.error("Failed to export SVG. Please try again."),setTimeout(()=>G(""),2e3)}finally{K(!1)}};return T.useEffect(()=>{se&&Vp().catch(console.error)},[se]),T.useEffect(()=>{if(p.length===0)return;const De=setInterval(()=>{y(void 0,!0)},5*60*1e3);return()=>clearInterval(De)},[p.length,y]),T.useEffect(()=>{const De=_e=>{if(_e.target instanceof HTMLInputElement||_e.target instanceof HTMLTextAreaElement)return;const Re=_e.key.toLowerCase(),Me=_e.ctrlKey||_e.metaKey,Xe=_e.shiftKey,Ft=_e.altKey;if(Me&&Re==="s"){_e.preventDefault(),vr();return}if(Me&&Re==="e"){_e.preventDefault(),Yt();return}if((Re==="delete"||Re==="backspace")&&r){_e.preventDefault(),t(r);return}if(Me&&Re==="z"&&!Xe){_e.preventDefault(),n();return}if(Me&&Re==="z"&&Xe){_e.preventDefault(),i();return}if(Me&&Re==="d"&&!Xe&&r){_e.preventDefault();const fe=p.find(Pe=>Pe.id===r);if(fe){const{id:Pe,...Fe}=fe;S({...Fe,x:fe.x+10,y:fe.y+10}),ce.success("Object duplicated")}return}if(Me&&Xe&&Re==="d"&&r){_e.preventDefault(),pe(!0);return}if(Re==="t"&&!Me&&!Ft){_e.preventDefault(),k("text");return}if(Re==="p"&&!Me&&!Ft){_e.preventDefault(),k("pen");return}if(Re==="g"&&!Me&&!Ft){_e.preventDefault(),k("graphics");return}if(Re==="l"&&!Me&&!Ft){_e.preventDefault(),k("lines");return}if(Re==="s"&&!Me&&!Ft){_e.preventDefault(),k("stickers");return}if(Re==="u"&&!Me&&!Ft){_e.preventDefault(),k("uploads");return}if(Re==="escape"){_e.preventDefault(),C(null),k(null);return}if(Me&&Xe&&Re==="r"){_e.preventDefault(),Ct.getState().toggleRulers();const fe=Ct.getState().showRulers;ce.success(fe?"Rulers enabled":"Rulers disabled");return}if(Me&&Re==="l"&&r){_e.preventDefault();const fe=p.find(Pe=>Pe.id===r);fe&&(x(r,{locked:!fe.locked}),ce.success(fe.locked?"Object unlocked":"Object locked"));return}if(Me&&Re==="g"&&!Xe&&e.length>=2){_e.preventDefault(),z(e),ce.success(`Grouped ${e.length} objects`);return}if(Me&&Xe&&Re==="g"&&e.length===1){_e.preventDefault();const fe=p.find(Pe=>Pe.id===e[0]);fe&&fe.type==="group"?(X(e[0]),ce.success("Ungrouped objects")):ce.error("Selected object is not a group");return}if(e.length>=2){const fe=p.filter(Pe=>e.includes(Pe.id));if(Me&&Xe&&Re==="l"){_e.preventDefault(),v();const Pe=Math.min(...fe.map(Fe=>Fe.x));fe.forEach(Fe=>x(Fe.id,{x:Pe})),ce.success("Aligned to left edge");return}if(Me&&Xe&&Re===";"){_e.preventDefault(),v();const Pe=Math.max(...fe.map(Fe=>Fe.x+Fe.width));fe.forEach(Fe=>x(Fe.id,{x:Pe-Fe.width})),ce.success("Aligned to right edge");return}if(Me&&Xe&&Re==="c"){_e.preventDefault(),v();const Pe=Math.min(...fe.map(Nt=>Nt.x)),Fe=Math.max(...fe.map(Nt=>Nt.x+Nt.width)),Wt=(Pe+Fe)/2;fe.forEach(Nt=>x(Nt.id,{x:Wt-Nt.width/2})),ce.success("Aligned horizontally");return}if(Me&&Xe&&Re==="t"){_e.preventDefault(),v();const Pe=Math.min(...fe.map(Fe=>Fe.y));fe.forEach(Fe=>x(Fe.id,{y:Pe})),ce.success("Aligned to top edge");return}if(Me&&Xe&&Re==="b"){_e.preventDefault(),v();const Pe=Math.max(...fe.map(Fe=>Fe.y+Fe.height));fe.forEach(Fe=>x(Fe.id,{y:Pe-Fe.height})),ce.success("Aligned to bottom edge");return}if(Me&&Xe&&Re==="m"){_e.preventDefault(),v();const Pe=Math.min(...fe.map(Nt=>Nt.y)),Fe=Math.max(...fe.map(Nt=>Nt.y+Nt.height)),Wt=(Pe+Fe)/2;fe.forEach(Nt=>x(Nt.id,{y:Wt-Nt.height/2})),ce.success("Aligned vertically");return}}if(r&&["arrowup","arrowdown","arrowleft","arrowright"].includes(Re)){_e.preventDefault();const fe=p.find(Wt=>Wt.id===r);if(!fe)return;const Pe=Xe?10:1,Fe={};Re==="arrowup"&&(Fe.y=fe.y-Pe),Re==="arrowdown"&&(Fe.y=fe.y+Pe),Re==="arrowleft"&&(Fe.x=fe.x-Pe),Re==="arrowright"&&(Fe.x=fe.x+Pe),x(r,Fe);return}if(Me&&Re==="c"&&r){_e.preventDefault();const fe=p.find(Pe=>Pe.id===r);fe&&(sessionStorage.setItem("deckforge_clipboard",JSON.stringify(fe)),ce.success("Copied to clipboard"));return}if(Me&&Re==="v"){_e.preventDefault();const fe=sessionStorage.getItem("deckforge_clipboard");if(fe)try{const Pe=JSON.parse(fe),{id:Fe,...Wt}=Pe;S({...Wt,x:Pe.x+20,y:Pe.y+20}),ce.success("Pasted from clipboard")}catch{ce.error("Failed to paste")}else ce.error("Nothing to paste");return}if(Me&&Re==="a"){_e.preventDefault(),p.length>0&&(C(p[p.length-1].id),ce.success(`Selected top object (${p.length} total)`));return}if(Me&&Re==="0"){_e.preventDefault(),P(1),ce.success("Zoom reset to 100%");return}if(Me&&Re==="1"){_e.preventDefault(),P(.8),ce.success("Zoom to fit");return}if(Me&&(Re==="="||Re==="+")){_e.preventDefault();const fe=Math.min(3,E*1.2);P(fe),ce.success(`Zoom: ${Math.round(fe*100)}%`);return}if(Me&&(Re==="-"||Re==="_")){_e.preventDefault();const fe=Math.max(.25,E/1.2);P(fe),ce.success(`Zoom: ${Math.round(fe*100)}%`);return}if(r){const fe=p.findIndex(Pe=>Pe.id===r);if(fe===-1)return;if(Me&&!Xe&&Re==="]"){if(_e.preventDefault(),fe<p.length-1){const Pe=[...p];[Pe[fe],Pe[fe+1]]=[Pe[fe+1],Pe[fe]],Ct.setState({objects:Pe}),ce.success("Brought forward")}return}if(Me&&!Xe&&Re==="["){if(_e.preventDefault(),fe>0){const Pe=[...p];[Pe[fe],Pe[fe-1]]=[Pe[fe-1],Pe[fe]],Ct.setState({objects:Pe}),ce.success("Sent backward")}return}if(Me&&Xe&&Re==="]"){_e.preventDefault();const Pe=p.filter(Fe=>Fe.id!==r);Pe.push(p[fe]),Ct.setState({objects:Pe}),ce.success("Brought to front");return}if(Me&&Xe&&Re==="["){_e.preventDefault();const Pe=p.filter(Fe=>Fe.id!==r);Pe.unshift(p[fe]),Ct.setState({objects:Pe}),ce.success("Sent to back");return}}if(r&&Ft){const fe=p.find(Wt=>Wt.id===r);if(!fe)return;const Pe=(fi-fe.width*fe.scaleX)/2,Fe=(hi-fe.height*fe.scaleY)/2;if(Re==="l"){_e.preventDefault(),x(r,{x:0}),ce.success("Aligned left");return}if(Re==="r"){_e.preventDefault(),x(r,{x:fi-fe.width*fe.scaleX}),ce.success("Aligned right");return}if(Re==="c"){_e.preventDefault(),x(r,{x:Pe}),ce.success("Aligned center");return}if(Re==="t"){_e.preventDefault(),x(r,{y:0}),ce.success("Aligned top");return}if(Re==="b"){_e.preventDefault(),x(r,{y:hi-fe.height*fe.scaleY}),ce.success("Aligned bottom");return}if(Re==="m"){_e.preventDefault(),x(r,{y:Fe}),ce.success("Aligned middle");return}}};return window.addEventListener("keydown",De),()=>window.removeEventListener("keydown",De)},[r,t,n,i,p,vr,Yt,S,C,k,x,E,P]),a.jsxs("div",{className:"h-screen w-screen flex flex-col bg-background overflow-hidden",children:[a.jsxs("header",{className:it("border-b border-border flex items-center px-4 bg-card shrink-0","h-12"),children:[a.jsxs("h1",{className:it("font-display uppercase tracking-widest text-foreground",H?"text-base":"text-lg"),children:["Deck",a.jsx("span",{className:"text-primary",children:"Forge"})]}),!H&&a.jsx("div",{className:"ml-4 flex items-center gap-2",children:a.jsx("span",{className:"tag-brutal",children:"v1.0"})}),a.jsxs("div",{className:"ml-auto flex items-center gap-2",children:[!H&&a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"text-[10px] text-muted-foreground uppercase tracking-widest hidden md:block mr-4",children:"Fingerboard Graphics Editor"}),j&&a.jsx("span",{className:"text-xs text-primary",children:j}),a.jsxs("div",{className:"flex items-center gap-1 border border-border rounded",children:[a.jsxs(de,{size:"sm",variant:"ghost",onClick:n,disabled:w.length===0,className:"gap-1.5 rounded-r-none border-r border-border",title:`Undo (Ctrl+Z) - ${w.length} action${w.length!==1?"s":""} available`,children:[a.jsx(om,{className:"w-4 h-4"}),a.jsx("span",{className:"text-[10px] text-muted-foreground font-mono",children:w.length})]}),a.jsxs(de,{size:"sm",variant:"ghost",onClick:i,disabled:_.length===0,className:"gap-1.5 rounded-l-none",title:`Redo (Ctrl+Shift+Z) - ${_.length} action${_.length!==1?"s":""} available`,children:[a.jsx(lm,{className:"w-4 h-4"}),a.jsx("span",{className:"text-[10px] text-muted-foreground font-mono",children:_.length})]})]}),a.jsxs(de,{size:"sm",variant:"outline",onClick:vr,disabled:f,className:"gap-2",children:[a.jsx(cm,{className:"w-4 h-4"}),f?"Saving...":"Save"]}),a.jsxs("div",{className:"relative",children:[a.jsxs(de,{size:"sm",variant:"outline",onClick:()=>ee(!J),disabled:Q,className:"gap-2",children:[a.jsx(Hr,{className:"w-4 h-4"}),Q?"Exporting...":"Export",a.jsx(em,{className:"w-3 h-3"})]}),J&&!Q&&a.jsxs("div",{className:"absolute top-full mt-1 right-0 z-50 bg-card border border-border shadow-lg min-w-[180px] rounded-lg overflow-hidden",children:[a.jsxs("button",{onClick:()=>{ee(!1),oe(!0)},className:"w-full px-4 py-2.5 text-left text-sm hover:bg-secondary transition-colors font-medium flex items-center gap-2",children:[a.jsx(cr,{className:"w-4 h-4 text-primary"}),"Quick Export",a.jsx("span",{className:"ml-auto text-[9px] text-primary",children:"NEW"})]}),a.jsxs("button",{onClick:()=>{ee(!1),Qe(!0)},className:"w-full px-4 py-2 text-left text-sm hover:bg-secondary transition-colors border-t border-border",children:["PNG (High-Res)",a.jsx("span",{className:"ml-2 text-[9px] text-muted-foreground",children:"Preview first"})]}),a.jsxs("button",{onClick:hn,className:"w-full px-4 py-2 text-left text-sm hover:bg-secondary transition-colors border-t border-border",children:["SVG (Vector)",a.jsx("span",{className:"ml-2 text-[10px] text-accent",children:"PRO"})]})]})]}),a.jsxs(de,{size:"sm",variant:"outline",onClick:()=>gt(!0),className:"gap-2",children:[a.jsx(td,{className:"w-4 h-4"}),"Brand Kits",a.jsx("span",{className:"ml-1 text-[9px] text-accent",children:"PRO"})]}),a.jsxs(de,{size:"sm",variant:"outline",onClick:()=>ue(!0),className:"gap-2",children:[a.jsx(td,{className:"w-4 h-4"}),"Extract Colors"]}),a.jsxs(de,{size:"sm",variant:"outline",onClick:()=>He(!0),className:"gap-2",children:[a.jsx(Jo,{className:"w-4 h-4"}),"Custom Fonts"]}),c&&a.jsxs(de,{size:"sm",variant:"outline",onClick:()=>Se(!0),className:"gap-2",children:[a.jsx(dm,{className:"w-4 h-4"}),"Share"]}),a.jsxs(de,{size:"sm",variant:"outline",onClick:()=>V(!0),className:"gap-2",children:[a.jsx(Ld,{className:"w-4 h-4"}),"History"]}),a.jsxs(de,{size:"sm",variant:"outline",onClick:()=>ye(!0),className:"gap-2",children:[a.jsx(dy,{className:"w-4 h-4"}),"Preview"]}),a.jsxs(de,{size:"sm",variant:"outline",onClick:()=>U(!0),className:"gap-2 bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white border-0",children:[a.jsx("span",{className:"text-sm font-bold",children:" 3D Print"}),a.jsx("span",{className:"ml-1 text-[9px] bg-white/20 px-1 rounded",children:"NEW"})]}),a.jsxs(de,{size:"sm",variant:"outline",onClick:()=>L(!0),className:"gap-2",children:[a.jsx(cr,{className:"w-4 h-4"}),"Templates",a.jsx("span",{className:"ml-1 text-[9px] text-primary",children:"NEW"})]}),a.jsxs(de,{size:"sm",variant:"outline",onClick:()=>R("/marketplace"),className:"gap-2",children:[a.jsx(cr,{className:"w-4 h-4"}),"Marketplace",a.jsx("span",{className:"ml-1 text-[9px] text-primary",children:"NEW"})]}),a.jsxs(de,{size:"sm",variant:"ghost",onClick:()=>R("/gallery"),className:"gap-2",children:[a.jsx(cr,{className:"w-4 h-4"}),"Gallery"]}),a.jsxs(de,{size:"sm",variant:"ghost",onClick:()=>R(se?"/designs":"/auth"),className:"gap-2",children:[a.jsx(uf,{className:"w-4 h-4"}),se?"My Designs":"Login"]}),a.jsx(de,{size:"sm",variant:I?"default":"ghost",onClick:()=>{B(),ce.success(I?"Rulers hidden":"Rulers visible")},className:"gap-2",title:"Toggle rulers (Ctrl+Shift+R)",children:a.jsx(uy,{className:"w-4 h-4"})}),a.jsx(ww,{})]}),H&&a.jsx(de,{size:"sm",variant:"ghost",onClick:()=>Et(!0),className:"gap-2",children:a.jsx(am,{className:"w-5 h-5"})})]})]}),a.jsxs("div",{className:it("flex-1 flex overflow-hidden",H&&"pb-14"),children:[!H&&a.jsxs(a.Fragment,{children:[a.jsx(Bf,{}),a.jsx(Hf,{}),a.jsx(ed,{}),a.jsx(Vf,{})]}),H&&a.jsxs(a.Fragment,{children:[a.jsx(Bf,{}),a.jsx(Hf,{}),a.jsx(ed,{})]})]}),H&&a.jsx(xw,{onSave:vr,onExport:Yt,onOpenHistory:()=>V(!0),onOpenInspector:()=>xe(!0),onOpenLayers:()=>tt(!0),isSaving:f,isExporting:Q}),a.jsx(Wc,{isOpen:ke,onClose:()=>xe(!1),title:"Properties",children:a.jsx(Vf,{})}),a.jsx(Wc,{isOpen:Oe,onClose:()=>tt(!1),title:"Layers",children:a.jsx(zg,{})}),a.jsx(Wc,{isOpen:Ve,onClose:()=>Et(!1),title:"Menu",children:a.jsxs("div",{className:"space-y-2",children:[a.jsxs("button",{onClick:()=>{R("/templates"),Et(!1)},className:"w-full btn-brutal text-left py-3 flex items-center gap-2",children:[a.jsx(cr,{className:"w-4 h-4"}),"Templates"]}),a.jsxs("button",{onClick:()=>{R("/marketplace"),Et(!1)},className:"w-full btn-brutal text-left py-3 flex items-center gap-2",children:[a.jsx(cr,{className:"w-4 h-4"}),"Marketplace",a.jsx("span",{className:"ml-auto text-[9px] text-primary",children:"NEW"})]}),a.jsxs("button",{onClick:()=>{R("/fingerpark"),Et(!1)},className:"w-full btn-brutal text-left py-3 flex items-center gap-2",children:[a.jsx(cr,{className:"w-4 h-4"}),"Park Builder",a.jsx("span",{className:"ml-auto text-[9px] text-primary",children:"NEW"})]}),a.jsxs("button",{onClick:()=>{R(se?"/designs":"/auth"),Et(!1)},className:"w-full btn-brutal text-left py-3 flex items-center gap-2",children:[a.jsx(uf,{className:"w-4 h-4"}),se?"My Designs":"Login"]}),j&&a.jsx("p",{className:"text-xs text-primary text-center py-2",children:j})]})}),a.jsxs(T.Suspense,{fallback:null,children:[a.jsx(_w,{isOpen:be,onClose:()=>V(!1)}),c&&a.jsx(Sw,{isOpen:Y,onClose:()=>Se(!1),designId:c,designName:m}),a.jsx(Cw,{isOpen:Ce,onClose:()=>ye(!1)}),a.jsx(Nw,{isOpen:Ge,onClose:()=>He(!1),onFontUploaded:De=>{ce.success(`${De.name} is now available!`,{description:"You can now use this font in your text objects."})}}),a.jsx(Pw,{open:ot,onClose:()=>Ue(!1),onDuplicate:(De,_e,Re,Me)=>{if(r){D(r,De,_e,Re,Me);const Xe=De*_e-1;ce.success(`Created ${Xe} ${Xe===1?"copy":"copies"} in ${De}${_e} grid`)}}})]}),a.jsx(kw,{isOpen:at,onClose:()=>gt(!1),currentColors:(()=>{const De=new Set;return p.forEach(_e=>{_e.fill&&De.add(_e.fill),_e.stroke&&De.add(_e.stroke),_e.colorize&&De.add(_e.colorize)}),Array.from(De)})(),onApplyKit:De=>{const _e=new Set;p.forEach(fe=>{fe.fill&&fe.fill!=="none"&&_e.add(fe.fill),fe.stroke&&_e.add(fe.stroke),fe.colorize&&_e.add(fe.colorize)});const Re=Array.from(_e),Me=De.colors,Xe=new Map;Re.forEach((fe,Pe)=>{const Fe=Me[Pe%Me.length];Xe.set(fe,Fe)}),v();let Ft=0;p.forEach(fe=>{const Pe={};fe.fill&&Xe.has(fe.fill)&&(Pe.fill=Xe.get(fe.fill),Ft++),fe.stroke&&Xe.has(fe.stroke)&&(Pe.stroke=Xe.get(fe.stroke),Ft++),fe.colorize&&Xe.has(fe.colorize)&&(Pe.colorize=Xe.get(fe.colorize),Ft++),Object.keys(Pe).length>0&&x(fe.id,Pe)}),Ft>0?ce.success(`Applied "${De.name}" - ${Ft} color${Ft!==1?"s":""} changed`):ce.info(`Applied "${De.name}" - No matching colors found`)}}),a.jsxs(T.Suspense,{fallback:null,children:[a.jsx(Aw,{isOpen:At,onClose:()=>Qe(!1),objects:p,designName:m,onConfirmExport:()=>{ce.success("Design exported successfully")}}),a.jsx(Tw,{open:A,onClose:()=>oe(!1)}),a.jsx(Rw,{isOpen:ne,onClose:()=>L(!1)}),M&&a.jsx(Dw,{objects:p,onClose:()=>U(!1)}),a.jsx(jw,{isOpen:le,onClose:()=>ue(!1)}),a.jsx(Ew,{isOpen:Z,onClose:()=>pe(!1)})]}),a.jsx(gw,{}),a.jsx(yw,{})]})}function Iw(){const[r,e]=T.useState(!0),[t,n]=T.useState(""),[i,l]=T.useState(""),[c,d]=T.useState(""),{signup:u,login:f,isLoading:p,error:m}=Nn(),y=Tr(),w=async _=>{_.preventDefault();try{r?await f(t,i):await u(t,i,c),y("/")}catch(x){console.error(x)}};return a.jsx("div",{className:"min-h-screen flex items-center justify-center bg-background p-4",children:a.jsxs("div",{className:"w-full max-w-md space-y-8",children:[a.jsxs("div",{className:"text-center",children:[a.jsxs("h1",{className:"font-display text-4xl uppercase tracking-widest",children:["Deck",a.jsx("span",{className:"text-primary",children:"Forge"})]}),a.jsx("p",{className:"mt-2 text-sm text-muted-foreground uppercase tracking-widest",children:"Fingerboard Graphics Editor"})]}),a.jsxs("div",{className:"border border-border bg-card p-8 space-y-6",children:[a.jsxs("div",{className:"flex gap-2",children:[a.jsx(de,{variant:r?"default":"outline",className:"flex-1",onClick:()=>e(!0),children:"Login"}),a.jsx(de,{variant:r?"outline":"default",className:"flex-1",onClick:()=>e(!1),children:"Sign Up"})]}),a.jsxs("form",{onSubmit:w,className:"space-y-4",children:[!r&&a.jsxs("div",{className:"space-y-2",children:[a.jsx(Ee,{htmlFor:"username",children:"Username"}),a.jsx(pt,{id:"username",type:"text",value:c,onChange:_=>d(_.target.value),placeholder:"fingerboarder123",required:!r})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Ee,{htmlFor:"email",children:"Email"}),a.jsx(pt,{id:"email",type:"email",value:t,onChange:_=>n(_.target.value),placeholder:"you@example.com",required:!0})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Ee,{htmlFor:"password",children:"Password"}),a.jsx(pt,{id:"password",type:"password",value:i,onChange:_=>l(_.target.value),placeholder:"",required:!0,minLength:6})]}),m&&a.jsx("div",{className:"text-sm text-destructive bg-destructive/10 border border-destructive/20 p-3 rounded",children:m}),a.jsx(de,{type:"submit",className:"w-full",disabled:p,children:p?"Loading...":r?"Login":"Create Account"})]}),a.jsx("div",{className:"text-center",children:a.jsx(de,{variant:"link",onClick:()=>y("/"),className:"text-xs uppercase tracking-widest",children:"Continue as Guest"})})]})]})})}function So(r){throw new Error('Could not dynamically require "'+r+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var E0={exports:{}};/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/(function(r,e){(function(t){r.exports=t()})(function(){return function t(n,i,l){function c(f,p){if(!i[f]){if(!n[f]){var m=typeof So=="function"&&So;if(!p&&m)return m(f,!0);if(d)return d(f,!0);var y=new Error("Cannot find module '"+f+"'");throw y.code="MODULE_NOT_FOUND",y}var w=i[f]={exports:{}};n[f][0].call(w.exports,function(_){var x=n[f][1][_];return c(x||_)},w,w.exports,t,n,i,l)}return i[f].exports}for(var d=typeof So=="function"&&So,u=0;u<l.length;u++)c(l[u]);return c}({1:[function(t,n,i){var l=t("./utils"),c=t("./support"),d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";i.encode=function(u){for(var f,p,m,y,w,_,x,v=[],S=0,C=u.length,k=C,E=l.getTypeOf(u)!=="string";S<u.length;)k=C-S,m=E?(f=u[S++],p=S<C?u[S++]:0,S<C?u[S++]:0):(f=u.charCodeAt(S++),p=S<C?u.charCodeAt(S++):0,S<C?u.charCodeAt(S++):0),y=f>>2,w=(3&f)<<4|p>>4,_=1<k?(15&p)<<2|m>>6:64,x=2<k?63&m:64,v.push(d.charAt(y)+d.charAt(w)+d.charAt(_)+d.charAt(x));return v.join("")},i.decode=function(u){var f,p,m,y,w,_,x=0,v=0,S="data:";if(u.substr(0,S.length)===S)throw new Error("Invalid base64 input, it looks like a data url.");var C,k=3*(u=u.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(u.charAt(u.length-1)===d.charAt(64)&&k--,u.charAt(u.length-2)===d.charAt(64)&&k--,k%1!=0)throw new Error("Invalid base64 input, bad content length.");for(C=c.uint8array?new Uint8Array(0|k):new Array(0|k);x<u.length;)f=d.indexOf(u.charAt(x++))<<2|(y=d.indexOf(u.charAt(x++)))>>4,p=(15&y)<<4|(w=d.indexOf(u.charAt(x++)))>>2,m=(3&w)<<6|(_=d.indexOf(u.charAt(x++))),C[v++]=f,w!==64&&(C[v++]=p),_!==64&&(C[v++]=m);return C}},{"./support":30,"./utils":32}],2:[function(t,n,i){var l=t("./external"),c=t("./stream/DataWorker"),d=t("./stream/Crc32Probe"),u=t("./stream/DataLengthProbe");function f(p,m,y,w,_){this.compressedSize=p,this.uncompressedSize=m,this.crc32=y,this.compression=w,this.compressedContent=_}f.prototype={getContentWorker:function(){var p=new c(l.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new u("data_length")),m=this;return p.on("end",function(){if(this.streamInfo.data_length!==m.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),p},getCompressedWorker:function(){return new c(l.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},f.createWorkerFrom=function(p,m,y){return p.pipe(new d).pipe(new u("uncompressedSize")).pipe(m.compressWorker(y)).pipe(new u("compressedSize")).withStreamInfo("compression",m)},n.exports=f},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(t,n,i){var l=t("./stream/GenericWorker");i.STORE={magic:"\0\0",compressWorker:function(){return new l("STORE compression")},uncompressWorker:function(){return new l("STORE decompression")}},i.DEFLATE=t("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(t,n,i){var l=t("./utils"),c=function(){for(var d,u=[],f=0;f<256;f++){d=f;for(var p=0;p<8;p++)d=1&d?3988292384^d>>>1:d>>>1;u[f]=d}return u}();n.exports=function(d,u){return d!==void 0&&d.length?l.getTypeOf(d)!=="string"?function(f,p,m,y){var w=c,_=y+m;f^=-1;for(var x=y;x<_;x++)f=f>>>8^w[255&(f^p[x])];return-1^f}(0|u,d,d.length,0):function(f,p,m,y){var w=c,_=y+m;f^=-1;for(var x=y;x<_;x++)f=f>>>8^w[255&(f^p.charCodeAt(x))];return-1^f}(0|u,d,d.length,0):0}},{"./utils":32}],5:[function(t,n,i){i.base64=!1,i.binary=!1,i.dir=!1,i.createFolders=!0,i.date=null,i.compression=null,i.compressionOptions=null,i.comment=null,i.unixPermissions=null,i.dosPermissions=null},{}],6:[function(t,n,i){var l=null;l=typeof Promise<"u"?Promise:t("lie"),n.exports={Promise:l}},{lie:37}],7:[function(t,n,i){var l=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",c=t("pako"),d=t("./utils"),u=t("./stream/GenericWorker"),f=l?"uint8array":"array";function p(m,y){u.call(this,"FlateWorker/"+m),this._pako=null,this._pakoAction=m,this._pakoOptions=y,this.meta={}}i.magic="\b\0",d.inherits(p,u),p.prototype.processChunk=function(m){this.meta=m.meta,this._pako===null&&this._createPako(),this._pako.push(d.transformTo(f,m.data),!1)},p.prototype.flush=function(){u.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},p.prototype.cleanUp=function(){u.prototype.cleanUp.call(this),this._pako=null},p.prototype._createPako=function(){this._pako=new c[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var m=this;this._pako.onData=function(y){m.push({data:y,meta:m.meta})}},i.compressWorker=function(m){return new p("Deflate",m)},i.uncompressWorker=function(){return new p("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(t,n,i){function l(w,_){var x,v="";for(x=0;x<_;x++)v+=String.fromCharCode(255&w),w>>>=8;return v}function c(w,_,x,v,S,C){var k,E,P=w.file,D=w.compression,I=C!==f.utf8encode,B=d.transformTo("string",C(P.name)),z=d.transformTo("string",f.utf8encode(P.name)),X=P.comment,se=d.transformTo("string",C(X)),R=d.transformTo("string",f.utf8encode(X)),H=z.length!==P.name.length,j=R.length!==X.length,G="",Q="",K="",J=P.dir,ee=P.date,be={crc32:0,compressedSize:0,uncompressedSize:0};_&&!x||(be.crc32=w.crc32,be.compressedSize=w.compressedSize,be.uncompressedSize=w.uncompressedSize);var V=0;_&&(V|=8),I||!H&&!j||(V|=2048);var Y=0,Se=0;J&&(Y|=16),S==="UNIX"?(Se=798,Y|=function(ye,at){var gt=ye;return ye||(gt=at?16893:33204),(65535&gt)<<16}(P.unixPermissions,J)):(Se=20,Y|=function(ye){return 63&(ye||0)}(P.dosPermissions)),k=ee.getUTCHours(),k<<=6,k|=ee.getUTCMinutes(),k<<=5,k|=ee.getUTCSeconds()/2,E=ee.getUTCFullYear()-1980,E<<=4,E|=ee.getUTCMonth()+1,E<<=5,E|=ee.getUTCDate(),H&&(Q=l(1,1)+l(p(B),4)+z,G+="up"+l(Q.length,2)+Q),j&&(K=l(1,1)+l(p(se),4)+R,G+="uc"+l(K.length,2)+K);var Ce="";return Ce+=`
\0`,Ce+=l(V,2),Ce+=D.magic,Ce+=l(k,2),Ce+=l(E,2),Ce+=l(be.crc32,4),Ce+=l(be.compressedSize,4),Ce+=l(be.uncompressedSize,4),Ce+=l(B.length,2),Ce+=l(G.length,2),{fileRecord:m.LOCAL_FILE_HEADER+Ce+B+G,dirRecord:m.CENTRAL_FILE_HEADER+l(Se,2)+Ce+l(se.length,2)+"\0\0\0\0"+l(Y,4)+l(v,4)+B+G+se}}var d=t("../utils"),u=t("../stream/GenericWorker"),f=t("../utf8"),p=t("../crc32"),m=t("../signature");function y(w,_,x,v){u.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=_,this.zipPlatform=x,this.encodeFileName=v,this.streamFiles=w,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}d.inherits(y,u),y.prototype.push=function(w){var _=w.meta.percent||0,x=this.entriesCount,v=this._sources.length;this.accumulate?this.contentBuffer.push(w):(this.bytesWritten+=w.data.length,u.prototype.push.call(this,{data:w.data,meta:{currentFile:this.currentFile,percent:x?(_+100*(x-v-1))/x:100}}))},y.prototype.openedSource=function(w){this.currentSourceOffset=this.bytesWritten,this.currentFile=w.file.name;var _=this.streamFiles&&!w.file.dir;if(_){var x=c(w,_,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:x.fileRecord,meta:{percent:0}})}else this.accumulate=!0},y.prototype.closedSource=function(w){this.accumulate=!1;var _=this.streamFiles&&!w.file.dir,x=c(w,_,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(x.dirRecord),_)this.push({data:function(v){return m.DATA_DESCRIPTOR+l(v.crc32,4)+l(v.compressedSize,4)+l(v.uncompressedSize,4)}(w),meta:{percent:100}});else for(this.push({data:x.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},y.prototype.flush=function(){for(var w=this.bytesWritten,_=0;_<this.dirRecords.length;_++)this.push({data:this.dirRecords[_],meta:{percent:100}});var x=this.bytesWritten-w,v=function(S,C,k,E,P){var D=d.transformTo("string",P(E));return m.CENTRAL_DIRECTORY_END+"\0\0\0\0"+l(S,2)+l(S,2)+l(C,4)+l(k,4)+l(D.length,2)+D}(this.dirRecords.length,x,w,this.zipComment,this.encodeFileName);this.push({data:v,meta:{percent:100}})},y.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},y.prototype.registerPrevious=function(w){this._sources.push(w);var _=this;return w.on("data",function(x){_.processChunk(x)}),w.on("end",function(){_.closedSource(_.previous.streamInfo),_._sources.length?_.prepareNextSource():_.end()}),w.on("error",function(x){_.error(x)}),this},y.prototype.resume=function(){return!!u.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},y.prototype.error=function(w){var _=this._sources;if(!u.prototype.error.call(this,w))return!1;for(var x=0;x<_.length;x++)try{_[x].error(w)}catch{}return!0},y.prototype.lock=function(){u.prototype.lock.call(this);for(var w=this._sources,_=0;_<w.length;_++)w[_].lock()},n.exports=y},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(t,n,i){var l=t("../compressions"),c=t("./ZipFileWorker");i.generateWorker=function(d,u,f){var p=new c(u.streamFiles,f,u.platform,u.encodeFileName),m=0;try{d.forEach(function(y,w){m++;var _=function(C,k){var E=C||k,P=l[E];if(!P)throw new Error(E+" is not a valid compression method !");return P}(w.options.compression,u.compression),x=w.options.compressionOptions||u.compressionOptions||{},v=w.dir,S=w.date;w._compressWorker(_,x).withStreamInfo("file",{name:y,dir:v,date:S,comment:w.comment||"",unixPermissions:w.unixPermissions,dosPermissions:w.dosPermissions}).pipe(p)}),p.entriesCount=m}catch(y){p.error(y)}return p}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(t,n,i){function l(){if(!(this instanceof l))return new l;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var c=new l;for(var d in this)typeof this[d]!="function"&&(c[d]=this[d]);return c}}(l.prototype=t("./object")).loadAsync=t("./load"),l.support=t("./support"),l.defaults=t("./defaults"),l.version="3.10.1",l.loadAsync=function(c,d){return new l().loadAsync(c,d)},l.external=t("./external"),n.exports=l},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(t,n,i){var l=t("./utils"),c=t("./external"),d=t("./utf8"),u=t("./zipEntries"),f=t("./stream/Crc32Probe"),p=t("./nodejsUtils");function m(y){return new c.Promise(function(w,_){var x=y.decompressed.getContentWorker().pipe(new f);x.on("error",function(v){_(v)}).on("end",function(){x.streamInfo.crc32!==y.decompressed.crc32?_(new Error("Corrupted zip : CRC32 mismatch")):w()}).resume()})}n.exports=function(y,w){var _=this;return w=l.extend(w||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:d.utf8decode}),p.isNode&&p.isStream(y)?c.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):l.prepareContent("the loaded zip file",y,!0,w.optimizedBinaryString,w.base64).then(function(x){var v=new u(w);return v.load(x),v}).then(function(x){var v=[c.Promise.resolve(x)],S=x.files;if(w.checkCRC32)for(var C=0;C<S.length;C++)v.push(m(S[C]));return c.Promise.all(v)}).then(function(x){for(var v=x.shift(),S=v.files,C=0;C<S.length;C++){var k=S[C],E=k.fileNameStr,P=l.resolve(k.fileNameStr);_.file(P,k.decompressed,{binary:!0,optimizedBinaryString:!0,date:k.date,dir:k.dir,comment:k.fileCommentStr.length?k.fileCommentStr:null,unixPermissions:k.unixPermissions,dosPermissions:k.dosPermissions,createFolders:w.createFolders}),k.dir||(_.file(P).unsafeOriginalName=E)}return v.zipComment.length&&(_.comment=v.zipComment),_})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(t,n,i){var l=t("../utils"),c=t("../stream/GenericWorker");function d(u,f){c.call(this,"Nodejs stream input adapter for "+u),this._upstreamEnded=!1,this._bindStream(f)}l.inherits(d,c),d.prototype._bindStream=function(u){var f=this;(this._stream=u).pause(),u.on("data",function(p){f.push({data:p,meta:{percent:0}})}).on("error",function(p){f.isPaused?this.generatedError=p:f.error(p)}).on("end",function(){f.isPaused?f._upstreamEnded=!0:f.end()})},d.prototype.pause=function(){return!!c.prototype.pause.call(this)&&(this._stream.pause(),!0)},d.prototype.resume=function(){return!!c.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},n.exports=d},{"../stream/GenericWorker":28,"../utils":32}],13:[function(t,n,i){var l=t("readable-stream").Readable;function c(d,u,f){l.call(this,u),this._helper=d;var p=this;d.on("data",function(m,y){p.push(m)||p._helper.pause(),f&&f(y)}).on("error",function(m){p.emit("error",m)}).on("end",function(){p.push(null)})}t("../utils").inherits(c,l),c.prototype._read=function(){this._helper.resume()},n.exports=c},{"../utils":32,"readable-stream":16}],14:[function(t,n,i){n.exports={isNode:typeof Buffer<"u",newBufferFrom:function(l,c){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(l,c);if(typeof l=="number")throw new Error('The "data" argument must not be a number');return new Buffer(l,c)},allocBuffer:function(l){if(Buffer.alloc)return Buffer.alloc(l);var c=new Buffer(l);return c.fill(0),c},isBuffer:function(l){return Buffer.isBuffer(l)},isStream:function(l){return l&&typeof l.on=="function"&&typeof l.pause=="function"&&typeof l.resume=="function"}}},{}],15:[function(t,n,i){function l(P,D,I){var B,z=d.getTypeOf(D),X=d.extend(I||{},p);X.date=X.date||new Date,X.compression!==null&&(X.compression=X.compression.toUpperCase()),typeof X.unixPermissions=="string"&&(X.unixPermissions=parseInt(X.unixPermissions,8)),X.unixPermissions&&16384&X.unixPermissions&&(X.dir=!0),X.dosPermissions&&16&X.dosPermissions&&(X.dir=!0),X.dir&&(P=S(P)),X.createFolders&&(B=v(P))&&C.call(this,B,!0);var se=z==="string"&&X.binary===!1&&X.base64===!1;I&&I.binary!==void 0||(X.binary=!se),(D instanceof m&&D.uncompressedSize===0||X.dir||!D||D.length===0)&&(X.base64=!1,X.binary=!0,D="",X.compression="STORE",z="string");var R=null;R=D instanceof m||D instanceof u?D:_.isNode&&_.isStream(D)?new x(P,D):d.prepareContent(P,D,X.binary,X.optimizedBinaryString,X.base64);var H=new y(P,R,X);this.files[P]=H}var c=t("./utf8"),d=t("./utils"),u=t("./stream/GenericWorker"),f=t("./stream/StreamHelper"),p=t("./defaults"),m=t("./compressedObject"),y=t("./zipObject"),w=t("./generate"),_=t("./nodejsUtils"),x=t("./nodejs/NodejsStreamInputAdapter"),v=function(P){P.slice(-1)==="/"&&(P=P.substring(0,P.length-1));var D=P.lastIndexOf("/");return 0<D?P.substring(0,D):""},S=function(P){return P.slice(-1)!=="/"&&(P+="/"),P},C=function(P,D){return D=D!==void 0?D:p.createFolders,P=S(P),this.files[P]||l.call(this,P,null,{dir:!0,createFolders:D}),this.files[P]};function k(P){return Object.prototype.toString.call(P)==="[object RegExp]"}var E={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(P){var D,I,B;for(D in this.files)B=this.files[D],(I=D.slice(this.root.length,D.length))&&D.slice(0,this.root.length)===this.root&&P(I,B)},filter:function(P){var D=[];return this.forEach(function(I,B){P(I,B)&&D.push(B)}),D},file:function(P,D,I){if(arguments.length!==1)return P=this.root+P,l.call(this,P,D,I),this;if(k(P)){var B=P;return this.filter(function(X,se){return!se.dir&&B.test(X)})}var z=this.files[this.root+P];return z&&!z.dir?z:null},folder:function(P){if(!P)return this;if(k(P))return this.filter(function(z,X){return X.dir&&P.test(z)});var D=this.root+P,I=C.call(this,D),B=this.clone();return B.root=I.name,B},remove:function(P){P=this.root+P;var D=this.files[P];if(D||(P.slice(-1)!=="/"&&(P+="/"),D=this.files[P]),D&&!D.dir)delete this.files[P];else for(var I=this.filter(function(z,X){return X.name.slice(0,P.length)===P}),B=0;B<I.length;B++)delete this.files[I[B].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(P){var D,I={};try{if((I=d.extend(P||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:c.utf8encode})).type=I.type.toLowerCase(),I.compression=I.compression.toUpperCase(),I.type==="binarystring"&&(I.type="string"),!I.type)throw new Error("No output type specified.");d.checkSupport(I.type),I.platform!=="darwin"&&I.platform!=="freebsd"&&I.platform!=="linux"&&I.platform!=="sunos"||(I.platform="UNIX"),I.platform==="win32"&&(I.platform="DOS");var B=I.comment||this.comment||"";D=w.generateWorker(this,I,B)}catch(z){(D=new u("error")).error(z)}return new f(D,I.type||"string",I.mimeType)},generateAsync:function(P,D){return this.generateInternalStream(P).accumulate(D)},generateNodeStream:function(P,D){return(P=P||{}).type||(P.type="nodebuffer"),this.generateInternalStream(P).toNodejsStream(D)}};n.exports=E},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(t,n,i){n.exports=t("stream")},{stream:void 0}],17:[function(t,n,i){var l=t("./DataReader");function c(d){l.call(this,d);for(var u=0;u<this.data.length;u++)d[u]=255&d[u]}t("../utils").inherits(c,l),c.prototype.byteAt=function(d){return this.data[this.zero+d]},c.prototype.lastIndexOfSignature=function(d){for(var u=d.charCodeAt(0),f=d.charCodeAt(1),p=d.charCodeAt(2),m=d.charCodeAt(3),y=this.length-4;0<=y;--y)if(this.data[y]===u&&this.data[y+1]===f&&this.data[y+2]===p&&this.data[y+3]===m)return y-this.zero;return-1},c.prototype.readAndCheckSignature=function(d){var u=d.charCodeAt(0),f=d.charCodeAt(1),p=d.charCodeAt(2),m=d.charCodeAt(3),y=this.readData(4);return u===y[0]&&f===y[1]&&p===y[2]&&m===y[3]},c.prototype.readData=function(d){if(this.checkOffset(d),d===0)return[];var u=this.data.slice(this.zero+this.index,this.zero+this.index+d);return this.index+=d,u},n.exports=c},{"../utils":32,"./DataReader":18}],18:[function(t,n,i){var l=t("../utils");function c(d){this.data=d,this.length=d.length,this.index=0,this.zero=0}c.prototype={checkOffset:function(d){this.checkIndex(this.index+d)},checkIndex:function(d){if(this.length<this.zero+d||d<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+d+"). Corrupted zip ?")},setIndex:function(d){this.checkIndex(d),this.index=d},skip:function(d){this.setIndex(this.index+d)},byteAt:function(){},readInt:function(d){var u,f=0;for(this.checkOffset(d),u=this.index+d-1;u>=this.index;u--)f=(f<<8)+this.byteAt(u);return this.index+=d,f},readString:function(d){return l.transformTo("string",this.readData(d))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var d=this.readInt(4);return new Date(Date.UTC(1980+(d>>25&127),(d>>21&15)-1,d>>16&31,d>>11&31,d>>5&63,(31&d)<<1))}},n.exports=c},{"../utils":32}],19:[function(t,n,i){var l=t("./Uint8ArrayReader");function c(d){l.call(this,d)}t("../utils").inherits(c,l),c.prototype.readData=function(d){this.checkOffset(d);var u=this.data.slice(this.zero+this.index,this.zero+this.index+d);return this.index+=d,u},n.exports=c},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(t,n,i){var l=t("./DataReader");function c(d){l.call(this,d)}t("../utils").inherits(c,l),c.prototype.byteAt=function(d){return this.data.charCodeAt(this.zero+d)},c.prototype.lastIndexOfSignature=function(d){return this.data.lastIndexOf(d)-this.zero},c.prototype.readAndCheckSignature=function(d){return d===this.readData(4)},c.prototype.readData=function(d){this.checkOffset(d);var u=this.data.slice(this.zero+this.index,this.zero+this.index+d);return this.index+=d,u},n.exports=c},{"../utils":32,"./DataReader":18}],21:[function(t,n,i){var l=t("./ArrayReader");function c(d){l.call(this,d)}t("../utils").inherits(c,l),c.prototype.readData=function(d){if(this.checkOffset(d),d===0)return new Uint8Array(0);var u=this.data.subarray(this.zero+this.index,this.zero+this.index+d);return this.index+=d,u},n.exports=c},{"../utils":32,"./ArrayReader":17}],22:[function(t,n,i){var l=t("../utils"),c=t("../support"),d=t("./ArrayReader"),u=t("./StringReader"),f=t("./NodeBufferReader"),p=t("./Uint8ArrayReader");n.exports=function(m){var y=l.getTypeOf(m);return l.checkSupport(y),y!=="string"||c.uint8array?y==="nodebuffer"?new f(m):c.uint8array?new p(l.transformTo("uint8array",m)):new d(l.transformTo("array",m)):new u(m)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(t,n,i){i.LOCAL_FILE_HEADER="PK",i.CENTRAL_FILE_HEADER="PK",i.CENTRAL_DIRECTORY_END="PK",i.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",i.ZIP64_CENTRAL_DIRECTORY_END="PK",i.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(t,n,i){var l=t("./GenericWorker"),c=t("../utils");function d(u){l.call(this,"ConvertWorker to "+u),this.destType=u}c.inherits(d,l),d.prototype.processChunk=function(u){this.push({data:c.transformTo(this.destType,u.data),meta:u.meta})},n.exports=d},{"../utils":32,"./GenericWorker":28}],25:[function(t,n,i){var l=t("./GenericWorker"),c=t("../crc32");function d(){l.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}t("../utils").inherits(d,l),d.prototype.processChunk=function(u){this.streamInfo.crc32=c(u.data,this.streamInfo.crc32||0),this.push(u)},n.exports=d},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(t,n,i){var l=t("../utils"),c=t("./GenericWorker");function d(u){c.call(this,"DataLengthProbe for "+u),this.propName=u,this.withStreamInfo(u,0)}l.inherits(d,c),d.prototype.processChunk=function(u){if(u){var f=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=f+u.data.length}c.prototype.processChunk.call(this,u)},n.exports=d},{"../utils":32,"./GenericWorker":28}],27:[function(t,n,i){var l=t("../utils"),c=t("./GenericWorker");function d(u){c.call(this,"DataWorker");var f=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,u.then(function(p){f.dataIsReady=!0,f.data=p,f.max=p&&p.length||0,f.type=l.getTypeOf(p),f.isPaused||f._tickAndRepeat()},function(p){f.error(p)})}l.inherits(d,c),d.prototype.cleanUp=function(){c.prototype.cleanUp.call(this),this.data=null},d.prototype.resume=function(){return!!c.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,l.delay(this._tickAndRepeat,[],this)),!0)},d.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(l.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},d.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var u=null,f=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":u=this.data.substring(this.index,f);break;case"uint8array":u=this.data.subarray(this.index,f);break;case"array":case"nodebuffer":u=this.data.slice(this.index,f)}return this.index=f,this.push({data:u,meta:{percent:this.max?this.index/this.max*100:0}})},n.exports=d},{"../utils":32,"./GenericWorker":28}],28:[function(t,n,i){function l(c){this.name=c||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}l.prototype={push:function(c){this.emit("data",c)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(c){this.emit("error",c)}return!0},error:function(c){return!this.isFinished&&(this.isPaused?this.generatedError=c:(this.isFinished=!0,this.emit("error",c),this.previous&&this.previous.error(c),this.cleanUp()),!0)},on:function(c,d){return this._listeners[c].push(d),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(c,d){if(this._listeners[c])for(var u=0;u<this._listeners[c].length;u++)this._listeners[c][u].call(this,d)},pipe:function(c){return c.registerPrevious(this)},registerPrevious:function(c){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=c.streamInfo,this.mergeStreamInfo(),this.previous=c;var d=this;return c.on("data",function(u){d.processChunk(u)}),c.on("end",function(){d.end()}),c.on("error",function(u){d.error(u)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var c=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),c=!0),this.previous&&this.previous.resume(),!c},flush:function(){},processChunk:function(c){this.push(c)},withStreamInfo:function(c,d){return this.extraStreamInfo[c]=d,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var c in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,c)&&(this.streamInfo[c]=this.extraStreamInfo[c])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var c="Worker "+this.name;return this.previous?this.previous+" -> "+c:c}},n.exports=l},{}],29:[function(t,n,i){var l=t("../utils"),c=t("./ConvertWorker"),d=t("./GenericWorker"),u=t("../base64"),f=t("../support"),p=t("../external"),m=null;if(f.nodestream)try{m=t("../nodejs/NodejsStreamOutputAdapter")}catch{}function y(_,x){return new p.Promise(function(v,S){var C=[],k=_._internalType,E=_._outputType,P=_._mimeType;_.on("data",function(D,I){C.push(D),x&&x(I)}).on("error",function(D){C=[],S(D)}).on("end",function(){try{var D=function(I,B,z){switch(I){case"blob":return l.newBlob(l.transformTo("arraybuffer",B),z);case"base64":return u.encode(B);default:return l.transformTo(I,B)}}(E,function(I,B){var z,X=0,se=null,R=0;for(z=0;z<B.length;z++)R+=B[z].length;switch(I){case"string":return B.join("");case"array":return Array.prototype.concat.apply([],B);case"uint8array":for(se=new Uint8Array(R),z=0;z<B.length;z++)se.set(B[z],X),X+=B[z].length;return se;case"nodebuffer":return Buffer.concat(B);default:throw new Error("concat : unsupported type '"+I+"'")}}(k,C),P);v(D)}catch(I){S(I)}C=[]}).resume()})}function w(_,x,v){var S=x;switch(x){case"blob":case"arraybuffer":S="uint8array";break;case"base64":S="string"}try{this._internalType=S,this._outputType=x,this._mimeType=v,l.checkSupport(S),this._worker=_.pipe(new c(S)),_.lock()}catch(C){this._worker=new d("error"),this._worker.error(C)}}w.prototype={accumulate:function(_){return y(this,_)},on:function(_,x){var v=this;return _==="data"?this._worker.on(_,function(S){x.call(v,S.data,S.meta)}):this._worker.on(_,function(){l.delay(x,arguments,v)}),this},resume:function(){return l.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(_){if(l.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new m(this,{objectMode:this._outputType!=="nodebuffer"},_)}},n.exports=w},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(t,n,i){if(i.base64=!0,i.array=!0,i.string=!0,i.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",i.nodebuffer=typeof Buffer<"u",i.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")i.blob=!1;else{var l=new ArrayBuffer(0);try{i.blob=new Blob([l],{type:"application/zip"}).size===0}catch{try{var c=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);c.append(l),i.blob=c.getBlob("application/zip").size===0}catch{i.blob=!1}}}try{i.nodestream=!!t("readable-stream").Readable}catch{i.nodestream=!1}},{"readable-stream":16}],31:[function(t,n,i){for(var l=t("./utils"),c=t("./support"),d=t("./nodejsUtils"),u=t("./stream/GenericWorker"),f=new Array(256),p=0;p<256;p++)f[p]=252<=p?6:248<=p?5:240<=p?4:224<=p?3:192<=p?2:1;f[254]=f[254]=1;function m(){u.call(this,"utf-8 decode"),this.leftOver=null}function y(){u.call(this,"utf-8 encode")}i.utf8encode=function(w){return c.nodebuffer?d.newBufferFrom(w,"utf-8"):function(_){var x,v,S,C,k,E=_.length,P=0;for(C=0;C<E;C++)(64512&(v=_.charCodeAt(C)))==55296&&C+1<E&&(64512&(S=_.charCodeAt(C+1)))==56320&&(v=65536+(v-55296<<10)+(S-56320),C++),P+=v<128?1:v<2048?2:v<65536?3:4;for(x=c.uint8array?new Uint8Array(P):new Array(P),C=k=0;k<P;C++)(64512&(v=_.charCodeAt(C)))==55296&&C+1<E&&(64512&(S=_.charCodeAt(C+1)))==56320&&(v=65536+(v-55296<<10)+(S-56320),C++),v<128?x[k++]=v:(v<2048?x[k++]=192|v>>>6:(v<65536?x[k++]=224|v>>>12:(x[k++]=240|v>>>18,x[k++]=128|v>>>12&63),x[k++]=128|v>>>6&63),x[k++]=128|63&v);return x}(w)},i.utf8decode=function(w){return c.nodebuffer?l.transformTo("nodebuffer",w).toString("utf-8"):function(_){var x,v,S,C,k=_.length,E=new Array(2*k);for(x=v=0;x<k;)if((S=_[x++])<128)E[v++]=S;else if(4<(C=f[S]))E[v++]=65533,x+=C-1;else{for(S&=C===2?31:C===3?15:7;1<C&&x<k;)S=S<<6|63&_[x++],C--;1<C?E[v++]=65533:S<65536?E[v++]=S:(S-=65536,E[v++]=55296|S>>10&1023,E[v++]=56320|1023&S)}return E.length!==v&&(E.subarray?E=E.subarray(0,v):E.length=v),l.applyFromCharCode(E)}(w=l.transformTo(c.uint8array?"uint8array":"array",w))},l.inherits(m,u),m.prototype.processChunk=function(w){var _=l.transformTo(c.uint8array?"uint8array":"array",w.data);if(this.leftOver&&this.leftOver.length){if(c.uint8array){var x=_;(_=new Uint8Array(x.length+this.leftOver.length)).set(this.leftOver,0),_.set(x,this.leftOver.length)}else _=this.leftOver.concat(_);this.leftOver=null}var v=function(C,k){var E;for((k=k||C.length)>C.length&&(k=C.length),E=k-1;0<=E&&(192&C[E])==128;)E--;return E<0||E===0?k:E+f[C[E]]>k?E:k}(_),S=_;v!==_.length&&(c.uint8array?(S=_.subarray(0,v),this.leftOver=_.subarray(v,_.length)):(S=_.slice(0,v),this.leftOver=_.slice(v,_.length))),this.push({data:i.utf8decode(S),meta:w.meta})},m.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:i.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},i.Utf8DecodeWorker=m,l.inherits(y,u),y.prototype.processChunk=function(w){this.push({data:i.utf8encode(w.data),meta:w.meta})},i.Utf8EncodeWorker=y},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(t,n,i){var l=t("./support"),c=t("./base64"),d=t("./nodejsUtils"),u=t("./external");function f(x){return x}function p(x,v){for(var S=0;S<x.length;++S)v[S]=255&x.charCodeAt(S);return v}t("setimmediate"),i.newBlob=function(x,v){i.checkSupport("blob");try{return new Blob([x],{type:v})}catch{try{var S=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return S.append(x),S.getBlob(v)}catch{throw new Error("Bug : can't construct the Blob.")}}};var m={stringifyByChunk:function(x,v,S){var C=[],k=0,E=x.length;if(E<=S)return String.fromCharCode.apply(null,x);for(;k<E;)v==="array"||v==="nodebuffer"?C.push(String.fromCharCode.apply(null,x.slice(k,Math.min(k+S,E)))):C.push(String.fromCharCode.apply(null,x.subarray(k,Math.min(k+S,E)))),k+=S;return C.join("")},stringifyByChar:function(x){for(var v="",S=0;S<x.length;S++)v+=String.fromCharCode(x[S]);return v},applyCanBeUsed:{uint8array:function(){try{return l.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return l.nodebuffer&&String.fromCharCode.apply(null,d.allocBuffer(1)).length===1}catch{return!1}}()}};function y(x){var v=65536,S=i.getTypeOf(x),C=!0;if(S==="uint8array"?C=m.applyCanBeUsed.uint8array:S==="nodebuffer"&&(C=m.applyCanBeUsed.nodebuffer),C)for(;1<v;)try{return m.stringifyByChunk(x,S,v)}catch{v=Math.floor(v/2)}return m.stringifyByChar(x)}function w(x,v){for(var S=0;S<x.length;S++)v[S]=x[S];return v}i.applyFromCharCode=y;var _={};_.string={string:f,array:function(x){return p(x,new Array(x.length))},arraybuffer:function(x){return _.string.uint8array(x).buffer},uint8array:function(x){return p(x,new Uint8Array(x.length))},nodebuffer:function(x){return p(x,d.allocBuffer(x.length))}},_.array={string:y,array:f,arraybuffer:function(x){return new Uint8Array(x).buffer},uint8array:function(x){return new Uint8Array(x)},nodebuffer:function(x){return d.newBufferFrom(x)}},_.arraybuffer={string:function(x){return y(new Uint8Array(x))},array:function(x){return w(new Uint8Array(x),new Array(x.byteLength))},arraybuffer:f,uint8array:function(x){return new Uint8Array(x)},nodebuffer:function(x){return d.newBufferFrom(new Uint8Array(x))}},_.uint8array={string:y,array:function(x){return w(x,new Array(x.length))},arraybuffer:function(x){return x.buffer},uint8array:f,nodebuffer:function(x){return d.newBufferFrom(x)}},_.nodebuffer={string:y,array:function(x){return w(x,new Array(x.length))},arraybuffer:function(x){return _.nodebuffer.uint8array(x).buffer},uint8array:function(x){return w(x,new Uint8Array(x.length))},nodebuffer:f},i.transformTo=function(x,v){if(v=v||"",!x)return v;i.checkSupport(x);var S=i.getTypeOf(v);return _[S][x](v)},i.resolve=function(x){for(var v=x.split("/"),S=[],C=0;C<v.length;C++){var k=v[C];k==="."||k===""&&C!==0&&C!==v.length-1||(k===".."?S.pop():S.push(k))}return S.join("/")},i.getTypeOf=function(x){return typeof x=="string"?"string":Object.prototype.toString.call(x)==="[object Array]"?"array":l.nodebuffer&&d.isBuffer(x)?"nodebuffer":l.uint8array&&x instanceof Uint8Array?"uint8array":l.arraybuffer&&x instanceof ArrayBuffer?"arraybuffer":void 0},i.checkSupport=function(x){if(!l[x.toLowerCase()])throw new Error(x+" is not supported by this platform")},i.MAX_VALUE_16BITS=65535,i.MAX_VALUE_32BITS=-1,i.pretty=function(x){var v,S,C="";for(S=0;S<(x||"").length;S++)C+="\\x"+((v=x.charCodeAt(S))<16?"0":"")+v.toString(16).toUpperCase();return C},i.delay=function(x,v,S){setImmediate(function(){x.apply(S||null,v||[])})},i.inherits=function(x,v){function S(){}S.prototype=v.prototype,x.prototype=new S},i.extend=function(){var x,v,S={};for(x=0;x<arguments.length;x++)for(v in arguments[x])Object.prototype.hasOwnProperty.call(arguments[x],v)&&S[v]===void 0&&(S[v]=arguments[x][v]);return S},i.prepareContent=function(x,v,S,C,k){return u.Promise.resolve(v).then(function(E){return l.blob&&(E instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(E))!==-1)&&typeof FileReader<"u"?new u.Promise(function(P,D){var I=new FileReader;I.onload=function(B){P(B.target.result)},I.onerror=function(B){D(B.target.error)},I.readAsArrayBuffer(E)}):E}).then(function(E){var P=i.getTypeOf(E);return P?(P==="arraybuffer"?E=i.transformTo("uint8array",E):P==="string"&&(k?E=c.decode(E):S&&C!==!0&&(E=function(D){return p(D,l.uint8array?new Uint8Array(D.length):new Array(D.length))}(E))),E):u.Promise.reject(new Error("Can't read the data of '"+x+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(t,n,i){var l=t("./reader/readerFor"),c=t("./utils"),d=t("./signature"),u=t("./zipEntry"),f=t("./support");function p(m){this.files=[],this.loadOptions=m}p.prototype={checkSignature:function(m){if(!this.reader.readAndCheckSignature(m)){this.reader.index-=4;var y=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+c.pretty(y)+", expected "+c.pretty(m)+")")}},isSignature:function(m,y){var w=this.reader.index;this.reader.setIndex(m);var _=this.reader.readString(4)===y;return this.reader.setIndex(w),_},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var m=this.reader.readData(this.zipCommentLength),y=f.uint8array?"uint8array":"array",w=c.transformTo(y,m);this.zipComment=this.loadOptions.decodeFileName(w)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var m,y,w,_=this.zip64EndOfCentralSize-44;0<_;)m=this.reader.readInt(2),y=this.reader.readInt(4),w=this.reader.readData(y),this.zip64ExtensibleData[m]={id:m,length:y,value:w}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var m,y;for(m=0;m<this.files.length;m++)y=this.files[m],this.reader.setIndex(y.localHeaderOffset),this.checkSignature(d.LOCAL_FILE_HEADER),y.readLocalPart(this.reader),y.handleUTF8(),y.processAttributes()},readCentralDir:function(){var m;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(d.CENTRAL_FILE_HEADER);)(m=new u({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(m);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var m=this.reader.lastIndexOfSignature(d.CENTRAL_DIRECTORY_END);if(m<0)throw this.isSignature(0,d.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(m);var y=m;if(this.checkSignature(d.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===c.MAX_VALUE_16BITS||this.diskWithCentralDirStart===c.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===c.MAX_VALUE_16BITS||this.centralDirRecords===c.MAX_VALUE_16BITS||this.centralDirSize===c.MAX_VALUE_32BITS||this.centralDirOffset===c.MAX_VALUE_32BITS){if(this.zip64=!0,(m=this.reader.lastIndexOfSignature(d.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(m),this.checkSignature(d.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,d.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(d.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(d.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var w=this.centralDirOffset+this.centralDirSize;this.zip64&&(w+=20,w+=12+this.zip64EndOfCentralSize);var _=y-w;if(0<_)this.isSignature(y,d.CENTRAL_FILE_HEADER)||(this.reader.zero=_);else if(_<0)throw new Error("Corrupted zip: missing "+Math.abs(_)+" bytes.")},prepareReader:function(m){this.reader=l(m)},load:function(m){this.prepareReader(m),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},n.exports=p},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(t,n,i){var l=t("./reader/readerFor"),c=t("./utils"),d=t("./compressedObject"),u=t("./crc32"),f=t("./utf8"),p=t("./compressions"),m=t("./support");function y(w,_){this.options=w,this.loadOptions=_}y.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(w){var _,x;if(w.skip(22),this.fileNameLength=w.readInt(2),x=w.readInt(2),this.fileName=w.readData(this.fileNameLength),w.skip(x),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((_=function(v){for(var S in p)if(Object.prototype.hasOwnProperty.call(p,S)&&p[S].magic===v)return p[S];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+c.pretty(this.compressionMethod)+" unknown (inner file : "+c.transformTo("string",this.fileName)+")");this.decompressed=new d(this.compressedSize,this.uncompressedSize,this.crc32,_,w.readData(this.compressedSize))},readCentralPart:function(w){this.versionMadeBy=w.readInt(2),w.skip(2),this.bitFlag=w.readInt(2),this.compressionMethod=w.readString(2),this.date=w.readDate(),this.crc32=w.readInt(4),this.compressedSize=w.readInt(4),this.uncompressedSize=w.readInt(4);var _=w.readInt(2);if(this.extraFieldsLength=w.readInt(2),this.fileCommentLength=w.readInt(2),this.diskNumberStart=w.readInt(2),this.internalFileAttributes=w.readInt(2),this.externalFileAttributes=w.readInt(4),this.localHeaderOffset=w.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");w.skip(_),this.readExtraFields(w),this.parseZIP64ExtraField(w),this.fileComment=w.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var w=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),w==0&&(this.dosPermissions=63&this.externalFileAttributes),w==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var w=l(this.extraFields[1].value);this.uncompressedSize===c.MAX_VALUE_32BITS&&(this.uncompressedSize=w.readInt(8)),this.compressedSize===c.MAX_VALUE_32BITS&&(this.compressedSize=w.readInt(8)),this.localHeaderOffset===c.MAX_VALUE_32BITS&&(this.localHeaderOffset=w.readInt(8)),this.diskNumberStart===c.MAX_VALUE_32BITS&&(this.diskNumberStart=w.readInt(4))}},readExtraFields:function(w){var _,x,v,S=w.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});w.index+4<S;)_=w.readInt(2),x=w.readInt(2),v=w.readData(x),this.extraFields[_]={id:_,length:x,value:v};w.setIndex(S)},handleUTF8:function(){var w=m.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=f.utf8decode(this.fileName),this.fileCommentStr=f.utf8decode(this.fileComment);else{var _=this.findExtraFieldUnicodePath();if(_!==null)this.fileNameStr=_;else{var x=c.transformTo(w,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(x)}var v=this.findExtraFieldUnicodeComment();if(v!==null)this.fileCommentStr=v;else{var S=c.transformTo(w,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(S)}}},findExtraFieldUnicodePath:function(){var w=this.extraFields[28789];if(w){var _=l(w.value);return _.readInt(1)!==1||u(this.fileName)!==_.readInt(4)?null:f.utf8decode(_.readData(w.length-5))}return null},findExtraFieldUnicodeComment:function(){var w=this.extraFields[25461];if(w){var _=l(w.value);return _.readInt(1)!==1||u(this.fileComment)!==_.readInt(4)?null:f.utf8decode(_.readData(w.length-5))}return null}},n.exports=y},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(t,n,i){function l(_,x,v){this.name=_,this.dir=v.dir,this.date=v.date,this.comment=v.comment,this.unixPermissions=v.unixPermissions,this.dosPermissions=v.dosPermissions,this._data=x,this._dataBinary=v.binary,this.options={compression:v.compression,compressionOptions:v.compressionOptions}}var c=t("./stream/StreamHelper"),d=t("./stream/DataWorker"),u=t("./utf8"),f=t("./compressedObject"),p=t("./stream/GenericWorker");l.prototype={internalStream:function(_){var x=null,v="string";try{if(!_)throw new Error("No output type specified.");var S=(v=_.toLowerCase())==="string"||v==="text";v!=="binarystring"&&v!=="text"||(v="string"),x=this._decompressWorker();var C=!this._dataBinary;C&&!S&&(x=x.pipe(new u.Utf8EncodeWorker)),!C&&S&&(x=x.pipe(new u.Utf8DecodeWorker))}catch(k){(x=new p("error")).error(k)}return new c(x,v,"")},async:function(_,x){return this.internalStream(_).accumulate(x)},nodeStream:function(_,x){return this.internalStream(_||"nodebuffer").toNodejsStream(x)},_compressWorker:function(_,x){if(this._data instanceof f&&this._data.compression.magic===_.magic)return this._data.getCompressedWorker();var v=this._decompressWorker();return this._dataBinary||(v=v.pipe(new u.Utf8EncodeWorker)),f.createWorkerFrom(v,_,x)},_decompressWorker:function(){return this._data instanceof f?this._data.getContentWorker():this._data instanceof p?this._data:new d(this._data)}};for(var m=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],y=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},w=0;w<m.length;w++)l.prototype[m[w]]=y;n.exports=l},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(t,n,i){(function(l){var c,d,u=l.MutationObserver||l.WebKitMutationObserver;if(u){var f=0,p=new u(_),m=l.document.createTextNode("");p.observe(m,{characterData:!0}),c=function(){m.data=f=++f%2}}else if(l.setImmediate||l.MessageChannel===void 0)c="document"in l&&"onreadystatechange"in l.document.createElement("script")?function(){var x=l.document.createElement("script");x.onreadystatechange=function(){_(),x.onreadystatechange=null,x.parentNode.removeChild(x),x=null},l.document.documentElement.appendChild(x)}:function(){setTimeout(_,0)};else{var y=new l.MessageChannel;y.port1.onmessage=_,c=function(){y.port2.postMessage(0)}}var w=[];function _(){var x,v;d=!0;for(var S=w.length;S;){for(v=w,w=[],x=-1;++x<S;)v[x]();S=w.length}d=!1}n.exports=function(x){w.push(x)!==1||d||c()}}).call(this,typeof vo<"u"?vo:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(t,n,i){var l=t("immediate");function c(){}var d={},u=["REJECTED"],f=["FULFILLED"],p=["PENDING"];function m(S){if(typeof S!="function")throw new TypeError("resolver must be a function");this.state=p,this.queue=[],this.outcome=void 0,S!==c&&x(this,S)}function y(S,C,k){this.promise=S,typeof C=="function"&&(this.onFulfilled=C,this.callFulfilled=this.otherCallFulfilled),typeof k=="function"&&(this.onRejected=k,this.callRejected=this.otherCallRejected)}function w(S,C,k){l(function(){var E;try{E=C(k)}catch(P){return d.reject(S,P)}E===S?d.reject(S,new TypeError("Cannot resolve promise with itself")):d.resolve(S,E)})}function _(S){var C=S&&S.then;if(S&&(typeof S=="object"||typeof S=="function")&&typeof C=="function")return function(){C.apply(S,arguments)}}function x(S,C){var k=!1;function E(I){k||(k=!0,d.reject(S,I))}function P(I){k||(k=!0,d.resolve(S,I))}var D=v(function(){C(P,E)});D.status==="error"&&E(D.value)}function v(S,C){var k={};try{k.value=S(C),k.status="success"}catch(E){k.status="error",k.value=E}return k}(n.exports=m).prototype.finally=function(S){if(typeof S!="function")return this;var C=this.constructor;return this.then(function(k){return C.resolve(S()).then(function(){return k})},function(k){return C.resolve(S()).then(function(){throw k})})},m.prototype.catch=function(S){return this.then(null,S)},m.prototype.then=function(S,C){if(typeof S!="function"&&this.state===f||typeof C!="function"&&this.state===u)return this;var k=new this.constructor(c);return this.state!==p?w(k,this.state===f?S:C,this.outcome):this.queue.push(new y(k,S,C)),k},y.prototype.callFulfilled=function(S){d.resolve(this.promise,S)},y.prototype.otherCallFulfilled=function(S){w(this.promise,this.onFulfilled,S)},y.prototype.callRejected=function(S){d.reject(this.promise,S)},y.prototype.otherCallRejected=function(S){w(this.promise,this.onRejected,S)},d.resolve=function(S,C){var k=v(_,C);if(k.status==="error")return d.reject(S,k.value);var E=k.value;if(E)x(S,E);else{S.state=f,S.outcome=C;for(var P=-1,D=S.queue.length;++P<D;)S.queue[P].callFulfilled(C)}return S},d.reject=function(S,C){S.state=u,S.outcome=C;for(var k=-1,E=S.queue.length;++k<E;)S.queue[k].callRejected(C);return S},m.resolve=function(S){return S instanceof this?S:d.resolve(new this(c),S)},m.reject=function(S){var C=new this(c);return d.reject(C,S)},m.all=function(S){var C=this;if(Object.prototype.toString.call(S)!=="[object Array]")return this.reject(new TypeError("must be an array"));var k=S.length,E=!1;if(!k)return this.resolve([]);for(var P=new Array(k),D=0,I=-1,B=new this(c);++I<k;)z(S[I],I);return B;function z(X,se){C.resolve(X).then(function(R){P[se]=R,++D!==k||E||(E=!0,d.resolve(B,P))},function(R){E||(E=!0,d.reject(B,R))})}},m.race=function(S){var C=this;if(Object.prototype.toString.call(S)!=="[object Array]")return this.reject(new TypeError("must be an array"));var k=S.length,E=!1;if(!k)return this.resolve([]);for(var P=-1,D=new this(c);++P<k;)I=S[P],C.resolve(I).then(function(B){E||(E=!0,d.resolve(D,B))},function(B){E||(E=!0,d.reject(D,B))});var I;return D}},{immediate:36}],38:[function(t,n,i){var l={};(0,t("./lib/utils/common").assign)(l,t("./lib/deflate"),t("./lib/inflate"),t("./lib/zlib/constants")),n.exports=l},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(t,n,i){var l=t("./zlib/deflate"),c=t("./utils/common"),d=t("./utils/strings"),u=t("./zlib/messages"),f=t("./zlib/zstream"),p=Object.prototype.toString,m=0,y=-1,w=0,_=8;function x(S){if(!(this instanceof x))return new x(S);this.options=c.assign({level:y,method:_,chunkSize:16384,windowBits:15,memLevel:8,strategy:w,to:""},S||{});var C=this.options;C.raw&&0<C.windowBits?C.windowBits=-C.windowBits:C.gzip&&0<C.windowBits&&C.windowBits<16&&(C.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new f,this.strm.avail_out=0;var k=l.deflateInit2(this.strm,C.level,C.method,C.windowBits,C.memLevel,C.strategy);if(k!==m)throw new Error(u[k]);if(C.header&&l.deflateSetHeader(this.strm,C.header),C.dictionary){var E;if(E=typeof C.dictionary=="string"?d.string2buf(C.dictionary):p.call(C.dictionary)==="[object ArrayBuffer]"?new Uint8Array(C.dictionary):C.dictionary,(k=l.deflateSetDictionary(this.strm,E))!==m)throw new Error(u[k]);this._dict_set=!0}}function v(S,C){var k=new x(C);if(k.push(S,!0),k.err)throw k.msg||u[k.err];return k.result}x.prototype.push=function(S,C){var k,E,P=this.strm,D=this.options.chunkSize;if(this.ended)return!1;E=C===~~C?C:C===!0?4:0,typeof S=="string"?P.input=d.string2buf(S):p.call(S)==="[object ArrayBuffer]"?P.input=new Uint8Array(S):P.input=S,P.next_in=0,P.avail_in=P.input.length;do{if(P.avail_out===0&&(P.output=new c.Buf8(D),P.next_out=0,P.avail_out=D),(k=l.deflate(P,E))!==1&&k!==m)return this.onEnd(k),!(this.ended=!0);P.avail_out!==0&&(P.avail_in!==0||E!==4&&E!==2)||(this.options.to==="string"?this.onData(d.buf2binstring(c.shrinkBuf(P.output,P.next_out))):this.onData(c.shrinkBuf(P.output,P.next_out)))}while((0<P.avail_in||P.avail_out===0)&&k!==1);return E===4?(k=l.deflateEnd(this.strm),this.onEnd(k),this.ended=!0,k===m):E!==2||(this.onEnd(m),!(P.avail_out=0))},x.prototype.onData=function(S){this.chunks.push(S)},x.prototype.onEnd=function(S){S===m&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=c.flattenChunks(this.chunks)),this.chunks=[],this.err=S,this.msg=this.strm.msg},i.Deflate=x,i.deflate=v,i.deflateRaw=function(S,C){return(C=C||{}).raw=!0,v(S,C)},i.gzip=function(S,C){return(C=C||{}).gzip=!0,v(S,C)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(t,n,i){var l=t("./zlib/inflate"),c=t("./utils/common"),d=t("./utils/strings"),u=t("./zlib/constants"),f=t("./zlib/messages"),p=t("./zlib/zstream"),m=t("./zlib/gzheader"),y=Object.prototype.toString;function w(x){if(!(this instanceof w))return new w(x);this.options=c.assign({chunkSize:16384,windowBits:0,to:""},x||{});var v=this.options;v.raw&&0<=v.windowBits&&v.windowBits<16&&(v.windowBits=-v.windowBits,v.windowBits===0&&(v.windowBits=-15)),!(0<=v.windowBits&&v.windowBits<16)||x&&x.windowBits||(v.windowBits+=32),15<v.windowBits&&v.windowBits<48&&!(15&v.windowBits)&&(v.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new p,this.strm.avail_out=0;var S=l.inflateInit2(this.strm,v.windowBits);if(S!==u.Z_OK)throw new Error(f[S]);this.header=new m,l.inflateGetHeader(this.strm,this.header)}function _(x,v){var S=new w(v);if(S.push(x,!0),S.err)throw S.msg||f[S.err];return S.result}w.prototype.push=function(x,v){var S,C,k,E,P,D,I=this.strm,B=this.options.chunkSize,z=this.options.dictionary,X=!1;if(this.ended)return!1;C=v===~~v?v:v===!0?u.Z_FINISH:u.Z_NO_FLUSH,typeof x=="string"?I.input=d.binstring2buf(x):y.call(x)==="[object ArrayBuffer]"?I.input=new Uint8Array(x):I.input=x,I.next_in=0,I.avail_in=I.input.length;do{if(I.avail_out===0&&(I.output=new c.Buf8(B),I.next_out=0,I.avail_out=B),(S=l.inflate(I,u.Z_NO_FLUSH))===u.Z_NEED_DICT&&z&&(D=typeof z=="string"?d.string2buf(z):y.call(z)==="[object ArrayBuffer]"?new Uint8Array(z):z,S=l.inflateSetDictionary(this.strm,D)),S===u.Z_BUF_ERROR&&X===!0&&(S=u.Z_OK,X=!1),S!==u.Z_STREAM_END&&S!==u.Z_OK)return this.onEnd(S),!(this.ended=!0);I.next_out&&(I.avail_out!==0&&S!==u.Z_STREAM_END&&(I.avail_in!==0||C!==u.Z_FINISH&&C!==u.Z_SYNC_FLUSH)||(this.options.to==="string"?(k=d.utf8border(I.output,I.next_out),E=I.next_out-k,P=d.buf2string(I.output,k),I.next_out=E,I.avail_out=B-E,E&&c.arraySet(I.output,I.output,k,E,0),this.onData(P)):this.onData(c.shrinkBuf(I.output,I.next_out)))),I.avail_in===0&&I.avail_out===0&&(X=!0)}while((0<I.avail_in||I.avail_out===0)&&S!==u.Z_STREAM_END);return S===u.Z_STREAM_END&&(C=u.Z_FINISH),C===u.Z_FINISH?(S=l.inflateEnd(this.strm),this.onEnd(S),this.ended=!0,S===u.Z_OK):C!==u.Z_SYNC_FLUSH||(this.onEnd(u.Z_OK),!(I.avail_out=0))},w.prototype.onData=function(x){this.chunks.push(x)},w.prototype.onEnd=function(x){x===u.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=c.flattenChunks(this.chunks)),this.chunks=[],this.err=x,this.msg=this.strm.msg},i.Inflate=w,i.inflate=_,i.inflateRaw=function(x,v){return(v=v||{}).raw=!0,_(x,v)},i.ungzip=_},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(t,n,i){var l=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";i.assign=function(u){for(var f=Array.prototype.slice.call(arguments,1);f.length;){var p=f.shift();if(p){if(typeof p!="object")throw new TypeError(p+"must be non-object");for(var m in p)p.hasOwnProperty(m)&&(u[m]=p[m])}}return u},i.shrinkBuf=function(u,f){return u.length===f?u:u.subarray?u.subarray(0,f):(u.length=f,u)};var c={arraySet:function(u,f,p,m,y){if(f.subarray&&u.subarray)u.set(f.subarray(p,p+m),y);else for(var w=0;w<m;w++)u[y+w]=f[p+w]},flattenChunks:function(u){var f,p,m,y,w,_;for(f=m=0,p=u.length;f<p;f++)m+=u[f].length;for(_=new Uint8Array(m),f=y=0,p=u.length;f<p;f++)w=u[f],_.set(w,y),y+=w.length;return _}},d={arraySet:function(u,f,p,m,y){for(var w=0;w<m;w++)u[y+w]=f[p+w]},flattenChunks:function(u){return[].concat.apply([],u)}};i.setTyped=function(u){u?(i.Buf8=Uint8Array,i.Buf16=Uint16Array,i.Buf32=Int32Array,i.assign(i,c)):(i.Buf8=Array,i.Buf16=Array,i.Buf32=Array,i.assign(i,d))},i.setTyped(l)},{}],42:[function(t,n,i){var l=t("./common"),c=!0,d=!0;try{String.fromCharCode.apply(null,[0])}catch{c=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{d=!1}for(var u=new l.Buf8(256),f=0;f<256;f++)u[f]=252<=f?6:248<=f?5:240<=f?4:224<=f?3:192<=f?2:1;function p(m,y){if(y<65537&&(m.subarray&&d||!m.subarray&&c))return String.fromCharCode.apply(null,l.shrinkBuf(m,y));for(var w="",_=0;_<y;_++)w+=String.fromCharCode(m[_]);return w}u[254]=u[254]=1,i.string2buf=function(m){var y,w,_,x,v,S=m.length,C=0;for(x=0;x<S;x++)(64512&(w=m.charCodeAt(x)))==55296&&x+1<S&&(64512&(_=m.charCodeAt(x+1)))==56320&&(w=65536+(w-55296<<10)+(_-56320),x++),C+=w<128?1:w<2048?2:w<65536?3:4;for(y=new l.Buf8(C),x=v=0;v<C;x++)(64512&(w=m.charCodeAt(x)))==55296&&x+1<S&&(64512&(_=m.charCodeAt(x+1)))==56320&&(w=65536+(w-55296<<10)+(_-56320),x++),w<128?y[v++]=w:(w<2048?y[v++]=192|w>>>6:(w<65536?y[v++]=224|w>>>12:(y[v++]=240|w>>>18,y[v++]=128|w>>>12&63),y[v++]=128|w>>>6&63),y[v++]=128|63&w);return y},i.buf2binstring=function(m){return p(m,m.length)},i.binstring2buf=function(m){for(var y=new l.Buf8(m.length),w=0,_=y.length;w<_;w++)y[w]=m.charCodeAt(w);return y},i.buf2string=function(m,y){var w,_,x,v,S=y||m.length,C=new Array(2*S);for(w=_=0;w<S;)if((x=m[w++])<128)C[_++]=x;else if(4<(v=u[x]))C[_++]=65533,w+=v-1;else{for(x&=v===2?31:v===3?15:7;1<v&&w<S;)x=x<<6|63&m[w++],v--;1<v?C[_++]=65533:x<65536?C[_++]=x:(x-=65536,C[_++]=55296|x>>10&1023,C[_++]=56320|1023&x)}return p(C,_)},i.utf8border=function(m,y){var w;for((y=y||m.length)>m.length&&(y=m.length),w=y-1;0<=w&&(192&m[w])==128;)w--;return w<0||w===0?y:w+u[m[w]]>y?w:y}},{"./common":41}],43:[function(t,n,i){n.exports=function(l,c,d,u){for(var f=65535&l|0,p=l>>>16&65535|0,m=0;d!==0;){for(d-=m=2e3<d?2e3:d;p=p+(f=f+c[u++]|0)|0,--m;);f%=65521,p%=65521}return f|p<<16|0}},{}],44:[function(t,n,i){n.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(t,n,i){var l=function(){for(var c,d=[],u=0;u<256;u++){c=u;for(var f=0;f<8;f++)c=1&c?3988292384^c>>>1:c>>>1;d[u]=c}return d}();n.exports=function(c,d,u,f){var p=l,m=f+u;c^=-1;for(var y=f;y<m;y++)c=c>>>8^p[255&(c^d[y])];return-1^c}},{}],46:[function(t,n,i){var l,c=t("../utils/common"),d=t("./trees"),u=t("./adler32"),f=t("./crc32"),p=t("./messages"),m=0,y=4,w=0,_=-2,x=-1,v=4,S=2,C=8,k=9,E=286,P=30,D=19,I=2*E+1,B=15,z=3,X=258,se=X+z+1,R=42,H=113,j=1,G=2,Q=3,K=4;function J(A,oe){return A.msg=p[oe],oe}function ee(A){return(A<<1)-(4<A?9:0)}function be(A){for(var oe=A.length;0<=--oe;)A[oe]=0}function V(A){var oe=A.state,ne=oe.pending;ne>A.avail_out&&(ne=A.avail_out),ne!==0&&(c.arraySet(A.output,oe.pending_buf,oe.pending_out,ne,A.next_out),A.next_out+=ne,oe.pending_out+=ne,A.total_out+=ne,A.avail_out-=ne,oe.pending-=ne,oe.pending===0&&(oe.pending_out=0))}function Y(A,oe){d._tr_flush_block(A,0<=A.block_start?A.block_start:-1,A.strstart-A.block_start,oe),A.block_start=A.strstart,V(A.strm)}function Se(A,oe){A.pending_buf[A.pending++]=oe}function Ce(A,oe){A.pending_buf[A.pending++]=oe>>>8&255,A.pending_buf[A.pending++]=255&oe}function ye(A,oe){var ne,L,M=A.max_chain_length,U=A.strstart,le=A.prev_length,ue=A.nice_match,Z=A.strstart>A.w_size-se?A.strstart-(A.w_size-se):0,pe=A.window,ke=A.w_mask,xe=A.prev,Oe=A.strstart+X,tt=pe[U+le-1],Ve=pe[U+le];A.prev_length>=A.good_match&&(M>>=2),ue>A.lookahead&&(ue=A.lookahead);do if(pe[(ne=oe)+le]===Ve&&pe[ne+le-1]===tt&&pe[ne]===pe[U]&&pe[++ne]===pe[U+1]){U+=2,ne++;do;while(pe[++U]===pe[++ne]&&pe[++U]===pe[++ne]&&pe[++U]===pe[++ne]&&pe[++U]===pe[++ne]&&pe[++U]===pe[++ne]&&pe[++U]===pe[++ne]&&pe[++U]===pe[++ne]&&pe[++U]===pe[++ne]&&U<Oe);if(L=X-(Oe-U),U=Oe-X,le<L){if(A.match_start=oe,ue<=(le=L))break;tt=pe[U+le-1],Ve=pe[U+le]}}while((oe=xe[oe&ke])>Z&&--M!=0);return le<=A.lookahead?le:A.lookahead}function at(A){var oe,ne,L,M,U,le,ue,Z,pe,ke,xe=A.w_size;do{if(M=A.window_size-A.lookahead-A.strstart,A.strstart>=xe+(xe-se)){for(c.arraySet(A.window,A.window,xe,xe,0),A.match_start-=xe,A.strstart-=xe,A.block_start-=xe,oe=ne=A.hash_size;L=A.head[--oe],A.head[oe]=xe<=L?L-xe:0,--ne;);for(oe=ne=xe;L=A.prev[--oe],A.prev[oe]=xe<=L?L-xe:0,--ne;);M+=xe}if(A.strm.avail_in===0)break;if(le=A.strm,ue=A.window,Z=A.strstart+A.lookahead,pe=M,ke=void 0,ke=le.avail_in,pe<ke&&(ke=pe),ne=ke===0?0:(le.avail_in-=ke,c.arraySet(ue,le.input,le.next_in,ke,Z),le.state.wrap===1?le.adler=u(le.adler,ue,ke,Z):le.state.wrap===2&&(le.adler=f(le.adler,ue,ke,Z)),le.next_in+=ke,le.total_in+=ke,ke),A.lookahead+=ne,A.lookahead+A.insert>=z)for(U=A.strstart-A.insert,A.ins_h=A.window[U],A.ins_h=(A.ins_h<<A.hash_shift^A.window[U+1])&A.hash_mask;A.insert&&(A.ins_h=(A.ins_h<<A.hash_shift^A.window[U+z-1])&A.hash_mask,A.prev[U&A.w_mask]=A.head[A.ins_h],A.head[A.ins_h]=U,U++,A.insert--,!(A.lookahead+A.insert<z)););}while(A.lookahead<se&&A.strm.avail_in!==0)}function gt(A,oe){for(var ne,L;;){if(A.lookahead<se){if(at(A),A.lookahead<se&&oe===m)return j;if(A.lookahead===0)break}if(ne=0,A.lookahead>=z&&(A.ins_h=(A.ins_h<<A.hash_shift^A.window[A.strstart+z-1])&A.hash_mask,ne=A.prev[A.strstart&A.w_mask]=A.head[A.ins_h],A.head[A.ins_h]=A.strstart),ne!==0&&A.strstart-ne<=A.w_size-se&&(A.match_length=ye(A,ne)),A.match_length>=z)if(L=d._tr_tally(A,A.strstart-A.match_start,A.match_length-z),A.lookahead-=A.match_length,A.match_length<=A.max_lazy_match&&A.lookahead>=z){for(A.match_length--;A.strstart++,A.ins_h=(A.ins_h<<A.hash_shift^A.window[A.strstart+z-1])&A.hash_mask,ne=A.prev[A.strstart&A.w_mask]=A.head[A.ins_h],A.head[A.ins_h]=A.strstart,--A.match_length!=0;);A.strstart++}else A.strstart+=A.match_length,A.match_length=0,A.ins_h=A.window[A.strstart],A.ins_h=(A.ins_h<<A.hash_shift^A.window[A.strstart+1])&A.hash_mask;else L=d._tr_tally(A,0,A.window[A.strstart]),A.lookahead--,A.strstart++;if(L&&(Y(A,!1),A.strm.avail_out===0))return j}return A.insert=A.strstart<z-1?A.strstart:z-1,oe===y?(Y(A,!0),A.strm.avail_out===0?Q:K):A.last_lit&&(Y(A,!1),A.strm.avail_out===0)?j:G}function Ge(A,oe){for(var ne,L,M;;){if(A.lookahead<se){if(at(A),A.lookahead<se&&oe===m)return j;if(A.lookahead===0)break}if(ne=0,A.lookahead>=z&&(A.ins_h=(A.ins_h<<A.hash_shift^A.window[A.strstart+z-1])&A.hash_mask,ne=A.prev[A.strstart&A.w_mask]=A.head[A.ins_h],A.head[A.ins_h]=A.strstart),A.prev_length=A.match_length,A.prev_match=A.match_start,A.match_length=z-1,ne!==0&&A.prev_length<A.max_lazy_match&&A.strstart-ne<=A.w_size-se&&(A.match_length=ye(A,ne),A.match_length<=5&&(A.strategy===1||A.match_length===z&&4096<A.strstart-A.match_start)&&(A.match_length=z-1)),A.prev_length>=z&&A.match_length<=A.prev_length){for(M=A.strstart+A.lookahead-z,L=d._tr_tally(A,A.strstart-1-A.prev_match,A.prev_length-z),A.lookahead-=A.prev_length-1,A.prev_length-=2;++A.strstart<=M&&(A.ins_h=(A.ins_h<<A.hash_shift^A.window[A.strstart+z-1])&A.hash_mask,ne=A.prev[A.strstart&A.w_mask]=A.head[A.ins_h],A.head[A.ins_h]=A.strstart),--A.prev_length!=0;);if(A.match_available=0,A.match_length=z-1,A.strstart++,L&&(Y(A,!1),A.strm.avail_out===0))return j}else if(A.match_available){if((L=d._tr_tally(A,0,A.window[A.strstart-1]))&&Y(A,!1),A.strstart++,A.lookahead--,A.strm.avail_out===0)return j}else A.match_available=1,A.strstart++,A.lookahead--}return A.match_available&&(L=d._tr_tally(A,0,A.window[A.strstart-1]),A.match_available=0),A.insert=A.strstart<z-1?A.strstart:z-1,oe===y?(Y(A,!0),A.strm.avail_out===0?Q:K):A.last_lit&&(Y(A,!1),A.strm.avail_out===0)?j:G}function He(A,oe,ne,L,M){this.good_length=A,this.max_lazy=oe,this.nice_length=ne,this.max_chain=L,this.func=M}function ot(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=C,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new c.Buf16(2*I),this.dyn_dtree=new c.Buf16(2*(2*P+1)),this.bl_tree=new c.Buf16(2*(2*D+1)),be(this.dyn_ltree),be(this.dyn_dtree),be(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new c.Buf16(B+1),this.heap=new c.Buf16(2*E+1),be(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new c.Buf16(2*E+1),be(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function Ue(A){var oe;return A&&A.state?(A.total_in=A.total_out=0,A.data_type=S,(oe=A.state).pending=0,oe.pending_out=0,oe.wrap<0&&(oe.wrap=-oe.wrap),oe.status=oe.wrap?R:H,A.adler=oe.wrap===2?0:1,oe.last_flush=m,d._tr_init(oe),w):J(A,_)}function At(A){var oe=Ue(A);return oe===w&&function(ne){ne.window_size=2*ne.w_size,be(ne.head),ne.max_lazy_match=l[ne.level].max_lazy,ne.good_match=l[ne.level].good_length,ne.nice_match=l[ne.level].nice_length,ne.max_chain_length=l[ne.level].max_chain,ne.strstart=0,ne.block_start=0,ne.lookahead=0,ne.insert=0,ne.match_length=ne.prev_length=z-1,ne.match_available=0,ne.ins_h=0}(A.state),oe}function Qe(A,oe,ne,L,M,U){if(!A)return _;var le=1;if(oe===x&&(oe=6),L<0?(le=0,L=-L):15<L&&(le=2,L-=16),M<1||k<M||ne!==C||L<8||15<L||oe<0||9<oe||U<0||v<U)return J(A,_);L===8&&(L=9);var ue=new ot;return(A.state=ue).strm=A,ue.wrap=le,ue.gzhead=null,ue.w_bits=L,ue.w_size=1<<ue.w_bits,ue.w_mask=ue.w_size-1,ue.hash_bits=M+7,ue.hash_size=1<<ue.hash_bits,ue.hash_mask=ue.hash_size-1,ue.hash_shift=~~((ue.hash_bits+z-1)/z),ue.window=new c.Buf8(2*ue.w_size),ue.head=new c.Buf16(ue.hash_size),ue.prev=new c.Buf16(ue.w_size),ue.lit_bufsize=1<<M+6,ue.pending_buf_size=4*ue.lit_bufsize,ue.pending_buf=new c.Buf8(ue.pending_buf_size),ue.d_buf=1*ue.lit_bufsize,ue.l_buf=3*ue.lit_bufsize,ue.level=oe,ue.strategy=U,ue.method=ne,At(A)}l=[new He(0,0,0,0,function(A,oe){var ne=65535;for(ne>A.pending_buf_size-5&&(ne=A.pending_buf_size-5);;){if(A.lookahead<=1){if(at(A),A.lookahead===0&&oe===m)return j;if(A.lookahead===0)break}A.strstart+=A.lookahead,A.lookahead=0;var L=A.block_start+ne;if((A.strstart===0||A.strstart>=L)&&(A.lookahead=A.strstart-L,A.strstart=L,Y(A,!1),A.strm.avail_out===0)||A.strstart-A.block_start>=A.w_size-se&&(Y(A,!1),A.strm.avail_out===0))return j}return A.insert=0,oe===y?(Y(A,!0),A.strm.avail_out===0?Q:K):(A.strstart>A.block_start&&(Y(A,!1),A.strm.avail_out),j)}),new He(4,4,8,4,gt),new He(4,5,16,8,gt),new He(4,6,32,32,gt),new He(4,4,16,16,Ge),new He(8,16,32,32,Ge),new He(8,16,128,128,Ge),new He(8,32,128,256,Ge),new He(32,128,258,1024,Ge),new He(32,258,258,4096,Ge)],i.deflateInit=function(A,oe){return Qe(A,oe,C,15,8,0)},i.deflateInit2=Qe,i.deflateReset=At,i.deflateResetKeep=Ue,i.deflateSetHeader=function(A,oe){return A&&A.state?A.state.wrap!==2?_:(A.state.gzhead=oe,w):_},i.deflate=function(A,oe){var ne,L,M,U;if(!A||!A.state||5<oe||oe<0)return A?J(A,_):_;if(L=A.state,!A.output||!A.input&&A.avail_in!==0||L.status===666&&oe!==y)return J(A,A.avail_out===0?-5:_);if(L.strm=A,ne=L.last_flush,L.last_flush=oe,L.status===R)if(L.wrap===2)A.adler=0,Se(L,31),Se(L,139),Se(L,8),L.gzhead?(Se(L,(L.gzhead.text?1:0)+(L.gzhead.hcrc?2:0)+(L.gzhead.extra?4:0)+(L.gzhead.name?8:0)+(L.gzhead.comment?16:0)),Se(L,255&L.gzhead.time),Se(L,L.gzhead.time>>8&255),Se(L,L.gzhead.time>>16&255),Se(L,L.gzhead.time>>24&255),Se(L,L.level===9?2:2<=L.strategy||L.level<2?4:0),Se(L,255&L.gzhead.os),L.gzhead.extra&&L.gzhead.extra.length&&(Se(L,255&L.gzhead.extra.length),Se(L,L.gzhead.extra.length>>8&255)),L.gzhead.hcrc&&(A.adler=f(A.adler,L.pending_buf,L.pending,0)),L.gzindex=0,L.status=69):(Se(L,0),Se(L,0),Se(L,0),Se(L,0),Se(L,0),Se(L,L.level===9?2:2<=L.strategy||L.level<2?4:0),Se(L,3),L.status=H);else{var le=C+(L.w_bits-8<<4)<<8;le|=(2<=L.strategy||L.level<2?0:L.level<6?1:L.level===6?2:3)<<6,L.strstart!==0&&(le|=32),le+=31-le%31,L.status=H,Ce(L,le),L.strstart!==0&&(Ce(L,A.adler>>>16),Ce(L,65535&A.adler)),A.adler=1}if(L.status===69)if(L.gzhead.extra){for(M=L.pending;L.gzindex<(65535&L.gzhead.extra.length)&&(L.pending!==L.pending_buf_size||(L.gzhead.hcrc&&L.pending>M&&(A.adler=f(A.adler,L.pending_buf,L.pending-M,M)),V(A),M=L.pending,L.pending!==L.pending_buf_size));)Se(L,255&L.gzhead.extra[L.gzindex]),L.gzindex++;L.gzhead.hcrc&&L.pending>M&&(A.adler=f(A.adler,L.pending_buf,L.pending-M,M)),L.gzindex===L.gzhead.extra.length&&(L.gzindex=0,L.status=73)}else L.status=73;if(L.status===73)if(L.gzhead.name){M=L.pending;do{if(L.pending===L.pending_buf_size&&(L.gzhead.hcrc&&L.pending>M&&(A.adler=f(A.adler,L.pending_buf,L.pending-M,M)),V(A),M=L.pending,L.pending===L.pending_buf_size)){U=1;break}U=L.gzindex<L.gzhead.name.length?255&L.gzhead.name.charCodeAt(L.gzindex++):0,Se(L,U)}while(U!==0);L.gzhead.hcrc&&L.pending>M&&(A.adler=f(A.adler,L.pending_buf,L.pending-M,M)),U===0&&(L.gzindex=0,L.status=91)}else L.status=91;if(L.status===91)if(L.gzhead.comment){M=L.pending;do{if(L.pending===L.pending_buf_size&&(L.gzhead.hcrc&&L.pending>M&&(A.adler=f(A.adler,L.pending_buf,L.pending-M,M)),V(A),M=L.pending,L.pending===L.pending_buf_size)){U=1;break}U=L.gzindex<L.gzhead.comment.length?255&L.gzhead.comment.charCodeAt(L.gzindex++):0,Se(L,U)}while(U!==0);L.gzhead.hcrc&&L.pending>M&&(A.adler=f(A.adler,L.pending_buf,L.pending-M,M)),U===0&&(L.status=103)}else L.status=103;if(L.status===103&&(L.gzhead.hcrc?(L.pending+2>L.pending_buf_size&&V(A),L.pending+2<=L.pending_buf_size&&(Se(L,255&A.adler),Se(L,A.adler>>8&255),A.adler=0,L.status=H)):L.status=H),L.pending!==0){if(V(A),A.avail_out===0)return L.last_flush=-1,w}else if(A.avail_in===0&&ee(oe)<=ee(ne)&&oe!==y)return J(A,-5);if(L.status===666&&A.avail_in!==0)return J(A,-5);if(A.avail_in!==0||L.lookahead!==0||oe!==m&&L.status!==666){var ue=L.strategy===2?function(Z,pe){for(var ke;;){if(Z.lookahead===0&&(at(Z),Z.lookahead===0)){if(pe===m)return j;break}if(Z.match_length=0,ke=d._tr_tally(Z,0,Z.window[Z.strstart]),Z.lookahead--,Z.strstart++,ke&&(Y(Z,!1),Z.strm.avail_out===0))return j}return Z.insert=0,pe===y?(Y(Z,!0),Z.strm.avail_out===0?Q:K):Z.last_lit&&(Y(Z,!1),Z.strm.avail_out===0)?j:G}(L,oe):L.strategy===3?function(Z,pe){for(var ke,xe,Oe,tt,Ve=Z.window;;){if(Z.lookahead<=X){if(at(Z),Z.lookahead<=X&&pe===m)return j;if(Z.lookahead===0)break}if(Z.match_length=0,Z.lookahead>=z&&0<Z.strstart&&(xe=Ve[Oe=Z.strstart-1])===Ve[++Oe]&&xe===Ve[++Oe]&&xe===Ve[++Oe]){tt=Z.strstart+X;do;while(xe===Ve[++Oe]&&xe===Ve[++Oe]&&xe===Ve[++Oe]&&xe===Ve[++Oe]&&xe===Ve[++Oe]&&xe===Ve[++Oe]&&xe===Ve[++Oe]&&xe===Ve[++Oe]&&Oe<tt);Z.match_length=X-(tt-Oe),Z.match_length>Z.lookahead&&(Z.match_length=Z.lookahead)}if(Z.match_length>=z?(ke=d._tr_tally(Z,1,Z.match_length-z),Z.lookahead-=Z.match_length,Z.strstart+=Z.match_length,Z.match_length=0):(ke=d._tr_tally(Z,0,Z.window[Z.strstart]),Z.lookahead--,Z.strstart++),ke&&(Y(Z,!1),Z.strm.avail_out===0))return j}return Z.insert=0,pe===y?(Y(Z,!0),Z.strm.avail_out===0?Q:K):Z.last_lit&&(Y(Z,!1),Z.strm.avail_out===0)?j:G}(L,oe):l[L.level].func(L,oe);if(ue!==Q&&ue!==K||(L.status=666),ue===j||ue===Q)return A.avail_out===0&&(L.last_flush=-1),w;if(ue===G&&(oe===1?d._tr_align(L):oe!==5&&(d._tr_stored_block(L,0,0,!1),oe===3&&(be(L.head),L.lookahead===0&&(L.strstart=0,L.block_start=0,L.insert=0))),V(A),A.avail_out===0))return L.last_flush=-1,w}return oe!==y?w:L.wrap<=0?1:(L.wrap===2?(Se(L,255&A.adler),Se(L,A.adler>>8&255),Se(L,A.adler>>16&255),Se(L,A.adler>>24&255),Se(L,255&A.total_in),Se(L,A.total_in>>8&255),Se(L,A.total_in>>16&255),Se(L,A.total_in>>24&255)):(Ce(L,A.adler>>>16),Ce(L,65535&A.adler)),V(A),0<L.wrap&&(L.wrap=-L.wrap),L.pending!==0?w:1)},i.deflateEnd=function(A){var oe;return A&&A.state?(oe=A.state.status)!==R&&oe!==69&&oe!==73&&oe!==91&&oe!==103&&oe!==H&&oe!==666?J(A,_):(A.state=null,oe===H?J(A,-3):w):_},i.deflateSetDictionary=function(A,oe){var ne,L,M,U,le,ue,Z,pe,ke=oe.length;if(!A||!A.state||(U=(ne=A.state).wrap)===2||U===1&&ne.status!==R||ne.lookahead)return _;for(U===1&&(A.adler=u(A.adler,oe,ke,0)),ne.wrap=0,ke>=ne.w_size&&(U===0&&(be(ne.head),ne.strstart=0,ne.block_start=0,ne.insert=0),pe=new c.Buf8(ne.w_size),c.arraySet(pe,oe,ke-ne.w_size,ne.w_size,0),oe=pe,ke=ne.w_size),le=A.avail_in,ue=A.next_in,Z=A.input,A.avail_in=ke,A.next_in=0,A.input=oe,at(ne);ne.lookahead>=z;){for(L=ne.strstart,M=ne.lookahead-(z-1);ne.ins_h=(ne.ins_h<<ne.hash_shift^ne.window[L+z-1])&ne.hash_mask,ne.prev[L&ne.w_mask]=ne.head[ne.ins_h],ne.head[ne.ins_h]=L,L++,--M;);ne.strstart=L,ne.lookahead=z-1,at(ne)}return ne.strstart+=ne.lookahead,ne.block_start=ne.strstart,ne.insert=ne.lookahead,ne.lookahead=0,ne.match_length=ne.prev_length=z-1,ne.match_available=0,A.next_in=ue,A.input=Z,A.avail_in=le,ne.wrap=U,w},i.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(t,n,i){n.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(t,n,i){n.exports=function(l,c){var d,u,f,p,m,y,w,_,x,v,S,C,k,E,P,D,I,B,z,X,se,R,H,j,G;d=l.state,u=l.next_in,j=l.input,f=u+(l.avail_in-5),p=l.next_out,G=l.output,m=p-(c-l.avail_out),y=p+(l.avail_out-257),w=d.dmax,_=d.wsize,x=d.whave,v=d.wnext,S=d.window,C=d.hold,k=d.bits,E=d.lencode,P=d.distcode,D=(1<<d.lenbits)-1,I=(1<<d.distbits)-1;e:do{k<15&&(C+=j[u++]<<k,k+=8,C+=j[u++]<<k,k+=8),B=E[C&D];t:for(;;){if(C>>>=z=B>>>24,k-=z,(z=B>>>16&255)===0)G[p++]=65535&B;else{if(!(16&z)){if(!(64&z)){B=E[(65535&B)+(C&(1<<z)-1)];continue t}if(32&z){d.mode=12;break e}l.msg="invalid literal/length code",d.mode=30;break e}X=65535&B,(z&=15)&&(k<z&&(C+=j[u++]<<k,k+=8),X+=C&(1<<z)-1,C>>>=z,k-=z),k<15&&(C+=j[u++]<<k,k+=8,C+=j[u++]<<k,k+=8),B=P[C&I];r:for(;;){if(C>>>=z=B>>>24,k-=z,!(16&(z=B>>>16&255))){if(!(64&z)){B=P[(65535&B)+(C&(1<<z)-1)];continue r}l.msg="invalid distance code",d.mode=30;break e}if(se=65535&B,k<(z&=15)&&(C+=j[u++]<<k,(k+=8)<z&&(C+=j[u++]<<k,k+=8)),w<(se+=C&(1<<z)-1)){l.msg="invalid distance too far back",d.mode=30;break e}if(C>>>=z,k-=z,(z=p-m)<se){if(x<(z=se-z)&&d.sane){l.msg="invalid distance too far back",d.mode=30;break e}if(H=S,(R=0)===v){if(R+=_-z,z<X){for(X-=z;G[p++]=S[R++],--z;);R=p-se,H=G}}else if(v<z){if(R+=_+v-z,(z-=v)<X){for(X-=z;G[p++]=S[R++],--z;);if(R=0,v<X){for(X-=z=v;G[p++]=S[R++],--z;);R=p-se,H=G}}}else if(R+=v-z,z<X){for(X-=z;G[p++]=S[R++],--z;);R=p-se,H=G}for(;2<X;)G[p++]=H[R++],G[p++]=H[R++],G[p++]=H[R++],X-=3;X&&(G[p++]=H[R++],1<X&&(G[p++]=H[R++]))}else{for(R=p-se;G[p++]=G[R++],G[p++]=G[R++],G[p++]=G[R++],2<(X-=3););X&&(G[p++]=G[R++],1<X&&(G[p++]=G[R++]))}break}}break}}while(u<f&&p<y);u-=X=k>>3,C&=(1<<(k-=X<<3))-1,l.next_in=u,l.next_out=p,l.avail_in=u<f?f-u+5:5-(u-f),l.avail_out=p<y?y-p+257:257-(p-y),d.hold=C,d.bits=k}},{}],49:[function(t,n,i){var l=t("../utils/common"),c=t("./adler32"),d=t("./crc32"),u=t("./inffast"),f=t("./inftrees"),p=1,m=2,y=0,w=-2,_=1,x=852,v=592;function S(R){return(R>>>24&255)+(R>>>8&65280)+((65280&R)<<8)+((255&R)<<24)}function C(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new l.Buf16(320),this.work=new l.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function k(R){var H;return R&&R.state?(H=R.state,R.total_in=R.total_out=H.total=0,R.msg="",H.wrap&&(R.adler=1&H.wrap),H.mode=_,H.last=0,H.havedict=0,H.dmax=32768,H.head=null,H.hold=0,H.bits=0,H.lencode=H.lendyn=new l.Buf32(x),H.distcode=H.distdyn=new l.Buf32(v),H.sane=1,H.back=-1,y):w}function E(R){var H;return R&&R.state?((H=R.state).wsize=0,H.whave=0,H.wnext=0,k(R)):w}function P(R,H){var j,G;return R&&R.state?(G=R.state,H<0?(j=0,H=-H):(j=1+(H>>4),H<48&&(H&=15)),H&&(H<8||15<H)?w:(G.window!==null&&G.wbits!==H&&(G.window=null),G.wrap=j,G.wbits=H,E(R))):w}function D(R,H){var j,G;return R?(G=new C,(R.state=G).window=null,(j=P(R,H))!==y&&(R.state=null),j):w}var I,B,z=!0;function X(R){if(z){var H;for(I=new l.Buf32(512),B=new l.Buf32(32),H=0;H<144;)R.lens[H++]=8;for(;H<256;)R.lens[H++]=9;for(;H<280;)R.lens[H++]=7;for(;H<288;)R.lens[H++]=8;for(f(p,R.lens,0,288,I,0,R.work,{bits:9}),H=0;H<32;)R.lens[H++]=5;f(m,R.lens,0,32,B,0,R.work,{bits:5}),z=!1}R.lencode=I,R.lenbits=9,R.distcode=B,R.distbits=5}function se(R,H,j,G){var Q,K=R.state;return K.window===null&&(K.wsize=1<<K.wbits,K.wnext=0,K.whave=0,K.window=new l.Buf8(K.wsize)),G>=K.wsize?(l.arraySet(K.window,H,j-K.wsize,K.wsize,0),K.wnext=0,K.whave=K.wsize):(G<(Q=K.wsize-K.wnext)&&(Q=G),l.arraySet(K.window,H,j-G,Q,K.wnext),(G-=Q)?(l.arraySet(K.window,H,j-G,G,0),K.wnext=G,K.whave=K.wsize):(K.wnext+=Q,K.wnext===K.wsize&&(K.wnext=0),K.whave<K.wsize&&(K.whave+=Q))),0}i.inflateReset=E,i.inflateReset2=P,i.inflateResetKeep=k,i.inflateInit=function(R){return D(R,15)},i.inflateInit2=D,i.inflate=function(R,H){var j,G,Q,K,J,ee,be,V,Y,Se,Ce,ye,at,gt,Ge,He,ot,Ue,At,Qe,A,oe,ne,L,M=0,U=new l.Buf8(4),le=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!R||!R.state||!R.output||!R.input&&R.avail_in!==0)return w;(j=R.state).mode===12&&(j.mode=13),J=R.next_out,Q=R.output,be=R.avail_out,K=R.next_in,G=R.input,ee=R.avail_in,V=j.hold,Y=j.bits,Se=ee,Ce=be,oe=y;e:for(;;)switch(j.mode){case _:if(j.wrap===0){j.mode=13;break}for(;Y<16;){if(ee===0)break e;ee--,V+=G[K++]<<Y,Y+=8}if(2&j.wrap&&V===35615){U[j.check=0]=255&V,U[1]=V>>>8&255,j.check=d(j.check,U,2,0),Y=V=0,j.mode=2;break}if(j.flags=0,j.head&&(j.head.done=!1),!(1&j.wrap)||(((255&V)<<8)+(V>>8))%31){R.msg="incorrect header check",j.mode=30;break}if((15&V)!=8){R.msg="unknown compression method",j.mode=30;break}if(Y-=4,A=8+(15&(V>>>=4)),j.wbits===0)j.wbits=A;else if(A>j.wbits){R.msg="invalid window size",j.mode=30;break}j.dmax=1<<A,R.adler=j.check=1,j.mode=512&V?10:12,Y=V=0;break;case 2:for(;Y<16;){if(ee===0)break e;ee--,V+=G[K++]<<Y,Y+=8}if(j.flags=V,(255&j.flags)!=8){R.msg="unknown compression method",j.mode=30;break}if(57344&j.flags){R.msg="unknown header flags set",j.mode=30;break}j.head&&(j.head.text=V>>8&1),512&j.flags&&(U[0]=255&V,U[1]=V>>>8&255,j.check=d(j.check,U,2,0)),Y=V=0,j.mode=3;case 3:for(;Y<32;){if(ee===0)break e;ee--,V+=G[K++]<<Y,Y+=8}j.head&&(j.head.time=V),512&j.flags&&(U[0]=255&V,U[1]=V>>>8&255,U[2]=V>>>16&255,U[3]=V>>>24&255,j.check=d(j.check,U,4,0)),Y=V=0,j.mode=4;case 4:for(;Y<16;){if(ee===0)break e;ee--,V+=G[K++]<<Y,Y+=8}j.head&&(j.head.xflags=255&V,j.head.os=V>>8),512&j.flags&&(U[0]=255&V,U[1]=V>>>8&255,j.check=d(j.check,U,2,0)),Y=V=0,j.mode=5;case 5:if(1024&j.flags){for(;Y<16;){if(ee===0)break e;ee--,V+=G[K++]<<Y,Y+=8}j.length=V,j.head&&(j.head.extra_len=V),512&j.flags&&(U[0]=255&V,U[1]=V>>>8&255,j.check=d(j.check,U,2,0)),Y=V=0}else j.head&&(j.head.extra=null);j.mode=6;case 6:if(1024&j.flags&&(ee<(ye=j.length)&&(ye=ee),ye&&(j.head&&(A=j.head.extra_len-j.length,j.head.extra||(j.head.extra=new Array(j.head.extra_len)),l.arraySet(j.head.extra,G,K,ye,A)),512&j.flags&&(j.check=d(j.check,G,ye,K)),ee-=ye,K+=ye,j.length-=ye),j.length))break e;j.length=0,j.mode=7;case 7:if(2048&j.flags){if(ee===0)break e;for(ye=0;A=G[K+ye++],j.head&&A&&j.length<65536&&(j.head.name+=String.fromCharCode(A)),A&&ye<ee;);if(512&j.flags&&(j.check=d(j.check,G,ye,K)),ee-=ye,K+=ye,A)break e}else j.head&&(j.head.name=null);j.length=0,j.mode=8;case 8:if(4096&j.flags){if(ee===0)break e;for(ye=0;A=G[K+ye++],j.head&&A&&j.length<65536&&(j.head.comment+=String.fromCharCode(A)),A&&ye<ee;);if(512&j.flags&&(j.check=d(j.check,G,ye,K)),ee-=ye,K+=ye,A)break e}else j.head&&(j.head.comment=null);j.mode=9;case 9:if(512&j.flags){for(;Y<16;){if(ee===0)break e;ee--,V+=G[K++]<<Y,Y+=8}if(V!==(65535&j.check)){R.msg="header crc mismatch",j.mode=30;break}Y=V=0}j.head&&(j.head.hcrc=j.flags>>9&1,j.head.done=!0),R.adler=j.check=0,j.mode=12;break;case 10:for(;Y<32;){if(ee===0)break e;ee--,V+=G[K++]<<Y,Y+=8}R.adler=j.check=S(V),Y=V=0,j.mode=11;case 11:if(j.havedict===0)return R.next_out=J,R.avail_out=be,R.next_in=K,R.avail_in=ee,j.hold=V,j.bits=Y,2;R.adler=j.check=1,j.mode=12;case 12:if(H===5||H===6)break e;case 13:if(j.last){V>>>=7&Y,Y-=7&Y,j.mode=27;break}for(;Y<3;){if(ee===0)break e;ee--,V+=G[K++]<<Y,Y+=8}switch(j.last=1&V,Y-=1,3&(V>>>=1)){case 0:j.mode=14;break;case 1:if(X(j),j.mode=20,H!==6)break;V>>>=2,Y-=2;break e;case 2:j.mode=17;break;case 3:R.msg="invalid block type",j.mode=30}V>>>=2,Y-=2;break;case 14:for(V>>>=7&Y,Y-=7&Y;Y<32;){if(ee===0)break e;ee--,V+=G[K++]<<Y,Y+=8}if((65535&V)!=(V>>>16^65535)){R.msg="invalid stored block lengths",j.mode=30;break}if(j.length=65535&V,Y=V=0,j.mode=15,H===6)break e;case 15:j.mode=16;case 16:if(ye=j.length){if(ee<ye&&(ye=ee),be<ye&&(ye=be),ye===0)break e;l.arraySet(Q,G,K,ye,J),ee-=ye,K+=ye,be-=ye,J+=ye,j.length-=ye;break}j.mode=12;break;case 17:for(;Y<14;){if(ee===0)break e;ee--,V+=G[K++]<<Y,Y+=8}if(j.nlen=257+(31&V),V>>>=5,Y-=5,j.ndist=1+(31&V),V>>>=5,Y-=5,j.ncode=4+(15&V),V>>>=4,Y-=4,286<j.nlen||30<j.ndist){R.msg="too many length or distance symbols",j.mode=30;break}j.have=0,j.mode=18;case 18:for(;j.have<j.ncode;){for(;Y<3;){if(ee===0)break e;ee--,V+=G[K++]<<Y,Y+=8}j.lens[le[j.have++]]=7&V,V>>>=3,Y-=3}for(;j.have<19;)j.lens[le[j.have++]]=0;if(j.lencode=j.lendyn,j.lenbits=7,ne={bits:j.lenbits},oe=f(0,j.lens,0,19,j.lencode,0,j.work,ne),j.lenbits=ne.bits,oe){R.msg="invalid code lengths set",j.mode=30;break}j.have=0,j.mode=19;case 19:for(;j.have<j.nlen+j.ndist;){for(;He=(M=j.lencode[V&(1<<j.lenbits)-1])>>>16&255,ot=65535&M,!((Ge=M>>>24)<=Y);){if(ee===0)break e;ee--,V+=G[K++]<<Y,Y+=8}if(ot<16)V>>>=Ge,Y-=Ge,j.lens[j.have++]=ot;else{if(ot===16){for(L=Ge+2;Y<L;){if(ee===0)break e;ee--,V+=G[K++]<<Y,Y+=8}if(V>>>=Ge,Y-=Ge,j.have===0){R.msg="invalid bit length repeat",j.mode=30;break}A=j.lens[j.have-1],ye=3+(3&V),V>>>=2,Y-=2}else if(ot===17){for(L=Ge+3;Y<L;){if(ee===0)break e;ee--,V+=G[K++]<<Y,Y+=8}Y-=Ge,A=0,ye=3+(7&(V>>>=Ge)),V>>>=3,Y-=3}else{for(L=Ge+7;Y<L;){if(ee===0)break e;ee--,V+=G[K++]<<Y,Y+=8}Y-=Ge,A=0,ye=11+(127&(V>>>=Ge)),V>>>=7,Y-=7}if(j.have+ye>j.nlen+j.ndist){R.msg="invalid bit length repeat",j.mode=30;break}for(;ye--;)j.lens[j.have++]=A}}if(j.mode===30)break;if(j.lens[256]===0){R.msg="invalid code -- missing end-of-block",j.mode=30;break}if(j.lenbits=9,ne={bits:j.lenbits},oe=f(p,j.lens,0,j.nlen,j.lencode,0,j.work,ne),j.lenbits=ne.bits,oe){R.msg="invalid literal/lengths set",j.mode=30;break}if(j.distbits=6,j.distcode=j.distdyn,ne={bits:j.distbits},oe=f(m,j.lens,j.nlen,j.ndist,j.distcode,0,j.work,ne),j.distbits=ne.bits,oe){R.msg="invalid distances set",j.mode=30;break}if(j.mode=20,H===6)break e;case 20:j.mode=21;case 21:if(6<=ee&&258<=be){R.next_out=J,R.avail_out=be,R.next_in=K,R.avail_in=ee,j.hold=V,j.bits=Y,u(R,Ce),J=R.next_out,Q=R.output,be=R.avail_out,K=R.next_in,G=R.input,ee=R.avail_in,V=j.hold,Y=j.bits,j.mode===12&&(j.back=-1);break}for(j.back=0;He=(M=j.lencode[V&(1<<j.lenbits)-1])>>>16&255,ot=65535&M,!((Ge=M>>>24)<=Y);){if(ee===0)break e;ee--,V+=G[K++]<<Y,Y+=8}if(He&&!(240&He)){for(Ue=Ge,At=He,Qe=ot;He=(M=j.lencode[Qe+((V&(1<<Ue+At)-1)>>Ue)])>>>16&255,ot=65535&M,!(Ue+(Ge=M>>>24)<=Y);){if(ee===0)break e;ee--,V+=G[K++]<<Y,Y+=8}V>>>=Ue,Y-=Ue,j.back+=Ue}if(V>>>=Ge,Y-=Ge,j.back+=Ge,j.length=ot,He===0){j.mode=26;break}if(32&He){j.back=-1,j.mode=12;break}if(64&He){R.msg="invalid literal/length code",j.mode=30;break}j.extra=15&He,j.mode=22;case 22:if(j.extra){for(L=j.extra;Y<L;){if(ee===0)break e;ee--,V+=G[K++]<<Y,Y+=8}j.length+=V&(1<<j.extra)-1,V>>>=j.extra,Y-=j.extra,j.back+=j.extra}j.was=j.length,j.mode=23;case 23:for(;He=(M=j.distcode[V&(1<<j.distbits)-1])>>>16&255,ot=65535&M,!((Ge=M>>>24)<=Y);){if(ee===0)break e;ee--,V+=G[K++]<<Y,Y+=8}if(!(240&He)){for(Ue=Ge,At=He,Qe=ot;He=(M=j.distcode[Qe+((V&(1<<Ue+At)-1)>>Ue)])>>>16&255,ot=65535&M,!(Ue+(Ge=M>>>24)<=Y);){if(ee===0)break e;ee--,V+=G[K++]<<Y,Y+=8}V>>>=Ue,Y-=Ue,j.back+=Ue}if(V>>>=Ge,Y-=Ge,j.back+=Ge,64&He){R.msg="invalid distance code",j.mode=30;break}j.offset=ot,j.extra=15&He,j.mode=24;case 24:if(j.extra){for(L=j.extra;Y<L;){if(ee===0)break e;ee--,V+=G[K++]<<Y,Y+=8}j.offset+=V&(1<<j.extra)-1,V>>>=j.extra,Y-=j.extra,j.back+=j.extra}if(j.offset>j.dmax){R.msg="invalid distance too far back",j.mode=30;break}j.mode=25;case 25:if(be===0)break e;if(ye=Ce-be,j.offset>ye){if((ye=j.offset-ye)>j.whave&&j.sane){R.msg="invalid distance too far back",j.mode=30;break}at=ye>j.wnext?(ye-=j.wnext,j.wsize-ye):j.wnext-ye,ye>j.length&&(ye=j.length),gt=j.window}else gt=Q,at=J-j.offset,ye=j.length;for(be<ye&&(ye=be),be-=ye,j.length-=ye;Q[J++]=gt[at++],--ye;);j.length===0&&(j.mode=21);break;case 26:if(be===0)break e;Q[J++]=j.length,be--,j.mode=21;break;case 27:if(j.wrap){for(;Y<32;){if(ee===0)break e;ee--,V|=G[K++]<<Y,Y+=8}if(Ce-=be,R.total_out+=Ce,j.total+=Ce,Ce&&(R.adler=j.check=j.flags?d(j.check,Q,Ce,J-Ce):c(j.check,Q,Ce,J-Ce)),Ce=be,(j.flags?V:S(V))!==j.check){R.msg="incorrect data check",j.mode=30;break}Y=V=0}j.mode=28;case 28:if(j.wrap&&j.flags){for(;Y<32;){if(ee===0)break e;ee--,V+=G[K++]<<Y,Y+=8}if(V!==(4294967295&j.total)){R.msg="incorrect length check",j.mode=30;break}Y=V=0}j.mode=29;case 29:oe=1;break e;case 30:oe=-3;break e;case 31:return-4;case 32:default:return w}return R.next_out=J,R.avail_out=be,R.next_in=K,R.avail_in=ee,j.hold=V,j.bits=Y,(j.wsize||Ce!==R.avail_out&&j.mode<30&&(j.mode<27||H!==4))&&se(R,R.output,R.next_out,Ce-R.avail_out)?(j.mode=31,-4):(Se-=R.avail_in,Ce-=R.avail_out,R.total_in+=Se,R.total_out+=Ce,j.total+=Ce,j.wrap&&Ce&&(R.adler=j.check=j.flags?d(j.check,Q,Ce,R.next_out-Ce):c(j.check,Q,Ce,R.next_out-Ce)),R.data_type=j.bits+(j.last?64:0)+(j.mode===12?128:0)+(j.mode===20||j.mode===15?256:0),(Se==0&&Ce===0||H===4)&&oe===y&&(oe=-5),oe)},i.inflateEnd=function(R){if(!R||!R.state)return w;var H=R.state;return H.window&&(H.window=null),R.state=null,y},i.inflateGetHeader=function(R,H){var j;return R&&R.state&&2&(j=R.state).wrap?((j.head=H).done=!1,y):w},i.inflateSetDictionary=function(R,H){var j,G=H.length;return R&&R.state?(j=R.state).wrap!==0&&j.mode!==11?w:j.mode===11&&c(1,H,G,0)!==j.check?-3:se(R,H,G,G)?(j.mode=31,-4):(j.havedict=1,y):w},i.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(t,n,i){var l=t("../utils/common"),c=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],d=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],u=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],f=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];n.exports=function(p,m,y,w,_,x,v,S){var C,k,E,P,D,I,B,z,X,se=S.bits,R=0,H=0,j=0,G=0,Q=0,K=0,J=0,ee=0,be=0,V=0,Y=null,Se=0,Ce=new l.Buf16(16),ye=new l.Buf16(16),at=null,gt=0;for(R=0;R<=15;R++)Ce[R]=0;for(H=0;H<w;H++)Ce[m[y+H]]++;for(Q=se,G=15;1<=G&&Ce[G]===0;G--);if(G<Q&&(Q=G),G===0)return _[x++]=20971520,_[x++]=20971520,S.bits=1,0;for(j=1;j<G&&Ce[j]===0;j++);for(Q<j&&(Q=j),R=ee=1;R<=15;R++)if(ee<<=1,(ee-=Ce[R])<0)return-1;if(0<ee&&(p===0||G!==1))return-1;for(ye[1]=0,R=1;R<15;R++)ye[R+1]=ye[R]+Ce[R];for(H=0;H<w;H++)m[y+H]!==0&&(v[ye[m[y+H]]++]=H);if(I=p===0?(Y=at=v,19):p===1?(Y=c,Se-=257,at=d,gt-=257,256):(Y=u,at=f,-1),R=j,D=x,J=H=V=0,E=-1,P=(be=1<<(K=Q))-1,p===1&&852<be||p===2&&592<be)return 1;for(;;){for(B=R-J,X=v[H]<I?(z=0,v[H]):v[H]>I?(z=at[gt+v[H]],Y[Se+v[H]]):(z=96,0),C=1<<R-J,j=k=1<<K;_[D+(V>>J)+(k-=C)]=B<<24|z<<16|X|0,k!==0;);for(C=1<<R-1;V&C;)C>>=1;if(C!==0?(V&=C-1,V+=C):V=0,H++,--Ce[R]==0){if(R===G)break;R=m[y+v[H]]}if(Q<R&&(V&P)!==E){for(J===0&&(J=Q),D+=j,ee=1<<(K=R-J);K+J<G&&!((ee-=Ce[K+J])<=0);)K++,ee<<=1;if(be+=1<<K,p===1&&852<be||p===2&&592<be)return 1;_[E=V&P]=Q<<24|K<<16|D-x|0}}return V!==0&&(_[D+V]=R-J<<24|64<<16|0),S.bits=Q,0}},{"../utils/common":41}],51:[function(t,n,i){n.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(t,n,i){var l=t("../utils/common"),c=0,d=1;function u(M){for(var U=M.length;0<=--U;)M[U]=0}var f=0,p=29,m=256,y=m+1+p,w=30,_=19,x=2*y+1,v=15,S=16,C=7,k=256,E=16,P=17,D=18,I=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],B=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],z=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],X=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],se=new Array(2*(y+2));u(se);var R=new Array(2*w);u(R);var H=new Array(512);u(H);var j=new Array(256);u(j);var G=new Array(p);u(G);var Q,K,J,ee=new Array(w);function be(M,U,le,ue,Z){this.static_tree=M,this.extra_bits=U,this.extra_base=le,this.elems=ue,this.max_length=Z,this.has_stree=M&&M.length}function V(M,U){this.dyn_tree=M,this.max_code=0,this.stat_desc=U}function Y(M){return M<256?H[M]:H[256+(M>>>7)]}function Se(M,U){M.pending_buf[M.pending++]=255&U,M.pending_buf[M.pending++]=U>>>8&255}function Ce(M,U,le){M.bi_valid>S-le?(M.bi_buf|=U<<M.bi_valid&65535,Se(M,M.bi_buf),M.bi_buf=U>>S-M.bi_valid,M.bi_valid+=le-S):(M.bi_buf|=U<<M.bi_valid&65535,M.bi_valid+=le)}function ye(M,U,le){Ce(M,le[2*U],le[2*U+1])}function at(M,U){for(var le=0;le|=1&M,M>>>=1,le<<=1,0<--U;);return le>>>1}function gt(M,U,le){var ue,Z,pe=new Array(v+1),ke=0;for(ue=1;ue<=v;ue++)pe[ue]=ke=ke+le[ue-1]<<1;for(Z=0;Z<=U;Z++){var xe=M[2*Z+1];xe!==0&&(M[2*Z]=at(pe[xe]++,xe))}}function Ge(M){var U;for(U=0;U<y;U++)M.dyn_ltree[2*U]=0;for(U=0;U<w;U++)M.dyn_dtree[2*U]=0;for(U=0;U<_;U++)M.bl_tree[2*U]=0;M.dyn_ltree[2*k]=1,M.opt_len=M.static_len=0,M.last_lit=M.matches=0}function He(M){8<M.bi_valid?Se(M,M.bi_buf):0<M.bi_valid&&(M.pending_buf[M.pending++]=M.bi_buf),M.bi_buf=0,M.bi_valid=0}function ot(M,U,le,ue){var Z=2*U,pe=2*le;return M[Z]<M[pe]||M[Z]===M[pe]&&ue[U]<=ue[le]}function Ue(M,U,le){for(var ue=M.heap[le],Z=le<<1;Z<=M.heap_len&&(Z<M.heap_len&&ot(U,M.heap[Z+1],M.heap[Z],M.depth)&&Z++,!ot(U,ue,M.heap[Z],M.depth));)M.heap[le]=M.heap[Z],le=Z,Z<<=1;M.heap[le]=ue}function At(M,U,le){var ue,Z,pe,ke,xe=0;if(M.last_lit!==0)for(;ue=M.pending_buf[M.d_buf+2*xe]<<8|M.pending_buf[M.d_buf+2*xe+1],Z=M.pending_buf[M.l_buf+xe],xe++,ue===0?ye(M,Z,U):(ye(M,(pe=j[Z])+m+1,U),(ke=I[pe])!==0&&Ce(M,Z-=G[pe],ke),ye(M,pe=Y(--ue),le),(ke=B[pe])!==0&&Ce(M,ue-=ee[pe],ke)),xe<M.last_lit;);ye(M,k,U)}function Qe(M,U){var le,ue,Z,pe=U.dyn_tree,ke=U.stat_desc.static_tree,xe=U.stat_desc.has_stree,Oe=U.stat_desc.elems,tt=-1;for(M.heap_len=0,M.heap_max=x,le=0;le<Oe;le++)pe[2*le]!==0?(M.heap[++M.heap_len]=tt=le,M.depth[le]=0):pe[2*le+1]=0;for(;M.heap_len<2;)pe[2*(Z=M.heap[++M.heap_len]=tt<2?++tt:0)]=1,M.depth[Z]=0,M.opt_len--,xe&&(M.static_len-=ke[2*Z+1]);for(U.max_code=tt,le=M.heap_len>>1;1<=le;le--)Ue(M,pe,le);for(Z=Oe;le=M.heap[1],M.heap[1]=M.heap[M.heap_len--],Ue(M,pe,1),ue=M.heap[1],M.heap[--M.heap_max]=le,M.heap[--M.heap_max]=ue,pe[2*Z]=pe[2*le]+pe[2*ue],M.depth[Z]=(M.depth[le]>=M.depth[ue]?M.depth[le]:M.depth[ue])+1,pe[2*le+1]=pe[2*ue+1]=Z,M.heap[1]=Z++,Ue(M,pe,1),2<=M.heap_len;);M.heap[--M.heap_max]=M.heap[1],function(Ve,Et){var vr,Yt,hn,De,_e,Re,Me=Et.dyn_tree,Xe=Et.max_code,Ft=Et.stat_desc.static_tree,fe=Et.stat_desc.has_stree,Pe=Et.stat_desc.extra_bits,Fe=Et.stat_desc.extra_base,Wt=Et.stat_desc.max_length,Nt=0;for(De=0;De<=v;De++)Ve.bl_count[De]=0;for(Me[2*Ve.heap[Ve.heap_max]+1]=0,vr=Ve.heap_max+1;vr<x;vr++)Wt<(De=Me[2*Me[2*(Yt=Ve.heap[vr])+1]+1]+1)&&(De=Wt,Nt++),Me[2*Yt+1]=De,Xe<Yt||(Ve.bl_count[De]++,_e=0,Fe<=Yt&&(_e=Pe[Yt-Fe]),Re=Me[2*Yt],Ve.opt_len+=Re*(De+_e),fe&&(Ve.static_len+=Re*(Ft[2*Yt+1]+_e)));if(Nt!==0){do{for(De=Wt-1;Ve.bl_count[De]===0;)De--;Ve.bl_count[De]--,Ve.bl_count[De+1]+=2,Ve.bl_count[Wt]--,Nt-=2}while(0<Nt);for(De=Wt;De!==0;De--)for(Yt=Ve.bl_count[De];Yt!==0;)Xe<(hn=Ve.heap[--vr])||(Me[2*hn+1]!==De&&(Ve.opt_len+=(De-Me[2*hn+1])*Me[2*hn],Me[2*hn+1]=De),Yt--)}}(M,U),gt(pe,tt,M.bl_count)}function A(M,U,le){var ue,Z,pe=-1,ke=U[1],xe=0,Oe=7,tt=4;for(ke===0&&(Oe=138,tt=3),U[2*(le+1)+1]=65535,ue=0;ue<=le;ue++)Z=ke,ke=U[2*(ue+1)+1],++xe<Oe&&Z===ke||(xe<tt?M.bl_tree[2*Z]+=xe:Z!==0?(Z!==pe&&M.bl_tree[2*Z]++,M.bl_tree[2*E]++):xe<=10?M.bl_tree[2*P]++:M.bl_tree[2*D]++,pe=Z,tt=(xe=0)===ke?(Oe=138,3):Z===ke?(Oe=6,3):(Oe=7,4))}function oe(M,U,le){var ue,Z,pe=-1,ke=U[1],xe=0,Oe=7,tt=4;for(ke===0&&(Oe=138,tt=3),ue=0;ue<=le;ue++)if(Z=ke,ke=U[2*(ue+1)+1],!(++xe<Oe&&Z===ke)){if(xe<tt)for(;ye(M,Z,M.bl_tree),--xe!=0;);else Z!==0?(Z!==pe&&(ye(M,Z,M.bl_tree),xe--),ye(M,E,M.bl_tree),Ce(M,xe-3,2)):xe<=10?(ye(M,P,M.bl_tree),Ce(M,xe-3,3)):(ye(M,D,M.bl_tree),Ce(M,xe-11,7));pe=Z,tt=(xe=0)===ke?(Oe=138,3):Z===ke?(Oe=6,3):(Oe=7,4)}}u(ee);var ne=!1;function L(M,U,le,ue){Ce(M,(f<<1)+(ue?1:0),3),function(Z,pe,ke,xe){He(Z),Se(Z,ke),Se(Z,~ke),l.arraySet(Z.pending_buf,Z.window,pe,ke,Z.pending),Z.pending+=ke}(M,U,le)}i._tr_init=function(M){ne||(function(){var U,le,ue,Z,pe,ke=new Array(v+1);for(Z=ue=0;Z<p-1;Z++)for(G[Z]=ue,U=0;U<1<<I[Z];U++)j[ue++]=Z;for(j[ue-1]=Z,Z=pe=0;Z<16;Z++)for(ee[Z]=pe,U=0;U<1<<B[Z];U++)H[pe++]=Z;for(pe>>=7;Z<w;Z++)for(ee[Z]=pe<<7,U=0;U<1<<B[Z]-7;U++)H[256+pe++]=Z;for(le=0;le<=v;le++)ke[le]=0;for(U=0;U<=143;)se[2*U+1]=8,U++,ke[8]++;for(;U<=255;)se[2*U+1]=9,U++,ke[9]++;for(;U<=279;)se[2*U+1]=7,U++,ke[7]++;for(;U<=287;)se[2*U+1]=8,U++,ke[8]++;for(gt(se,y+1,ke),U=0;U<w;U++)R[2*U+1]=5,R[2*U]=at(U,5);Q=new be(se,I,m+1,y,v),K=new be(R,B,0,w,v),J=new be(new Array(0),z,0,_,C)}(),ne=!0),M.l_desc=new V(M.dyn_ltree,Q),M.d_desc=new V(M.dyn_dtree,K),M.bl_desc=new V(M.bl_tree,J),M.bi_buf=0,M.bi_valid=0,Ge(M)},i._tr_stored_block=L,i._tr_flush_block=function(M,U,le,ue){var Z,pe,ke=0;0<M.level?(M.strm.data_type===2&&(M.strm.data_type=function(xe){var Oe,tt=4093624447;for(Oe=0;Oe<=31;Oe++,tt>>>=1)if(1&tt&&xe.dyn_ltree[2*Oe]!==0)return c;if(xe.dyn_ltree[18]!==0||xe.dyn_ltree[20]!==0||xe.dyn_ltree[26]!==0)return d;for(Oe=32;Oe<m;Oe++)if(xe.dyn_ltree[2*Oe]!==0)return d;return c}(M)),Qe(M,M.l_desc),Qe(M,M.d_desc),ke=function(xe){var Oe;for(A(xe,xe.dyn_ltree,xe.l_desc.max_code),A(xe,xe.dyn_dtree,xe.d_desc.max_code),Qe(xe,xe.bl_desc),Oe=_-1;3<=Oe&&xe.bl_tree[2*X[Oe]+1]===0;Oe--);return xe.opt_len+=3*(Oe+1)+5+5+4,Oe}(M),Z=M.opt_len+3+7>>>3,(pe=M.static_len+3+7>>>3)<=Z&&(Z=pe)):Z=pe=le+5,le+4<=Z&&U!==-1?L(M,U,le,ue):M.strategy===4||pe===Z?(Ce(M,2+(ue?1:0),3),At(M,se,R)):(Ce(M,4+(ue?1:0),3),function(xe,Oe,tt,Ve){var Et;for(Ce(xe,Oe-257,5),Ce(xe,tt-1,5),Ce(xe,Ve-4,4),Et=0;Et<Ve;Et++)Ce(xe,xe.bl_tree[2*X[Et]+1],3);oe(xe,xe.dyn_ltree,Oe-1),oe(xe,xe.dyn_dtree,tt-1)}(M,M.l_desc.max_code+1,M.d_desc.max_code+1,ke+1),At(M,M.dyn_ltree,M.dyn_dtree)),Ge(M),ue&&He(M)},i._tr_tally=function(M,U,le){return M.pending_buf[M.d_buf+2*M.last_lit]=U>>>8&255,M.pending_buf[M.d_buf+2*M.last_lit+1]=255&U,M.pending_buf[M.l_buf+M.last_lit]=255&le,M.last_lit++,U===0?M.dyn_ltree[2*le]++:(M.matches++,U--,M.dyn_ltree[2*(j[le]+m+1)]++,M.dyn_dtree[2*Y(U)]++),M.last_lit===M.lit_bufsize-1},i._tr_align=function(M){Ce(M,2,3),ye(M,k,se),function(U){U.bi_valid===16?(Se(U,U.bi_buf),U.bi_buf=0,U.bi_valid=0):8<=U.bi_valid&&(U.pending_buf[U.pending++]=255&U.bi_buf,U.bi_buf>>=8,U.bi_valid-=8)}(M)}},{"../utils/common":41}],53:[function(t,n,i){n.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(t,n,i){(function(l){(function(c,d){if(!c.setImmediate){var u,f,p,m,y=1,w={},_=!1,x=c.document,v=Object.getPrototypeOf&&Object.getPrototypeOf(c);v=v&&v.setTimeout?v:c,u={}.toString.call(c.process)==="[object process]"?function(E){process.nextTick(function(){C(E)})}:function(){if(c.postMessage&&!c.importScripts){var E=!0,P=c.onmessage;return c.onmessage=function(){E=!1},c.postMessage("","*"),c.onmessage=P,E}}()?(m="setImmediate$"+Math.random()+"$",c.addEventListener?c.addEventListener("message",k,!1):c.attachEvent("onmessage",k),function(E){c.postMessage(m+E,"*")}):c.MessageChannel?((p=new MessageChannel).port1.onmessage=function(E){C(E.data)},function(E){p.port2.postMessage(E)}):x&&"onreadystatechange"in x.createElement("script")?(f=x.documentElement,function(E){var P=x.createElement("script");P.onreadystatechange=function(){C(E),P.onreadystatechange=null,f.removeChild(P),P=null},f.appendChild(P)}):function(E){setTimeout(C,0,E)},v.setImmediate=function(E){typeof E!="function"&&(E=new Function(""+E));for(var P=new Array(arguments.length-1),D=0;D<P.length;D++)P[D]=arguments[D+1];var I={callback:E,args:P};return w[y]=I,u(y),y++},v.clearImmediate=S}function S(E){delete w[E]}function C(E){if(_)setTimeout(C,0,E);else{var P=w[E];if(P){_=!0;try{(function(D){var I=D.callback,B=D.args;switch(B.length){case 0:I();break;case 1:I(B[0]);break;case 2:I(B[0],B[1]);break;case 3:I(B[0],B[1],B[2]);break;default:I.apply(d,B)}})(P)}finally{S(E),_=!1}}}}function k(E){E.source===c&&typeof E.data=="string"&&E.data.indexOf(m)===0&&C(+E.data.slice(m.length))}})(typeof self>"u"?l===void 0?this:l:self)}).call(this,typeof vo<"u"?vo:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})})(E0);var Mw=E0.exports;const Lw=um(Mw);async function Fw(r,e){const t=new Lw,n=t.folder("deckforge-designs");if(!n)throw new Error("Failed to create ZIP folder");for(let l=0;l<r.length;l++){const c=r[l];e==null||e(l+1,r.length);try{const d=await $p(c.canvas_data.objects,{scale:3,format:"png",includeBackground:!0}),f=`${c.name.replace(/[^a-z0-9]/gi,"_").toLowerCase()}_${c.id.slice(0,8)}.png`;n.file(f,d)}catch(d){console.error(`Failed to export design ${c.name}:`,d)}}return await t.generateAsync({type:"blob",compression:"DEFLATE",compressionOptions:{level:6}})}function zw(r,e){const t=URL.createObjectURL(r),n=document.createElement("a");n.href=t,n.download=e,document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(t)}const Ks="http://localhost:3000",Co={async list(){const r=localStorage.getItem("token");return(await dr.get(`${Ks}/folders`,{headers:{Authorization:`Bearer ${r}`}})).data.folders},async create(r,e){const t=localStorage.getItem("token");return(await dr.post(`${Ks}/folders`,{name:r,color:e},{headers:{Authorization:`Bearer ${t}`}})).data.folder},async update(r,e){const t=localStorage.getItem("token");return(await dr.patch(`${Ks}/folders/${r}`,e,{headers:{Authorization:`Bearer ${t}`}})).data.folder},async delete(r){const e=localStorage.getItem("token");await dr.delete(`${Ks}/folders/${r}`,{headers:{Authorization:`Bearer ${e}`}})},async moveDesign(r,e){const t=localStorage.getItem("token");await dr.post(`${Ks}/folders/${r}/designs/${e}`,{},{headers:{Authorization:`Bearer ${t}`}})},async removeDesign(r,e){const t=localStorage.getItem("token");await dr.delete(`${Ks}/folders/${r}/designs/${e}`,{headers:{Authorization:`Bearer ${t}`}})}},Yf=["#ccff00","#00ffff","#ff00ff","#ff6600","#00ff00","#ff0000","#0000ff","#ffff00"];function Bw({selectedFolder:r,onFolderSelect:e}){const[t,n]=T.useState([]),[i,l]=T.useState(!0),[c,d]=T.useState(!1),[u,f]=T.useState(""),[p,m]=T.useState(null),[y,w]=T.useState("");T.useEffect(()=>{_()},[]);const _=async()=>{l(!0);try{const C=await Co.list();n(C)}catch(C){console.error("Failed to load folders:",C)}finally{l(!1)}},x=async()=>{var C,k;if(u.trim())try{const E=Yf[Math.floor(Math.random()*Yf.length)],P=await Co.create(u.trim(),E);n([...t,P]),f(""),d(!1),Mt({title:" Folder created",description:`${P.name} is ready`})}catch(E){Mt({title:"Failed to create folder",description:((k=(C=E.response)==null?void 0:C.data)==null?void 0:k.error)||"Please try again",variant:"destructive"})}},v=async C=>{if(y.trim())try{const k=await Co.update(C,{name:y.trim()});n(t.map(E=>E.id===C?k:E)),m(null),Mt({title:" Folder renamed"})}catch{Mt({title:"Failed to rename",variant:"destructive"})}},S=async(C,k)=>{if(confirm(`Delete folder "${k}"? Designs will be moved to "All Designs".`))try{await Co.delete(C),n(t.filter(E=>E.id!==C)),r===C&&e(null),Mt({title:" Folder deleted"})}catch{Mt({title:"Failed to delete",variant:"destructive"})}};return a.jsxs("div",{className:"w-64 bg-card border-r border-border h-full flex flex-col",children:[a.jsxs("div",{className:"p-3 border-b border-border",children:[a.jsx("h3",{className:"font-display text-xs uppercase tracking-wider mb-3",children:"Folders"}),a.jsxs(de,{size:"sm",variant:"outline",onClick:()=>d(!c),className:"w-full gap-2",children:[a.jsx(hy,{className:"w-4 h-4"}),"New Folder"]})]}),a.jsx(Qn,{className:"flex-1",children:a.jsxs("div",{className:"p-3 space-y-1",children:[a.jsxs("button",{onClick:()=>e(null),className:`w-full flex items-center gap-2 px-3 py-2 text-sm transition-colors ${r===null?"bg-primary/10 text-primary border border-primary":"hover:bg-secondary border border-transparent"}`,children:[a.jsx(fy,{className:"w-4 h-4"}),a.jsx("span",{className:"flex-1 text-left",children:"All Designs"})]}),c&&a.jsxs("div",{className:"py-2 space-y-2",children:[a.jsx(pt,{placeholder:"Folder name...",value:u,onChange:C=>f(C.target.value),onKeyDown:C=>{C.key==="Enter"&&x(),C.key==="Escape"&&d(!1)},autoFocus:!0,className:"h-8 text-sm"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx(de,{size:"sm",onClick:x,disabled:!u.trim(),className:"flex-1",children:"Create"}),a.jsx(de,{size:"sm",variant:"ghost",onClick:()=>d(!1),children:"Cancel"})]})]}),i&&a.jsx("div",{className:"flex justify-center py-4",children:a.jsx(xr,{className:"w-5 h-5 animate-spin text-muted-foreground"})}),t.map(C=>a.jsx("div",{className:`group flex items-center gap-2 px-3 py-2 text-sm transition-colors ${r===C.id?"bg-primary/10 text-primary border border-primary":"hover:bg-secondary border border-transparent"}`,children:p===C.id?a.jsxs("div",{className:"flex-1 flex items-center gap-2",children:[a.jsx(pt,{value:y,onChange:k=>w(k.target.value),onKeyDown:k=>{k.key==="Enter"&&v(C.id),k.key==="Escape"&&m(null)},className:"h-7 text-sm",autoFocus:!0}),a.jsx(de,{size:"sm",variant:"ghost",onClick:()=>v(C.id),className:"h-7 px-2",children:"Save"})]}):a.jsxs(a.Fragment,{children:[a.jsxs("button",{onClick:()=>e(C.id),className:"flex-1 flex items-center gap-2",children:[a.jsx(py,{className:"w-4 h-4",style:{color:C.color}}),a.jsx("span",{className:"truncate",children:C.name})]}),a.jsxs("div",{className:"opacity-0 group-hover:opacity-100 flex gap-1",children:[a.jsx("button",{onClick:()=>{m(C.id),w(C.name)},className:"p-1 hover:bg-secondary",children:a.jsx(Rd,{className:"w-3 h-3"})}),a.jsx("button",{onClick:()=>S(C.id,C.name),className:"p-1 hover:bg-destructive/10 text-destructive",children:a.jsx(jn,{className:"w-3 h-3"})})]})]})},C.id))]})})]})}function Gw(){const[r,e]=T.useState([]),[t,n]=T.useState(!0),[i,l]=T.useState(new Set),[c,d]=T.useState(!1),[u,f]=T.useState({current:0,total:0}),[p,m]=T.useState(null),{isAuthenticated:y,logout:w}=Nn(),{loadDesign:_,resetCanvas:x}=Ct(),v=Tr(),S=p?r.filter(R=>R.folder_id===p):r;T.useEffect(()=>{if(!y){v("/auth");return}C()},[y]);const C=async()=>{n(!0);try{const R=await Go.list();e(R.designs||[])}catch(R){console.error("Failed to load designs:",R)}finally{n(!1)}},k=R=>{_(R.canvas_data),v("/")},E=async(R,H)=>{if(H.stopPropagation(),!!confirm("Delete this design? This cannot be undone."))try{await Go.delete(R),l(j=>{const G=new Set(j);return G.delete(R),G}),await C()}catch(j){console.error("Delete failed:",j),alert("Failed to delete design")}},P=(R,H)=>{H.stopPropagation(),l(j=>{const G=new Set(j);return G.has(R)?G.delete(R):G.add(R),G})},D=()=>{i.size===S.length?l(new Set):l(new Set(S.map(R=>R.id)))},I=async(R,H,j)=>{j.stopPropagation();const G="http://localhost:3000",Q=localStorage.getItem("token");try{await dr.patch(`${G}/gallery/${R}/visibility`,{is_public:!H},{headers:{Authorization:`Bearer ${Q}`}}),e(K=>K.map(J=>J.id===R?{...J,is_public:!H}:J)),Mt({title:H?" Design unpublished":" Design published",description:H?"Your design has been removed from the gallery":"Your design is now visible in the public gallery"})}catch(K){console.error("Toggle public failed:",K),Mt({title:"Failed to update visibility",description:"Please try again",variant:"destructive"})}},B=async()=>{const R=r.filter(H=>i.has(H.id));if(R.length===0){Mt({title:"No designs selected",description:"Please select at least one design to export.",variant:"destructive"});return}d(!0),f({current:0,total:R.length});try{const H=await Fw(R,(Q,K)=>{f({current:Q,total:K})}),G=`deckforge_designs_${Date.now()}.zip`;zw(H,G),Mt({title:" Batch export complete",description:`${R.length} design${R.length!==1?"s":""} exported successfully.`}),l(new Set)}catch(H){console.error("Batch export failed:",H),Mt({title:"Export failed",description:"Failed to export designs. Please try again.",variant:"destructive"})}finally{d(!1),f({current:0,total:0})}},z=()=>{x(),v("/")},X=async()=>{await w(),v("/auth")};if(!y)return null;const se=i.size>0;return a.jsxs("div",{className:"min-h-screen bg-background flex flex-col",children:[a.jsxs("header",{className:"h-16 border-b border-border flex items-center px-6 bg-card shrink-0",children:[a.jsxs("h1",{className:"font-display text-xl uppercase tracking-widest",children:["My ",a.jsx("span",{className:"text-primary",children:"Designs"})]}),a.jsxs("div",{className:"ml-auto flex items-center gap-4",children:[se&&a.jsxs(a.Fragment,{children:[a.jsxs("span",{className:"text-sm text-muted-foreground",children:[i.size," selected"]}),a.jsx(de,{size:"sm",variant:"outline",onClick:B,disabled:c,className:"gap-2",children:c?a.jsxs(a.Fragment,{children:[a.jsx(xr,{className:"w-4 h-4 animate-spin"}),"Exporting ",u.current,"/",u.total]}):a.jsxs(a.Fragment,{children:[a.jsx(Hr,{className:"w-4 h-4"}),"Export Selected"]})})]}),a.jsxs(de,{size:"sm",variant:"outline",onClick:z,className:"gap-2",children:[a.jsx(da,{className:"w-4 h-4"}),"New Design"]}),a.jsx(de,{size:"sm",variant:"ghost",onClick:X,children:"Logout"})]})]}),a.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[a.jsx(Bw,{selectedFolder:p,onFolderSelect:m}),a.jsx("div",{className:"flex-1 overflow-auto",children:a.jsx("div",{className:"container mx-auto px-6 py-8",children:t?a.jsx("div",{className:"flex items-center justify-center py-20",children:a.jsx(xr,{className:"w-8 h-8 animate-spin text-muted-foreground"})}):S.length===0?a.jsxs("div",{className:"text-center py-20 space-y-6",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-display uppercase tracking-widest mb-2",children:"No Designs Yet"}),a.jsx("p",{className:"text-muted-foreground",children:"Create your first custom deck design!"})]}),a.jsxs(de,{onClick:z,size:"lg",className:"gap-2",children:[a.jsx(da,{className:"w-5 h-5"}),"Create Design"]})]}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"mb-4 flex items-center gap-3",children:[a.jsx(de,{size:"sm",variant:"outline",onClick:D,className:"gap-2",children:i.size===S.length?a.jsxs(a.Fragment,{children:[a.jsx(hf,{className:"w-4 h-4"}),"Deselect All"]}):a.jsxs(a.Fragment,{children:[a.jsx(Wo,{className:"w-4 h-4"}),"Select All"]})}),a.jsxs("span",{className:"text-sm text-muted-foreground",children:[S.length," design",S.length!==1?"s":"",p&&" in folder"]})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:S.map(R=>{const H=i.has(R.id);return a.jsxs("div",{className:`group border transition-colors bg-card overflow-hidden cursor-pointer relative ${H?"border-primary ring-2 ring-primary/20":"border-border hover:border-primary"}`,onClick:()=>k(R),children:[a.jsx("div",{className:"absolute top-2 left-2 z-10",onClick:j=>P(R.id,j),children:a.jsx("div",{className:`w-6 h-6 border-2 flex items-center justify-center transition-colors cursor-pointer ${H?"bg-primary border-primary":"bg-background border-border hover:border-primary"}`,children:H&&a.jsx(hf,{className:"w-5 h-5 text-primary-foreground"})})}),a.jsx("div",{className:"aspect-[32/98] bg-muted flex items-center justify-center overflow-hidden",children:R.thumbnail_url?a.jsx("img",{src:R.thumbnail_url,alt:R.name,className:"w-full h-full object-cover"}):a.jsx("div",{className:"text-muted-foreground text-sm uppercase tracking-widest",children:R.name})}),R.is_public&&a.jsx("div",{className:"absolute top-2 right-2 z-10",children:a.jsxs("div",{className:"bg-primary text-primary-foreground px-2 py-1 rounded text-[10px] uppercase tracking-wider flex items-center gap-1",children:[a.jsx(ff,{className:"w-3 h-3"}),"Public"]})}),a.jsxs("div",{className:"p-4 space-y-3",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"font-display text-sm uppercase tracking-widest truncate",children:R.name}),R.description&&a.jsx("p",{className:"text-xs text-muted-foreground truncate mt-1",children:R.description}),a.jsx("p",{className:"text-[10px] text-muted-foreground mt-1 uppercase tracking-widest",children:new Date(R.updated_at).toLocaleDateString()})]}),a.jsx("div",{className:"space-y-2",children:a.jsxs("div",{className:"flex gap-2 opacity-0 group-hover:opacity-100 transition-opacity",children:[a.jsxs(de,{size:"sm",variant:"outline",className:"flex-1 gap-1",onClick:j=>{j.stopPropagation(),k(R)},children:[a.jsx(Zn,{className:"w-3 h-3"}),"Open"]}),a.jsx(de,{size:"sm",variant:R.is_public?"default":"outline",onClick:j=>I(R.id,R.is_public,j),title:R.is_public?"Make Private":"Publish to Gallery",children:R.is_public?a.jsx(ff,{className:"w-3 h-3"}):a.jsx(el,{className:"w-3 h-3"})}),a.jsx(de,{size:"sm",variant:"destructive",onClick:j=>E(R.id,j),children:a.jsx(jn,{className:"w-3 h-3"})})]})})]})]},R.id)})})]})})})]})]})}const yd=[{id:"skull-flames",name:"Skull & Flames",description:"Classic skate punk aesthetic with skull and flame stickers",tags:["punk","edgy","classic"],objects:[{type:"shape",shapeType:"rect",x:0,y:0,width:96,height:294,rotation:0,opacity:1,scaleX:1,scaleY:1,fill:"#000000"},{type:"shape",shapeType:"rect",x:0,y:120,width:96,height:54,rotation:0,opacity:1,scaleX:1,scaleY:1,fill:"#ff0000"},{type:"sticker",x:28,y:80,width:40,height:40,rotation:0,opacity:1,scaleX:1,scaleY:1,iconName:"Skull",fill:"#ffffff",strokeWidth:0,solidFill:!0},{type:"sticker",x:10,y:200,width:30,height:30,rotation:-15,opacity:1,scaleX:1,scaleY:1,iconName:"Flame",fill:"#ff4500",strokeWidth:0,solidFill:!0},{type:"sticker",x:56,y:200,width:30,height:30,rotation:15,opacity:1,scaleX:1,scaleY:1,iconName:"Flame",fill:"#ff4500",strokeWidth:0,solidFill:!0}]},{id:"gradient-fade",name:"Gradient Fade",description:"Modern gradient design with smooth color transitions",tags:["modern","gradient","clean"],objects:[{type:"shape",shapeType:"rect",x:0,y:0,width:96,height:294,rotation:0,opacity:1,scaleX:1,scaleY:1,fillType:"linear-gradient",gradientStops:[{offset:0,color:"#667eea"},{offset:.5,color:"#764ba2"},{offset:1,color:"#f093fb"}],gradientAngle:180},{type:"shape",shapeType:"circle",x:23,y:122,width:50,height:50,rotation:0,opacity:1,scaleX:1,scaleY:1,fill:"#ffffff",glow:{enabled:!0,radius:20,color:"#ffffff",intensity:.8}}]},{id:"retro-vinyl",name:"Retro Vinyl",description:"Vintage music-inspired design with record and music icons",tags:["retro","music","vintage"],objects:[{type:"shape",shapeType:"rect",x:0,y:0,width:96,height:294,rotation:0,opacity:1,scaleX:1,scaleY:1,fill:"#f4e8d8"},{type:"shape",shapeType:"rect",x:0,y:140,width:96,height:14,rotation:0,opacity:1,scaleX:1,scaleY:1,fill:"#8b4513"},{type:"sticker",x:23,y:60,width:50,height:50,rotation:0,opacity:1,scaleX:1,scaleY:1,iconName:"Disc",fill:"#2c2c2c",strokeWidth:0,solidFill:!0},{type:"sticker",x:12,y:200,width:25,height:25,rotation:-10,opacity:1,scaleX:1,scaleY:1,iconName:"Music",fill:"#8b4513",strokeWidth:0,solidFill:!0},{type:"sticker",x:59,y:195,width:25,height:25,rotation:10,opacity:1,scaleX:1,scaleY:1,iconName:"Music",fill:"#8b4513",strokeWidth:0,solidFill:!0}]},{id:"neon-lightning",name:"Neon Lightning",description:"Electric neon design with lightning bolts",tags:["neon","electric","bold"],objects:[{type:"shape",shapeType:"rect",x:0,y:0,width:96,height:294,rotation:0,opacity:1,scaleX:1,scaleY:1,fill:"#1a1a2e"},{type:"sticker",x:18,y:90,width:60,height:60,rotation:15,opacity:1,scaleX:1,scaleY:1,iconName:"Zap",fill:"#00ff88",strokeWidth:0,solidFill:!0,glow:{enabled:!0,radius:15,color:"#00ff88",intensity:1}},{type:"sticker",x:8,y:180,width:40,height:40,rotation:-25,opacity:.7,scaleX:1,scaleY:1,iconName:"Zap",fill:"#ff00ff",strokeWidth:0,solidFill:!0,glow:{enabled:!0,radius:12,color:"#ff00ff",intensity:.9}},{type:"sticker",x:48,y:170,width:40,height:40,rotation:30,opacity:.7,scaleX:1,scaleY:1,iconName:"Zap",fill:"#00ddff",strokeWidth:0,solidFill:!0,glow:{enabled:!0,radius:12,color:"#00ddff",intensity:.9}}]},{id:"minimalist-shapes",name:"Minimalist Shapes",description:"Clean geometric design with simple shapes",tags:["minimal","geometric","clean"],objects:[{type:"shape",shapeType:"rect",x:0,y:0,width:96,height:294,rotation:0,opacity:1,scaleX:1,scaleY:1,fill:"#ffffff"},{type:"shape",shapeType:"circle",x:8,y:70,width:80,height:80,rotation:0,opacity:1,scaleX:1,scaleY:1,fill:"#000000"},{type:"sticker",x:28,y:180,width:40,height:40,rotation:0,opacity:1,scaleX:1,scaleY:1,iconName:"Triangle",fill:"#ff0000",strokeWidth:0,solidFill:!0}]},{id:"blank",name:"Blank Canvas",description:"Start from scratch with a clean white deck",tags:["blank","custom"],objects:[{type:"shape",shapeType:"rect",x:0,y:0,width:96,height:294,rotation:0,opacity:1,scaleX:1,scaleY:1,fill:"#ffffff"}]}];function Hw(r){if(!r)return yd;const e=r.toLowerCase();return yd.filter(t=>t.name.toLowerCase().includes(e)||t.description.toLowerCase().includes(e)||t.tags.some(n=>n.toLowerCase().includes(e)))}function Uw(){const[r,e]=T.useState(""),{loadDesign:t}=Ct(),n=Tr(),i=Hw(r),l=c=>{const d=yd.find(u=>u.id===c);d&&(t({objects:d.objects,name:d.name}),n("/"))};return a.jsxs("div",{className:"min-h-screen bg-background",children:[a.jsxs("header",{className:"h-16 border-b border-border flex items-center px-6 bg-card",children:[a.jsxs("h1",{className:"font-display text-xl uppercase tracking-widest flex items-center gap-2",children:[a.jsx(cr,{className:"w-5 h-5 text-primary"}),a.jsx("span",{children:"Templates"})]}),a.jsx("div",{className:"ml-auto flex items-center gap-4",children:a.jsx(de,{size:"sm",variant:"outline",onClick:()=>n("/"),children:"Back to Editor"})})]}),a.jsxs("div",{className:"container mx-auto px-6 py-8",children:[a.jsx("div",{className:"max-w-md mb-8",children:a.jsxs("div",{className:"relative",children:[a.jsx(hm,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground"}),a.jsx(pt,{type:"text",placeholder:"Search templates...",value:r,onChange:c=>e(c.target.value),className:"pl-10"})]})}),i.length===0?a.jsx("div",{className:"text-center py-20",children:a.jsx("p",{className:"text-muted-foreground",children:"No templates found"})}):a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:i.map(c=>a.jsxs("div",{className:"group border border-border hover:border-primary transition-colors bg-card overflow-hidden cursor-pointer",onClick:()=>l(c.id),children:[a.jsxs("div",{className:"aspect-[32/98] bg-muted flex items-center justify-center overflow-hidden relative",children:[c.thumbnail?a.jsx("img",{src:c.thumbnail,alt:c.name,className:"w-full h-full object-cover"}):a.jsxs("div",{className:"text-center p-4",children:[a.jsx(cr,{className:"w-8 h-8 mx-auto mb-2 text-primary"}),a.jsx("p",{className:"text-xs text-muted-foreground uppercase tracking-widest",children:c.name})]}),a.jsx("div",{className:"absolute inset-0 bg-black/60 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center",children:a.jsx(de,{size:"sm",variant:"default",children:"Use Template"})})]}),a.jsxs("div",{className:"p-4 space-y-2",children:[a.jsx("h3",{className:"font-display text-sm uppercase tracking-widest",children:c.name}),a.jsx("p",{className:"text-xs text-muted-foreground",children:c.description}),a.jsx("div",{className:"flex flex-wrap gap-1 pt-2",children:c.tags.map(d=>a.jsx("span",{className:"px-2 py-0.5 text-[10px] uppercase tracking-wider bg-primary/10 text-primary rounded",children:d},d))})]})]},c.id))})]})]})}const Vc="http://localhost:3000";function Ww({designId:r}){const[e,t]=T.useState([]),[n,i]=T.useState(""),[l,c]=T.useState(!0),[d,u]=T.useState(!1),{isAuthenticated:f}=Nn();T.useEffect(()=>{p()},[r]);const p=async()=>{c(!0);try{const w=await dr.get(`${Vc}/comments/${r}`);t(w.data.comments||[])}catch(w){console.error("Failed to load comments:",w)}finally{c(!1)}},m=async w=>{var _,x;if(w.preventDefault(),!f){Mt({title:"Login required",description:"Please login to comment",variant:"destructive"});return}if(n.trim()){u(!0);try{const v=localStorage.getItem("token"),S=await dr.post(`${Vc}/comments/${r}`,{content:n},{headers:{Authorization:`Bearer ${v}`}});t([...e,S.data.comment]),i(""),Mt({title:" Comment posted",description:"Your comment has been added"})}catch(v){console.error("Failed to post comment:",v),Mt({title:"Failed to post comment",description:((x=(_=v.response)==null?void 0:_.data)==null?void 0:x.error)||"Please try again",variant:"destructive"})}finally{u(!1)}}},y=async w=>{if(confirm("Delete this comment?"))try{const _=localStorage.getItem("token");await dr.delete(`${Vc}/comments/${w}`,{headers:{Authorization:`Bearer ${_}`}}),t(e.filter(x=>x.id!==w)),Mt({title:" Comment deleted",description:"Your comment has been removed"})}catch(_){console.error("Failed to delete comment:",_),Mt({title:"Failed to delete",description:"Please try again",variant:"destructive"})}};return a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(my,{className:"w-5 h-5"}),a.jsxs("h3",{className:"font-display text-sm uppercase tracking-wider",children:["Comments (",e.length,")"]})]}),f?a.jsxs("form",{onSubmit:m,className:"space-y-2",children:[a.jsx(Yp,{value:n,onChange:w=>i(w.target.value),placeholder:"Add a comment...",className:"min-h-[80px] resize-none",disabled:d}),a.jsx("div",{className:"flex justify-end",children:a.jsx(de,{type:"submit",size:"sm",disabled:!n.trim()||d,className:"gap-2",children:d?a.jsxs(a.Fragment,{children:[a.jsx(xr,{className:"w-3 h-3 animate-spin"}),"Posting..."]}):a.jsxs(a.Fragment,{children:[a.jsx(gy,{className:"w-3 h-3"}),"Post Comment"]})})})]}):a.jsx("div",{className:"border border-border p-4 text-center text-sm text-muted-foreground",children:"Please login to comment"}),a.jsx("div",{className:"space-y-3",children:l?a.jsx("div",{className:"flex justify-center py-8",children:a.jsx(xr,{className:"w-6 h-6 animate-spin text-muted-foreground"})}):e.length===0?a.jsx("div",{className:"text-center py-8 text-sm text-muted-foreground",children:"No comments yet. Be the first to comment!"}):e.map(w=>a.jsxs("div",{className:"border border-border p-3 space-y-2 bg-secondary/50",children:[a.jsxs("div",{className:"flex items-start justify-between gap-2",children:[a.jsx("div",{className:"flex-1",children:a.jsx("p",{className:"text-sm whitespace-pre-wrap break-words",children:w.content})}),f&&w.user_id===localStorage.getItem("userId")&&a.jsx(de,{size:"sm",variant:"ghost",onClick:()=>y(w.id),className:"shrink-0",children:a.jsx(jn,{className:"w-3 h-3"})})]}),a.jsx("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:a.jsx("span",{children:new Date(w.created_at).toLocaleString()})})]},w.id))})]})}const ko="http://localhost:3000";function Vw(){const[r,e]=T.useState([]),[t,n]=T.useState(!0),[i,l]=T.useState("recent"),[c,d]=T.useState(new Set),[u,f]=T.useState(null),{isAuthenticated:p}=Nn(),{loadDesign:m}=Ct(),y=Tr();T.useEffect(()=>{w()},[i]);const w=async()=>{n(!0);try{const v=await dr.get(`${ko}/gallery?sort=${i}&limit=50`);if(e(v.data.designs||[]),p){const S=new Set;for(const C of v.data.designs||[])try{const k=localStorage.getItem("token");(await dr.get(`${ko}/gallery/${C.id}/liked`,{headers:{Authorization:`Bearer ${k}`}})).data.liked&&S.add(C.id)}catch{}d(S)}}catch(v){console.error("Failed to load gallery:",v)}finally{n(!1)}},_=async(v,S)=>{var E,P;if(S.stopPropagation(),!p){Mt({title:"Login required",description:"Please login to like designs",variant:"destructive"}),y("/auth");return}const C=localStorage.getItem("token"),k=c.has(v);try{k?(await dr.delete(`${ko}/gallery/${v}/like`,{headers:{Authorization:`Bearer ${C}`}}),d(D=>{const I=new Set(D);return I.delete(v),I}),e(D=>D.map(I=>I.id===v?{...I,like_count:I.like_count-1}:I))):(await dr.post(`${ko}/gallery/${v}/like`,{},{headers:{Authorization:`Bearer ${C}`}}),d(D=>new Set(D).add(v)),e(D=>D.map(I=>I.id===v?{...I,like_count:I.like_count+1}:I)))}catch(D){console.error("Like failed:",D),Mt({title:"Action failed",description:((P=(E=D.response)==null?void 0:E.data)==null?void 0:P.error)||"Please try again",variant:"destructive"})}},x=(v,S)=>{S.stopPropagation(),m(v.canvas_data),y("/"),Mt({title:" Design loaded",description:"Remix and make it your own!"})};return a.jsxs("div",{className:"min-h-screen bg-background",children:[a.jsxs("header",{className:"h-16 border-b border-border flex items-center px-6 bg-card",children:[a.jsxs("h1",{className:"font-display text-xl uppercase tracking-widest",children:["Design ",a.jsx("span",{className:"text-primary",children:"Gallery"})]}),a.jsxs("div",{className:"ml-auto flex items-center gap-4",children:[a.jsxs("div",{className:"flex gap-2",children:[a.jsxs(de,{size:"sm",variant:i==="recent"?"default":"outline",onClick:()=>l("recent"),className:"gap-2",children:[a.jsx(Ld,{className:"w-4 h-4"}),"Recent"]}),a.jsxs(de,{size:"sm",variant:i==="popular"?"default":"outline",onClick:()=>l("popular"),className:"gap-2",children:[a.jsx(Fd,{className:"w-4 h-4"}),"Popular"]}),a.jsxs(de,{size:"sm",variant:i==="liked"?"default":"outline",onClick:()=>l("liked"),className:"gap-2",children:[a.jsx(xy,{className:"w-4 h-4"}),"Most Liked"]})]}),a.jsx(de,{size:"sm",variant:"outline",onClick:()=>y("/"),children:"Create Design"}),!p&&a.jsx(de,{size:"sm",variant:"ghost",onClick:()=>y("/auth"),children:"Login"})]})]}),a.jsx("div",{className:"container mx-auto px-6 py-8",children:t?a.jsx("div",{className:"flex items-center justify-center py-20",children:a.jsx(xr,{className:"w-8 h-8 animate-spin text-muted-foreground"})}):r.length===0?a.jsxs("div",{className:"text-center py-20 space-y-6",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-display uppercase tracking-widest mb-2",children:"No Public Designs Yet"}),a.jsx("p",{className:"text-muted-foreground",children:"Be the first to share a design with the community!"})]}),a.jsx(de,{onClick:()=>y("/"),size:"lg",children:"Create & Share"})]}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"mb-6",children:a.jsxs("p",{className:"text-sm text-muted-foreground",children:[r.length," design",r.length!==1?"s":"","  Community creations"]})}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:r.map(v=>{const S=c.has(v.id);return a.jsxs("div",{className:"group border border-border hover:border-primary transition-colors bg-card overflow-hidden cursor-pointer",onClick:()=>f(v),children:[a.jsxs("div",{className:"aspect-[32/98] bg-muted flex items-center justify-center overflow-hidden relative",children:[v.thumbnail_url?a.jsx("img",{src:v.thumbnail_url,alt:v.name,className:"w-full h-full object-cover"}):a.jsx("div",{className:"text-muted-foreground text-sm uppercase tracking-widest",children:v.name}),a.jsxs("div",{className:"absolute bottom-2 right-2 flex gap-2",children:[a.jsxs("div",{className:"bg-black/80 backdrop-blur-sm px-2 py-1 rounded text-xs text-white flex items-center gap-1",children:[a.jsx(Zn,{className:"w-3 h-3"}),v.view_count]}),a.jsxs("div",{className:"bg-black/80 backdrop-blur-sm px-2 py-1 rounded text-xs text-white flex items-center gap-1",children:[a.jsx(sn,{className:"w-3 h-3"}),v.like_count]})]})]}),a.jsxs("div",{className:"p-4 space-y-3",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"font-display text-sm uppercase tracking-widest truncate",children:v.name}),v.description&&a.jsx("p",{className:"text-xs text-muted-foreground truncate mt-1",children:v.description}),a.jsx("p",{className:"text-[10px] text-muted-foreground mt-1 uppercase tracking-widest",children:new Date(v.created_at).toLocaleDateString()})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs(de,{size:"sm",variant:"outline",className:"flex-1 gap-1",onClick:C=>x(v,C),children:[a.jsx(pf,{className:"w-3 h-3"}),"Remix"]}),a.jsx(de,{size:"sm",variant:S?"default":"outline",onClick:C=>_(v.id,C),className:S?"text-red-500":"",children:a.jsx(sn,{className:`w-3 h-3 ${S?"fill-current":""}`})})]})]})]},v.id)})})]})}),u&&a.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[a.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm",onClick:()=>f(null)}),a.jsxs("div",{className:"relative bg-card border-2 border-border shadow-xl w-full max-w-4xl max-h-[90vh] overflow-auto",children:[a.jsxs("div",{className:"sticky top-0 bg-card border-b border-border p-4 flex items-center justify-between z-10",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"font-display text-lg uppercase tracking-wider",children:u.name}),u.description&&a.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:u.description})]}),a.jsx("button",{onClick:()=>f(null),className:"text-muted-foreground hover:text-foreground transition-colors",children:a.jsx(wa,{className:"w-5 h-5"})})]}),a.jsxs("div",{className:"p-6 space-y-6",children:[a.jsx("div",{className:"aspect-[32/98] bg-muted flex items-center justify-center overflow-hidden border border-border",children:u.thumbnail_url?a.jsx("img",{src:u.thumbnail_url,alt:u.name,className:"w-full h-full object-cover"}):a.jsx("div",{className:"text-muted-foreground text-sm uppercase tracking-widest",children:u.name})}),a.jsxs("div",{className:"flex items-center justify-between pb-6 border-b border-border",children:[a.jsxs("div",{className:"flex gap-4 text-sm text-muted-foreground",children:[a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(Zn,{className:"w-4 h-4"}),u.view_count," views"]}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(sn,{className:"w-4 h-4"}),u.like_count," likes"]})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs(de,{size:"sm",variant:"outline",onClick:v=>{v.stopPropagation(),x(u,v),f(null)},className:"gap-2",children:[a.jsx(pf,{className:"w-4 h-4"}),"Remix"]}),a.jsx(de,{size:"sm",variant:c.has(u.id)?"default":"outline",onClick:v=>_(u.id,v),children:a.jsx(sn,{className:`w-4 h-4 ${c.has(u.id)?"fill-current":""}`})})]})]}),a.jsx(Ww,{designId:u.id})]})]})]})]})}function $w(){const{token:r}=fm(),e=Tr(),{loadDesign:t}=Ct(),[n,i]=T.useState(null),[l,c]=T.useState(!0),[d,u]=T.useState(null);T.useEffect(()=>{r&&f()},[r]);const f=async()=>{var p,m;if(r){c(!0),u(null);try{const y=await $x.getSharedDesign(r);i(y),t(y.canvas_data)}catch(y){console.error("Failed to load shared design:",y),u(((m=(p=y.response)==null?void 0:p.data)==null?void 0:m.error)||"Failed to load shared design")}finally{c(!1)}}};return l?a.jsx("div",{className:"h-screen w-screen flex items-center justify-center bg-background",children:a.jsxs("div",{className:"text-center space-y-3",children:[a.jsx(xr,{className:"w-12 h-12 mx-auto animate-spin text-primary"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"Loading shared design..."})]})}):d||!n?a.jsx("div",{className:"h-screen w-screen flex items-center justify-center bg-background",children:a.jsxs("div",{className:"text-center space-y-4 max-w-md",children:[a.jsx(yy,{className:"w-12 h-12 mx-auto text-destructive"}),a.jsx("h2",{className:"font-display text-xl uppercase tracking-wider",children:"Design Not Found"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:d||"This shared design link may have been revoked or does not exist."}),a.jsxs(de,{onClick:()=>e("/"),className:"gap-2",children:[a.jsx(vy,{className:"w-4 h-4"}),"Go to DeckForge"]})]})}):a.jsxs("div",{className:"h-screen w-screen flex flex-col bg-background overflow-hidden",children:[a.jsxs("header",{className:"h-12 border-b border-border flex items-center px-4 bg-card shrink-0",children:[a.jsxs("h1",{className:"font-display text-lg uppercase tracking-widest text-foreground",children:["Deck",a.jsx("span",{className:"text-primary",children:"Forge"})]}),a.jsx("div",{className:"ml-4 flex items-center gap-2",children:a.jsx("span",{className:"tag-brutal",children:"Shared"})}),a.jsxs("div",{className:"ml-auto flex items-center gap-3",children:[a.jsxs("div",{className:"text-right hidden sm:block",children:[a.jsx("h2",{className:"text-sm font-medium",children:n.name}),a.jsxs("p",{className:"text-xs text-muted-foreground",children:["View only  Created ",new Date(n.created_at).toLocaleDateString()]})]}),a.jsx(de,{size:"sm",variant:"outline",onClick:()=>e("/"),className:"gap-2",children:"Create Your Own"})]})]}),a.jsx("div",{className:"flex-1 flex overflow-hidden",children:a.jsx(ed,{})}),a.jsx("footer",{className:"h-10 border-t border-border flex items-center justify-center px-4 bg-card shrink-0",children:a.jsxs("p",{className:"text-xs text-muted-foreground",children:["Made with ",a.jsx("span",{className:"text-primary",children:"DeckForge"}),"  Fingerboard Graphics Editor"]})})]})}const on={async browseDesigns(r){let e=lt.from("marketplace_designs").select(`
        *,
        designer:designer_profiles!inner(bio, verified)
      `).eq("published",!0);r.category&&r.category!=="all"&&(e=e.eq("category",r.category)),r.search&&(e=e.or(`title.ilike.%${r.search}%,description.ilike.%${r.search}%`)),r.priceMin!==void 0&&(e=e.gte("price",r.priceMin)),r.priceMax!==void 0&&(e=e.lte("price",r.priceMax)),r.tags&&r.tags.length>0&&(e=e.contains("tags",r.tags)),r.sortBy==="newest"?e=e.order("created_at",{ascending:!1}):r.sortBy==="popular"?e=e.order("downloads",{ascending:!1}):r.sortBy==="trending"&&(e=e.gte("created_at",new Date(Date.now()-7*24*60*60*1e3).toISOString()).order("downloads",{ascending:!1})),e=e.range(r.offset||0,(r.offset||0)+(r.limit||20)-1);const{data:t,error:n}=await e;if(n)throw n;return t},async getDesign(r){const{data:e,error:t}=await lt.from("marketplace_designs").select(`
        *,
        designer:designer_profiles!inner(bio, verified)
      `).eq("id",r).single();if(t)throw t;await lt.rpc("increment_views",{design_id:r});const{data:n}=await lt.auth.getSession();if(n.session){const{data:i}=await lt.from("marketplace_favorites").select("design_id").eq("user_id",n.session.user.id).eq("design_id",r).single();e.is_favorited=!!i;const{data:l}=await lt.from("marketplace_purchases").select("design_id").eq("buyer_id",n.session.user.id).eq("design_id",r).single();e.is_purchased=!!l}return e},async uploadDesign(r){const{data:e}=await lt.auth.getSession();if(!e.session)throw new Error("Not authenticated");const n=`${e.session.user.id}/${Date.now()}.deckforge`,{data:i,error:l}=await lt.storage.from("marketplace-designs").upload(n,r.file);if(l)throw l;const d=`${e.session.user.id}/${Date.now()}_thumb.png`,{data:u,error:f}=await lt.storage.from("marketplace-designs").upload(d,r.thumbnail);if(f)throw f;const{data:{publicUrl:p}}=lt.storage.from("marketplace-designs").getPublicUrl(n),{data:{publicUrl:m}}=lt.storage.from("marketplace-designs").getPublicUrl(d),{data:y,error:w}=await lt.from("marketplace_designs").insert({user_id:e.session.user.id,title:r.title,description:r.description,file_url:p,thumbnail_url:m,price:r.price,license_type:r.license_type,tags:r.tags,category:r.category,published:!0}).select().single();if(w)throw w;return y},async purchaseDesign(r){const{data:e}=await lt.auth.getSession();if(!e.session)throw new Error("Not authenticated");const{data:t,error:n}=await lt.from("marketplace_designs").select("price, user_id").eq("id",r).single();if(n)throw n;if(t.user_id===e.session.user.id)throw new Error("Cannot purchase your own design");const{data:i}=await lt.from("marketplace_purchases").select("id").eq("buyer_id",e.session.user.id).eq("design_id",r).single();if(i)throw new Error("Already purchased");const{data:l,error:c}=await lt.from("marketplace_purchases").insert({design_id:r,buyer_id:e.session.user.id,price_paid:t.price}).select().single();if(c)throw c;return l},async getMyPurchases(){const{data:r}=await lt.auth.getSession();if(!r.session)throw new Error("Not authenticated");const{data:e,error:t}=await lt.from("marketplace_purchases").select(`
        *,
        design:marketplace_designs(*)
      `).eq("buyer_id",r.session.user.id).order("purchased_at",{ascending:!1});if(t)throw t;return e},async toggleFavorite(r){const{data:e}=await lt.auth.getSession();if(!e.session)throw new Error("Not authenticated");const{data:t}=await lt.from("marketplace_favorites").select("design_id").eq("user_id",e.session.user.id).eq("design_id",r).single();if(t){const{error:n}=await lt.from("marketplace_favorites").delete().eq("user_id",e.session.user.id).eq("design_id",r);if(n)throw n;return!1}else{const{error:n}=await lt.from("marketplace_favorites").insert({user_id:e.session.user.id,design_id:r});if(n)throw n;return!0}},async getDesignerProfile(r){const{data:e,error:t}=await lt.from("designer_profiles").select("*").eq("user_id",r).single();if(t)throw t;return e},async updateDesignerProfile(r){const{data:e}=await lt.auth.getSession();if(!e.session)throw new Error("Not authenticated");const{data:t}=await lt.from("designer_profiles").select("id").eq("user_id",e.session.user.id).single();if(t){const{data:n,error:i}=await lt.from("designer_profiles").update(r).eq("user_id",e.session.user.id).select().single();if(i)throw i;return n}else{const{data:n,error:i}=await lt.from("designer_profiles").insert({user_id:e.session.user.id,...r}).select().single();if(i)throw i;return n}},async getDesignerDesigns(r){const{data:e,error:t}=await lt.from("marketplace_designs").select("*").eq("user_id",r).eq("published",!0).order("created_at",{ascending:!1});if(t)throw t;return e}};function Yw(){const r=Tr(),[e,t]=T.useState([]),[n,i]=T.useState(!0),[l,c]=T.useState(""),[d,u]=T.useState("all"),[f,p]=T.useState("trending"),[m,y]=T.useState("all");T.useEffect(()=>{w()},[d,f,m]);const w=async()=>{i(!0);try{const v={category:d!=="all"?d:void 0,sortBy:f,limit:50};m==="free"?(v.priceMin=0,v.priceMax=0):m==="paid"&&(v.priceMin=.01),l&&(v.search=l);const S=await on.browseDesigns(v);t(S)}catch(v){ce.error("Failed to load designs"),console.error(v)}finally{i(!1)}},_=v=>{v.preventDefault(),w()},x=[{value:"all",label:"All",icon:""},{value:"street",label:"Street",icon:""},{value:"edgy",label:"Edgy",icon:""},{value:"retro",label:"Retro",icon:""},{value:"minimal",label:"Minimal",icon:""},{value:"pro",label:"Pro",icon:""}];return a.jsxs("div",{className:"min-h-screen bg-background",children:[a.jsx("div",{className:"border-b border-border bg-card",children:a.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-6",children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-3xl font-bold text-foreground",children:"Design Marketplace"}),a.jsx("p",{className:"text-muted-foreground mt-1",children:"Discover and download custom fingerboard graphics"})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs(de,{onClick:()=>r("/marketplace/dashboard"),variant:"outline",className:"gap-2",children:[a.jsx(Fd,{className:"w-4 h-4"}),"Dashboard"]}),a.jsxs(de,{onClick:()=>r("/marketplace/upload"),className:"gap-2",children:[a.jsx(cr,{className:"w-4 h-4"}),"Upload Design"]})]})]}),a.jsx("form",{onSubmit:_,className:"mb-4",children:a.jsxs("div",{className:"relative",children:[a.jsx(hm,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-muted-foreground"}),a.jsx(pt,{type:"text",placeholder:"Search designs...",value:l,onChange:v=>c(v.target.value),className:"pl-10"})]})}),a.jsxs("div",{className:"flex flex-wrap gap-4 items-center",children:[a.jsx("div",{className:"flex gap-2 flex-wrap",children:x.map(v=>a.jsxs("button",{onClick:()=>u(v.value),className:`px-3 py-1.5 rounded-lg text-sm font-medium transition-colors flex items-center gap-2 ${d===v.value?"bg-primary text-primary-foreground":"bg-secondary text-secondary-foreground hover:bg-secondary/80"}`,children:[a.jsx("span",{children:v.icon}),v.label]},v.value))}),a.jsxs("div",{className:"flex items-center gap-2 ml-auto",children:[a.jsx("span",{className:"text-sm text-muted-foreground",children:"Sort:"}),a.jsxs("select",{value:f,onChange:v=>p(v.target.value),className:"px-3 py-1.5 rounded-lg text-sm bg-secondary border-border",children:[a.jsx("option",{value:"trending",children:" Trending"}),a.jsx("option",{value:"newest",children:" Newest"}),a.jsx("option",{value:"popular",children:" Popular"})]})]}),a.jsxs("select",{value:m,onChange:v=>y(v.target.value),className:"px-3 py-1.5 rounded-lg text-sm bg-secondary border-border",children:[a.jsx("option",{value:"all",children:"All Prices"}),a.jsx("option",{value:"free",children:"Free"}),a.jsx("option",{value:"paid",children:"Paid"})]})]})]})}),a.jsx("div",{className:"max-w-7xl mx-auto px-4 py-8",children:n?a.jsxs("div",{className:"text-center py-20",children:[a.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-primary"}),a.jsx("p",{className:"mt-4 text-muted-foreground",children:"Loading designs..."})]}):e.length===0?a.jsxs("div",{className:"text-center py-20",children:[a.jsx("p",{className:"text-lg text-muted-foreground",children:"No designs found"}),a.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:"Try adjusting your filters"})]}):a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:e.map(v=>a.jsx(Xw,{design:v},v.id))})})]})}function Xw({design:r}){const e=Tr(),[t,n]=T.useState(r.is_favorited||!1),i=async l=>{l.stopPropagation();try{const c=await on.toggleFavorite(r.id);n(c),ce.success(c?"Added to favorites":"Removed from favorites")}catch(c){ce.error(c.message||"Failed to toggle favorite")}};return a.jsxs("div",{onClick:()=>e(`/marketplace/design/${r.id}`),className:"group border border-border rounded-lg overflow-hidden hover:shadow-lg transition-all cursor-pointer bg-card",children:[a.jsxs("div",{className:"aspect-[3/8] bg-gradient-to-br from-muted to-muted/50 relative",children:[r.thumbnail_url?a.jsx("img",{src:r.thumbnail_url,alt:r.title,className:"w-full h-full object-cover"}):a.jsx("div",{className:"w-full h-full flex items-center justify-center text-6xl",children:""}),a.jsx("button",{onClick:i,className:"absolute top-2 right-2 w-8 h-8 rounded-full bg-background/80 backdrop-blur-sm flex items-center justify-center hover:bg-background transition-colors",children:a.jsx(sn,{className:`w-4 h-4 ${t?"fill-red-500 text-red-500":"text-foreground"}`})}),r.featured_until&&new Date(r.featured_until)>new Date&&a.jsxs("div",{className:"absolute top-2 left-2 bg-yellow-400 text-yellow-900 px-2 py-1 rounded-full flex items-center gap-1 text-xs font-bold",children:[a.jsx(cr,{className:"w-3 h-3"}),"Featured"]})]}),a.jsxs("div",{className:"p-4",children:[a.jsx("h3",{className:"font-bold text-foreground group-hover:text-primary transition-colors truncate",children:r.title}),r.description&&a.jsx("p",{className:"text-sm text-muted-foreground mt-1 line-clamp-2",children:r.description}),a.jsxs("div",{className:"flex items-center gap-3 mt-3 text-xs text-muted-foreground",children:[a.jsxs("span",{className:"flex items-center gap-1",children:[a.jsx(Hr,{className:"w-3 h-3"}),r.downloads]}),a.jsxs("span",{className:"flex items-center gap-1",children:[a.jsx(sn,{className:"w-3 h-3"}),r.favorites]})]}),a.jsxs("div",{className:"flex items-center justify-between mt-4 pt-4 border-t border-border",children:[r.price===0?a.jsx("span",{className:"text-sm font-bold text-green-600",children:"FREE"}):a.jsxs("span",{className:"text-sm font-bold text-foreground flex items-center gap-1",children:[a.jsx(zd,{className:"w-4 h-4"}),r.price.toFixed(2)]}),r.designer&&r.designer.verified&&a.jsx("span",{className:"text-xs bg-blue-500/10 text-blue-500 px-2 py-1 rounded-full font-medium",children:"Verified"})]})]})]})}function qw(){var S,C;const{id:r}=fm(),e=Tr(),{isAuthenticated:t}=Nn(),[n,i]=T.useState(null),[l,c]=T.useState(!0),[d,u]=T.useState(!1),[f,p]=T.useState(!1);T.useEffect(()=>{m()},[r]);const m=async()=>{if(r){c(!0);try{const k=await on.getDesign(r);i(k),p(k.is_favorited||!1)}catch(k){ce.error("Failed to load design"),console.error(k)}finally{c(!1)}}},y=async()=>{if(!t){ce.error("Please sign in to favorite designs"),e("/auth");return}try{const k=await on.toggleFavorite(r);p(k),ce.success(k?"Added to favorites":"Removed from favorites"),n&&i({...n,favorites:k?n.favorites+1:n.favorites-1})}catch(k){ce.error(k.message||"Failed to toggle favorite")}},w=async()=>{if(!t){ce.error("Please sign in to purchase"),e("/auth");return}if(n){if(n.price===0){_();return}u(!0);try{await on.purchaseDesign(r),ce.success("Purchase successful! Downloading now..."),_(),m()}catch(k){ce.error(k.message||"Purchase failed")}finally{u(!1)}}},_=()=>{if(!n)return;const k=document.createElement("a");k.href=n.file_url,k.download=`${n.title}.deckforge`,document.body.appendChild(k),k.click(),document.body.removeChild(k),ce.success("Design downloaded!")},x=()=>{n&&ce.info("Opening in editor...",{description:"This feature is coming soon!"})},v=()=>{navigator.share?navigator.share({title:n==null?void 0:n.title,text:(n==null?void 0:n.description)||"",url:window.location.href}):(navigator.clipboard.writeText(window.location.href),ce.success("Link copied to clipboard!"))};return l?a.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:a.jsx(xr,{className:"w-8 h-8 animate-spin text-primary"})}):n?a.jsxs("div",{className:"min-h-screen bg-background",children:[a.jsx("div",{className:"border-b border-border bg-card",children:a.jsx("div",{className:"max-w-7xl mx-auto px-4 py-4",children:a.jsx(de,{variant:"ghost",onClick:()=>e("/marketplace"),className:"mb-4",children:" Back to Marketplace"})})}),a.jsx("div",{className:"max-w-7xl mx-auto px-4 py-8",children:a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[a.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[a.jsxs("div",{className:"aspect-[3/8] bg-gradient-to-br from-muted to-muted/50 rounded-lg overflow-hidden relative",children:[n.thumbnail_url?a.jsx("img",{src:n.thumbnail_url,alt:n.title,className:"w-full h-full object-cover"}):a.jsx("div",{className:"w-full h-full flex items-center justify-center text-8xl",children:""}),n.featured_until&&new Date(n.featured_until)>new Date&&a.jsxs("div",{className:"absolute top-4 left-4 bg-yellow-400 text-yellow-900 px-3 py-1.5 rounded-full flex items-center gap-2 text-sm font-bold",children:[a.jsx(Md,{className:"w-4 h-4 fill-current"}),"Featured"]})]}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-3xl font-bold text-foreground",children:n.title}),a.jsxs("div",{className:"flex items-center gap-4 mt-3 text-sm text-muted-foreground",children:[a.jsxs("span",{className:"flex items-center gap-1",children:[a.jsx(Zn,{className:"w-4 h-4"}),n.views," views"]}),a.jsxs("span",{className:"flex items-center gap-1",children:[a.jsx(Hr,{className:"w-4 h-4"}),n.downloads," downloads"]}),a.jsxs("span",{className:"flex items-center gap-1",children:[a.jsx(sn,{className:"w-4 h-4"}),n.favorites," favorites"]})]}),n.description&&a.jsx("p",{className:"text-muted-foreground mt-4 whitespace-pre-wrap",children:n.description})]}),n.tags&&n.tags.length>0&&a.jsxs("div",{children:[a.jsx("h3",{className:"text-sm font-semibold text-foreground mb-2",children:"Tags"}),a.jsx("div",{className:"flex flex-wrap gap-2",children:n.tags.map(k=>a.jsx("span",{className:"px-3 py-1 rounded-full bg-secondary text-secondary-foreground text-sm",children:k},k))})]}),a.jsxs("div",{className:"border border-border rounded-lg p-4 bg-card",children:[a.jsx("h3",{className:"text-sm font-semibold text-foreground mb-2",children:"License"}),a.jsxs("div",{className:"text-sm text-muted-foreground",children:[n.license_type==="personal"&&a.jsx("p",{children:"Personal use only. Cannot be used for commercial purposes."}),n.license_type==="commercial"&&a.jsx("p",{children:"Commercial use allowed. Can be used for business purposes."}),n.license_type==="unlimited"&&a.jsx("p",{children:"Unlimited use. Use however you want, including resale."})]})]})]}),a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"border border-border rounded-lg p-6 bg-card sticky top-4",children:[a.jsxs("div",{className:"mb-6",children:[n.price===0?a.jsx("div",{className:"text-3xl font-bold text-green-600",children:"FREE"}):a.jsxs("div",{className:"flex items-baseline gap-2",children:[a.jsxs("span",{className:"text-3xl font-bold text-foreground",children:["$",n.price.toFixed(2)]}),a.jsx("span",{className:"text-sm text-muted-foreground",children:"USD"})]}),a.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[n.license_type.charAt(0).toUpperCase()+n.license_type.slice(1)," License"]})]}),a.jsxs("div",{className:"space-y-3",children:[n.is_purchased?a.jsxs(a.Fragment,{children:[a.jsxs(de,{onClick:_,className:"w-full gap-2",size:"lg",children:[a.jsx(Hr,{className:"w-4 h-4"}),"Download Again"]}),a.jsxs(de,{onClick:x,variant:"outline",className:"w-full gap-2",size:"lg",children:[a.jsx(wy,{className:"w-4 h-4"}),"Open in Editor"]})]}):a.jsxs(a.Fragment,{children:[a.jsx(de,{onClick:w,className:"w-full gap-2",size:"lg",disabled:d,children:d?a.jsxs(a.Fragment,{children:[a.jsx(xr,{className:"w-4 h-4 animate-spin"}),"Processing..."]}):a.jsx(a.Fragment,{children:n.price===0?a.jsxs(a.Fragment,{children:[a.jsx(Hr,{className:"w-4 h-4"}),"Download Free"]}):a.jsxs(a.Fragment,{children:[a.jsx(by,{className:"w-4 h-4"}),"Purchase & Download"]})})}),a.jsxs(de,{onClick:y,variant:"outline",className:"w-full gap-2",size:"lg",children:[a.jsx(sn,{className:`w-4 h-4 ${f?"fill-red-500 text-red-500":""}`}),f?"Favorited":"Add to Favorites"]})]}),a.jsxs(de,{onClick:v,variant:"ghost",className:"w-full gap-2",size:"sm",children:[a.jsx(dm,{className:"w-4 h-4"}),"Share"]})]})]}),n.designer&&a.jsxs("div",{className:"border border-border rounded-lg p-4 bg-card",children:[a.jsx("h3",{className:"text-sm font-semibold text-foreground mb-3",children:"Designer"}),a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("div",{className:"w-12 h-12 rounded-full bg-gradient-to-br from-primary to-primary/50 flex items-center justify-center text-xl font-bold text-primary-foreground",children:((C=(S=n.designer.email)==null?void 0:S[0])==null?void 0:C.toUpperCase())||"D"}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"font-medium text-foreground truncate",children:n.designer.email}),n.designer.verified&&a.jsx("span",{className:"text-xs bg-blue-500/10 text-blue-500 px-2 py-0.5 rounded-full font-medium",children:"Verified"})]}),n.designer.bio&&a.jsx("p",{className:"text-sm text-muted-foreground mt-1 line-clamp-2",children:n.designer.bio})]})]}),a.jsx(de,{onClick:()=>e(`/marketplace/designer/${n.user_id}`),variant:"outline",className:"w-full mt-4",size:"sm",children:"View Profile"})]}),a.jsxs("div",{className:"border border-border rounded-lg p-4 bg-card",children:[a.jsx("h3",{className:"text-sm font-semibold text-foreground mb-2",children:"Category"}),a.jsx("span",{className:"inline-block px-3 py-1.5 rounded-lg bg-primary/10 text-primary text-sm font-medium",children:n.category.charAt(0).toUpperCase()+n.category.slice(1)})]})]})]})})]}):a.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx("h2",{className:"text-2xl font-bold text-foreground",children:"Design not found"}),a.jsx(de,{onClick:()=>e("/marketplace"),className:"mt-4",children:"Back to Marketplace"})]})})}function Kw(){const r=Tr(),{isAuthenticated:e}=Nn(),[t,n]=T.useState(!1),[i,l]=T.useState(""),[c,d]=T.useState(""),[u,f]=T.useState("0"),[p,m]=T.useState("personal"),[y,w]=T.useState("street"),[_,x]=T.useState(""),[v,S]=T.useState(null),[C,k]=T.useState(null),E=I=>{var z;const B=(z=I.target.files)==null?void 0:z[0];if(B){if(!B.name.endsWith(".deckforge")){ce.error("Please upload a .deckforge file");return}S(B)}},P=I=>{var z;const B=(z=I.target.files)==null?void 0:z[0];if(B){if(!B.type.startsWith("image/")){ce.error("Please upload an image file");return}k(B)}},D=async I=>{if(I.preventDefault(),!e){ce.error("Please sign in to upload designs"),r("/auth");return}if(!i.trim()){ce.error("Please enter a title");return}if(!v){ce.error("Please upload a design file");return}if(!C){ce.error("Please upload a thumbnail image");return}const B=parseFloat(u);if(isNaN(B)||B<0){ce.error("Please enter a valid price");return}if(B>100){ce.error("Maximum price is $100");return}n(!0);try{const z=_.split(",").map(X=>X.trim()).filter(X=>X.length>0);await on.uploadDesign({title:i.trim(),description:c.trim(),file:v,thumbnail:C,price:B,license_type:p,tags:z,category:y}),ce.success("Design uploaded successfully!"),r("/marketplace")}catch(z){ce.error(z.message||"Failed to upload design"),console.error(z)}finally{n(!1)}};return a.jsxs("div",{className:"min-h-screen bg-background",children:[a.jsx("div",{className:"border-b border-border bg-card",children:a.jsxs("div",{className:"max-w-3xl mx-auto px-4 py-6",children:[a.jsx(de,{variant:"ghost",onClick:()=>r("/marketplace"),className:"mb-4",children:" Back to Marketplace"}),a.jsx("h1",{className:"text-3xl font-bold text-foreground",children:"Upload Design"}),a.jsx("p",{className:"text-muted-foreground mt-1",children:"Share your design with the community"})]})}),a.jsx("div",{className:"max-w-3xl mx-auto px-4 py-8",children:a.jsxs("form",{onSubmit:D,className:"space-y-6",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(Ee,{htmlFor:"title",children:"Title *"}),a.jsx(pt,{id:"title",placeholder:"My Awesome Deck Design",value:i,onChange:I=>l(I.target.value),maxLength:100}),a.jsxs("p",{className:"text-xs text-muted-foreground",children:[i.length,"/100 characters"]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Ee,{htmlFor:"description",children:"Description"}),a.jsx(Yp,{id:"description",placeholder:"Tell people about your design...",value:c,onChange:I=>d(I.target.value),rows:4,maxLength:500}),a.jsxs("p",{className:"text-xs text-muted-foreground",children:[c.length,"/500 characters"]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Ee,{htmlFor:"design-file",children:"Design File (.deckforge) *"}),a.jsxs("div",{className:"border-2 border-dashed border-border rounded-lg p-6 hover:border-primary transition-colors",children:[a.jsx("input",{type:"file",id:"design-file",accept:".deckforge",onChange:E,className:"hidden"}),a.jsxs("label",{htmlFor:"design-file",className:"flex flex-col items-center cursor-pointer",children:[a.jsx(Ho,{className:"w-8 h-8 text-muted-foreground mb-2"}),v?a.jsx("p",{className:"text-sm text-foreground font-medium",children:v.name}):a.jsxs(a.Fragment,{children:[a.jsx("p",{className:"text-sm text-foreground font-medium",children:"Click to upload design file"}),a.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:".deckforge file from DeckForge editor"})]})]})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Ee,{htmlFor:"thumbnail",children:"Preview Image *"}),a.jsxs("div",{className:"border-2 border-dashed border-border rounded-lg p-6 hover:border-primary transition-colors",children:[a.jsx("input",{type:"file",id:"thumbnail",accept:"image/png,image/jpeg,image/jpg",onChange:P,className:"hidden"}),a.jsxs("label",{htmlFor:"thumbnail",className:"flex flex-col items-center cursor-pointer",children:[a.jsx(Id,{className:"w-8 h-8 text-muted-foreground mb-2"}),C?a.jsxs(a.Fragment,{children:[a.jsx("p",{className:"text-sm text-foreground font-medium",children:C.name}),a.jsx("img",{src:URL.createObjectURL(C),alt:"Preview",className:"mt-4 max-h-48 rounded-lg"})]}):a.jsxs(a.Fragment,{children:[a.jsx("p",{className:"text-sm text-foreground font-medium",children:"Click to upload preview image"}),a.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"PNG or JPG, recommended 750x2450px"})]})]})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Ee,{htmlFor:"category",children:"Category *"}),a.jsxs("select",{id:"category",value:y,onChange:I=>w(I.target.value),className:"w-full h-10 px-3 rounded-md border border-border bg-background",children:[a.jsx("option",{value:"street",children:"Street"}),a.jsx("option",{value:"edgy",children:"Edgy"}),a.jsx("option",{value:"retro",children:"Retro"}),a.jsx("option",{value:"minimal",children:"Minimal"}),a.jsx("option",{value:"pro",children:"Pro"})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Ee,{htmlFor:"tags",children:"Tags"}),a.jsx(pt,{id:"tags",placeholder:"graffiti, urban, colorful (comma separated)",value:_,onChange:I=>x(I.target.value)}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"Separate tags with commas. Max 10 tags."})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Ee,{htmlFor:"price",children:"Price (USD) *"}),a.jsxs("div",{className:"relative",children:[a.jsx(zd,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground"}),a.jsx(pt,{id:"price",type:"number",step:"0.01",min:"0",max:"100",placeholder:"0.00",value:u,onChange:I=>f(I.target.value),className:"pl-8"})]}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"Set to $0.00 for free. You'll receive 80% of paid sales."})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Ee,{children:"License Type *"}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("label",{className:"flex items-start gap-3 p-4 border border-border rounded-lg cursor-pointer hover:border-primary transition-colors",children:[a.jsx("input",{type:"radio",name:"license",value:"personal",checked:p==="personal",onChange:I=>m(I.target.value),className:"mt-1"}),a.jsxs("div",{className:"flex-1",children:[a.jsx("div",{className:"font-medium text-foreground",children:"Personal Use"}),a.jsx("div",{className:"text-sm text-muted-foreground",children:"Buyer can use for personal projects only"})]})]}),a.jsxs("label",{className:"flex items-start gap-3 p-4 border border-border rounded-lg cursor-pointer hover:border-primary transition-colors",children:[a.jsx("input",{type:"radio",name:"license",value:"commercial",checked:p==="commercial",onChange:I=>m(I.target.value),className:"mt-1"}),a.jsxs("div",{className:"flex-1",children:[a.jsx("div",{className:"font-medium text-foreground",children:"Commercial Use"}),a.jsx("div",{className:"text-sm text-muted-foreground",children:"Buyer can use for commercial projects"})]})]}),a.jsxs("label",{className:"flex items-start gap-3 p-4 border border-border rounded-lg cursor-pointer hover:border-primary transition-colors",children:[a.jsx("input",{type:"radio",name:"license",value:"unlimited",checked:p==="unlimited",onChange:I=>m(I.target.value),className:"mt-1"}),a.jsxs("div",{className:"flex-1",children:[a.jsx("div",{className:"font-medium text-foreground",children:"Unlimited"}),a.jsx("div",{className:"text-sm text-muted-foreground",children:"Buyer can use however they want, including resale"})]})]})]})]}),a.jsxs("div",{className:"border border-blue-500/20 bg-blue-500/10 rounded-lg p-4 flex gap-3",children:[a.jsx(Zp,{className:"w-5 h-5 text-blue-500 flex-shrink-0 mt-0.5"}),a.jsxs("div",{className:"text-sm text-foreground",children:[a.jsx("p",{className:"font-medium mb-1",children:"Before uploading:"}),a.jsxs("ul",{className:"list-disc list-inside space-y-1 text-muted-foreground",children:[a.jsx("li",{children:"Ensure your design is original or you have rights to sell it"}),a.jsx("li",{children:"No copyrighted logos or trademarks without permission"}),a.jsx("li",{children:"Create a high-quality preview image"}),a.jsx("li",{children:"Choose appropriate tags for discoverability"})]})]})]}),a.jsxs("div",{className:"flex gap-4",children:[a.jsx(de,{type:"submit",disabled:t,className:"flex-1",size:"lg",children:t?a.jsxs(a.Fragment,{children:[a.jsx(xr,{className:"w-4 h-4 mr-2 animate-spin"}),"Uploading..."]}):a.jsxs(a.Fragment,{children:[a.jsx(Ho,{className:"w-4 h-4 mr-2"}),"Upload Design"]})}),a.jsx(de,{type:"button",variant:"outline",onClick:()=>r("/marketplace"),disabled:t,size:"lg",children:"Cancel"})]})]})})]})}function Qw(){const r=Tr(),{isAuthenticated:e,user:t}=Nn(),[n,i]=T.useState(null),[l,c]=T.useState([]),[d,u]=T.useState(!0);T.useEffect(()=>{if(!e){r("/auth");return}f()},[e]);const f=async()=>{u(!0);try{if(t!=null&&t.id){try{const v=await on.getDesignerProfile(t.id);i(v)}catch{const S=await on.updateDesignerProfile({bio:"",social_links:{}});i(S)}const x=await on.getDesignerDesigns(t.id);c(x)}}catch(x){ce.error("Failed to load dashboard"),console.error(x)}finally{u(!1)}},p=async x=>{if(confirm("Are you sure you want to delete this design?"))try{await fetch(`undefined/rest/v1/marketplace_designs?id=eq.${x}`,{method:"DELETE",headers:{apikey:void 0,Authorization:`Bearer ${(await on).supabase.auth.getSession()}`}}),ce.success("Design deleted"),f()}catch{ce.error("Failed to delete design")}};if(d)return a.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:a.jsx(xr,{className:"w-8 h-8 animate-spin text-primary"})});const m=(n==null?void 0:n.total_earnings)||0,y=(n==null?void 0:n.total_sales)||0,w=l.length,_=l.reduce((x,v)=>x+v.downloads,0);return a.jsxs("div",{className:"min-h-screen bg-background",children:[a.jsx("div",{className:"border-b border-border bg-card",children:a.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-6",children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-3xl font-bold text-foreground",children:"Designer Dashboard"}),a.jsx("p",{className:"text-muted-foreground mt-1",children:"Manage your designs and track your earnings"})]}),a.jsxs(de,{onClick:()=>r("/marketplace/upload"),className:"gap-2",children:[a.jsx(da,{className:"w-4 h-4"}),"Upload New Design"]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[a.jsx(No,{icon:zd,label:"Total Earnings",value:`$${m.toFixed(2)}`,description:"80% of sales",color:"text-green-600"}),a.jsx(No,{icon:Fd,label:"Total Sales",value:y.toString(),description:"Completed purchases",color:"text-blue-600"}),a.jsx(No,{icon:mf,label:"Designs",value:w.toString(),description:"Published designs",color:"text-purple-600"}),a.jsx(No,{icon:Hr,label:"Downloads",value:_.toString(),description:"All-time downloads",color:"text-orange-600"})]})]})}),a.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-8",children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsx("h2",{className:"text-2xl font-bold text-foreground",children:"Your Designs"}),a.jsx(de,{variant:"outline",onClick:()=>r("/marketplace"),children:"View Marketplace"})]}),l.length===0?a.jsxs("div",{className:"text-center py-20 border border-dashed border-border rounded-lg",children:[a.jsx(mf,{className:"w-12 h-12 mx-auto text-muted-foreground mb-4"}),a.jsx("h3",{className:"text-lg font-semibold text-foreground mb-2",children:"No designs yet"}),a.jsx("p",{className:"text-sm text-muted-foreground mb-6",children:"Upload your first design to start earning"}),a.jsxs(de,{onClick:()=>r("/marketplace/upload"),children:[a.jsx(da,{className:"w-4 h-4 mr-2"}),"Upload Design"]})]}):a.jsx("div",{className:"space-y-4",children:l.map(x=>a.jsx(Zw,{design:x,onDelete:()=>p(x.id)},x.id))})]})]})}function No({icon:r,label:e,value:t,description:n,color:i}){return a.jsx("div",{className:"border border-border rounded-lg p-4 bg-card",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:`w-10 h-10 rounded-full bg-muted flex items-center justify-center ${i}`,children:a.jsx(r,{className:"w-5 h-5"})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("p",{className:"text-sm text-muted-foreground",children:e}),a.jsx("p",{className:"text-2xl font-bold text-foreground",children:t}),a.jsx("p",{className:"text-xs text-muted-foreground",children:n})]})]})})}function Zw({design:r,onDelete:e}){const t=Tr();return a.jsx("div",{className:"border border-border rounded-lg p-4 bg-card hover:shadow-md transition-shadow",children:a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"w-24 h-32 bg-gradient-to-br from-muted to-muted/50 rounded overflow-hidden flex-shrink-0 cursor-pointer",onClick:()=>t(`/marketplace/design/${r.id}`),children:r.thumbnail_url?a.jsx("img",{src:r.thumbnail_url,alt:r.title,className:"w-full h-full object-cover"}):a.jsx("div",{className:"w-full h-full flex items-center justify-center text-3xl",children:""})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"flex items-start justify-between mb-2",children:[a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h3",{className:"font-bold text-foreground truncate cursor-pointer hover:text-primary",onClick:()=>t(`/marketplace/design/${r.id}`),children:r.title}),r.description&&a.jsx("p",{className:"text-sm text-muted-foreground line-clamp-1",children:r.description})]}),a.jsxs("div",{className:"ml-4 text-right",children:[r.price===0?a.jsx("span",{className:"text-sm font-bold text-green-600",children:"FREE"}):a.jsxs("span",{className:"text-sm font-bold text-foreground",children:["$",r.price.toFixed(2)]}),a.jsx("div",{className:"text-xs text-muted-foreground",children:r.license_type})]})]}),a.jsxs("div",{className:"flex items-center gap-4 text-xs text-muted-foreground mb-3",children:[a.jsxs("span",{className:"flex items-center gap-1",children:[a.jsx(Zn,{className:"w-3 h-3"}),r.views]}),a.jsxs("span",{className:"flex items-center gap-1",children:[a.jsx(Hr,{className:"w-3 h-3"}),r.downloads]}),a.jsxs("span",{className:"flex items-center gap-1",children:[a.jsx(sn,{className:"w-3 h-3"}),r.favorites]}),a.jsx("span",{className:"px-2 py-0.5 rounded-full bg-primary/10 text-primary text-[10px] font-medium",children:r.category}),!r.published&&a.jsx("span",{className:"px-2 py-0.5 rounded-full bg-yellow-500/10 text-yellow-600 text-[10px] font-medium",children:"Draft"})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs(de,{variant:"outline",size:"sm",onClick:()=>t(`/marketplace/design/${r.id}`),className:"gap-1",children:[a.jsx(Zn,{className:"w-3 h-3"}),"View"]}),a.jsxs(de,{variant:"outline",size:"sm",onClick:()=>ce.info("Edit feature coming soon!"),className:"gap-1",children:[a.jsx(_y,{className:"w-3 h-3"}),"Edit"]}),a.jsxs(de,{variant:"outline",size:"sm",onClick:e,className:"gap-1 text-red-600 hover:text-red-700 hover:border-red-600",children:[a.jsx(jn,{className:"w-3 h-3"}),"Delete"]})]})]})]})})}const Jw=Math.PI/180;function eb(){return typeof window<"u"&&({}.toString.call(window)==="[object Window]"||{}.toString.call(window)==="[object global]")}const bs=typeof global<"u"?global:typeof window<"u"?window:typeof WorkerGlobalScope<"u"?self:{},we={_global:bs,version:"10.2.0",isBrowser:eb(),isUnminified:/param/.test((function(r){}).toString()),dblClickWindow:400,getAngle(r){return we.angleDeg?r*Jw:r},enableTrace:!1,pointerEventsEnabled:!0,autoDrawEnabled:!0,hitOnDragEnabled:!1,capturePointerEventsEnabled:!1,_mouseListenClick:!1,_touchListenClick:!1,_pointerListenClick:!1,_mouseInDblClickWindow:!1,_touchInDblClickWindow:!1,_pointerInDblClickWindow:!1,_mouseDblClickPointerId:null,_touchDblClickPointerId:null,_pointerDblClickPointerId:null,_renderBackend:"web",legacyTextRendering:!1,pixelRatio:typeof window<"u"&&window.devicePixelRatio||1,dragDistance:3,angleDeg:!0,showWarnings:!0,dragButtons:[0,1],isDragging(){return we.DD.isDragging},isTransforming(){var r,e;return(e=(r=we.Transformer)===null||r===void 0?void 0:r.isTransforming())!==null&&e!==void 0?e:!1},isDragReady(){return!!we.DD.node},releaseCanvasOnDestroy:!0,document:bs.document,_injectGlobal(r){typeof bs.Konva<"u"&&console.error("Several Konva instances detected. It is not recommended to use multiple Konva instances in the same environment."),bs.Konva=r}},kt=r=>{we[r.prototype.getClassName()]=r};we._injectGlobal(we);const tb=`Konva.js unsupported environment.

Looks like you are trying to use Konva.js in Node.js environment. because "document" object is undefined.

To use Konva.js in Node.js environment, you need to use the "canvas-backend" or "skia-backend" module.

bash: npm install canvas
js: import "konva/canvas-backend";

or

bash: npm install skia-canvas
js: import "konva/skia-backend";
`,Xf=()=>{if(typeof document>"u")throw new Error(tb)};class pr{constructor(e=[1,0,0,1,0,0]){this.dirty=!1,this.m=e&&e.slice()||[1,0,0,1,0,0]}reset(){this.m[0]=1,this.m[1]=0,this.m[2]=0,this.m[3]=1,this.m[4]=0,this.m[5]=0}copy(){return new pr(this.m)}copyInto(e){e.m[0]=this.m[0],e.m[1]=this.m[1],e.m[2]=this.m[2],e.m[3]=this.m[3],e.m[4]=this.m[4],e.m[5]=this.m[5]}point(e){const t=this.m;return{x:t[0]*e.x+t[2]*e.y+t[4],y:t[1]*e.x+t[3]*e.y+t[5]}}translate(e,t){return this.m[4]+=this.m[0]*e+this.m[2]*t,this.m[5]+=this.m[1]*e+this.m[3]*t,this}scale(e,t){return this.m[0]*=e,this.m[1]*=e,this.m[2]*=t,this.m[3]*=t,this}rotate(e){const t=Math.cos(e),n=Math.sin(e),i=this.m[0]*t+this.m[2]*n,l=this.m[1]*t+this.m[3]*n,c=this.m[0]*-n+this.m[2]*t,d=this.m[1]*-n+this.m[3]*t;return this.m[0]=i,this.m[1]=l,this.m[2]=c,this.m[3]=d,this}getTranslation(){return{x:this.m[4],y:this.m[5]}}skew(e,t){const n=this.m[0]+this.m[2]*t,i=this.m[1]+this.m[3]*t,l=this.m[2]+this.m[0]*e,c=this.m[3]+this.m[1]*e;return this.m[0]=n,this.m[1]=i,this.m[2]=l,this.m[3]=c,this}multiply(e){const t=this.m[0]*e.m[0]+this.m[2]*e.m[1],n=this.m[1]*e.m[0]+this.m[3]*e.m[1],i=this.m[0]*e.m[2]+this.m[2]*e.m[3],l=this.m[1]*e.m[2]+this.m[3]*e.m[3],c=this.m[0]*e.m[4]+this.m[2]*e.m[5]+this.m[4],d=this.m[1]*e.m[4]+this.m[3]*e.m[5]+this.m[5];return this.m[0]=t,this.m[1]=n,this.m[2]=i,this.m[3]=l,this.m[4]=c,this.m[5]=d,this}invert(){const e=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]),t=this.m[3]*e,n=-this.m[1]*e,i=-this.m[2]*e,l=this.m[0]*e,c=e*(this.m[2]*this.m[5]-this.m[3]*this.m[4]),d=e*(this.m[1]*this.m[4]-this.m[0]*this.m[5]);return this.m[0]=t,this.m[1]=n,this.m[2]=i,this.m[3]=l,this.m[4]=c,this.m[5]=d,this}getMatrix(){return this.m}decompose(){const e=this.m[0],t=this.m[1],n=this.m[2],i=this.m[3],l=this.m[4],c=this.m[5],d=e*i-t*n,u={x:l,y:c,rotation:0,scaleX:0,scaleY:0,skewX:0,skewY:0};if(e!=0||t!=0){const f=Math.sqrt(e*e+t*t);u.rotation=t>0?Math.acos(e/f):-Math.acos(e/f),u.scaleX=f,u.scaleY=d/f,u.skewX=(e*n+t*i)/d,u.skewY=0}else if(n!=0||i!=0){const f=Math.sqrt(n*n+i*i);u.rotation=Math.PI/2-(i>0?Math.acos(-n/f):-Math.acos(n/f)),u.scaleX=d/f,u.scaleY=f,u.skewX=0,u.skewY=(e*n+t*i)/d}return u.rotation=$._getRotation(u.rotation),u}}const rb="[object Array]",nb="[object Number]",sb="[object String]",ib="[object Boolean]",ab=Math.PI/180,ob=180/Math.PI,Hi="#",lb="",cb="0",db="Konva warning: ",qf="Konva error: ",ub="rgb(",$c={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,132,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,255,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,203],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[119,128,144],slategrey:[119,128,144],snow:[255,255,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],transparent:[255,255,255,0],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,5]},hb=/rgb\((\d{1,3}),(\d{1,3}),(\d{1,3})\)/;let jo=[],Ui=null;const fb=typeof requestAnimationFrame<"u"&&requestAnimationFrame||function(r){setTimeout(r,16)},$={_isElement(r){return!!(r&&r.nodeType==1)},_isFunction(r){return!!(r&&r.constructor&&r.call&&r.apply)},_isPlainObject(r){return!!r&&r.constructor===Object},_isArray(r){return Object.prototype.toString.call(r)===rb},_isNumber(r){return Object.prototype.toString.call(r)===nb&&!isNaN(r)&&isFinite(r)},_isString(r){return Object.prototype.toString.call(r)===sb},_isBoolean(r){return Object.prototype.toString.call(r)===ib},isObject(r){return r instanceof Object},isValidSelector(r){if(typeof r!="string")return!1;const e=r[0];return e==="#"||e==="."||e===e.toUpperCase()},_sign(r){return r===0||r>0?1:-1},requestAnimFrame(r){jo.push(r),jo.length===1&&fb(function(){const e=jo;jo=[],e.forEach(function(t){t()})})},createCanvasElement(){Xf();const r=document.createElement("canvas");try{r.style=r.style||{}}catch{}return r},createImageElement(){return Xf(),document.createElement("img")},_isInDocument(r){for(;r=r.parentNode;)if(r==document)return!0;return!1},_urlToImage(r,e){const t=$.createImageElement();t.onload=function(){e(t)},t.src=r},_rgbToHex(r,e,t){return((1<<24)+(r<<16)+(e<<8)+t).toString(16).slice(1)},_hexToRgb(r){r=r.replace(Hi,lb);const e=parseInt(r,16);return{r:e>>16&255,g:e>>8&255,b:e&255}},getRandomColor(){let r=(Math.random()*16777215<<0).toString(16);for(;r.length<6;)r=cb+r;return Hi+r},isCanvasFarblingActive(){if(Ui!==null)return Ui;if(typeof document>"u")return Ui=!1,!1;const r=this.createCanvasElement();r.width=10,r.height=10;const e=r.getContext("2d",{willReadFrequently:!0});e.clearRect(0,0,10,10),e.fillStyle="#282828",e.fillRect(0,0,10,10);const t=e.getImageData(0,0,10,10).data;let n=!1;for(let i=0;i<100;i++)if(t[i*4]!==40||t[i*4+1]!==40||t[i*4+2]!==40||t[i*4+3]!==255){n=!0;break}return Ui=n,this.releaseCanvas(r),Ui},getHitColor(){const r=this.getRandomColor();return this.isCanvasFarblingActive()?this.getSnappedHexColor(r):r},getHitColorKey(r,e,t){return this.isCanvasFarblingActive()&&(r=Math.round(r/5)*5,e=Math.round(e/5)*5,t=Math.round(t/5)*5),Hi+this._rgbToHex(r,e,t)},getSnappedHexColor(r){const e=this._hexToRgb(r);return Hi+this._rgbToHex(Math.round(e.r/5)*5,Math.round(e.g/5)*5,Math.round(e.b/5)*5)},getRGB(r){let e;return r in $c?(e=$c[r],{r:e[0],g:e[1],b:e[2]}):r[0]===Hi?this._hexToRgb(r.substring(1)):r.substr(0,4)===ub?(e=hb.exec(r.replace(/ /g,"")),{r:parseInt(e[1],10),g:parseInt(e[2],10),b:parseInt(e[3],10)}):{r:0,g:0,b:0}},colorToRGBA(r){return r=r||"black",$._namedColorToRBA(r)||$._hex3ColorToRGBA(r)||$._hex4ColorToRGBA(r)||$._hex6ColorToRGBA(r)||$._hex8ColorToRGBA(r)||$._rgbColorToRGBA(r)||$._rgbaColorToRGBA(r)||$._hslColorToRGBA(r)},_namedColorToRBA(r){const e=$c[r.toLowerCase()];return e?{r:e[0],g:e[1],b:e[2],a:1}:null},_rgbColorToRGBA(r){if(r.indexOf("rgb(")===0){r=r.match(/rgb\(([^)]+)\)/)[1];const e=r.split(/ *, */).map(Number);return{r:e[0],g:e[1],b:e[2],a:1}}},_rgbaColorToRGBA(r){if(r.indexOf("rgba(")===0){r=r.match(/rgba\(([^)]+)\)/)[1];const e=r.split(/ *, */).map((t,n)=>t.slice(-1)==="%"?n===3?parseInt(t)/100:parseInt(t)/100*255:Number(t));return{r:e[0],g:e[1],b:e[2],a:e[3]}}},_hex8ColorToRGBA(r){if(r[0]==="#"&&r.length===9)return{r:parseInt(r.slice(1,3),16),g:parseInt(r.slice(3,5),16),b:parseInt(r.slice(5,7),16),a:parseInt(r.slice(7,9),16)/255}},_hex6ColorToRGBA(r){if(r[0]==="#"&&r.length===7)return{r:parseInt(r.slice(1,3),16),g:parseInt(r.slice(3,5),16),b:parseInt(r.slice(5,7),16),a:1}},_hex4ColorToRGBA(r){if(r[0]==="#"&&r.length===5)return{r:parseInt(r[1]+r[1],16),g:parseInt(r[2]+r[2],16),b:parseInt(r[3]+r[3],16),a:parseInt(r[4]+r[4],16)/255}},_hex3ColorToRGBA(r){if(r[0]==="#"&&r.length===4)return{r:parseInt(r[1]+r[1],16),g:parseInt(r[2]+r[2],16),b:parseInt(r[3]+r[3],16),a:1}},_hslColorToRGBA(r){if(/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.test(r)){const[e,...t]=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(r),n=Number(t[0])/360,i=Number(t[1])/100,l=Number(t[2])/100;let c,d,u;if(i===0)return u=l*255,{r:Math.round(u),g:Math.round(u),b:Math.round(u),a:1};l<.5?c=l*(1+i):c=l+i-l*i;const f=2*l-c,p=[0,0,0];for(let m=0;m<3;m++)d=n+1/3*-(m-1),d<0&&d++,d>1&&d--,6*d<1?u=f+(c-f)*6*d:2*d<1?u=c:3*d<2?u=f+(c-f)*(2/3-d)*6:u=f,p[m]=u*255;return{r:Math.round(p[0]),g:Math.round(p[1]),b:Math.round(p[2]),a:1}}},haveIntersection(r,e){return!(e.x>r.x+r.width||e.x+e.width<r.x||e.y>r.y+r.height||e.y+e.height<r.y)},cloneObject(r){const e={};for(const t in r)this._isPlainObject(r[t])?e[t]=this.cloneObject(r[t]):this._isArray(r[t])?e[t]=this.cloneArray(r[t]):e[t]=r[t];return e},cloneArray(r){return r.slice(0)},degToRad(r){return r*ab},radToDeg(r){return r*ob},_degToRad(r){return $.warn("Util._degToRad is removed. Please use public Util.degToRad instead."),$.degToRad(r)},_radToDeg(r){return $.warn("Util._radToDeg is removed. Please use public Util.radToDeg instead."),$.radToDeg(r)},_getRotation(r){return we.angleDeg?$.radToDeg(r):r},_capitalize(r){return r.charAt(0).toUpperCase()+r.slice(1)},throw(r){throw new Error(qf+r)},error(r){console.error(qf+r)},warn(r){we.showWarnings&&console.warn(db+r)},each(r,e){for(const t in r)e(t,r[t])},_inRange(r,e,t){return e<=r&&r<t},_getProjectionToSegment(r,e,t,n,i,l){let c,d,u;const f=(r-t)*(r-t)+(e-n)*(e-n);if(f==0)c=r,d=e,u=(i-t)*(i-t)+(l-n)*(l-n);else{const p=((i-r)*(t-r)+(l-e)*(n-e))/f;p<0?(c=r,d=e,u=(r-i)*(r-i)+(e-l)*(e-l)):p>1?(c=t,d=n,u=(t-i)*(t-i)+(n-l)*(n-l)):(c=r+p*(t-r),d=e+p*(n-e),u=(c-i)*(c-i)+(d-l)*(d-l))}return[c,d,u]},_getProjectionToLine(r,e,t){const n=$.cloneObject(r);let i=Number.MAX_VALUE;return e.forEach(function(l,c){if(!t&&c===e.length-1)return;const d=e[(c+1)%e.length],u=$._getProjectionToSegment(l.x,l.y,d.x,d.y,r.x,r.y),f=u[0],p=u[1],m=u[2];m<i&&(n.x=f,n.y=p,i=m)}),n},_prepareArrayForTween(r,e,t){const n=[],i=[];if(r.length>e.length){const c=e;e=r,r=c}for(let c=0;c<r.length;c+=2)n.push({x:r[c],y:r[c+1]});for(let c=0;c<e.length;c+=2)i.push({x:e[c],y:e[c+1]});const l=[];return i.forEach(function(c){const d=$._getProjectionToLine(c,n,t);l.push(d.x),l.push(d.y)}),l},_prepareToStringify(r){let e;r.visitedByCircularReferenceRemoval=!0;for(const t in r)if(r.hasOwnProperty(t)&&r[t]&&typeof r[t]=="object"){if(e=Object.getOwnPropertyDescriptor(r,t),r[t].visitedByCircularReferenceRemoval||$._isElement(r[t]))if(e.configurable)delete r[t];else return null;else if($._prepareToStringify(r[t])===null)if(e.configurable)delete r[t];else return null}return delete r.visitedByCircularReferenceRemoval,r},_assign(r,e){for(const t in e)r[t]=e[t];return r},_getFirstPointerId(r){return r.touches?r.changedTouches[0].identifier:r.pointerId||999},releaseCanvas(...r){we.releaseCanvasOnDestroy&&r.forEach(e=>{e.width=0,e.height=0})},drawRoundedRectPath(r,e,t,n){let i=e<0?e:0,l=t<0?t:0;e=Math.abs(e),t=Math.abs(t);let c=0,d=0,u=0,f=0;typeof n=="number"?c=d=u=f=Math.min(n,e/2,t/2):(c=Math.min(n[0]||0,e/2,t/2),d=Math.min(n[1]||0,e/2,t/2),f=Math.min(n[2]||0,e/2,t/2),u=Math.min(n[3]||0,e/2,t/2)),r.moveTo(i+c,l),r.lineTo(i+e-d,l),r.arc(i+e-d,l+d,d,Math.PI*3/2,0,!1),r.lineTo(i+e,l+t-f),r.arc(i+e-f,l+t-f,f,0,Math.PI/2,!1),r.lineTo(i+u,l+t),r.arc(i+u,l+t-u,u,Math.PI/2,Math.PI,!1),r.lineTo(i,l+c),r.arc(i+c,l+c,c,Math.PI,Math.PI*3/2,!1)},drawRoundedPolygonPath(r,e,t,n,i){n=Math.abs(n);for(let l=0;l<t;l++){const c=e[(l-1+t)%t],d=e[l],u=e[(l+1)%t],f={x:d.x-c.x,y:d.y-c.y},p={x:u.x-d.x,y:u.y-d.y},m=Math.hypot(f.x,f.y),y=Math.hypot(p.x,p.y);let w;typeof i=="number"?w=i:w=l<i.length?i[l]:0,w=n*Math.cos(Math.PI/t)*Math.min(1,w/n*2);const x={x:f.x/m,y:f.y/m},v={x:p.x/y,y:p.y/y},S={x:d.x-x.x*w,y:d.y-x.y*w},C={x:d.x+v.x*w,y:d.y+v.y*w};l===0?r.moveTo(S.x,S.y):r.lineTo(S.x,S.y),r.arcTo(d.x,d.y,C.x,C.y,w)}}};function pb(r){const e=[],t=r.length,n=$;for(let i=0;i<t;i++){let l=r[i];n._isNumber(l)?l=Math.round(l*1e3)/1e3:n._isString(l)||(l=l+""),e.push(l)}return e}const Kf=",",mb="(",gb=")",xb="([",yb="])",vb=";",wb="()",bb="=",Qf=["arc","arcTo","beginPath","bezierCurveTo","clearRect","clip","closePath","createLinearGradient","createPattern","createRadialGradient","drawImage","ellipse","fill","fillText","getImageData","createImageData","lineTo","moveTo","putImageData","quadraticCurveTo","rect","roundRect","restore","rotate","save","scale","setLineDash","setTransform","stroke","strokeText","transform","translate"],_b=["fillStyle","strokeStyle","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","letterSpacing","lineCap","lineDashOffset","lineJoin","lineWidth","miterLimit","direction","font","textAlign","textBaseline","globalAlpha","globalCompositeOperation","imageSmoothingEnabled","filter"],Sb=100;let Eo=null;function Zf(){if(Eo!==null)return Eo;try{const e=$.createCanvasElement().getContext("2d");return e?!!e&&"filter"in e:(Eo=!1,!1)}catch{return Eo=!1,!1}}class wl{constructor(e){this.canvas=e,we.enableTrace&&(this.traceArr=[],this._enableTrace())}fillShape(e){e.fillEnabled()&&this._fill(e)}_fill(e){}strokeShape(e){e.hasStroke()&&this._stroke(e)}_stroke(e){}fillStrokeShape(e){e.attrs.fillAfterStrokeEnabled?(this.strokeShape(e),this.fillShape(e)):(this.fillShape(e),this.strokeShape(e))}getTrace(e,t){let n=this.traceArr,i=n.length,l="",c,d,u,f;for(c=0;c<i;c++)d=n[c],u=d.method,u?(f=d.args,l+=u,e?l+=wb:$._isArray(f[0])?l+=xb+f.join(Kf)+yb:(t&&(f=f.map(p=>typeof p=="number"?Math.floor(p):p)),l+=mb+f.join(Kf)+gb)):(l+=d.property,e||(l+=bb+d.val)),l+=vb;return l}clearTrace(){this.traceArr=[]}_trace(e){let t=this.traceArr,n;t.push(e),n=t.length,n>=Sb&&t.shift()}reset(){const e=this.getCanvas().getPixelRatio();this.setTransform(1*e,0,0,1*e,0,0)}getCanvas(){return this.canvas}clear(e){const t=this.getCanvas();e?this.clearRect(e.x||0,e.y||0,e.width||0,e.height||0):this.clearRect(0,0,t.getWidth()/t.pixelRatio,t.getHeight()/t.pixelRatio)}_applyLineCap(e){const t=e.attrs.lineCap;t&&this.setAttr("lineCap",t)}_applyOpacity(e){const t=e.getAbsoluteOpacity();t!==1&&this.setAttr("globalAlpha",t)}_applyLineJoin(e){const t=e.attrs.lineJoin;t&&this.setAttr("lineJoin",t)}_applyMiterLimit(e){const t=e.attrs.miterLimit;t!=null&&this.setAttr("miterLimit",t)}setAttr(e,t){this._context[e]=t}arc(e,t,n,i,l,c){this._context.arc(e,t,n,i,l,c)}arcTo(e,t,n,i,l){this._context.arcTo(e,t,n,i,l)}beginPath(){this._context.beginPath()}bezierCurveTo(e,t,n,i,l,c){this._context.bezierCurveTo(e,t,n,i,l,c)}clearRect(e,t,n,i){this._context.clearRect(e,t,n,i)}clip(...e){this._context.clip.apply(this._context,e)}closePath(){this._context.closePath()}createImageData(e,t){const n=arguments;if(n.length===2)return this._context.createImageData(e,t);if(n.length===1)return this._context.createImageData(e)}createLinearGradient(e,t,n,i){return this._context.createLinearGradient(e,t,n,i)}createPattern(e,t){return this._context.createPattern(e,t)}createRadialGradient(e,t,n,i,l,c){return this._context.createRadialGradient(e,t,n,i,l,c)}drawImage(e,t,n,i,l,c,d,u,f){const p=arguments,m=this._context;p.length===3?m.drawImage(e,t,n):p.length===5?m.drawImage(e,t,n,i,l):p.length===9&&m.drawImage(e,t,n,i,l,c,d,u,f)}ellipse(e,t,n,i,l,c,d,u){this._context.ellipse(e,t,n,i,l,c,d,u)}isPointInPath(e,t,n,i){return n?this._context.isPointInPath(n,e,t,i):this._context.isPointInPath(e,t,i)}fill(...e){this._context.fill.apply(this._context,e)}fillRect(e,t,n,i){this._context.fillRect(e,t,n,i)}strokeRect(e,t,n,i){this._context.strokeRect(e,t,n,i)}fillText(e,t,n,i){i?this._context.fillText(e,t,n,i):this._context.fillText(e,t,n)}measureText(e){return this._context.measureText(e)}getImageData(e,t,n,i){return this._context.getImageData(e,t,n,i)}lineTo(e,t){this._context.lineTo(e,t)}moveTo(e,t){this._context.moveTo(e,t)}rect(e,t,n,i){this._context.rect(e,t,n,i)}roundRect(e,t,n,i,l){this._context.roundRect(e,t,n,i,l)}putImageData(e,t,n){this._context.putImageData(e,t,n)}quadraticCurveTo(e,t,n,i){this._context.quadraticCurveTo(e,t,n,i)}restore(){this._context.restore()}rotate(e){this._context.rotate(e)}save(){this._context.save()}scale(e,t){this._context.scale(e,t)}setLineDash(e){this._context.setLineDash?this._context.setLineDash(e):"mozDash"in this._context?this._context.mozDash=e:"webkitLineDash"in this._context&&(this._context.webkitLineDash=e)}getLineDash(){return this._context.getLineDash()}setTransform(e,t,n,i,l,c){this._context.setTransform(e,t,n,i,l,c)}stroke(e){e?this._context.stroke(e):this._context.stroke()}strokeText(e,t,n,i){this._context.strokeText(e,t,n,i)}transform(e,t,n,i,l,c){this._context.transform(e,t,n,i,l,c)}translate(e,t){this._context.translate(e,t)}_enableTrace(){let e=this,t=Qf.length,n=this.setAttr,i,l;const c=function(d){let u=e[d],f;e[d]=function(){return l=pb(Array.prototype.slice.call(arguments,0)),f=u.apply(e,arguments),e._trace({method:d,args:l}),f}};for(i=0;i<t;i++)c(Qf[i]);e.setAttr=function(){n.apply(e,arguments);const d=arguments[0];let u=arguments[1];(d==="shadowOffsetX"||d==="shadowOffsetY"||d==="shadowBlur")&&(u=u/this.canvas.getPixelRatio()),e._trace({property:d,val:u})}}_applyGlobalCompositeOperation(e){const t=e.attrs.globalCompositeOperation;!t||t==="source-over"||this.setAttr("globalCompositeOperation",t)}}_b.forEach(function(r){Object.defineProperty(wl.prototype,r,{get(){return this._context[r]},set(e){this._context[r]=e}})});class Cb extends wl{constructor(e,{willReadFrequently:t=!1}={}){super(e),this._context=e._canvas.getContext("2d",{willReadFrequently:t})}_fillColor(e){const t=e.fill();this.setAttr("fillStyle",t),e._fillFunc(this)}_fillPattern(e){this.setAttr("fillStyle",e._getFillPattern()),e._fillFunc(this)}_fillLinearGradient(e){const t=e._getLinearGradient();t&&(this.setAttr("fillStyle",t),e._fillFunc(this))}_fillRadialGradient(e){const t=e._getRadialGradient();t&&(this.setAttr("fillStyle",t),e._fillFunc(this))}_fill(e){const t=e.fill(),n=e.getFillPriority();if(t&&n==="color"){this._fillColor(e);return}const i=e.getFillPatternImage();if(i&&n==="pattern"){this._fillPattern(e);return}const l=e.getFillLinearGradientColorStops();if(l&&n==="linear-gradient"){this._fillLinearGradient(e);return}const c=e.getFillRadialGradientColorStops();if(c&&n==="radial-gradient"){this._fillRadialGradient(e);return}t?this._fillColor(e):i?this._fillPattern(e):l?this._fillLinearGradient(e):c&&this._fillRadialGradient(e)}_strokeLinearGradient(e){const t=e.getStrokeLinearGradientStartPoint(),n=e.getStrokeLinearGradientEndPoint(),i=e.getStrokeLinearGradientColorStops(),l=this.createLinearGradient(t.x,t.y,n.x,n.y);if(i){for(let c=0;c<i.length;c+=2)l.addColorStop(i[c],i[c+1]);this.setAttr("strokeStyle",l)}}_stroke(e){const t=e.dash(),n=e.getStrokeScaleEnabled();if(e.hasStroke()){if(!n){this.save();const l=this.getCanvas().getPixelRatio();this.setTransform(l,0,0,l,0,0)}this._applyLineCap(e),t&&e.dashEnabled()&&(this.setLineDash(t),this.setAttr("lineDashOffset",e.dashOffset())),this.setAttr("lineWidth",e.strokeWidth()),e.getShadowForStrokeEnabled()||this.setAttr("shadowColor","rgba(0,0,0,0)"),e.getStrokeLinearGradientColorStops()?this._strokeLinearGradient(e):this.setAttr("strokeStyle",e.stroke()),e._strokeFunc(this),n||this.restore()}}_applyShadow(e){var t,n,i;const l=(t=e.getShadowRGBA())!==null&&t!==void 0?t:"black",c=(n=e.getShadowBlur())!==null&&n!==void 0?n:5,d=(i=e.getShadowOffset())!==null&&i!==void 0?i:{x:0,y:0},u=e.getAbsoluteScale(),f=this.canvas.getPixelRatio(),p=u.x*f,m=u.y*f;this.setAttr("shadowColor",l),this.setAttr("shadowBlur",c*Math.min(Math.abs(p),Math.abs(m))),this.setAttr("shadowOffsetX",d.x*p),this.setAttr("shadowOffsetY",d.y*m)}}class kb extends wl{constructor(e){super(e),this._context=e._canvas.getContext("2d",{willReadFrequently:!0})}_fill(e){this.save(),this.setAttr("fillStyle",e.colorKey),e._fillFuncHit(this),this.restore()}strokeShape(e){e.hasHitStroke()&&this._stroke(e)}_stroke(e){if(e.hasHitStroke()){const t=e.getStrokeScaleEnabled();if(!t){this.save();const l=this.getCanvas().getPixelRatio();this.setTransform(l,0,0,l,0,0)}this._applyLineCap(e);const n=e.hitStrokeWidth(),i=n==="auto"?e.strokeWidth():n;this.setAttr("lineWidth",i),this.setAttr("strokeStyle",e.colorKey),e._strokeFuncHit(this),t||this.restore()}}}let Po;function Nb(){if(Po)return Po;const r=$.createCanvasElement(),e=r.getContext("2d");return Po=function(){const t=we._global.devicePixelRatio||1,n=e.webkitBackingStorePixelRatio||e.mozBackingStorePixelRatio||e.msBackingStorePixelRatio||e.oBackingStorePixelRatio||e.backingStorePixelRatio||1;return t/n}(),$.releaseCanvas(r),Po}class uu{constructor(e){this.pixelRatio=1,this.width=0,this.height=0,this.isCache=!1;const n=(e||{}).pixelRatio||we.pixelRatio||Nb();this.pixelRatio=n,this._canvas=$.createCanvasElement(),this._canvas.style.padding="0",this._canvas.style.margin="0",this._canvas.style.border="0",this._canvas.style.background="transparent",this._canvas.style.position="absolute",this._canvas.style.top="0",this._canvas.style.left="0"}getContext(){return this.context}getPixelRatio(){return this.pixelRatio}setPixelRatio(e){const t=this.pixelRatio;this.pixelRatio=e,this.setSize(this.getWidth()/t,this.getHeight()/t)}setWidth(e){this.width=this._canvas.width=e*this.pixelRatio,this._canvas.style.width=e+"px";const t=this.pixelRatio;this.getContext()._context.scale(t,t)}setHeight(e){this.height=this._canvas.height=e*this.pixelRatio,this._canvas.style.height=e+"px";const t=this.pixelRatio;this.getContext()._context.scale(t,t)}getWidth(){return this.width}getHeight(){return this.height}setSize(e,t){this.setWidth(e||0),this.setHeight(t||0)}toDataURL(e,t){try{return this._canvas.toDataURL(e,t)}catch{try{return this._canvas.toDataURL()}catch(i){return $.error("Unable to get data URL. "+i.message+" For more info read https://konvajs.org/docs/posts/Tainted_Canvas.html."),""}}}}class Wn extends uu{constructor(e={width:0,height:0,willReadFrequently:!1}){super(e),this.context=new Cb(this,{willReadFrequently:e.willReadFrequently}),this.setSize(e.width,e.height)}}class hu extends uu{constructor(e={width:0,height:0}){super(e),this.hitCanvas=!0,this.context=new kb(this),this.setSize(e.width,e.height)}}const rt={get isDragging(){let r=!1;return rt._dragElements.forEach(e=>{e.dragStatus==="dragging"&&(r=!0)}),r},justDragged:!1,get node(){let r;return rt._dragElements.forEach(e=>{r=e.node}),r},_dragElements:new Map,_drag(r){const e=[];rt._dragElements.forEach((t,n)=>{const{node:i}=t,l=i.getStage();l.setPointersPositions(r),t.pointerId===void 0&&(t.pointerId=$._getFirstPointerId(r));const c=l._changedPointerPositions.find(d=>d.id===t.pointerId);if(c){if(t.dragStatus!=="dragging"){const d=i.dragDistance();if(Math.max(Math.abs(c.x-t.startPointerPos.x),Math.abs(c.y-t.startPointerPos.y))<d||(i.startDrag({evt:r}),!i.isDragging()))return}i._setDragPosition(r,t),e.push(i)}}),e.forEach(t=>{t.fire("dragmove",{type:"dragmove",target:t,evt:r},!0)})},_endDragBefore(r){const e=[];rt._dragElements.forEach(t=>{const{node:n}=t,i=n.getStage();if(r&&i.setPointersPositions(r),!i._changedPointerPositions.find(d=>d.id===t.pointerId))return;(t.dragStatus==="dragging"||t.dragStatus==="stopped")&&(rt.justDragged=!0,we._mouseListenClick=!1,we._touchListenClick=!1,we._pointerListenClick=!1,t.dragStatus="stopped");const c=t.node.getLayer()||t.node instanceof we.Stage&&t.node;c&&e.indexOf(c)===-1&&e.push(c)}),e.forEach(t=>{t.draw()})},_endDragAfter(r){rt._dragElements.forEach((e,t)=>{e.dragStatus==="stopped"&&e.node.fire("dragend",{type:"dragend",target:e.node,evt:r},!0),e.dragStatus!=="dragging"&&rt._dragElements.delete(t)})}};we.isBrowser&&(window.addEventListener("mouseup",rt._endDragBefore,!0),window.addEventListener("touchend",rt._endDragBefore,!0),window.addEventListener("touchcancel",rt._endDragBefore,!0),window.addEventListener("mousemove",rt._drag),window.addEventListener("touchmove",rt._drag),window.addEventListener("mouseup",rt._endDragAfter,!1),window.addEventListener("touchend",rt._endDragAfter,!1),window.addEventListener("touchcancel",rt._endDragAfter,!1));function ns(r){return $._isString(r)?'"'+r+'"':Object.prototype.toString.call(r)==="[object Number]"||$._isBoolean(r)?r:Object.prototype.toString.call(r)}function P0(r){return r>255?255:r<0?0:Math.round(r)}function ge(){if(we.isUnminified)return function(r,e){return $._isNumber(r)||$.warn(ns(r)+' is a not valid value for "'+e+'" attribute. The value should be a number.'),r}}function bl(r){if(we.isUnminified)return function(e,t){let n=$._isNumber(e),i=$._isArray(e)&&e.length==r;return!n&&!i&&$.warn(ns(e)+' is a not valid value for "'+t+'" attribute. The value should be a number or Array<number>('+r+")"),e}}function fu(){if(we.isUnminified)return function(r,e){return $._isNumber(r)||r==="auto"||$.warn(ns(r)+' is a not valid value for "'+e+'" attribute. The value should be a number or "auto".'),r}}function As(){if(we.isUnminified)return function(r,e){return $._isString(r)||$.warn(ns(r)+' is a not valid value for "'+e+'" attribute. The value should be a string.'),r}}function A0(){if(we.isUnminified)return function(r,e){const t=$._isString(r),n=Object.prototype.toString.call(r)==="[object CanvasGradient]"||r&&r.addColorStop;return t||n||$.warn(ns(r)+' is a not valid value for "'+e+'" attribute. The value should be a string or a native gradient.'),r}}function jb(){if(we.isUnminified)return function(r,e){const t=Int8Array?Object.getPrototypeOf(Int8Array):null;return t&&r instanceof t||($._isArray(r)?r.forEach(function(n){$._isNumber(n)||$.warn('"'+e+'" attribute has non numeric element '+n+". Make sure that all elements are numbers.")}):$.warn(ns(r)+' is a not valid value for "'+e+'" attribute. The value should be a array of numbers.')),r}}function $r(){if(we.isUnminified)return function(r,e){return r===!0||r===!1||$.warn(ns(r)+' is a not valid value for "'+e+'" attribute. The value should be a boolean.'),r}}function Eb(r){if(we.isUnminified)return function(e,t){return e==null||$.isObject(e)||$.warn(ns(e)+' is a not valid value for "'+t+'" attribute. The value should be an object with properties '+r),e}}const Wi="get",Vi="set",F={addGetterSetter(r,e,t,n,i){F.addGetter(r,e,t),F.addSetter(r,e,n,i),F.addOverloadedGetterSetter(r,e)},addGetter(r,e,t){const n=Wi+$._capitalize(e);r.prototype[n]=r.prototype[n]||function(){const i=this.attrs[e];return i===void 0?t:i}},addSetter(r,e,t,n){const i=Vi+$._capitalize(e);r.prototype[i]||F.overWriteSetter(r,e,t,n)},overWriteSetter(r,e,t,n){const i=Vi+$._capitalize(e);r.prototype[i]=function(l){return t&&l!==void 0&&l!==null&&(l=t.call(this,l,e)),this._setAttr(e,l),n&&n.call(this),this}},addComponentsGetterSetter(r,e,t,n,i){const l=t.length,c=$._capitalize,d=Wi+c(e),u=Vi+c(e);r.prototype[d]=function(){const p={};for(let m=0;m<l;m++){const y=t[m];p[y]=this.getAttr(e+c(y))}return p};const f=Eb(t);r.prototype[u]=function(p){const m=this.attrs[e];n&&(p=n.call(this,p,e)),f&&f.call(this,p,e);for(const y in p)p.hasOwnProperty(y)&&this._setAttr(e+c(y),p[y]);return p||t.forEach(y=>{this._setAttr(e+c(y),void 0)}),this._fireChangeEvent(e,m,p),i&&i.call(this),this},F.addOverloadedGetterSetter(r,e)},addOverloadedGetterSetter(r,e){const t=$._capitalize(e),n=Vi+t,i=Wi+t;r.prototype[e]=function(){return arguments.length?(this[n](arguments[0]),this):this[i]()}},addDeprecatedGetterSetter(r,e,t,n){$.error("Adding deprecated "+e);const i=Wi+$._capitalize(e),l=e+" property is deprecated and will be removed soon. Look at Konva change log for more information.";r.prototype[i]=function(){$.error(l);const c=this.attrs[e];return c===void 0?t:c},F.addSetter(r,e,n,function(){$.error(l)}),F.addOverloadedGetterSetter(r,e)},backCompat(r,e){$.each(e,function(t,n){const i=r.prototype[n],l=Wi+$._capitalize(t),c=Vi+$._capitalize(t);function d(){i.apply(this,arguments),$.error('"'+t+'" method is deprecated and will be removed soon. Use ""'+n+'" instead.')}r.prototype[t]=d,r.prototype[l]=d,r.prototype[c]=d})},afterSetFilter(){this._filterUpToDate=!1}};function Pb(r){const e=/(\w+)\(([^)]+)\)/g;let t;for(;(t=e.exec(r))!==null;){const[,n,i]=t;switch(n){case"blur":{const l=parseFloat(i.replace("px",""));return function(c){this.blurRadius(l*.5);const d=we.Filters;d&&d.Blur&&d.Blur.call(this,c)}}case"brightness":{const l=i.includes("%")?parseFloat(i)/100:parseFloat(i);return function(c){this.brightness(l);const d=we.Filters;d&&d.Brightness&&d.Brightness.call(this,c)}}case"contrast":{const l=parseFloat(i);return function(c){const d=100*(Math.sqrt(l)-1);this.contrast(d);const u=we.Filters;u&&u.Contrast&&u.Contrast.call(this,c)}}case"grayscale":return function(l){const c=we.Filters;c&&c.Grayscale&&c.Grayscale.call(this,l)};case"sepia":return function(l){const c=we.Filters;c&&c.Sepia&&c.Sepia.call(this,l)};case"invert":return function(l){const c=we.Filters;c&&c.Invert&&c.Invert.call(this,l)};default:$.warn(`CSS filter "${n}" is not supported in fallback mode. Consider using function filters for better compatibility.`);break}}return()=>{}}const zo="absoluteOpacity",Jf="allEventListeners",bn="absoluteTransform",ep="absoluteScale",vs="canvas",Ab="Change",Tb="children",Rb="konva",vd="listening",Db="mouseenter",Ob="mouseleave",Ib="pointerenter",Mb="pointerleave",Lb="touchenter",Fb="touchleave",tp="set",rp="Shape",Bo=" ",np="stage",Hn="transform",zb="Stage",wd="visible",Bb=["xChange.konva","yChange.konva","scaleXChange.konva","scaleYChange.konva","skewXChange.konva","skewYChange.konva","rotationChange.konva","offsetXChange.konva","offsetYChange.konva","transformsEnabledChange.konva"].join(Bo);let Gb=1,ve=class qi{constructor(e){this._id=Gb++,this.eventListeners={},this.attrs={},this.index=0,this._allEventListeners=null,this.parent=null,this._cache=new Map,this._attachedDepsListeners=new Map,this._lastPos=null,this._batchingTransformChange=!1,this._needClearTransformCache=!1,this._filterUpToDate=!1,this._isUnderCache=!1,this._dragEventId=null,this._shouldFireChangeEvents=!1,this.setAttrs(e),this._shouldFireChangeEvents=!0}hasChildren(){return!1}_clearCache(e){(e===Hn||e===bn)&&this._cache.get(e)?this._cache.get(e).dirty=!0:e?this._cache.delete(e):this._cache.clear()}_getCache(e,t){let n=this._cache.get(e);return(n===void 0||(e===Hn||e===bn)&&n.dirty===!0)&&(n=t.call(this),this._cache.set(e,n)),n}_calculate(e,t,n){if(!this._attachedDepsListeners.get(e)){const i=t.map(l=>l+"Change.konva").join(Bo);this.on(i,()=>{this._clearCache(e)}),this._attachedDepsListeners.set(e,!0)}return this._getCache(e,n)}_getCanvasCache(){return this._cache.get(vs)}_clearSelfAndDescendantCache(e){this._clearCache(e),e===bn&&this.fire("absoluteTransformChange")}clearCache(){if(this._cache.has(vs)){const{scene:e,filter:t,hit:n}=this._cache.get(vs);$.releaseCanvas(e._canvas,t._canvas,n._canvas),this._cache.delete(vs)}return this._clearSelfAndDescendantCache(),this._requestDraw(),this}cache(e){const t=e||{};let n={};(t.x===void 0||t.y===void 0||t.width===void 0||t.height===void 0)&&(n=this.getClientRect({skipTransform:!0,relativeTo:this.getParent()||void 0}));let i=Math.ceil(t.width||n.width),l=Math.ceil(t.height||n.height),c=t.pixelRatio,d=t.x===void 0?Math.floor(n.x):t.x,u=t.y===void 0?Math.floor(n.y):t.y,f=t.offset||0,p=t.drawBorder||!1,m=t.hitCanvasPixelRatio||1;if(!i||!l){$.error("Can not cache the node. Width or height of the node equals 0. Caching is skipped.");return}const y=Math.abs(Math.round(n.x)-d)>.5?1:0,w=Math.abs(Math.round(n.y)-u)>.5?1:0;i+=f*2+y,l+=f*2+w,d-=f,u-=f;const _=new Wn({pixelRatio:c,width:i,height:l}),x=new Wn({pixelRatio:c,width:0,height:0,willReadFrequently:!0}),v=new hu({pixelRatio:m,width:i,height:l}),S=_.getContext(),C=v.getContext(),k=new Wn({width:_.width/_.pixelRatio+Math.abs(d),height:_.height/_.pixelRatio+Math.abs(u),pixelRatio:_.pixelRatio}),E=k.getContext();return v.isCache=!0,_.isCache=!0,this._cache.delete(vs),this._filterUpToDate=!1,t.imageSmoothingEnabled===!1&&(_.getContext()._context.imageSmoothingEnabled=!1,x.getContext()._context.imageSmoothingEnabled=!1),S.save(),C.save(),E.save(),S.translate(-d,-u),C.translate(-d,-u),E.translate(-d,-u),k.x=d,k.y=u,this._isUnderCache=!0,this._clearSelfAndDescendantCache(zo),this._clearSelfAndDescendantCache(ep),this.drawScene(_,this,k),this.drawHit(v,this),this._isUnderCache=!1,S.restore(),C.restore(),p&&(S.save(),S.beginPath(),S.rect(0,0,i,l),S.closePath(),S.setAttr("strokeStyle","red"),S.setAttr("lineWidth",5),S.stroke(),S.restore()),$.releaseCanvas(k._canvas),this._cache.set(vs,{scene:_,filter:x,hit:v,x:d,y:u}),this._requestDraw(),this}isCached(){return this._cache.has(vs)}getClientRect(e){throw new Error('abstract "getClientRect" method call')}_transformedRect(e,t){const n=[{x:e.x,y:e.y},{x:e.x+e.width,y:e.y},{x:e.x+e.width,y:e.y+e.height},{x:e.x,y:e.y+e.height}];let i=1/0,l=1/0,c=-1/0,d=-1/0;const u=this.getAbsoluteTransform(t);return n.forEach(function(f){const p=u.point(f);i===void 0&&(i=c=p.x,l=d=p.y),i=Math.min(i,p.x),l=Math.min(l,p.y),c=Math.max(c,p.x),d=Math.max(d,p.y)}),{x:i,y:l,width:c-i,height:d-l}}_drawCachedSceneCanvas(e){e.save(),e._applyOpacity(this),e._applyGlobalCompositeOperation(this);const t=this._getCanvasCache();e.translate(t.x,t.y);const n=this._getCachedSceneCanvas(),i=n.pixelRatio;e.drawImage(n._canvas,0,0,n.width/i,n.height/i),e.restore()}_drawCachedHitCanvas(e){const t=this._getCanvasCache(),n=t.hit;e.save(),e.translate(t.x,t.y),e.drawImage(n._canvas,0,0,n.width/n.pixelRatio,n.height/n.pixelRatio),e.restore()}_getCachedSceneCanvas(){let e=this.filters(),t=this._getCanvasCache(),n=t.scene,i=t.filter,l=i.getContext(),c,d,u,f;if(!e||e.length===0)return n;if(this._filterUpToDate)return i;let p=!0;for(let y=0;y<e.length;y++)if(typeof e[y]=="string"&&Zf(),typeof e[y]!="string"||!Zf()){p=!1;break}const m=n.pixelRatio;if(i.setSize(n.width/n.pixelRatio,n.height/n.pixelRatio),p){const y=e.join(" ");return l.save(),l.setAttr("filter",y),l.drawImage(n._canvas,0,0,n.getWidth()/m,n.getHeight()/m),l.restore(),this._filterUpToDate=!0,i}try{for(c=e.length,l.clear(),l.drawImage(n._canvas,0,0,n.getWidth()/m,n.getHeight()/m),d=l.getImageData(0,0,i.getWidth(),i.getHeight()),u=0;u<c;u++)f=e[u],typeof f=="string"&&(f=Pb(f)),f.call(this,d),l.putImageData(d,0,0)}catch(y){$.error("Unable to apply filter. "+y.message+" This post my help you https://konvajs.org/docs/posts/Tainted_Canvas.html.")}return this._filterUpToDate=!0,i}on(e,t){if(this._cache&&this._cache.delete(Jf),arguments.length===3)return this._delegate.apply(this,arguments);const n=e.split(Bo);for(let i=0;i<n.length;i++){const c=n[i].split("."),d=c[0],u=c[1]||"";this.eventListeners[d]||(this.eventListeners[d]=[]),this.eventListeners[d].push({name:u,handler:t})}return this}off(e,t){let n=(e||"").split(Bo),i=n.length,l,c,d,u,f,p;if(this._cache&&this._cache.delete(Jf),!e)for(c in this.eventListeners)this._off(c);for(l=0;l<i;l++)if(d=n[l],u=d.split("."),f=u[0],p=u[1],f)this.eventListeners[f]&&this._off(f,p,t);else for(c in this.eventListeners)this._off(c,p,t);return this}dispatchEvent(e){const t={target:this,type:e.type,evt:e};return this.fire(e.type,t),this}addEventListener(e,t){return this.on(e,function(n){t.call(this,n.evt)}),this}removeEventListener(e){return this.off(e),this}_delegate(e,t,n){const i=this;this.on(e,function(l){const c=l.target.findAncestors(t,!0,i);for(let d=0;d<c.length;d++)l=$.cloneObject(l),l.currentTarget=c[d],n.call(c[d],l)})}remove(){return this.isDragging()&&this.stopDrag(),rt._dragElements.delete(this._id),this._remove(),this}_clearCaches(){this._clearSelfAndDescendantCache(bn),this._clearSelfAndDescendantCache(zo),this._clearSelfAndDescendantCache(ep),this._clearSelfAndDescendantCache(np),this._clearSelfAndDescendantCache(wd),this._clearSelfAndDescendantCache(vd)}_remove(){this._clearCaches();const e=this.getParent();e&&e.children&&(e.children.splice(this.index,1),e._setChildrenIndices(),this.parent=null)}destroy(){return this.remove(),this.clearCache(),this}getAttr(e){const t="get"+$._capitalize(e);return $._isFunction(this[t])?this[t]():this.attrs[e]}getAncestors(){let e=this.getParent(),t=[];for(;e;)t.push(e),e=e.getParent();return t}getAttrs(){return this.attrs||{}}setAttrs(e){return this._batchTransformChanges(()=>{let t,n;if(!e)return this;for(t in e)t!==Tb&&(n=tp+$._capitalize(t),$._isFunction(this[n])?this[n](e[t]):this._setAttr(t,e[t]))}),this}isListening(){return this._getCache(vd,this._isListening)}_isListening(e){if(!this.listening())return!1;const n=this.getParent();return n&&n!==e&&this!==e?n._isListening(e):!0}isVisible(){return this._getCache(wd,this._isVisible)}_isVisible(e){if(!this.visible())return!1;const n=this.getParent();return n&&n!==e&&this!==e?n._isVisible(e):!0}shouldDrawHit(e,t=!1){if(e)return this._isVisible(e)&&this._isListening(e);const n=this.getLayer();let i=!1;rt._dragElements.forEach(c=>{c.dragStatus==="dragging"&&(c.node.nodeType==="Stage"||c.node.getLayer()===n)&&(i=!0)});const l=!t&&!we.hitOnDragEnabled&&(i||we.isTransforming());return this.isListening()&&this.isVisible()&&!l}show(){return this.visible(!0),this}hide(){return this.visible(!1),this}getZIndex(){return this.index||0}getAbsoluteZIndex(){let e=this.getDepth(),t=this,n=0,i,l,c,d;function u(p){for(i=[],l=p.length,c=0;c<l;c++)d=p[c],n++,d.nodeType!==rp&&(i=i.concat(d.getChildren().slice())),d._id===t._id&&(c=l);i.length>0&&i[0].getDepth()<=e&&u(i)}const f=this.getStage();return t.nodeType!==zb&&f&&u(f.getChildren()),n}getDepth(){let e=0,t=this.parent;for(;t;)e++,t=t.parent;return e}_batchTransformChanges(e){this._batchingTransformChange=!0,e(),this._batchingTransformChange=!1,this._needClearTransformCache&&(this._clearCache(Hn),this._clearSelfAndDescendantCache(bn)),this._needClearTransformCache=!1}setPosition(e){return this._batchTransformChanges(()=>{this.x(e.x),this.y(e.y)}),this}getPosition(){return{x:this.x(),y:this.y()}}getRelativePointerPosition(){const e=this.getStage();if(!e)return null;const t=e.getPointerPosition();if(!t)return null;const n=this.getAbsoluteTransform().copy();return n.invert(),n.point(t)}getAbsolutePosition(e){let t=!1,n=this.parent;for(;n;){if(n.isCached()){t=!0;break}n=n.parent}t&&!e&&(e=!0);const i=this.getAbsoluteTransform(e).getMatrix(),l=new pr,c=this.offset();return l.m=i.slice(),l.translate(c.x,c.y),l.getTranslation()}setAbsolutePosition(e){const{x:t,y:n,...i}=this._clearTransform();this.attrs.x=t,this.attrs.y=n,this._clearCache(Hn);const l=this._getAbsoluteTransform().copy();return l.invert(),l.translate(e.x,e.y),e={x:this.attrs.x+l.getTranslation().x,y:this.attrs.y+l.getTranslation().y},this._setTransform(i),this.setPosition({x:e.x,y:e.y}),this._clearCache(Hn),this._clearSelfAndDescendantCache(bn),this}_setTransform(e){let t;for(t in e)this.attrs[t]=e[t]}_clearTransform(){const e={x:this.x(),y:this.y(),rotation:this.rotation(),scaleX:this.scaleX(),scaleY:this.scaleY(),offsetX:this.offsetX(),offsetY:this.offsetY(),skewX:this.skewX(),skewY:this.skewY()};return this.attrs.x=0,this.attrs.y=0,this.attrs.rotation=0,this.attrs.scaleX=1,this.attrs.scaleY=1,this.attrs.offsetX=0,this.attrs.offsetY=0,this.attrs.skewX=0,this.attrs.skewY=0,e}move(e){let t=e.x,n=e.y,i=this.x(),l=this.y();return t!==void 0&&(i+=t),n!==void 0&&(l+=n),this.setPosition({x:i,y:l}),this}_eachAncestorReverse(e,t){let n=[],i=this.getParent(),l,c;if(!(t&&t._id===this._id)){for(n.unshift(this);i&&(!t||i._id!==t._id);)n.unshift(i),i=i.parent;for(l=n.length,c=0;c<l;c++)e(n[c])}}rotate(e){return this.rotation(this.rotation()+e),this}moveToTop(){if(!this.parent)return $.warn("Node has no parent. moveToTop function is ignored."),!1;const e=this.index,t=this.parent.getChildren().length;return e<t-1?(this.parent.children.splice(e,1),this.parent.children.push(this),this.parent._setChildrenIndices(),!0):!1}moveUp(){if(!this.parent)return $.warn("Node has no parent. moveUp function is ignored."),!1;const e=this.index,t=this.parent.getChildren().length;return e<t-1?(this.parent.children.splice(e,1),this.parent.children.splice(e+1,0,this),this.parent._setChildrenIndices(),!0):!1}moveDown(){if(!this.parent)return $.warn("Node has no parent. moveDown function is ignored."),!1;const e=this.index;return e>0?(this.parent.children.splice(e,1),this.parent.children.splice(e-1,0,this),this.parent._setChildrenIndices(),!0):!1}moveToBottom(){if(!this.parent)return $.warn("Node has no parent. moveToBottom function is ignored."),!1;const e=this.index;return e>0?(this.parent.children.splice(e,1),this.parent.children.unshift(this),this.parent._setChildrenIndices(),!0):!1}setZIndex(e){if(!this.parent)return $.warn("Node has no parent. zIndex parameter is ignored."),this;(e<0||e>=this.parent.children.length)&&$.warn("Unexpected value "+e+" for zIndex property. zIndex is just index of a node in children of its parent. Expected value is from 0 to "+(this.parent.children.length-1)+".");const t=this.index;return this.parent.children.splice(t,1),this.parent.children.splice(e,0,this),this.parent._setChildrenIndices(),this}getAbsoluteOpacity(){return this._getCache(zo,this._getAbsoluteOpacity)}_getAbsoluteOpacity(){let e=this.opacity();const t=this.getParent();return t&&!t._isUnderCache&&(e*=t.getAbsoluteOpacity()),e}moveTo(e){return this.getParent()!==e&&(this._remove(),e.add(this)),this}toObject(){let e=this.getAttrs(),t,n,i,l,c;const d={attrs:{},className:this.getClassName()};for(t in e)n=e[t],c=$.isObject(n)&&!$._isPlainObject(n)&&!$._isArray(n),!c&&(i=typeof this[t]=="function"&&this[t],delete e[t],l=i?i.call(this):null,e[t]=n,l!==n&&(d.attrs[t]=n));return $._prepareToStringify(d)}toJSON(){return JSON.stringify(this.toObject())}getParent(){return this.parent}findAncestors(e,t,n){const i=[];t&&this._isMatch(e)&&i.push(this);let l=this.parent;for(;l;){if(l===n)return i;l._isMatch(e)&&i.push(l),l=l.parent}return i}isAncestorOf(e){return!1}findAncestor(e,t,n){return this.findAncestors(e,t,n)[0]}_isMatch(e){if(!e)return!1;if(typeof e=="function")return e(this);let t=e.replace(/ /g,"").split(","),n=t.length,i,l;for(i=0;i<n;i++)if(l=t[i],$.isValidSelector(l)||($.warn('Selector "'+l+'" is invalid. Allowed selectors examples are "#foo", ".bar" or "Group".'),$.warn('If you have a custom shape with such className, please change it to start with upper letter like "Triangle".'),$.warn("Konva is awesome, right?")),l.charAt(0)==="#"){if(this.id()===l.slice(1))return!0}else if(l.charAt(0)==="."){if(this.hasName(l.slice(1)))return!0}else if(this.className===l||this.nodeType===l)return!0;return!1}getLayer(){const e=this.getParent();return e?e.getLayer():null}getStage(){return this._getCache(np,this._getStage)}_getStage(){const e=this.getParent();return e?e.getStage():null}fire(e,t={},n){return t.target=t.target||this,n?this._fireAndBubble(e,t):this._fire(e,t),this}getAbsoluteTransform(e){return e?this._getAbsoluteTransform(e):this._getCache(bn,this._getAbsoluteTransform)}_getAbsoluteTransform(e){let t;if(e)return t=new pr,this._eachAncestorReverse(function(n){const i=n.transformsEnabled();i==="all"?t.multiply(n.getTransform()):i==="position"&&t.translate(n.x()-n.offsetX(),n.y()-n.offsetY())},e),t;{t=this._cache.get(bn)||new pr,this.parent?this.parent.getAbsoluteTransform().copyInto(t):t.reset();const n=this.transformsEnabled();if(n==="all")t.multiply(this.getTransform());else if(n==="position"){const i=this.attrs.x||0,l=this.attrs.y||0,c=this.attrs.offsetX||0,d=this.attrs.offsetY||0;t.translate(i-c,l-d)}return t.dirty=!1,t}}getAbsoluteScale(e){let t=this;for(;t;)t._isUnderCache&&(e=t),t=t.getParent();const i=this.getAbsoluteTransform(e).decompose();return{x:i.scaleX,y:i.scaleY}}getAbsoluteRotation(){return this.getAbsoluteTransform().decompose().rotation}getTransform(){return this._getCache(Hn,this._getTransform)}_getTransform(){var e,t;const n=this._cache.get(Hn)||new pr;n.reset();const i=this.x(),l=this.y(),c=we.getAngle(this.rotation()),d=(e=this.attrs.scaleX)!==null&&e!==void 0?e:1,u=(t=this.attrs.scaleY)!==null&&t!==void 0?t:1,f=this.attrs.skewX||0,p=this.attrs.skewY||0,m=this.attrs.offsetX||0,y=this.attrs.offsetY||0;return(i!==0||l!==0)&&n.translate(i,l),c!==0&&n.rotate(c),(f!==0||p!==0)&&n.skew(f,p),(d!==1||u!==1)&&n.scale(d,u),(m!==0||y!==0)&&n.translate(-1*m,-1*y),n.dirty=!1,n}clone(e){let t=$.cloneObject(this.attrs),n,i,l,c,d;for(n in e)t[n]=e[n];const u=new this.constructor(t);for(n in this.eventListeners)for(i=this.eventListeners[n],l=i.length,c=0;c<l;c++)d=i[c],d.name.indexOf(Rb)<0&&(u.eventListeners[n]||(u.eventListeners[n]=[]),u.eventListeners[n].push(d));return u}_toKonvaCanvas(e){e=e||{};const t=this.getClientRect(),n=this.getStage(),i=e.x!==void 0?e.x:Math.floor(t.x),l=e.y!==void 0?e.y:Math.floor(t.y),c=e.pixelRatio||1,d=new Wn({width:e.width||Math.ceil(t.width)||(n?n.width():0),height:e.height||Math.ceil(t.height)||(n?n.height():0),pixelRatio:c}),u=d.getContext(),f=new Wn({width:d.width/d.pixelRatio+Math.abs(i),height:d.height/d.pixelRatio+Math.abs(l),pixelRatio:d.pixelRatio});return e.imageSmoothingEnabled===!1&&(u._context.imageSmoothingEnabled=!1),u.save(),(i||l)&&u.translate(-1*i,-1*l),this.drawScene(d,void 0,f),u.restore(),d}toCanvas(e){return this._toKonvaCanvas(e)._canvas}toDataURL(e){e=e||{};const t=e.mimeType||null,n=e.quality||null,i=this._toKonvaCanvas(e).toDataURL(t,n);return e.callback&&e.callback(i),i}toImage(e){return new Promise((t,n)=>{try{const i=e==null?void 0:e.callback;i&&delete e.callback,$._urlToImage(this.toDataURL(e),function(l){t(l),i==null||i(l)})}catch(i){n(i)}})}toBlob(e){return new Promise((t,n)=>{try{const i=e==null?void 0:e.callback;i&&delete e.callback,this.toCanvas(e).toBlob(l=>{t(l),i==null||i(l)},e==null?void 0:e.mimeType,e==null?void 0:e.quality)}catch(i){n(i)}})}setSize(e){return this.width(e.width),this.height(e.height),this}getSize(){return{width:this.width(),height:this.height()}}getClassName(){return this.className||this.nodeType}getType(){return this.nodeType}getDragDistance(){return this.attrs.dragDistance!==void 0?this.attrs.dragDistance:this.parent?this.parent.getDragDistance():we.dragDistance}_off(e,t,n){let i=this.eventListeners[e],l,c,d;for(l=0;l<i.length;l++)if(c=i[l].name,d=i[l].handler,(c!=="konva"||t==="konva")&&(!t||c===t)&&(!n||n===d)){if(i.splice(l,1),i.length===0){delete this.eventListeners[e];break}l--}}_fireChangeEvent(e,t,n){this._fire(e+Ab,{oldVal:t,newVal:n})}addName(e){if(!this.hasName(e)){const t=this.name(),n=t?t+" "+e:e;this.name(n)}return this}hasName(e){if(!e)return!1;const t=this.name();return t?(t||"").split(/\s/g).indexOf(e)!==-1:!1}removeName(e){const t=(this.name()||"").split(/\s/g),n=t.indexOf(e);return n!==-1&&(t.splice(n,1),this.name(t.join(" "))),this}setAttr(e,t){const n=this[tp+$._capitalize(e)];return $._isFunction(n)?n.call(this,t):this._setAttr(e,t),this}_requestDraw(){if(we.autoDrawEnabled){const e=this.getLayer()||this.getStage();e==null||e.batchDraw()}}_setAttr(e,t){const n=this.attrs[e];n===t&&!$.isObject(t)||(t==null?delete this.attrs[e]:this.attrs[e]=t,this._shouldFireChangeEvents&&this._fireChangeEvent(e,n,t),this._requestDraw())}_setComponentAttr(e,t,n){let i;n!==void 0&&(i=this.attrs[e],i||(this.attrs[e]=this.getAttr(e)),this.attrs[e][t]=n,this._fireChangeEvent(e,i,n))}_fireAndBubble(e,t,n){t&&this.nodeType===rp&&(t.target=this);const i=[Db,Ob,Ib,Mb,Lb,Fb];if(!(i.indexOf(e)!==-1&&(n&&(this===n||this.isAncestorOf&&this.isAncestorOf(n))||this.nodeType==="Stage"&&!n))){this._fire(e,t);const c=i.indexOf(e)!==-1&&n&&n.isAncestorOf&&n.isAncestorOf(this)&&!n.isAncestorOf(this.parent);(t&&!t.cancelBubble||!t)&&this.parent&&this.parent.isListening()&&!c&&(n&&n.parent?this._fireAndBubble.call(this.parent,e,t,n):this._fireAndBubble.call(this.parent,e,t))}}_getProtoListeners(e){var t,n;const{nodeType:i}=this,l=qi.protoListenerMap.get(i)||{};let c=l==null?void 0:l[e];if(c===void 0){c=[];let d=Object.getPrototypeOf(this);for(;d;){const u=(n=(t=d.eventListeners)===null||t===void 0?void 0:t[e])!==null&&n!==void 0?n:[];c.push(...u),d=Object.getPrototypeOf(d)}l[e]=c,qi.protoListenerMap.set(i,l)}return c}_fire(e,t){t=t||{},t.currentTarget=this,t.type=e;const n=this._getProtoListeners(e);if(n)for(let l=0;l<n.length;l++)n[l].handler.call(this,t);const i=this.eventListeners[e];if(i)for(let l=0;l<i.length;l++)i[l].handler.call(this,t)}draw(){return this.drawScene(),this.drawHit(),this}_createDragElement(e){const t=e?e.pointerId:void 0,n=this.getStage(),i=this.getAbsolutePosition();if(!n)return;const l=n._getPointerById(t)||n._changedPointerPositions[0]||i;rt._dragElements.set(this._id,{node:this,startPointerPos:l,offset:{x:l.x-i.x,y:l.y-i.y},dragStatus:"ready",pointerId:t})}startDrag(e,t=!0){rt._dragElements.has(this._id)||this._createDragElement(e);const n=rt._dragElements.get(this._id);n.dragStatus="dragging",this.fire("dragstart",{type:"dragstart",target:this,evt:e&&e.evt},t)}_setDragPosition(e,t){const n=this.getStage()._getPointerById(t.pointerId);if(!n)return;let i={x:n.x-t.offset.x,y:n.y-t.offset.y};const l=this.dragBoundFunc();if(l!==void 0){const c=l.call(this,i,e);c?i=c:$.warn("dragBoundFunc did not return any value. That is unexpected behavior. You must return new absolute position from dragBoundFunc.")}(!this._lastPos||this._lastPos.x!==i.x||this._lastPos.y!==i.y)&&(this.setAbsolutePosition(i),this._requestDraw()),this._lastPos=i}stopDrag(e){const t=rt._dragElements.get(this._id);t&&(t.dragStatus="stopped"),rt._endDragBefore(e),rt._endDragAfter(e)}setDraggable(e){this._setAttr("draggable",e),this._dragChange()}isDragging(){const e=rt._dragElements.get(this._id);return e?e.dragStatus==="dragging":!1}_listenDrag(){this._dragCleanup(),this.on("mousedown.konva touchstart.konva",function(e){if(!(!(e.evt.button!==void 0)||we.dragButtons.indexOf(e.evt.button)>=0)||this.isDragging())return;let i=!1;rt._dragElements.forEach(l=>{this.isAncestorOf(l.node)&&(i=!0)}),i||this._createDragElement(e)})}_dragChange(){if(this.attrs.draggable)this._listenDrag();else{if(this._dragCleanup(),!this.getStage())return;const t=rt._dragElements.get(this._id),n=t&&t.dragStatus==="dragging",i=t&&t.dragStatus==="ready";n?this.stopDrag():i&&rt._dragElements.delete(this._id)}}_dragCleanup(){this.off("mousedown.konva"),this.off("touchstart.konva")}isClientRectOnScreen(e={x:0,y:0}){const t=this.getStage();if(!t)return!1;const n={x:-e.x,y:-e.y,width:t.width()+2*e.x,height:t.height()+2*e.y};return $.haveIntersection(n,this.getClientRect())}static create(e,t){return $._isString(e)&&(e=JSON.parse(e)),this._createNode(e,t)}static _createNode(e,t){let n=qi.prototype.getClassName.call(e),i=e.children,l,c,d;t&&(e.attrs.container=t),we[n]||($.warn('Can not find a node with class name "'+n+'". Fallback to "Shape".'),n="Shape");const u=we[n];if(l=new u(e.attrs),i)for(c=i.length,d=0;d<c;d++)l.add(qi._createNode(i[d]));return l}};ve.protoListenerMap=new Map;ve.prototype.nodeType="Node";ve.prototype._attrsAffectingSize=[];ve.prototype.eventListeners={};ve.prototype.on.call(ve.prototype,Bb,function(){if(this._batchingTransformChange){this._needClearTransformCache=!0;return}this._clearCache(Hn),this._clearSelfAndDescendantCache(bn)});ve.prototype.on.call(ve.prototype,"visibleChange.konva",function(){this._clearSelfAndDescendantCache(wd)});ve.prototype.on.call(ve.prototype,"listeningChange.konva",function(){this._clearSelfAndDescendantCache(vd)});ve.prototype.on.call(ve.prototype,"opacityChange.konva",function(){this._clearSelfAndDescendantCache(zo)});const dt=F.addGetterSetter;dt(ve,"zIndex");dt(ve,"absolutePosition");dt(ve,"position");dt(ve,"x",0,ge());dt(ve,"y",0,ge());dt(ve,"globalCompositeOperation","source-over",As());dt(ve,"opacity",1,ge());dt(ve,"name","",As());dt(ve,"id","",As());dt(ve,"rotation",0,ge());F.addComponentsGetterSetter(ve,"scale",["x","y"]);dt(ve,"scaleX",1,ge());dt(ve,"scaleY",1,ge());F.addComponentsGetterSetter(ve,"skew",["x","y"]);dt(ve,"skewX",0,ge());dt(ve,"skewY",0,ge());F.addComponentsGetterSetter(ve,"offset",["x","y"]);dt(ve,"offsetX",0,ge());dt(ve,"offsetY",0,ge());dt(ve,"dragDistance",void 0,ge());dt(ve,"width",0,ge());dt(ve,"height",0,ge());dt(ve,"listening",!0,$r());dt(ve,"preventDefault",!0,$r());dt(ve,"filters",void 0,function(r){return this._filterUpToDate=!1,r});dt(ve,"visible",!0,$r());dt(ve,"transformsEnabled","all",As());dt(ve,"size");dt(ve,"dragBoundFunc");dt(ve,"draggable",!1,$r());F.backCompat(ve,{rotateDeg:"rotate",setRotationDeg:"setRotation",getRotationDeg:"getRotation"});class gr extends ve{constructor(){super(...arguments),this.children=[]}getChildren(e){const t=this.children||[];return e?t.filter(e):t}hasChildren(){return this.getChildren().length>0}removeChildren(){return this.getChildren().forEach(e=>{e.parent=null,e.index=0,e.remove()}),this.children=[],this._requestDraw(),this}destroyChildren(){return this.getChildren().forEach(e=>{e.parent=null,e.index=0,e.destroy()}),this.children=[],this._requestDraw(),this}add(...e){if(e.length===0)return this;if(e.length>1){for(let n=0;n<e.length;n++)this.add(e[n]);return this}const t=e[0];return t.getParent()?(t.moveTo(this),this):(this._validateAdd(t),t.index=this.getChildren().length,t.parent=this,t._clearCaches(),this.getChildren().push(t),this._fire("add",{child:t}),this._requestDraw(),this)}destroy(){return this.hasChildren()&&this.destroyChildren(),super.destroy(),this}find(e){return this._generalFind(e,!1)}findOne(e){const t=this._generalFind(e,!0);return t.length>0?t[0]:void 0}_generalFind(e,t){const n=[];return this._descendants(i=>{const l=i._isMatch(e);return l&&n.push(i),!!(l&&t)}),n}_descendants(e){let t=!1;const n=this.getChildren();for(const i of n){if(t=e(i),t)return!0;if(i.hasChildren()&&(t=i._descendants(e),t))return!0}return!1}toObject(){const e=ve.prototype.toObject.call(this);return e.children=[],this.getChildren().forEach(t=>{e.children.push(t.toObject())}),e}isAncestorOf(e){let t=e.getParent();for(;t;){if(t._id===this._id)return!0;t=t.getParent()}return!1}clone(e){const t=ve.prototype.clone.call(this,e);return this.getChildren().forEach(function(n){t.add(n.clone())}),t}getAllIntersections(e){const t=[];return this.find("Shape").forEach(n=>{n.isVisible()&&n.intersects(e)&&t.push(n)}),t}_clearSelfAndDescendantCache(e){var t;super._clearSelfAndDescendantCache(e),!this.isCached()&&((t=this.children)===null||t===void 0||t.forEach(function(n){n._clearSelfAndDescendantCache(e)}))}_setChildrenIndices(){var e;(e=this.children)===null||e===void 0||e.forEach(function(t,n){t.index=n}),this._requestDraw()}drawScene(e,t,n){const i=this.getLayer(),l=e||i&&i.getCanvas(),c=l&&l.getContext(),d=this._getCanvasCache(),u=d&&d.scene,f=l&&l.isCache;if(!this.isVisible()&&!f)return this;if(u){c.save();const p=this.getAbsoluteTransform(t).getMatrix();c.transform(p[0],p[1],p[2],p[3],p[4],p[5]),this._drawCachedSceneCanvas(c),c.restore()}else this._drawChildren("drawScene",l,t,n);return this}drawHit(e,t){if(!this.shouldDrawHit(t))return this;const n=this.getLayer(),i=e||n&&n.hitCanvas,l=i&&i.getContext(),c=this._getCanvasCache();if(c&&c.hit){l.save();const u=this.getAbsoluteTransform(t).getMatrix();l.transform(u[0],u[1],u[2],u[3],u[4],u[5]),this._drawCachedHitCanvas(l),l.restore()}else this._drawChildren("drawHit",i,t);return this}_drawChildren(e,t,n,i){var l;const c=t&&t.getContext(),d=this.clipWidth(),u=this.clipHeight(),f=this.clipFunc(),p=typeof d=="number"&&typeof u=="number"||f,m=n===this;if(p){c.save();const w=this.getAbsoluteTransform(n);let _=w.getMatrix();c.transform(_[0],_[1],_[2],_[3],_[4],_[5]),c.beginPath();let x;if(f)x=f.call(this,c,this);else{const v=this.clipX(),S=this.clipY();c.rect(v||0,S||0,d,u)}c.clip.apply(c,x),_=w.copy().invert().getMatrix(),c.transform(_[0],_[1],_[2],_[3],_[4],_[5])}const y=!m&&this.globalCompositeOperation()!=="source-over"&&e==="drawScene";y&&(c.save(),c._applyGlobalCompositeOperation(this)),(l=this.children)===null||l===void 0||l.forEach(function(w){w[e](t,n,i)}),y&&c.restore(),p&&c.restore()}getClientRect(e={}){var t;const n=e.skipTransform,i=e.relativeTo;let l,c,d,u,f={x:1/0,y:1/0,width:0,height:0};const p=this;(t=this.children)===null||t===void 0||t.forEach(function(w){if(!w.visible())return;const _=w.getClientRect({relativeTo:p,skipShadow:e.skipShadow,skipStroke:e.skipStroke});_.width===0&&_.height===0||(l===void 0?(l=_.x,c=_.y,d=_.x+_.width,u=_.y+_.height):(l=Math.min(l,_.x),c=Math.min(c,_.y),d=Math.max(d,_.x+_.width),u=Math.max(u,_.y+_.height)))});const m=this.find("Shape");let y=!1;for(let w=0;w<m.length;w++)if(m[w]._isVisible(this)){y=!0;break}return y&&l!==void 0?f={x:l,y:c,width:d-l,height:u-c}:f={x:0,y:0,width:0,height:0},n?f:this._transformedRect(f,i)}}F.addComponentsGetterSetter(gr,"clip",["x","y","width","height"]);F.addGetterSetter(gr,"clipX",void 0,ge());F.addGetterSetter(gr,"clipY",void 0,ge());F.addGetterSetter(gr,"clipWidth",void 0,ge());F.addGetterSetter(gr,"clipHeight",void 0,ge());F.addGetterSetter(gr,"clipFunc");const ma=new Map,T0=we._global.PointerEvent!==void 0;function Yc(r){return ma.get(r)}function pu(r){return{evt:r,pointerId:r.pointerId}}function R0(r,e){return ma.get(r)===e}function D0(r,e){sa(r),e.getStage()&&(ma.set(r,e),T0&&e._fire("gotpointercapture",pu(new PointerEvent("gotpointercapture"))))}function sa(r,e){const t=ma.get(r);if(!t)return;const n=t.getStage();n&&n.content,ma.delete(r),T0&&t._fire("lostpointercapture",pu(new PointerEvent("lostpointercapture")))}const Hb="Stage",Ub="string",sp="px",Wb="mouseout",O0="mouseleave",I0="mouseover",M0="mouseenter",L0="mousemove",F0="mousedown",z0="mouseup",Ki="pointermove",Qi="pointerdown",ti="pointerup",Zi="pointercancel",Vb="lostpointercapture",Ao="pointerout",Ji="pointerleave",To="pointerover",Ro="pointerenter",bd="contextmenu",B0="touchstart",G0="touchend",H0="touchmove",U0="touchcancel",_d="wheel",$b=5,Yb=[[M0,"_pointerenter"],[F0,"_pointerdown"],[L0,"_pointermove"],[z0,"_pointerup"],[O0,"_pointerleave"],[B0,"_pointerdown"],[H0,"_pointermove"],[G0,"_pointerup"],[U0,"_pointercancel"],[I0,"_pointerover"],[_d,"_wheel"],[bd,"_contextmenu"],[Qi,"_pointerdown"],[Ki,"_pointermove"],[ti,"_pointerup"],[Zi,"_pointercancel"],[Ji,"_pointerleave"],[Vb,"_lostpointercapture"]],Xc={mouse:{[Ao]:Wb,[Ji]:O0,[To]:I0,[Ro]:M0,[Ki]:L0,[Qi]:F0,[ti]:z0,[Zi]:"mousecancel",pointerclick:"click",pointerdblclick:"dblclick"},touch:{[Ao]:"touchout",[Ji]:"touchleave",[To]:"touchover",[Ro]:"touchenter",[Ki]:H0,[Qi]:B0,[ti]:G0,[Zi]:U0,pointerclick:"tap",pointerdblclick:"dbltap"},pointer:{[Ao]:Ao,[Ji]:Ji,[To]:To,[Ro]:Ro,[Ki]:Ki,[Qi]:Qi,[ti]:ti,[Zi]:Zi,pointerclick:"pointerclick",pointerdblclick:"pointerdblclick"}},ea=r=>r.indexOf("pointer")>=0?"pointer":r.indexOf("touch")>=0?"touch":"mouse",Qs=r=>{const e=ea(r);if(e==="pointer")return we.pointerEventsEnabled&&Xc.pointer;if(e==="touch")return Xc.touch;if(e==="mouse")return Xc.mouse};function ip(r={}){return(r.clipFunc||r.clipWidth||r.clipHeight)&&$.warn("Stage does not support clipping. Please use clip for Layers or Groups."),r}const Xb="Pointer position is missing and not registered by the stage. Looks like it is outside of the stage container. You can set it manually from event: stage.setPointersPositions(event);",ia=[];let _l=class extends gr{constructor(e){super(ip(e)),this._pointerPositions=[],this._changedPointerPositions=[],this._buildDOM(),this._bindContentEvents(),ia.push(this),this.on("widthChange.konva heightChange.konva",this._resizeDOM),this.on("visibleChange.konva",this._checkVisibility),this.on("clipWidthChange.konva clipHeightChange.konva clipFuncChange.konva",()=>{ip(this.attrs)}),this._checkVisibility()}_validateAdd(e){const t=e.getType()==="Layer",n=e.getType()==="FastLayer";t||n||$.throw("You may only add layers to the stage.")}_checkVisibility(){if(!this.content)return;const e=this.visible()?"":"none";this.content.style.display=e}setContainer(e){if(typeof e===Ub){let t;if(e.charAt(0)==="."){const n=e.slice(1);e=document.getElementsByClassName(n)[0]}else e.charAt(0)!=="#"?t=e:t=e.slice(1),e=document.getElementById(t);if(!e)throw"Can not find container in document with id "+t}return this._setAttr("container",e),this.content&&(this.content.parentElement&&this.content.parentElement.removeChild(this.content),e.appendChild(this.content)),this}shouldDrawHit(){return!0}clear(){const e=this.children,t=e.length;for(let n=0;n<t;n++)e[n].clear();return this}clone(e){return e||(e={}),e.container=typeof document<"u"&&document.createElement("div"),gr.prototype.clone.call(this,e)}destroy(){super.destroy();const e=this.content;e&&$._isInDocument(e)&&this.container().removeChild(e);const t=ia.indexOf(this);return t>-1&&ia.splice(t,1),$.releaseCanvas(this.bufferCanvas._canvas,this.bufferHitCanvas._canvas),this}getPointerPosition(){const e=this._pointerPositions[0]||this._changedPointerPositions[0];return e?{x:e.x,y:e.y}:($.warn(Xb),null)}_getPointerById(e){return this._pointerPositions.find(t=>t.id===e)}getPointersPositions(){return this._pointerPositions}getStage(){return this}getContent(){return this.content}_toKonvaCanvas(e){e={...e},e.x=e.x||0,e.y=e.y||0,e.width=e.width||this.width(),e.height=e.height||this.height();const t=new Wn({width:e.width,height:e.height,pixelRatio:e.pixelRatio||1}),n=t.getContext()._context,i=this.children;return(e.x||e.y)&&n.translate(-1*e.x,-1*e.y),i.forEach(function(l){if(!l.isVisible())return;const c=l._toKonvaCanvas(e);n.drawImage(c._canvas,e.x,e.y,c.getWidth()/c.getPixelRatio(),c.getHeight()/c.getPixelRatio())}),t}getIntersection(e){if(!e)return null;const t=this.children,n=t.length,i=n-1;for(let l=i;l>=0;l--){const c=t[l].getIntersection(e);if(c)return c}return null}_resizeDOM(){const e=this.width(),t=this.height();this.content&&(this.content.style.width=e+sp,this.content.style.height=t+sp),this.bufferCanvas.setSize(e,t),this.bufferHitCanvas.setSize(e,t),this.children.forEach(n=>{n.setSize({width:e,height:t}),n.draw()})}add(e,...t){if(arguments.length>1){for(let i=0;i<arguments.length;i++)this.add(arguments[i]);return this}super.add(e);const n=this.children.length;return n>$b&&$.warn("The stage has "+n+" layers. Recommended maximum number of layers is 3-5. Adding more layers into the stage may drop the performance. Rethink your tree structure, you can use Konva.Group."),e.setSize({width:this.width(),height:this.height()}),e.draw(),we.isBrowser&&this.content.appendChild(e.canvas._canvas),this}getParent(){return null}getLayer(){return null}hasPointerCapture(e){return R0(e,this)}setPointerCapture(e){D0(e,this)}releaseCapture(e){sa(e)}getLayers(){return this.children}_bindContentEvents(){we.isBrowser&&Yb.forEach(([e,t])=>{this.content.addEventListener(e,n=>{this[t](n)},{passive:!1})})}_pointerenter(e){this.setPointersPositions(e);const t=Qs(e.type);t&&this._fire(t.pointerenter,{evt:e,target:this,currentTarget:this})}_pointerover(e){this.setPointersPositions(e);const t=Qs(e.type);t&&this._fire(t.pointerover,{evt:e,target:this,currentTarget:this})}_getTargetShape(e){let t=this[e+"targetShape"];return t&&!t.getStage()&&(t=null),t}_pointerleave(e){const t=Qs(e.type),n=ea(e.type);if(!t)return;this.setPointersPositions(e);const i=this._getTargetShape(n),l=!(we.isDragging()||we.isTransforming())||we.hitOnDragEnabled;i&&l?(i._fireAndBubble(t.pointerout,{evt:e}),i._fireAndBubble(t.pointerleave,{evt:e}),this._fire(t.pointerleave,{evt:e,target:this,currentTarget:this}),this[n+"targetShape"]=null):l&&(this._fire(t.pointerleave,{evt:e,target:this,currentTarget:this}),this._fire(t.pointerout,{evt:e,target:this,currentTarget:this})),this.pointerPos=null,this._pointerPositions=[]}_pointerdown(e){const t=Qs(e.type),n=ea(e.type);if(!t)return;this.setPointersPositions(e);let i=!1;this._changedPointerPositions.forEach(l=>{const c=this.getIntersection(l);if(rt.justDragged=!1,we["_"+n+"ListenClick"]=!0,!c||!c.isListening()){this[n+"ClickStartShape"]=void 0;return}we.capturePointerEventsEnabled&&c.setPointerCapture(l.id),this[n+"ClickStartShape"]=c,c._fireAndBubble(t.pointerdown,{evt:e,pointerId:l.id}),i=!0;const d=e.type.indexOf("touch")>=0;c.preventDefault()&&e.cancelable&&d&&e.preventDefault()}),i||this._fire(t.pointerdown,{evt:e,target:this,currentTarget:this,pointerId:this._pointerPositions[0].id})}_pointermove(e){const t=Qs(e.type),n=ea(e.type);if(!t)return;const i=e.type.indexOf("touch")>=0||e.pointerType==="touch";if(we.isDragging()&&rt.node.preventDefault()&&e.cancelable&&i&&e.preventDefault(),this.setPointersPositions(e),!(!(we.isDragging()||we.isTransforming())||we.hitOnDragEnabled))return;const c={};let d=!1;const u=this._getTargetShape(n);this._changedPointerPositions.forEach(f=>{const p=Yc(f.id)||this.getIntersection(f),m=f.id,y={evt:e,pointerId:m},w=u!==p;if(w&&u&&(u._fireAndBubble(t.pointerout,{...y},p),u._fireAndBubble(t.pointerleave,{...y},p)),p){if(c[p._id])return;c[p._id]=!0}p&&p.isListening()?(d=!0,w&&(p._fireAndBubble(t.pointerover,{...y},u),p._fireAndBubble(t.pointerenter,{...y},u),this[n+"targetShape"]=p),p._fireAndBubble(t.pointermove,{...y})):u&&(this._fire(t.pointerover,{evt:e,target:this,currentTarget:this,pointerId:m}),this[n+"targetShape"]=null)}),d||this._fire(t.pointermove,{evt:e,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id})}_pointerup(e){const t=Qs(e.type),n=ea(e.type);if(!t)return;this.setPointersPositions(e);const i=this[n+"ClickStartShape"],l=this[n+"ClickEndShape"],c={};let d=!1;this._changedPointerPositions.forEach(u=>{const f=Yc(u.id)||this.getIntersection(u);if(f){if(f.releaseCapture(u.id),c[f._id])return;c[f._id]=!0}const p=u.id,m={evt:e,pointerId:p};let y=!1;we["_"+n+"InDblClickWindow"]?(y=!0,clearTimeout(this[n+"DblTimeout"])):rt.justDragged||(we["_"+n+"InDblClickWindow"]=!0,clearTimeout(this[n+"DblTimeout"])),this[n+"DblTimeout"]=setTimeout(function(){we["_"+n+"InDblClickWindow"]=!1},we.dblClickWindow),f&&f.isListening()?(d=!0,this[n+"ClickEndShape"]=f,f._fireAndBubble(t.pointerup,{...m}),we["_"+n+"ListenClick"]&&i&&i===f&&(f._fireAndBubble(t.pointerclick,{...m}),y&&l&&l===f&&f._fireAndBubble(t.pointerdblclick,{...m}))):(this[n+"ClickEndShape"]=null,d||(this._fire(t.pointerup,{evt:e,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id}),d=!0),we["_"+n+"ListenClick"]&&this._fire(t.pointerclick,{evt:e,target:this,currentTarget:this,pointerId:p}),y&&this._fire(t.pointerdblclick,{evt:e,target:this,currentTarget:this,pointerId:p}))}),d||this._fire(t.pointerup,{evt:e,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id}),we["_"+n+"ListenClick"]=!1,e.cancelable&&n!=="touch"&&n!=="pointer"&&e.preventDefault()}_contextmenu(e){this.setPointersPositions(e);const t=this.getIntersection(this.getPointerPosition());t&&t.isListening()?t._fireAndBubble(bd,{evt:e}):this._fire(bd,{evt:e,target:this,currentTarget:this})}_wheel(e){this.setPointersPositions(e);const t=this.getIntersection(this.getPointerPosition());t&&t.isListening()?t._fireAndBubble(_d,{evt:e}):this._fire(_d,{evt:e,target:this,currentTarget:this})}_pointercancel(e){this.setPointersPositions(e);const t=Yc(e.pointerId)||this.getIntersection(this.getPointerPosition());t&&t._fireAndBubble(ti,pu(e)),sa(e.pointerId)}_lostpointercapture(e){sa(e.pointerId)}setPointersPositions(e){const t=this._getContentPosition();let n=null,i=null;e=e||window.event,e.touches!==void 0?(this._pointerPositions=[],this._changedPointerPositions=[],Array.prototype.forEach.call(e.touches,l=>{this._pointerPositions.push({id:l.identifier,x:(l.clientX-t.left)/t.scaleX,y:(l.clientY-t.top)/t.scaleY})}),Array.prototype.forEach.call(e.changedTouches||e.touches,l=>{this._changedPointerPositions.push({id:l.identifier,x:(l.clientX-t.left)/t.scaleX,y:(l.clientY-t.top)/t.scaleY})})):(n=(e.clientX-t.left)/t.scaleX,i=(e.clientY-t.top)/t.scaleY,this.pointerPos={x:n,y:i},this._pointerPositions=[{x:n,y:i,id:$._getFirstPointerId(e)}],this._changedPointerPositions=[{x:n,y:i,id:$._getFirstPointerId(e)}])}_setPointerPosition(e){$.warn('Method _setPointerPosition is deprecated. Use "stage.setPointersPositions(event)" instead.'),this.setPointersPositions(e)}_getContentPosition(){if(!this.content||!this.content.getBoundingClientRect)return{top:0,left:0,scaleX:1,scaleY:1};const e=this.content.getBoundingClientRect();return{top:e.top,left:e.left,scaleX:e.width/this.content.clientWidth||1,scaleY:e.height/this.content.clientHeight||1}}_buildDOM(){if(this.bufferCanvas=new Wn({width:this.width(),height:this.height()}),this.bufferHitCanvas=new hu({pixelRatio:1,width:this.width(),height:this.height()}),!we.isBrowser)return;const e=this.container();if(!e)throw"Stage has no container. A container is required.";e.innerHTML="",this.content=document.createElement("div"),this.content.style.position="relative",this.content.style.userSelect="none",this.content.className="konvajs-content",this.content.setAttribute("role","presentation"),e.appendChild(this.content),this._resizeDOM()}cache(){return $.warn("Cache function is not allowed for stage. You may use cache only for layers, groups and shapes."),this}clearCache(){return this}batchDraw(){return this.getChildren().forEach(function(e){e.batchDraw()}),this}};_l.prototype.nodeType=Hb;kt(_l);F.addGetterSetter(_l,"container");we.isBrowser&&document.addEventListener("visibilitychange",()=>{ia.forEach(r=>{r.batchDraw()})});const W0="hasShadow",V0="shadowRGBA",$0="patternImage",Y0="linearGradient",X0="radialGradient";let Do;function qc(){return Do||(Do=$.createCanvasElement().getContext("2d"),Do)}const aa={};function qb(r){const e=this.attrs.fillRule;e?r.fill(e):r.fill()}function Kb(r){r.stroke()}function Qb(r){const e=this.attrs.fillRule;e?r.fill(e):r.fill()}function Zb(r){r.stroke()}function Jb(){this._clearCache(W0)}function e6(){this._clearCache(V0)}function t6(){this._clearCache($0)}function r6(){this._clearCache(Y0)}function n6(){this._clearCache(X0)}class he extends ve{constructor(e){super(e);let t,n=0;for(;t=$.getHitColor(),!(t&&!(t in aa));)if(n++,n>=1e4){$.warn("Failed to find a unique color key for a shape. Konva may work incorrectly. Most likely your browser is using canvas farbling. Consider disabling it."),t=$.getRandomColor();break}this.colorKey=t,aa[t]=this}getContext(){return $.warn("shape.getContext() method is deprecated. Please do not use it."),this.getLayer().getContext()}getCanvas(){return $.warn("shape.getCanvas() method is deprecated. Please do not use it."),this.getLayer().getCanvas()}getSceneFunc(){return this.attrs.sceneFunc||this._sceneFunc}getHitFunc(){return this.attrs.hitFunc||this._hitFunc}hasShadow(){return this._getCache(W0,this._hasShadow)}_hasShadow(){return this.shadowEnabled()&&this.shadowOpacity()!==0&&!!(this.shadowColor()||this.shadowBlur()||this.shadowOffsetX()||this.shadowOffsetY())}_getFillPattern(){return this._getCache($0,this.__getFillPattern)}__getFillPattern(){if(this.fillPatternImage()){const t=qc().createPattern(this.fillPatternImage(),this.fillPatternRepeat()||"repeat");if(t&&t.setTransform){const n=new pr;n.translate(this.fillPatternX(),this.fillPatternY()),n.rotate(we.getAngle(this.fillPatternRotation())),n.scale(this.fillPatternScaleX(),this.fillPatternScaleY()),n.translate(-1*this.fillPatternOffsetX(),-1*this.fillPatternOffsetY());const i=n.getMatrix(),l=typeof DOMMatrix>"u"?{a:i[0],b:i[1],c:i[2],d:i[3],e:i[4],f:i[5]}:new DOMMatrix(i);t.setTransform(l)}return t}}_getLinearGradient(){return this._getCache(Y0,this.__getLinearGradient)}__getLinearGradient(){const e=this.fillLinearGradientColorStops();if(e){const t=qc(),n=this.fillLinearGradientStartPoint(),i=this.fillLinearGradientEndPoint(),l=t.createLinearGradient(n.x,n.y,i.x,i.y);for(let c=0;c<e.length;c+=2)l.addColorStop(e[c],e[c+1]);return l}}_getRadialGradient(){return this._getCache(X0,this.__getRadialGradient)}__getRadialGradient(){const e=this.fillRadialGradientColorStops();if(e){const t=qc(),n=this.fillRadialGradientStartPoint(),i=this.fillRadialGradientEndPoint(),l=t.createRadialGradient(n.x,n.y,this.fillRadialGradientStartRadius(),i.x,i.y,this.fillRadialGradientEndRadius());for(let c=0;c<e.length;c+=2)l.addColorStop(e[c],e[c+1]);return l}}getShadowRGBA(){return this._getCache(V0,this._getShadowRGBA)}_getShadowRGBA(){if(!this.hasShadow())return;const e=$.colorToRGBA(this.shadowColor());if(e)return"rgba("+e.r+","+e.g+","+e.b+","+e.a*(this.shadowOpacity()||1)+")"}hasFill(){return this._calculate("hasFill",["fillEnabled","fill","fillPatternImage","fillLinearGradientColorStops","fillRadialGradientColorStops"],()=>this.fillEnabled()&&!!(this.fill()||this.fillPatternImage()||this.fillLinearGradientColorStops()||this.fillRadialGradientColorStops()))}hasStroke(){return this._calculate("hasStroke",["strokeEnabled","strokeWidth","stroke","strokeLinearGradientColorStops"],()=>this.strokeEnabled()&&this.strokeWidth()&&!!(this.stroke()||this.strokeLinearGradientColorStops()))}hasHitStroke(){const e=this.hitStrokeWidth();return e==="auto"?this.hasStroke():this.strokeEnabled()&&!!e}intersects(e){const t=this.getStage();if(!t)return!1;const n=t.bufferHitCanvas;return n.getContext().clear(),this.drawHit(n,void 0,!0),n.context.getImageData(Math.round(e.x),Math.round(e.y),1,1).data[3]>0}destroy(){return ve.prototype.destroy.call(this),delete aa[this.colorKey],delete this.colorKey,this}_useBufferCanvas(e){var t;if(!((t=this.attrs.perfectDrawEnabled)!==null&&t!==void 0?t:!0))return!1;const i=e||this.hasFill(),l=this.hasStroke(),c=this.getAbsoluteOpacity()!==1;if(i&&l&&c)return!0;const d=this.hasShadow(),u=this.shadowForStrokeEnabled();return!!(i&&l&&d&&u)}setStrokeHitEnabled(e){$.warn("strokeHitEnabled property is deprecated. Please use hitStrokeWidth instead."),e?this.hitStrokeWidth("auto"):this.hitStrokeWidth(0)}getStrokeHitEnabled(){return this.hitStrokeWidth()!==0}getSelfRect(){const e=this.size();return{x:this._centroid?-e.width/2:0,y:this._centroid?-e.height/2:0,width:e.width,height:e.height}}getClientRect(e={}){let t=!1,n=this.getParent();for(;n;){if(n.isCached()){t=!0;break}n=n.getParent()}const i=e.skipTransform,l=e.relativeTo||t&&this.getStage()||void 0,c=this.getSelfRect(),u=!e.skipStroke&&this.hasStroke()&&this.strokeWidth()||0,f=c.width+u,p=c.height+u,m=!e.skipShadow&&this.hasShadow(),y=m?this.shadowOffsetX():0,w=m?this.shadowOffsetY():0,_=f+Math.abs(y),x=p+Math.abs(w),v=m&&this.shadowBlur()||0,S=_+v*2,C=x+v*2,k={width:S,height:C,x:-(u/2+v)+Math.min(y,0)+c.x,y:-(u/2+v)+Math.min(w,0)+c.y};return i?k:this._transformedRect(k,l)}drawScene(e,t,n){const i=this.getLayer(),l=e||i.getCanvas(),c=l.getContext(),d=this._getCanvasCache(),u=this.getSceneFunc(),f=this.hasShadow();let p;const m=t===this;if(!this.isVisible()&&!m)return this;if(d){c.save();const y=this.getAbsoluteTransform(t).getMatrix();return c.transform(y[0],y[1],y[2],y[3],y[4],y[5]),this._drawCachedSceneCanvas(c),c.restore(),this}if(!u)return this;if(c.save(),this._useBufferCanvas()){p=this.getStage();const y=n||p.bufferCanvas,w=y.getContext();n?(w.save(),w.setTransform(1,0,0,1,0,0),w.clearRect(0,0,y.width,y.height),w.restore()):w.clear(),w.save(),w._applyLineJoin(this),w._applyMiterLimit(this);const _=this.getAbsoluteTransform(t).getMatrix();w.transform(_[0],_[1],_[2],_[3],_[4],_[5]),u.call(this,w,this),w.restore();const x=y.pixelRatio;f&&c._applyShadow(this),m||(c._applyOpacity(this),c._applyGlobalCompositeOperation(this)),c.drawImage(y._canvas,y.x||0,y.y||0,y.width/x,y.height/x)}else{if(c._applyLineJoin(this),c._applyMiterLimit(this),!m){const y=this.getAbsoluteTransform(t).getMatrix();c.transform(y[0],y[1],y[2],y[3],y[4],y[5]),c._applyOpacity(this),c._applyGlobalCompositeOperation(this)}f&&c._applyShadow(this),u.call(this,c,this)}return c.restore(),this}drawHit(e,t,n=!1){if(!this.shouldDrawHit(t,n))return this;const i=this.getLayer(),l=e||i.hitCanvas,c=l&&l.getContext(),d=this.hitFunc()||this.sceneFunc(),u=this._getCanvasCache(),f=u&&u.hit;if(this.colorKey||$.warn("Looks like your canvas has a destroyed shape in it. Do not reuse shape after you destroyed it. If you want to reuse shape you should call remove() instead of destroy()"),f){c.save();const m=this.getAbsoluteTransform(t).getMatrix();return c.transform(m[0],m[1],m[2],m[3],m[4],m[5]),this._drawCachedHitCanvas(c),c.restore(),this}if(!d)return this;if(c.save(),c._applyLineJoin(this),c._applyMiterLimit(this),!(this===t)){const m=this.getAbsoluteTransform(t).getMatrix();c.transform(m[0],m[1],m[2],m[3],m[4],m[5])}return d.call(this,c,this),c.restore(),this}drawHitFromCache(e=0){const t=this._getCanvasCache(),n=this._getCachedSceneCanvas(),i=t.hit,l=i.getContext(),c=i.getWidth(),d=i.getHeight();l.clear(),l.drawImage(n._canvas,0,0,c,d);try{const u=l.getImageData(0,0,c,d),f=u.data,p=f.length,m=$._hexToRgb(this.colorKey);for(let y=0;y<p;y+=4)f[y+3]>e?(f[y]=m.r,f[y+1]=m.g,f[y+2]=m.b,f[y+3]=255):f[y+3]=0;l.putImageData(u,0,0)}catch(u){$.error("Unable to draw hit graph from cached scene canvas. "+u.message)}return this}hasPointerCapture(e){return R0(e,this)}setPointerCapture(e){D0(e,this)}releaseCapture(e){sa(e)}}he.prototype._fillFunc=qb;he.prototype._strokeFunc=Kb;he.prototype._fillFuncHit=Qb;he.prototype._strokeFuncHit=Zb;he.prototype._centroid=!1;he.prototype.nodeType="Shape";kt(he);he.prototype.eventListeners={};he.prototype.on.call(he.prototype,"shadowColorChange.konva shadowBlurChange.konva shadowOffsetChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",Jb);he.prototype.on.call(he.prototype,"shadowColorChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",e6);he.prototype.on.call(he.prototype,"fillPriorityChange.konva fillPatternImageChange.konva fillPatternRepeatChange.konva fillPatternScaleXChange.konva fillPatternScaleYChange.konva fillPatternOffsetXChange.konva fillPatternOffsetYChange.konva fillPatternXChange.konva fillPatternYChange.konva fillPatternRotationChange.konva",t6);he.prototype.on.call(he.prototype,"fillPriorityChange.konva fillLinearGradientColorStopsChange.konva fillLinearGradientStartPointXChange.konva fillLinearGradientStartPointYChange.konva fillLinearGradientEndPointXChange.konva fillLinearGradientEndPointYChange.konva",r6);he.prototype.on.call(he.prototype,"fillPriorityChange.konva fillRadialGradientColorStopsChange.konva fillRadialGradientStartPointXChange.konva fillRadialGradientStartPointYChange.konva fillRadialGradientEndPointXChange.konva fillRadialGradientEndPointYChange.konva fillRadialGradientStartRadiusChange.konva fillRadialGradientEndRadiusChange.konva",n6);F.addGetterSetter(he,"stroke",void 0,A0());F.addGetterSetter(he,"strokeWidth",2,ge());F.addGetterSetter(he,"fillAfterStrokeEnabled",!1);F.addGetterSetter(he,"hitStrokeWidth","auto",fu());F.addGetterSetter(he,"strokeHitEnabled",!0,$r());F.addGetterSetter(he,"perfectDrawEnabled",!0,$r());F.addGetterSetter(he,"shadowForStrokeEnabled",!0,$r());F.addGetterSetter(he,"lineJoin");F.addGetterSetter(he,"lineCap");F.addGetterSetter(he,"miterLimit");F.addGetterSetter(he,"sceneFunc");F.addGetterSetter(he,"hitFunc");F.addGetterSetter(he,"dash");F.addGetterSetter(he,"dashOffset",0,ge());F.addGetterSetter(he,"shadowColor",void 0,As());F.addGetterSetter(he,"shadowBlur",0,ge());F.addGetterSetter(he,"shadowOpacity",1,ge());F.addComponentsGetterSetter(he,"shadowOffset",["x","y"]);F.addGetterSetter(he,"shadowOffsetX",0,ge());F.addGetterSetter(he,"shadowOffsetY",0,ge());F.addGetterSetter(he,"fillPatternImage");F.addGetterSetter(he,"fill",void 0,A0());F.addGetterSetter(he,"fillPatternX",0,ge());F.addGetterSetter(he,"fillPatternY",0,ge());F.addGetterSetter(he,"fillLinearGradientColorStops");F.addGetterSetter(he,"strokeLinearGradientColorStops");F.addGetterSetter(he,"fillRadialGradientStartRadius",0);F.addGetterSetter(he,"fillRadialGradientEndRadius",0);F.addGetterSetter(he,"fillRadialGradientColorStops");F.addGetterSetter(he,"fillPatternRepeat","repeat");F.addGetterSetter(he,"fillEnabled",!0);F.addGetterSetter(he,"strokeEnabled",!0);F.addGetterSetter(he,"shadowEnabled",!0);F.addGetterSetter(he,"dashEnabled",!0);F.addGetterSetter(he,"strokeScaleEnabled",!0);F.addGetterSetter(he,"fillPriority","color");F.addComponentsGetterSetter(he,"fillPatternOffset",["x","y"]);F.addGetterSetter(he,"fillPatternOffsetX",0,ge());F.addGetterSetter(he,"fillPatternOffsetY",0,ge());F.addComponentsGetterSetter(he,"fillPatternScale",["x","y"]);F.addGetterSetter(he,"fillPatternScaleX",1,ge());F.addGetterSetter(he,"fillPatternScaleY",1,ge());F.addComponentsGetterSetter(he,"fillLinearGradientStartPoint",["x","y"]);F.addComponentsGetterSetter(he,"strokeLinearGradientStartPoint",["x","y"]);F.addGetterSetter(he,"fillLinearGradientStartPointX",0);F.addGetterSetter(he,"strokeLinearGradientStartPointX",0);F.addGetterSetter(he,"fillLinearGradientStartPointY",0);F.addGetterSetter(he,"strokeLinearGradientStartPointY",0);F.addComponentsGetterSetter(he,"fillLinearGradientEndPoint",["x","y"]);F.addComponentsGetterSetter(he,"strokeLinearGradientEndPoint",["x","y"]);F.addGetterSetter(he,"fillLinearGradientEndPointX",0);F.addGetterSetter(he,"strokeLinearGradientEndPointX",0);F.addGetterSetter(he,"fillLinearGradientEndPointY",0);F.addGetterSetter(he,"strokeLinearGradientEndPointY",0);F.addComponentsGetterSetter(he,"fillRadialGradientStartPoint",["x","y"]);F.addGetterSetter(he,"fillRadialGradientStartPointX",0);F.addGetterSetter(he,"fillRadialGradientStartPointY",0);F.addComponentsGetterSetter(he,"fillRadialGradientEndPoint",["x","y"]);F.addGetterSetter(he,"fillRadialGradientEndPointX",0);F.addGetterSetter(he,"fillRadialGradientEndPointY",0);F.addGetterSetter(he,"fillPatternRotation",0);F.addGetterSetter(he,"fillRule",void 0,As());F.backCompat(he,{dashArray:"dash",getDashArray:"getDash",setDashArray:"getDash",drawFunc:"sceneFunc",getDrawFunc:"getSceneFunc",setDrawFunc:"setSceneFunc",drawHitFunc:"hitFunc",getDrawHitFunc:"getHitFunc",setDrawHitFunc:"setHitFunc"});const s6="beforeDraw",i6="draw",q0=[{x:0,y:0},{x:-1,y:-1},{x:1,y:-1},{x:1,y:1},{x:-1,y:1}],a6=q0.length;let Ts=class extends gr{constructor(e){super(e),this.canvas=new Wn,this.hitCanvas=new hu({pixelRatio:1}),this._waitingForDraw=!1,this.on("visibleChange.konva",this._checkVisibility),this._checkVisibility(),this.on("imageSmoothingEnabledChange.konva",this._setSmoothEnabled),this._setSmoothEnabled()}createPNGStream(){return this.canvas._canvas.createPNGStream()}getCanvas(){return this.canvas}getNativeCanvasElement(){return this.canvas._canvas}getHitCanvas(){return this.hitCanvas}getContext(){return this.getCanvas().getContext()}clear(e){return this.getContext().clear(e),this.getHitCanvas().getContext().clear(e),this}setZIndex(e){super.setZIndex(e);const t=this.getStage();return t&&t.content&&(t.content.removeChild(this.getNativeCanvasElement()),e<t.children.length-1?t.content.insertBefore(this.getNativeCanvasElement(),t.children[e+1].getCanvas()._canvas):t.content.appendChild(this.getNativeCanvasElement())),this}moveToTop(){ve.prototype.moveToTop.call(this);const e=this.getStage();return e&&e.content&&(e.content.removeChild(this.getNativeCanvasElement()),e.content.appendChild(this.getNativeCanvasElement())),!0}moveUp(){if(!ve.prototype.moveUp.call(this))return!1;const t=this.getStage();return!t||!t.content?!1:(t.content.removeChild(this.getNativeCanvasElement()),this.index<t.children.length-1?t.content.insertBefore(this.getNativeCanvasElement(),t.children[this.index+1].getCanvas()._canvas):t.content.appendChild(this.getNativeCanvasElement()),!0)}moveDown(){if(ve.prototype.moveDown.call(this)){const e=this.getStage();if(e){const t=e.children;e.content&&(e.content.removeChild(this.getNativeCanvasElement()),e.content.insertBefore(this.getNativeCanvasElement(),t[this.index+1].getCanvas()._canvas))}return!0}return!1}moveToBottom(){if(ve.prototype.moveToBottom.call(this)){const e=this.getStage();if(e){const t=e.children;e.content&&(e.content.removeChild(this.getNativeCanvasElement()),e.content.insertBefore(this.getNativeCanvasElement(),t[1].getCanvas()._canvas))}return!0}return!1}getLayer(){return this}remove(){const e=this.getNativeCanvasElement();return ve.prototype.remove.call(this),e&&e.parentNode&&$._isInDocument(e)&&e.parentNode.removeChild(e),this}getStage(){return this.parent}setSize({width:e,height:t}){return this.canvas.setSize(e,t),this.hitCanvas.setSize(e,t),this._setSmoothEnabled(),this}_validateAdd(e){const t=e.getType();t!=="Group"&&t!=="Shape"&&$.throw("You may only add groups and shapes to a layer.")}_toKonvaCanvas(e){return e={...e},e.width=e.width||this.getWidth(),e.height=e.height||this.getHeight(),e.x=e.x!==void 0?e.x:this.x(),e.y=e.y!==void 0?e.y:this.y(),ve.prototype._toKonvaCanvas.call(this,e)}_checkVisibility(){this.visible()?this.canvas._canvas.style.display="block":this.canvas._canvas.style.display="none"}_setSmoothEnabled(){this.getContext()._context.imageSmoothingEnabled=this.imageSmoothingEnabled()}getWidth(){if(this.parent)return this.parent.width()}setWidth(){$.warn('Can not change width of layer. Use "stage.width(value)" function instead.')}getHeight(){if(this.parent)return this.parent.height()}setHeight(){$.warn('Can not change height of layer. Use "stage.height(value)" function instead.')}batchDraw(){return this._waitingForDraw||(this._waitingForDraw=!0,$.requestAnimFrame(()=>{this.draw(),this._waitingForDraw=!1})),this}getIntersection(e){if(!this.isListening()||!this.isVisible())return null;let t=1,n=!1;for(;;){for(let i=0;i<a6;i++){const l=q0[i],c=this._getIntersection({x:e.x+l.x*t,y:e.y+l.y*t}),d=c.shape;if(d)return d;if(n=!!c.antialiased,!c.antialiased)break}if(n)t+=1;else return null}}_getIntersection(e){const t=this.hitCanvas.pixelRatio,n=this.hitCanvas.context.getImageData(Math.round(e.x*t),Math.round(e.y*t),1,1).data,i=n[3];if(i===255){const l=$.getHitColorKey(n[0],n[1],n[2]),c=aa[l];return c?{shape:c}:{antialiased:!0}}else if(i>0)return{antialiased:!0};return{}}drawScene(e,t,n){const i=this.getLayer(),l=e||i&&i.getCanvas();return this._fire(s6,{node:this}),this.clearBeforeDraw()&&l.getContext().clear(),gr.prototype.drawScene.call(this,l,t,n),this._fire(i6,{node:this}),this}drawHit(e,t){const n=this.getLayer(),i=e||n&&n.hitCanvas;return n&&n.clearBeforeDraw()&&n.getHitCanvas().getContext().clear(),gr.prototype.drawHit.call(this,i,t),this}enableHitGraph(){return this.hitGraphEnabled(!0),this}disableHitGraph(){return this.hitGraphEnabled(!1),this}setHitGraphEnabled(e){$.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening(e)}getHitGraphEnabled(e){return $.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening()}toggleHitCanvas(){if(!this.parent||!this.parent.content)return;const e=this.parent;!!this.hitCanvas._canvas.parentNode?e.content.removeChild(this.hitCanvas._canvas):e.content.appendChild(this.hitCanvas._canvas)}destroy(){return $.releaseCanvas(this.getNativeCanvasElement(),this.getHitCanvas()._canvas),super.destroy()}};Ts.prototype.nodeType="Layer";kt(Ts);F.addGetterSetter(Ts,"imageSmoothingEnabled",!0);F.addGetterSetter(Ts,"clearBeforeDraw",!0);F.addGetterSetter(Ts,"hitGraphEnabled",!0,$r());class mu extends Ts{constructor(e){super(e),this.listening(!1),$.warn('Konva.Fast layer is deprecated. Please use "new Konva.Layer({ listening: false })" instead.')}}mu.prototype.nodeType="FastLayer";kt(mu);let xi=class extends gr{_validateAdd(e){const t=e.getType();t!=="Group"&&t!=="Shape"&&$.throw("You may only add groups and shapes to groups.")}};xi.prototype.nodeType="Group";kt(xi);const Kc=function(){return bs.performance&&bs.performance.now?function(){return bs.performance.now()}:function(){return new Date().getTime()}}();class Ar{constructor(e,t){this.id=Ar.animIdCounter++,this.frame={time:0,timeDiff:0,lastTime:Kc(),frameRate:0},this.func=e,this.setLayers(t)}setLayers(e){let t=[];return e&&(t=Array.isArray(e)?e:[e]),this.layers=t,this}getLayers(){return this.layers}addLayer(e){const t=this.layers,n=t.length;for(let i=0;i<n;i++)if(t[i]._id===e._id)return!1;return this.layers.push(e),!0}isRunning(){const t=Ar.animations,n=t.length;for(let i=0;i<n;i++)if(t[i].id===this.id)return!0;return!1}start(){return this.stop(),this.frame.timeDiff=0,this.frame.lastTime=Kc(),Ar._addAnimation(this),this}stop(){return Ar._removeAnimation(this),this}_updateFrameObject(e){this.frame.timeDiff=e-this.frame.lastTime,this.frame.lastTime=e,this.frame.time+=this.frame.timeDiff,this.frame.frameRate=1e3/this.frame.timeDiff}static _addAnimation(e){this.animations.push(e),this._handleAnimation()}static _removeAnimation(e){const t=e.id,n=this.animations,i=n.length;for(let l=0;l<i;l++)if(n[l].id===t){this.animations.splice(l,1);break}}static _runFrames(){const e={},t=this.animations;for(let n=0;n<t.length;n++){const i=t[n],l=i.layers,c=i.func;i._updateFrameObject(Kc());const d=l.length;let u;if(c?u=c.call(i,i.frame)!==!1:u=!0,!!u)for(let f=0;f<d;f++){const p=l[f];p._id!==void 0&&(e[p._id]=p)}}for(const n in e)e.hasOwnProperty(n)&&e[n].batchDraw()}static _animationLoop(){const e=Ar;e.animations.length?(e._runFrames(),$.requestAnimFrame(e._animationLoop)):e.animRunning=!1}static _handleAnimation(){this.animRunning||(this.animRunning=!0,$.requestAnimFrame(this._animationLoop))}}Ar.animations=[];Ar.animIdCounter=0;Ar.animRunning=!1;const o6={node:1,duration:1,easing:1,onFinish:1,yoyo:1},l6=1,ap=2,op=3,lp=["fill","stroke","shadowColor"];let c6=0;class d6{constructor(e,t,n,i,l,c,d){this.prop=e,this.propFunc=t,this.begin=i,this._pos=i,this.duration=c,this._change=0,this.prevPos=0,this.yoyo=d,this._time=0,this._position=0,this._startTime=0,this._finish=0,this.func=n,this._change=l-this.begin,this.pause()}fire(e){const t=this[e];t&&t()}setTime(e){e>this.duration?this.yoyo?(this._time=this.duration,this.reverse()):this.finish():e<0?this.yoyo?(this._time=0,this.play()):this.reset():(this._time=e,this.update())}getTime(){return this._time}setPosition(e){this.prevPos=this._pos,this.propFunc(e),this._pos=e}getPosition(e){return e===void 0&&(e=this._time),this.func(e,this.begin,this._change,this.duration)}play(){this.state=ap,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onPlay")}reverse(){this.state=op,this._time=this.duration-this._time,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onReverse")}seek(e){this.pause(),this._time=e,this.update(),this.fire("onSeek")}reset(){this.pause(),this._time=0,this.update(),this.fire("onReset")}finish(){this.pause(),this._time=this.duration,this.update(),this.fire("onFinish")}update(){this.setPosition(this.getPosition(this._time)),this.fire("onUpdate")}onEnterFrame(){const e=this.getTimer()-this._startTime;this.state===ap?this.setTime(e):this.state===op&&this.setTime(this.duration-e)}pause(){this.state=l6,this.fire("onPause")}getTimer(){return new Date().getTime()}}class ht{constructor(e){const t=this,n=e.node,i=n._id,l=e.easing||oa.Linear,c=!!e.yoyo;let d,u;typeof e.duration>"u"?d=.3:e.duration===0?d=.001:d=e.duration,this.node=n,this._id=c6++;const f=n.getLayer()||(n instanceof we.Stage?n.getLayers():null);f||$.error("Tween constructor have `node` that is not in a layer. Please add node into layer first."),this.anim=new Ar(function(){t.tween.onEnterFrame()},f),this.tween=new d6(u,function(p){t._tweenFunc(p)},l,0,1,d*1e3,c),this._addListeners(),ht.attrs[i]||(ht.attrs[i]={}),ht.attrs[i][this._id]||(ht.attrs[i][this._id]={}),ht.tweens[i]||(ht.tweens[i]={});for(u in e)o6[u]===void 0&&this._addAttr(u,e[u]);this.reset(),this.onFinish=e.onFinish,this.onReset=e.onReset,this.onUpdate=e.onUpdate}_addAttr(e,t){const n=this.node,i=n._id;let l,c,d,u,f;const p=ht.tweens[i][e];p&&delete ht.attrs[i][p][e];let m=n.getAttr(e);if($._isArray(t))if(l=[],c=Math.max(t.length,m.length),e==="points"&&t.length!==m.length&&(t.length>m.length?(u=m,m=$._prepareArrayForTween(m,t,n.closed())):(d=t,t=$._prepareArrayForTween(t,m,n.closed()))),e.indexOf("fill")===0)for(let y=0;y<c;y++)if(y%2===0)l.push(t[y]-m[y]);else{const w=$.colorToRGBA(m[y]);f=$.colorToRGBA(t[y]),m[y]=w,l.push({r:f.r-w.r,g:f.g-w.g,b:f.b-w.b,a:f.a-w.a})}else for(let y=0;y<c;y++)l.push(t[y]-m[y]);else lp.indexOf(e)!==-1?(m=$.colorToRGBA(m),f=$.colorToRGBA(t),l={r:f.r-m.r,g:f.g-m.g,b:f.b-m.b,a:f.a-m.a}):l=t-m;ht.attrs[i][this._id][e]={start:m,diff:l,end:t,trueEnd:d,trueStart:u},ht.tweens[i][e]=this._id}_tweenFunc(e){const t=this.node,n=ht.attrs[t._id][this._id];let i,l,c,d,u,f,p,m;for(i in n){if(l=n[i],c=l.start,d=l.diff,m=l.end,$._isArray(c))if(u=[],p=Math.max(c.length,m.length),i.indexOf("fill")===0)for(f=0;f<p;f++)f%2===0?u.push((c[f]||0)+d[f]*e):u.push("rgba("+Math.round(c[f].r+d[f].r*e)+","+Math.round(c[f].g+d[f].g*e)+","+Math.round(c[f].b+d[f].b*e)+","+(c[f].a+d[f].a*e)+")");else for(f=0;f<p;f++)u.push((c[f]||0)+d[f]*e);else lp.indexOf(i)!==-1?u="rgba("+Math.round(c.r+d.r*e)+","+Math.round(c.g+d.g*e)+","+Math.round(c.b+d.b*e)+","+(c.a+d.a*e)+")":u=c+d*e;t.setAttr(i,u)}}_addListeners(){this.tween.onPlay=()=>{this.anim.start()},this.tween.onReverse=()=>{this.anim.start()},this.tween.onPause=()=>{this.anim.stop()},this.tween.onFinish=()=>{const e=this.node,t=ht.attrs[e._id][this._id];t.points&&t.points.trueEnd&&e.setAttr("points",t.points.trueEnd),this.onFinish&&this.onFinish.call(this)},this.tween.onReset=()=>{const e=this.node,t=ht.attrs[e._id][this._id];t.points&&t.points.trueStart&&e.points(t.points.trueStart),this.onReset&&this.onReset()},this.tween.onUpdate=()=>{this.onUpdate&&this.onUpdate.call(this)}}play(){return this.tween.play(),this}reverse(){return this.tween.reverse(),this}reset(){return this.tween.reset(),this}seek(e){return this.tween.seek(e*1e3),this}pause(){return this.tween.pause(),this}finish(){return this.tween.finish(),this}destroy(){const e=this.node._id,t=this._id,n=ht.tweens[e];this.pause(),this.anim&&this.anim.stop();for(const i in n)delete ht.tweens[e][i];delete ht.attrs[e][t],ht.tweens[e]&&(Object.keys(ht.tweens[e]).length===0&&delete ht.tweens[e],Object.keys(ht.attrs[e]).length===0&&delete ht.attrs[e])}}ht.attrs={};ht.tweens={};ve.prototype.to=function(r){const e=r.onFinish;r.node=this,r.onFinish=function(){this.destroy(),e&&e()},new ht(r).play()};const oa={BackEaseIn(r,e,t,n){return t*(r/=n)*r*((1.70158+1)*r-1.70158)+e},BackEaseOut(r,e,t,n){return t*((r=r/n-1)*r*((1.70158+1)*r+1.70158)+1)+e},BackEaseInOut(r,e,t,n){let i=1.70158;return(r/=n/2)<1?t/2*(r*r*(((i*=1.525)+1)*r-i))+e:t/2*((r-=2)*r*(((i*=1.525)+1)*r+i)+2)+e},ElasticEaseIn(r,e,t,n,i,l){let c=0;return r===0?e:(r/=n)===1?e+t:(l||(l=n*.3),!i||i<Math.abs(t)?(i=t,c=l/4):c=l/(2*Math.PI)*Math.asin(t/i),-(i*Math.pow(2,10*(r-=1))*Math.sin((r*n-c)*(2*Math.PI)/l))+e)},ElasticEaseOut(r,e,t,n,i,l){let c=0;return r===0?e:(r/=n)===1?e+t:(l||(l=n*.3),!i||i<Math.abs(t)?(i=t,c=l/4):c=l/(2*Math.PI)*Math.asin(t/i),i*Math.pow(2,-10*r)*Math.sin((r*n-c)*(2*Math.PI)/l)+t+e)},ElasticEaseInOut(r,e,t,n,i,l){let c=0;return r===0?e:(r/=n/2)===2?e+t:(l||(l=n*(.3*1.5)),!i||i<Math.abs(t)?(i=t,c=l/4):c=l/(2*Math.PI)*Math.asin(t/i),r<1?-.5*(i*Math.pow(2,10*(r-=1))*Math.sin((r*n-c)*(2*Math.PI)/l))+e:i*Math.pow(2,-10*(r-=1))*Math.sin((r*n-c)*(2*Math.PI)/l)*.5+t+e)},BounceEaseOut(r,e,t,n){return(r/=n)<1/2.75?t*(7.5625*r*r)+e:r<2/2.75?t*(7.5625*(r-=1.5/2.75)*r+.75)+e:r<2.5/2.75?t*(7.5625*(r-=2.25/2.75)*r+.9375)+e:t*(7.5625*(r-=2.625/2.75)*r+.984375)+e},BounceEaseIn(r,e,t,n){return t-oa.BounceEaseOut(n-r,0,t,n)+e},BounceEaseInOut(r,e,t,n){return r<n/2?oa.BounceEaseIn(r*2,0,t,n)*.5+e:oa.BounceEaseOut(r*2-n,0,t,n)*.5+t*.5+e},EaseIn(r,e,t,n){return t*(r/=n)*r+e},EaseOut(r,e,t,n){return-t*(r/=n)*(r-2)+e},EaseInOut(r,e,t,n){return(r/=n/2)<1?t/2*r*r+e:-t/2*(--r*(r-2)-1)+e},StrongEaseIn(r,e,t,n){return t*(r/=n)*r*r*r*r+e},StrongEaseOut(r,e,t,n){return t*((r=r/n-1)*r*r*r*r+1)+e},StrongEaseInOut(r,e,t,n){return(r/=n/2)<1?t/2*r*r*r*r*r+e:t/2*((r-=2)*r*r*r*r+2)+e},Linear(r,e,t,n){return t*r/n+e}},Ps=$._assign(we,{Util:$,Transform:pr,Node:ve,Container:gr,Stage:_l,stages:ia,Layer:Ts,FastLayer:mu,Group:xi,DD:rt,Shape:he,shapes:aa,Animation:Ar,Tween:ht,Easings:oa,Context:wl,Canvas:uu});class En extends he{_sceneFunc(e){const t=we.getAngle(this.angle()),n=this.clockwise();e.beginPath(),e.arc(0,0,this.outerRadius(),0,t,n),e.arc(0,0,this.innerRadius(),t,0,!n),e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(e){this.outerRadius(e/2)}setHeight(e){this.outerRadius(e/2)}getSelfRect(){const e=this.innerRadius(),t=this.outerRadius(),n=this.clockwise(),i=we.getAngle(n?360-this.angle():this.angle()),l=Math.cos(Math.min(i,Math.PI)),c=1,d=Math.sin(Math.min(Math.max(Math.PI,i),3*Math.PI/2)),u=Math.sin(Math.min(i,Math.PI/2)),f=l*(l>0?e:t),p=c*t,m=d*(d>0?e:t),y=u*(u>0?t:e);return{x:f,y:n?-1*y:m,width:p-f,height:y-m}}}En.prototype._centroid=!0;En.prototype.className="Arc";En.prototype._attrsAffectingSize=["innerRadius","outerRadius","angle","clockwise"];kt(En);F.addGetterSetter(En,"innerRadius",0,ge());F.addGetterSetter(En,"outerRadius",0,ge());F.addGetterSetter(En,"angle",0,ge());F.addGetterSetter(En,"clockwise",!1,$r());function Sd(r,e,t,n,i,l,c){const d=Math.sqrt(Math.pow(t-r,2)+Math.pow(n-e,2)),u=Math.sqrt(Math.pow(i-t,2)+Math.pow(l-n,2)),f=c*d/(d+u),p=c*u/(d+u),m=t-f*(i-r),y=n-f*(l-e),w=t+p*(i-r),_=n+p*(l-e);return[m,y,w,_]}function cp(r,e){const t=r.length,n=[];for(let i=2;i<t-2;i+=2){const l=Sd(r[i-2],r[i-1],r[i],r[i+1],r[i+2],r[i+3],e);isNaN(l[0])||(n.push(l[0]),n.push(l[1]),n.push(r[i]),n.push(r[i+1]),n.push(l[2]),n.push(l[3]))}return n}function u6(r){const e=[[r[0],r[2],r[4],r[6]],[r[1],r[3],r[5],r[7]]],t=[];for(const n of e){const i=-3*n[0]+9*n[1]-9*n[2]+3*n[3];if(i!==0){const l=6*n[0]-12*n[1]+6*n[2],c=-3*n[0]+3*n[1],d=l*l-4*i*c;if(d>=0){const u=Math.sqrt(d);t.push((-l+u)/(2*i)),t.push((-l-u)/(2*i))}}}return t.filter(n=>n>0&&n<1).flatMap(n=>e.map(i=>{const l=1-n;return l*l*l*i[0]+3*l*l*n*i[1]+3*l*n*n*i[2]+n*n*n*i[3]}))}let Pn=class extends he{constructor(e){super(e),this.on("pointsChange.konva tensionChange.konva closedChange.konva bezierChange.konva",function(){this._clearCache("tensionPoints")})}_sceneFunc(e){const t=this.points(),n=t.length,i=this.tension(),l=this.closed(),c=this.bezier();if(!n)return;let d=0;if(e.beginPath(),e.moveTo(t[0],t[1]),i!==0&&n>4){const u=this.getTensionPoints(),f=u.length;for(d=l?0:4,l||e.quadraticCurveTo(u[0],u[1],u[2],u[3]);d<f-2;)e.bezierCurveTo(u[d++],u[d++],u[d++],u[d++],u[d++],u[d++]);l||e.quadraticCurveTo(u[f-2],u[f-1],t[n-2],t[n-1])}else if(c)for(d=2;d<n;)e.bezierCurveTo(t[d++],t[d++],t[d++],t[d++],t[d++],t[d++]);else for(d=2;d<n;d+=2)e.lineTo(t[d],t[d+1]);l?(e.closePath(),e.fillStrokeShape(this)):e.strokeShape(this)}getTensionPoints(){return this._getCache("tensionPoints",this._getTensionPoints)}_getTensionPoints(){return this.closed()?this._getTensionPointsClosed():cp(this.points(),this.tension())}_getTensionPointsClosed(){const e=this.points(),t=e.length,n=this.tension(),i=Sd(e[t-2],e[t-1],e[0],e[1],e[2],e[3],n),l=Sd(e[t-4],e[t-3],e[t-2],e[t-1],e[0],e[1],n),c=cp(e,n);return[i[2],i[3]].concat(c).concat([l[0],l[1],e[t-2],e[t-1],l[2],l[3],i[0],i[1],e[0],e[1]])}getWidth(){return this.getSelfRect().width}getHeight(){return this.getSelfRect().height}getSelfRect(){let e=this.points();if(e.length<4)return{x:e[0]||0,y:e[1]||0,width:0,height:0};this.tension()!==0?e=[e[0],e[1],...this._getTensionPoints(),e[e.length-2],e[e.length-1]]:this.bezier()?e=[e[0],e[1],...u6(this.points()),e[e.length-2],e[e.length-1]]:e=this.points();let t=e[0],n=e[0],i=e[1],l=e[1],c,d;for(let u=0;u<e.length/2;u++)c=e[u*2],d=e[u*2+1],t=Math.min(t,c),n=Math.max(n,c),i=Math.min(i,d),l=Math.max(l,d);return{x:t,y:i,width:n-t,height:l-i}}};Pn.prototype.className="Line";Pn.prototype._attrsAffectingSize=["points","bezier","tension"];kt(Pn);F.addGetterSetter(Pn,"closed",!1);F.addGetterSetter(Pn,"bezier",!1);F.addGetterSetter(Pn,"tension",0,ge());F.addGetterSetter(Pn,"points",[],jb());const h6=[[],[],[-.5773502691896257,.5773502691896257],[0,-.7745966692414834,.7745966692414834],[-.33998104358485626,.33998104358485626,-.8611363115940526,.8611363115940526],[0,-.5384693101056831,.5384693101056831,-.906179845938664,.906179845938664],[.6612093864662645,-.6612093864662645,-.2386191860831969,.2386191860831969,-.932469514203152,.932469514203152],[0,.4058451513773972,-.4058451513773972,-.7415311855993945,.7415311855993945,-.9491079123427585,.9491079123427585],[-.1834346424956498,.1834346424956498,-.525532409916329,.525532409916329,-.7966664774136267,.7966664774136267,-.9602898564975363,.9602898564975363],[0,-.8360311073266358,.8360311073266358,-.9681602395076261,.9681602395076261,-.3242534234038089,.3242534234038089,-.6133714327005904,.6133714327005904],[-.14887433898163122,.14887433898163122,-.4333953941292472,.4333953941292472,-.6794095682990244,.6794095682990244,-.8650633666889845,.8650633666889845,-.9739065285171717,.9739065285171717],[0,-.26954315595234496,.26954315595234496,-.5190961292068118,.5190961292068118,-.7301520055740494,.7301520055740494,-.8870625997680953,.8870625997680953,-.978228658146057,.978228658146057],[-.1252334085114689,.1252334085114689,-.3678314989981802,.3678314989981802,-.5873179542866175,.5873179542866175,-.7699026741943047,.7699026741943047,-.9041172563704749,.9041172563704749,-.9815606342467192,.9815606342467192],[0,-.2304583159551348,.2304583159551348,-.44849275103644687,.44849275103644687,-.6423493394403402,.6423493394403402,-.8015780907333099,.8015780907333099,-.9175983992229779,.9175983992229779,-.9841830547185881,.9841830547185881],[-.10805494870734367,.10805494870734367,-.31911236892788974,.31911236892788974,-.5152486363581541,.5152486363581541,-.6872929048116855,.6872929048116855,-.827201315069765,.827201315069765,-.9284348836635735,.9284348836635735,-.9862838086968123,.9862838086968123],[0,-.20119409399743451,.20119409399743451,-.3941513470775634,.3941513470775634,-.5709721726085388,.5709721726085388,-.7244177313601701,.7244177313601701,-.8482065834104272,.8482065834104272,-.937273392400706,.937273392400706,-.9879925180204854,.9879925180204854],[-.09501250983763744,.09501250983763744,-.2816035507792589,.2816035507792589,-.45801677765722737,.45801677765722737,-.6178762444026438,.6178762444026438,-.755404408355003,.755404408355003,-.8656312023878318,.8656312023878318,-.9445750230732326,.9445750230732326,-.9894009349916499,.9894009349916499],[0,-.17848418149584785,.17848418149584785,-.3512317634538763,.3512317634538763,-.5126905370864769,.5126905370864769,-.6576711592166907,.6576711592166907,-.7815140038968014,.7815140038968014,-.8802391537269859,.8802391537269859,-.9506755217687678,.9506755217687678,-.9905754753144174,.9905754753144174],[-.0847750130417353,.0847750130417353,-.2518862256915055,.2518862256915055,-.41175116146284263,.41175116146284263,-.5597708310739475,.5597708310739475,-.6916870430603532,.6916870430603532,-.8037049589725231,.8037049589725231,-.8926024664975557,.8926024664975557,-.9558239495713977,.9558239495713977,-.9915651684209309,.9915651684209309],[0,-.16035864564022537,.16035864564022537,-.31656409996362983,.31656409996362983,-.46457074137596094,.46457074137596094,-.600545304661681,.600545304661681,-.7209661773352294,.7209661773352294,-.8227146565371428,.8227146565371428,-.9031559036148179,.9031559036148179,-.96020815213483,.96020815213483,-.9924068438435844,.9924068438435844],[-.07652652113349734,.07652652113349734,-.22778585114164507,.22778585114164507,-.37370608871541955,.37370608871541955,-.5108670019508271,.5108670019508271,-.636053680726515,.636053680726515,-.7463319064601508,.7463319064601508,-.8391169718222188,.8391169718222188,-.912234428251326,.912234428251326,-.9639719272779138,.9639719272779138,-.9931285991850949,.9931285991850949],[0,-.1455618541608951,.1455618541608951,-.2880213168024011,.2880213168024011,-.4243421202074388,.4243421202074388,-.5516188358872198,.5516188358872198,-.6671388041974123,.6671388041974123,-.7684399634756779,.7684399634756779,-.8533633645833173,.8533633645833173,-.9200993341504008,.9200993341504008,-.9672268385663063,.9672268385663063,-.9937521706203895,.9937521706203895],[-.06973927331972223,.06973927331972223,-.20786042668822127,.20786042668822127,-.34193582089208424,.34193582089208424,-.469355837986757,.469355837986757,-.5876404035069116,.5876404035069116,-.6944872631866827,.6944872631866827,-.7878168059792081,.7878168059792081,-.8658125777203002,.8658125777203002,-.926956772187174,.926956772187174,-.9700604978354287,.9700604978354287,-.9942945854823992,.9942945854823992],[0,-.1332568242984661,.1332568242984661,-.26413568097034495,.26413568097034495,-.3903010380302908,.3903010380302908,-.5095014778460075,.5095014778460075,-.6196098757636461,.6196098757636461,-.7186613631319502,.7186613631319502,-.8048884016188399,.8048884016188399,-.8767523582704416,.8767523582704416,-.9329710868260161,.9329710868260161,-.9725424712181152,.9725424712181152,-.9947693349975522,.9947693349975522],[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213]],f6=[[],[],[1,1],[.8888888888888888,.5555555555555556,.5555555555555556],[.6521451548625461,.6521451548625461,.34785484513745385,.34785484513745385],[.5688888888888889,.47862867049936647,.47862867049936647,.23692688505618908,.23692688505618908],[.3607615730481386,.3607615730481386,.46791393457269104,.46791393457269104,.17132449237917036,.17132449237917036],[.4179591836734694,.3818300505051189,.3818300505051189,.27970539148927664,.27970539148927664,.1294849661688697,.1294849661688697],[.362683783378362,.362683783378362,.31370664587788727,.31370664587788727,.22238103445337448,.22238103445337448,.10122853629037626,.10122853629037626],[.3302393550012598,.1806481606948574,.1806481606948574,.08127438836157441,.08127438836157441,.31234707704000286,.31234707704000286,.26061069640293544,.26061069640293544],[.29552422471475287,.29552422471475287,.26926671930999635,.26926671930999635,.21908636251598204,.21908636251598204,.1494513491505806,.1494513491505806,.06667134430868814,.06667134430868814],[.2729250867779006,.26280454451024665,.26280454451024665,.23319376459199048,.23319376459199048,.18629021092773426,.18629021092773426,.1255803694649046,.1255803694649046,.05566856711617366,.05566856711617366],[.24914704581340277,.24914704581340277,.2334925365383548,.2334925365383548,.20316742672306592,.20316742672306592,.16007832854334622,.16007832854334622,.10693932599531843,.10693932599531843,.04717533638651183,.04717533638651183],[.2325515532308739,.22628318026289723,.22628318026289723,.2078160475368885,.2078160475368885,.17814598076194574,.17814598076194574,.13887351021978725,.13887351021978725,.09212149983772845,.09212149983772845,.04048400476531588,.04048400476531588],[.2152638534631578,.2152638534631578,.2051984637212956,.2051984637212956,.18553839747793782,.18553839747793782,.15720316715819355,.15720316715819355,.12151857068790319,.12151857068790319,.08015808715976021,.08015808715976021,.03511946033175186,.03511946033175186],[.2025782419255613,.19843148532711158,.19843148532711158,.1861610000155622,.1861610000155622,.16626920581699392,.16626920581699392,.13957067792615432,.13957067792615432,.10715922046717194,.10715922046717194,.07036604748810812,.07036604748810812,.03075324199611727,.03075324199611727],[.1894506104550685,.1894506104550685,.18260341504492358,.18260341504492358,.16915651939500254,.16915651939500254,.14959598881657674,.14959598881657674,.12462897125553388,.12462897125553388,.09515851168249279,.09515851168249279,.062253523938647894,.062253523938647894,.027152459411754096,.027152459411754096],[.17944647035620653,.17656270536699264,.17656270536699264,.16800410215645004,.16800410215645004,.15404576107681028,.15404576107681028,.13513636846852548,.13513636846852548,.11188384719340397,.11188384719340397,.08503614831717918,.08503614831717918,.0554595293739872,.0554595293739872,.02414830286854793,.02414830286854793],[.1691423829631436,.1691423829631436,.16427648374583273,.16427648374583273,.15468467512626524,.15468467512626524,.14064291467065065,.14064291467065065,.12255520671147846,.12255520671147846,.10094204410628717,.10094204410628717,.07642573025488905,.07642573025488905,.0497145488949698,.0497145488949698,.02161601352648331,.02161601352648331],[.1610544498487837,.15896884339395434,.15896884339395434,.15276604206585967,.15276604206585967,.1426067021736066,.1426067021736066,.12875396253933621,.12875396253933621,.11156664554733399,.11156664554733399,.09149002162245,.09149002162245,.06904454273764123,.06904454273764123,.0448142267656996,.0448142267656996,.019461788229726478,.019461788229726478],[.15275338713072584,.15275338713072584,.14917298647260374,.14917298647260374,.14209610931838204,.14209610931838204,.13168863844917664,.13168863844917664,.11819453196151841,.11819453196151841,.10193011981724044,.10193011981724044,.08327674157670475,.08327674157670475,.06267204833410907,.06267204833410907,.04060142980038694,.04060142980038694,.017614007139152118,.017614007139152118],[.14608113364969041,.14452440398997005,.14452440398997005,.13988739479107315,.13988739479107315,.13226893863333747,.13226893863333747,.12183141605372853,.12183141605372853,.10879729916714838,.10879729916714838,.09344442345603386,.09344442345603386,.0761001136283793,.0761001136283793,.057134425426857205,.057134425426857205,.036953789770852494,.036953789770852494,.016017228257774335,.016017228257774335],[.13925187285563198,.13925187285563198,.13654149834601517,.13654149834601517,.13117350478706238,.13117350478706238,.12325237681051242,.12325237681051242,.11293229608053922,.11293229608053922,.10041414444288096,.10041414444288096,.08594160621706773,.08594160621706773,.06979646842452049,.06979646842452049,.052293335152683286,.052293335152683286,.03377490158481415,.03377490158481415,.0146279952982722,.0146279952982722],[.13365457218610619,.1324620394046966,.1324620394046966,.12890572218808216,.12890572218808216,.12304908430672953,.12304908430672953,.11499664022241136,.11499664022241136,.10489209146454141,.10489209146454141,.09291576606003515,.09291576606003515,.07928141177671895,.07928141177671895,.06423242140852585,.06423242140852585,.04803767173108467,.04803767173108467,.030988005856979445,.030988005856979445,.013411859487141771,.013411859487141771],[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872]],p6=[[1],[1,1],[1,2,1],[1,3,3,1]],dp=(r,e,t)=>{let n,i;const c=t/2;n=0;for(let d=0;d<20;d++)i=c*h6[20][d]+c,n+=f6[20][d]*m6(r,e,i);return c*n},up=(r,e,t)=>{t===void 0&&(t=1);const n=r[0]-2*r[1]+r[2],i=e[0]-2*e[1]+e[2],l=2*r[1]-2*r[0],c=2*e[1]-2*e[0],d=4*(n*n+i*i),u=4*(n*l+i*c),f=l*l+c*c;if(d===0)return t*Math.sqrt(Math.pow(r[2]-r[0],2)+Math.pow(e[2]-e[0],2));const p=u/(2*d),m=f/d,y=t+p,w=m-p*p,_=y*y+w>0?Math.sqrt(y*y+w):0,x=p*p+w>0?Math.sqrt(p*p+w):0,v=p+Math.sqrt(p*p+w)!==0?w*Math.log(Math.abs((y+_)/(p+x))):0;return Math.sqrt(d)/2*(y*_-p*x+v)};function m6(r,e,t){const n=Cd(1,t,r),i=Cd(1,t,e),l=n*n+i*i;return Math.sqrt(l)}const Cd=(r,e,t)=>{const n=t.length-1;let i,l;if(n===0)return 0;if(r===0){l=0;for(let c=0;c<=n;c++)l+=p6[n][c]*Math.pow(1-e,n-c)*Math.pow(e,c)*t[c];return l}else{i=new Array(n);for(let c=0;c<n;c++)i[c]=n*(t[c+1]-t[c]);return Cd(r-1,e,i)}},hp=(r,e,t)=>{let n=1,i=r/e,l=(r-t(i))/e,c=0;for(;n>.001;){const d=t(i+l),u=Math.abs(r-d)/e;if(u<n)n=u,i+=l;else{const f=t(i-l),p=Math.abs(r-f)/e;p<n?(n=p,i-=l):l/=2}if(c++,c>500)break}return i};class ft extends he{constructor(e){super(e),this.dataArray=[],this.pathLength=0,this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute()})}_readDataAttribute(){this.dataArray=ft.parsePathData(this.data()),this.pathLength=ft.getPathLength(this.dataArray)}_sceneFunc(e){const t=this.dataArray;e.beginPath();let n=!1;for(let i=0;i<t.length;i++){const l=t[i].command,c=t[i].points;switch(l){case"L":e.lineTo(c[0],c[1]);break;case"M":e.moveTo(c[0],c[1]);break;case"C":e.bezierCurveTo(c[0],c[1],c[2],c[3],c[4],c[5]);break;case"Q":e.quadraticCurveTo(c[0],c[1],c[2],c[3]);break;case"A":const d=c[0],u=c[1],f=c[2],p=c[3],m=c[4],y=c[5],w=c[6],_=c[7],x=f>p?f:p,v=f>p?1:f/p,S=f>p?p/f:1;e.translate(d,u),e.rotate(w),e.scale(v,S),e.arc(0,0,x,m,m+y,1-_),e.scale(1/v,1/S),e.rotate(-w),e.translate(-d,-u);break;case"z":n=!0,e.closePath();break}}!n&&!this.hasFill()?e.strokeShape(this):e.fillStrokeShape(this)}getSelfRect(){let e=[];this.dataArray.forEach(function(u){if(u.command==="A"){const f=u.points[4],p=u.points[5],m=u.points[4]+p;let y=Math.PI/180;if(Math.abs(f-m)<y&&(y=Math.abs(f-m)),p<0)for(let w=f-y;w>m;w-=y){const _=ft.getPointOnEllipticalArc(u.points[0],u.points[1],u.points[2],u.points[3],w,0);e.push(_.x,_.y)}else for(let w=f+y;w<m;w+=y){const _=ft.getPointOnEllipticalArc(u.points[0],u.points[1],u.points[2],u.points[3],w,0);e.push(_.x,_.y)}}else if(u.command==="C")for(let f=0;f<=1;f+=.01){const p=ft.getPointOnCubicBezier(f,u.start.x,u.start.y,u.points[0],u.points[1],u.points[2],u.points[3],u.points[4],u.points[5]);e.push(p.x,p.y)}else e=e.concat(u.points)});let t=e[0],n=e[0],i=e[1],l=e[1],c,d;for(let u=0;u<e.length/2;u++)c=e[u*2],d=e[u*2+1],isNaN(c)||(t=Math.min(t,c),n=Math.max(n,c)),isNaN(d)||(i=Math.min(i,d),l=Math.max(l,d));return{x:t,y:i,width:n-t,height:l-i}}getLength(){return this.pathLength}getPointAtLength(e){return ft.getPointAtLengthOfDataArray(e,this.dataArray)}static getLineLength(e,t,n,i){return Math.sqrt((n-e)*(n-e)+(i-t)*(i-t))}static getPathLength(e){let t=0;for(let n=0;n<e.length;++n)t+=e[n].pathLength;return t}static getPointAtLengthOfDataArray(e,t){let n,i=0,l=t.length;if(!l)return null;for(;i<l&&e>t[i].pathLength;)e-=t[i].pathLength,++i;if(i===l)return n=t[i-1].points.slice(-2),{x:n[0],y:n[1]};if(e<.01)return t[i].command==="M"?(n=t[i].points.slice(0,2),{x:n[0],y:n[1]}):{x:t[i].start.x,y:t[i].start.y};const c=t[i],d=c.points;switch(c.command){case"L":return ft.getPointOnLine(e,c.start.x,c.start.y,d[0],d[1]);case"C":return ft.getPointOnCubicBezier(hp(e,ft.getPathLength(t),x=>dp([c.start.x,d[0],d[2],d[4]],[c.start.y,d[1],d[3],d[5]],x)),c.start.x,c.start.y,d[0],d[1],d[2],d[3],d[4],d[5]);case"Q":return ft.getPointOnQuadraticBezier(hp(e,ft.getPathLength(t),x=>up([c.start.x,d[0],d[2]],[c.start.y,d[1],d[3]],x)),c.start.x,c.start.y,d[0],d[1],d[2],d[3]);case"A":const u=d[0],f=d[1],p=d[2],m=d[3],y=d[5],w=d[6];let _=d[4];return _+=y*e/c.pathLength,ft.getPointOnEllipticalArc(u,f,p,m,_,w)}return null}static getPointOnLine(e,t,n,i,l,c,d){c=c??t,d=d??n;const u=this.getLineLength(t,n,i,l);if(u<1e-10)return{x:t,y:n};if(i===t)return{x:c,y:d+(l>n?e:-e)};const f=(l-n)/(i-t),p=Math.sqrt(e*e/(1+f*f))*(i<t?-1:1),m=f*p;if(Math.abs(d-n-f*(c-t))<1e-10)return{x:c+p,y:d+m};const y=((c-t)*(i-t)+(d-n)*(l-n))/(u*u),w=t+y*(i-t),_=n+y*(l-n),x=this.getLineLength(c,d,w,_),v=Math.sqrt(e*e-x*x),S=Math.sqrt(v*v/(1+f*f))*(i<t?-1:1),C=f*S;return{x:w+S,y:_+C}}static getPointOnCubicBezier(e,t,n,i,l,c,d,u,f){function p(v){return v*v*v}function m(v){return 3*v*v*(1-v)}function y(v){return 3*v*(1-v)*(1-v)}function w(v){return(1-v)*(1-v)*(1-v)}const _=u*p(e)+c*m(e)+i*y(e)+t*w(e),x=f*p(e)+d*m(e)+l*y(e)+n*w(e);return{x:_,y:x}}static getPointOnQuadraticBezier(e,t,n,i,l,c,d){function u(w){return w*w}function f(w){return 2*w*(1-w)}function p(w){return(1-w)*(1-w)}const m=c*u(e)+i*f(e)+t*p(e),y=d*u(e)+l*f(e)+n*p(e);return{x:m,y}}static getPointOnEllipticalArc(e,t,n,i,l,c){const d=Math.cos(c),u=Math.sin(c),f={x:n*Math.cos(l),y:i*Math.sin(l)};return{x:e+(f.x*d-f.y*u),y:t+(f.x*u+f.y*d)}}static parsePathData(e){if(!e)return[];let t=e;const n=["m","M","l","L","v","V","h","H","z","Z","c","C","q","Q","t","T","s","S","a","A"];t=t.replace(new RegExp(" ","g"),",");for(let m=0;m<n.length;m++)t=t.replace(new RegExp(n[m],"g"),"|"+n[m]);const i=t.split("|"),l=[],c=[];let d=0,u=0;const f=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:e[-+]?\d+)?)/gi;let p;for(let m=1;m<i.length;m++){let y=i[m],w=y.charAt(0);for(y=y.slice(1),c.length=0;p=f.exec(y);)c.push(p[0]);let _=[],x=w==="A"||w==="a"?0:-1;for(let v=0,S=c.length;v<S;v++){const C=c[v];if(C==="00"){_.push(0,0),x>=0&&(x+=2,x>=7&&(x-=7));continue}if(x>=0){if(x===3){if(/^[01]{2}\d+(?:\.\d+)?$/.test(C)){_.push(parseInt(C[0],10)),_.push(parseInt(C[1],10)),_.push(parseFloat(C.slice(2))),x+=3,x>=7&&(x-=7);continue}if(C==="11"||C==="10"||C==="01"){_.push(parseInt(C[0],10)),_.push(parseInt(C[1],10)),x+=2,x>=7&&(x-=7);continue}if(C==="0"||C==="1"){_.push(parseInt(C,10)),x+=1,x>=7&&(x-=7);continue}}else if(x===4){if(/^[01]\d+(?:\.\d+)?$/.test(C)){_.push(parseInt(C[0],10)),_.push(parseFloat(C.slice(1))),x+=2,x>=7&&(x-=7);continue}if(C==="0"||C==="1"){_.push(parseInt(C,10)),x+=1,x>=7&&(x-=7);continue}}const k=parseFloat(C);isNaN(k)?_.push(0):_.push(k),x+=1,x>=7&&(x-=7)}else{const k=parseFloat(C);isNaN(k)?_.push(0):_.push(k)}}for(;_.length>0&&!isNaN(_[0]);){let v="",S=[];const C=d,k=u;let E,P,D,I,B,z,X,se,R,H;switch(w){case"l":d+=_.shift(),u+=_.shift(),v="L",S.push(d,u);break;case"L":d=_.shift(),u=_.shift(),S.push(d,u);break;case"m":const j=_.shift(),G=_.shift();if(d+=j,u+=G,v="M",l.length>2&&l[l.length-1].command==="z"){for(let Q=l.length-2;Q>=0;Q--)if(l[Q].command==="M"){d=l[Q].points[0]+j,u=l[Q].points[1]+G;break}}S.push(d,u),w="l";break;case"M":d=_.shift(),u=_.shift(),v="M",S.push(d,u),w="L";break;case"h":d+=_.shift(),v="L",S.push(d,u);break;case"H":d=_.shift(),v="L",S.push(d,u);break;case"v":u+=_.shift(),v="L",S.push(d,u);break;case"V":u=_.shift(),v="L",S.push(d,u);break;case"C":S.push(_.shift(),_.shift(),_.shift(),_.shift()),d=_.shift(),u=_.shift(),S.push(d,u);break;case"c":S.push(d+_.shift(),u+_.shift(),d+_.shift(),u+_.shift()),d+=_.shift(),u+=_.shift(),v="C",S.push(d,u);break;case"S":P=d,D=u,E=l[l.length-1],E.command==="C"&&(P=d+(d-E.points[2]),D=u+(u-E.points[3])),S.push(P,D,_.shift(),_.shift()),d=_.shift(),u=_.shift(),v="C",S.push(d,u);break;case"s":P=d,D=u,E=l[l.length-1],E.command==="C"&&(P=d+(d-E.points[2]),D=u+(u-E.points[3])),S.push(P,D,d+_.shift(),u+_.shift()),d+=_.shift(),u+=_.shift(),v="C",S.push(d,u);break;case"Q":S.push(_.shift(),_.shift()),d=_.shift(),u=_.shift(),S.push(d,u);break;case"q":S.push(d+_.shift(),u+_.shift()),d+=_.shift(),u+=_.shift(),v="Q",S.push(d,u);break;case"T":P=d,D=u,E=l[l.length-1],E.command==="Q"&&(P=d+(d-E.points[0]),D=u+(u-E.points[1])),d=_.shift(),u=_.shift(),v="Q",S.push(P,D,d,u);break;case"t":P=d,D=u,E=l[l.length-1],E.command==="Q"&&(P=d+(d-E.points[0]),D=u+(u-E.points[1])),d+=_.shift(),u+=_.shift(),v="Q",S.push(P,D,d,u);break;case"A":I=_.shift(),B=_.shift(),z=_.shift(),X=_.shift(),se=_.shift(),R=d,H=u,d=_.shift(),u=_.shift(),v="A",S=this.convertEndpointToCenterParameterization(R,H,d,u,X,se,I,B,z);break;case"a":I=_.shift(),B=_.shift(),z=_.shift(),X=_.shift(),se=_.shift(),R=d,H=u,d+=_.shift(),u+=_.shift(),v="A",S=this.convertEndpointToCenterParameterization(R,H,d,u,X,se,I,B,z);break}l.push({command:v||w,points:S,start:{x:C,y:k},pathLength:this.calcLength(C,k,v||w,S)})}(w==="z"||w==="Z")&&l.push({command:"z",points:[],start:void 0,pathLength:0})}return l}static calcLength(e,t,n,i){let l,c,d,u;const f=ft;switch(n){case"L":return f.getLineLength(e,t,i[0],i[1]);case"C":return dp([e,i[0],i[2],i[4]],[t,i[1],i[3],i[5]],1);case"Q":return up([e,i[0],i[2]],[t,i[1],i[3]],1);case"A":l=0;const p=i[4],m=i[5],y=i[4]+m;let w=Math.PI/180;if(Math.abs(p-y)<w&&(w=Math.abs(p-y)),c=f.getPointOnEllipticalArc(i[0],i[1],i[2],i[3],p,0),m<0)for(u=p-w;u>y;u-=w)d=f.getPointOnEllipticalArc(i[0],i[1],i[2],i[3],u,0),l+=f.getLineLength(c.x,c.y,d.x,d.y),c=d;else for(u=p+w;u<y;u+=w)d=f.getPointOnEllipticalArc(i[0],i[1],i[2],i[3],u,0),l+=f.getLineLength(c.x,c.y,d.x,d.y),c=d;return d=f.getPointOnEllipticalArc(i[0],i[1],i[2],i[3],y,0),l+=f.getLineLength(c.x,c.y,d.x,d.y),l}return 0}static convertEndpointToCenterParameterization(e,t,n,i,l,c,d,u,f){const p=f*(Math.PI/180),m=Math.cos(p)*(e-n)/2+Math.sin(p)*(t-i)/2,y=-1*Math.sin(p)*(e-n)/2+Math.cos(p)*(t-i)/2,w=m*m/(d*d)+y*y/(u*u);w>1&&(d*=Math.sqrt(w),u*=Math.sqrt(w));let _=Math.sqrt((d*d*(u*u)-d*d*(y*y)-u*u*(m*m))/(d*d*(y*y)+u*u*(m*m)));l===c&&(_*=-1),isNaN(_)&&(_=0);const x=_*d*y/u,v=_*-u*m/d,S=(e+n)/2+Math.cos(p)*x-Math.sin(p)*v,C=(t+i)/2+Math.sin(p)*x+Math.cos(p)*v,k=function(X){return Math.sqrt(X[0]*X[0]+X[1]*X[1])},E=function(X,se){return(X[0]*se[0]+X[1]*se[1])/(k(X)*k(se))},P=function(X,se){return(X[0]*se[1]<X[1]*se[0]?-1:1)*Math.acos(E(X,se))},D=P([1,0],[(m-x)/d,(y-v)/u]),I=[(m-x)/d,(y-v)/u],B=[(-1*m-x)/d,(-1*y-v)/u];let z=P(I,B);return E(I,B)<=-1&&(z=Math.PI),E(I,B)>=1&&(z=0),c===0&&z>0&&(z=z-2*Math.PI),c===1&&z<0&&(z=z+2*Math.PI),[S,C,d,u,D,z,p,c]}}ft.prototype.className="Path";ft.prototype._attrsAffectingSize=["data"];kt(ft);F.addGetterSetter(ft,"data");class Rs extends Pn{_sceneFunc(e){super._sceneFunc(e);const t=Math.PI*2,n=this.points();let i=n;const l=this.tension()!==0&&n.length>4;l&&(i=this.getTensionPoints());const c=this.pointerLength(),d=n.length;let u,f;if(l){const y=[i[i.length-4],i[i.length-3],i[i.length-2],i[i.length-1],n[d-2],n[d-1]],w=ft.calcLength(i[i.length-4],i[i.length-3],"C",y),_=ft.getPointOnQuadraticBezier(Math.min(1,1-c/w),y[0],y[1],y[2],y[3],y[4],y[5]);u=n[d-2]-_.x,f=n[d-1]-_.y}else u=n[d-2]-n[d-4],f=n[d-1]-n[d-3];const p=(Math.atan2(f,u)+t)%t,m=this.pointerWidth();this.pointerAtEnding()&&(e.save(),e.beginPath(),e.translate(n[d-2],n[d-1]),e.rotate(p),e.moveTo(0,0),e.lineTo(-c,m/2),e.lineTo(-c,-m/2),e.closePath(),e.restore(),this.__fillStroke(e)),this.pointerAtBeginning()&&(e.save(),e.beginPath(),e.translate(n[0],n[1]),l?(u=(i[0]+i[2])/2-n[0],f=(i[1]+i[3])/2-n[1]):(u=n[2]-n[0],f=n[3]-n[1]),e.rotate((Math.atan2(-f,-u)+t)%t),e.moveTo(0,0),e.lineTo(-c,m/2),e.lineTo(-c,-m/2),e.closePath(),e.restore(),this.__fillStroke(e))}__fillStroke(e){const t=this.dashEnabled();t&&(this.attrs.dashEnabled=!1,e.setLineDash([])),e.fillStrokeShape(this),t&&(this.attrs.dashEnabled=!0)}getSelfRect(){const e=super.getSelfRect(),t=this.pointerWidth()/2;return{x:e.x,y:e.y-t,width:e.width,height:e.height+t*2}}}Rs.prototype.className="Arrow";kt(Rs);F.addGetterSetter(Rs,"pointerLength",10,ge());F.addGetterSetter(Rs,"pointerWidth",10,ge());F.addGetterSetter(Rs,"pointerAtBeginning",!1);F.addGetterSetter(Rs,"pointerAtEnding",!0);class bi extends he{_sceneFunc(e){e.beginPath(),e.arc(0,0,this.attrs.radius||0,0,Math.PI*2,!1),e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(e){this.radius()!==e/2&&this.radius(e/2)}setHeight(e){this.radius()!==e/2&&this.radius(e/2)}}bi.prototype._centroid=!0;bi.prototype.className="Circle";bi.prototype._attrsAffectingSize=["radius"];kt(bi);F.addGetterSetter(bi,"radius",0,ge());class ss extends he{_sceneFunc(e){const t=this.radiusX(),n=this.radiusY();e.beginPath(),e.save(),t!==n&&e.scale(1,n/t),e.arc(0,0,t,0,Math.PI*2,!1),e.restore(),e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.radiusX()*2}getHeight(){return this.radiusY()*2}setWidth(e){this.radiusX(e/2)}setHeight(e){this.radiusY(e/2)}}ss.prototype.className="Ellipse";ss.prototype._centroid=!0;ss.prototype._attrsAffectingSize=["radiusX","radiusY"];kt(ss);F.addComponentsGetterSetter(ss,"radius",["x","y"]);F.addGetterSetter(ss,"radiusX",0,ge());F.addGetterSetter(ss,"radiusY",0,ge());class yr extends he{constructor(e){super(e),this._loadListener=()=>{this._requestDraw()},this.on("imageChange.konva",t=>{this._removeImageLoad(t.oldVal),this._setImageLoad()}),this._setImageLoad()}_setImageLoad(){const e=this.image();e&&e.complete||e&&e.readyState===4||e&&e.addEventListener&&e.addEventListener("load",this._loadListener)}_removeImageLoad(e){e&&e.removeEventListener&&e.removeEventListener("load",this._loadListener)}destroy(){return this._removeImageLoad(this.image()),super.destroy(),this}_useBufferCanvas(){const e=!!this.cornerRadius(),t=this.hasShadow();return e&&t?!0:super._useBufferCanvas(!0)}_sceneFunc(e){const t=this.getWidth(),n=this.getHeight(),i=this.cornerRadius(),l=this.attrs.image;let c;if(l){const d=this.attrs.cropWidth,u=this.attrs.cropHeight;d&&u?c=[l,this.cropX(),this.cropY(),d,u,0,0,t,n]:c=[l,0,0,t,n]}(this.hasFill()||this.hasStroke()||i)&&(e.beginPath(),i?$.drawRoundedRectPath(e,t,n,i):e.rect(0,0,t,n),e.closePath(),e.fillStrokeShape(this)),l&&(i&&e.clip(),e.drawImage.apply(e,c))}_hitFunc(e){const t=this.width(),n=this.height(),i=this.cornerRadius();e.beginPath(),i?$.drawRoundedRectPath(e,t,n,i):e.rect(0,0,t,n),e.closePath(),e.fillStrokeShape(this)}getWidth(){var e,t,n;return(n=(e=this.attrs.width)!==null&&e!==void 0?e:(t=this.image())===null||t===void 0?void 0:t.width)!==null&&n!==void 0?n:0}getHeight(){var e,t,n;return(n=(e=this.attrs.height)!==null&&e!==void 0?e:(t=this.image())===null||t===void 0?void 0:t.height)!==null&&n!==void 0?n:0}static fromURL(e,t,n=null){const i=$.createImageElement();i.onload=function(){const l=new yr({image:i});t(l)},i.onerror=n,i.crossOrigin="Anonymous",i.src=e}}yr.prototype.className="Image";yr.prototype._attrsAffectingSize=["image"];kt(yr);F.addGetterSetter(yr,"cornerRadius",0,bl(4));F.addGetterSetter(yr,"image");F.addComponentsGetterSetter(yr,"crop",["x","y","width","height"]);F.addGetterSetter(yr,"cropX",0,ge());F.addGetterSetter(yr,"cropY",0,ge());F.addGetterSetter(yr,"cropWidth",0,ge());F.addGetterSetter(yr,"cropHeight",0,ge());const K0=["fontFamily","fontSize","fontStyle","padding","lineHeight","text","width","height","pointerDirection","pointerWidth","pointerHeight"],g6="Change.konva",x6="none",kd="up",Nd="right",jd="down",Ed="left",y6=K0.length;class gu extends xi{constructor(e){super(e),this.on("add.konva",function(t){this._addListeners(t.child),this._sync()})}getText(){return this.find("Text")[0]}getTag(){return this.find("Tag")[0]}_addListeners(e){let t=this,n;const i=function(){t._sync()};for(n=0;n<y6;n++)e.on(K0[n]+g6,i)}getWidth(){return this.getText().width()}getHeight(){return this.getText().height()}_sync(){let e=this.getText(),t=this.getTag(),n,i,l,c,d,u,f;if(e&&t){switch(n=e.width(),i=e.height(),l=t.pointerDirection(),c=t.pointerWidth(),f=t.pointerHeight(),d=0,u=0,l){case kd:d=n/2,u=-1*f;break;case Nd:d=n+c,u=i/2;break;case jd:d=n/2,u=i+f;break;case Ed:d=-1*c,u=i/2;break}t.setAttrs({x:-1*d,y:-1*u,width:n,height:i}),e.setAttrs({x:-1*d,y:-1*u})}}}gu.prototype.className="Label";kt(gu);class Ds extends he{_sceneFunc(e){const t=this.width(),n=this.height(),i=this.pointerDirection(),l=this.pointerWidth(),c=this.pointerHeight(),d=this.cornerRadius();let u=0,f=0,p=0,m=0;typeof d=="number"?u=f=p=m=Math.min(d,t/2,n/2):(u=Math.min(d[0]||0,t/2,n/2),f=Math.min(d[1]||0,t/2,n/2),m=Math.min(d[2]||0,t/2,n/2),p=Math.min(d[3]||0,t/2,n/2)),e.beginPath(),e.moveTo(u,0),i===kd&&(e.lineTo((t-l)/2,0),e.lineTo(t/2,-1*c),e.lineTo((t+l)/2,0)),e.lineTo(t-f,0),e.arc(t-f,f,f,Math.PI*3/2,0,!1),i===Nd&&(e.lineTo(t,(n-c)/2),e.lineTo(t+l,n/2),e.lineTo(t,(n+c)/2)),e.lineTo(t,n-m),e.arc(t-m,n-m,m,0,Math.PI/2,!1),i===jd&&(e.lineTo((t+l)/2,n),e.lineTo(t/2,n+c),e.lineTo((t-l)/2,n)),e.lineTo(p,n),e.arc(p,n-p,p,Math.PI/2,Math.PI,!1),i===Ed&&(e.lineTo(0,(n+c)/2),e.lineTo(-1*l,n/2),e.lineTo(0,(n-c)/2)),e.lineTo(0,u),e.arc(u,u,u,Math.PI,Math.PI*3/2,!1),e.closePath(),e.fillStrokeShape(this)}getSelfRect(){let e=0,t=0,n=this.pointerWidth(),i=this.pointerHeight(),l=this.pointerDirection(),c=this.width(),d=this.height();return l===kd?(t-=i,d+=i):l===jd?d+=i:l===Ed?(e-=n*1.5,c+=n):l===Nd&&(c+=n*1.5),{x:e,y:t,width:c,height:d}}}Ds.prototype.className="Tag";kt(Ds);F.addGetterSetter(Ds,"pointerDirection",x6);F.addGetterSetter(Ds,"pointerWidth",0,ge());F.addGetterSetter(Ds,"pointerHeight",0,ge());F.addGetterSetter(Ds,"cornerRadius",0,bl(4));let Ca=class extends he{_sceneFunc(e){const t=this.cornerRadius(),n=this.width(),i=this.height();e.beginPath(),t?$.drawRoundedRectPath(e,n,i,t):e.rect(0,0,n,i),e.closePath(),e.fillStrokeShape(this)}};Ca.prototype.className="Rect";kt(Ca);F.addGetterSetter(Ca,"cornerRadius",0,bl(4));class is extends he{_sceneFunc(e){const t=this._getPoints(),n=this.radius(),i=this.sides(),l=this.cornerRadius();if(e.beginPath(),l)$.drawRoundedPolygonPath(e,t,i,n,l);else{e.moveTo(t[0].x,t[0].y);for(let c=1;c<t.length;c++)e.lineTo(t[c].x,t[c].y)}e.closePath(),e.fillStrokeShape(this)}_getPoints(){const e=this.attrs.sides,t=this.attrs.radius||0,n=[];for(let i=0;i<e;i++)n.push({x:t*Math.sin(i*2*Math.PI/e),y:-1*t*Math.cos(i*2*Math.PI/e)});return n}getSelfRect(){const e=this._getPoints();let t=e[0].x,n=e[0].x,i=e[0].y,l=e[0].y;return e.forEach(c=>{t=Math.min(t,c.x),n=Math.max(n,c.x),i=Math.min(i,c.y),l=Math.max(l,c.y)}),{x:t,y:i,width:n-t,height:l-i}}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(e){this.radius(e/2)}setHeight(e){this.radius(e/2)}}is.prototype.className="RegularPolygon";is.prototype._centroid=!0;is.prototype._attrsAffectingSize=["radius"];kt(is);F.addGetterSetter(is,"radius",0,ge());F.addGetterSetter(is,"sides",0,ge());F.addGetterSetter(is,"cornerRadius",0,bl(4));const fp=Math.PI*2;class Os extends he{_sceneFunc(e){e.beginPath(),e.arc(0,0,this.innerRadius(),0,fp,!1),e.moveTo(this.outerRadius(),0),e.arc(0,0,this.outerRadius(),fp,0,!0),e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(e){this.outerRadius(e/2)}setHeight(e){this.outerRadius(e/2)}}Os.prototype.className="Ring";Os.prototype._centroid=!0;Os.prototype._attrsAffectingSize=["innerRadius","outerRadius"];kt(Os);F.addGetterSetter(Os,"innerRadius",0,ge());F.addGetterSetter(Os,"outerRadius",0,ge());class un extends he{constructor(e){super(e),this._updated=!0,this.anim=new Ar(()=>{const t=this._updated;return this._updated=!1,t}),this.on("animationChange.konva",function(){this.frameIndex(0)}),this.on("frameIndexChange.konva",function(){this._updated=!0}),this.on("frameRateChange.konva",function(){this.anim.isRunning()&&(clearInterval(this.interval),this._setInterval())})}_sceneFunc(e){const t=this.animation(),n=this.frameIndex(),i=n*4,l=this.animations()[t],c=this.frameOffsets(),d=l[i+0],u=l[i+1],f=l[i+2],p=l[i+3],m=this.image();if((this.hasFill()||this.hasStroke())&&(e.beginPath(),e.rect(0,0,f,p),e.closePath(),e.fillStrokeShape(this)),m)if(c){const y=c[t],w=n*2;e.drawImage(m,d,u,f,p,y[w+0],y[w+1],f,p)}else e.drawImage(m,d,u,f,p,0,0,f,p)}_hitFunc(e){const t=this.animation(),n=this.frameIndex(),i=n*4,l=this.animations()[t],c=this.frameOffsets(),d=l[i+2],u=l[i+3];if(e.beginPath(),c){const f=c[t],p=n*2;e.rect(f[p+0],f[p+1],d,u)}else e.rect(0,0,d,u);e.closePath(),e.fillShape(this)}_useBufferCanvas(){return super._useBufferCanvas(!0)}_setInterval(){const e=this;this.interval=setInterval(function(){e._updateIndex()},1e3/this.frameRate())}start(){if(this.isRunning())return;const e=this.getLayer();this.anim.setLayers(e),this._setInterval(),this.anim.start()}stop(){this.anim.stop(),clearInterval(this.interval)}isRunning(){return this.anim.isRunning()}_updateIndex(){const e=this.frameIndex(),t=this.animation(),n=this.animations(),i=n[t],l=i.length/4;e<l-1?this.frameIndex(e+1):this.frameIndex(0)}}un.prototype.className="Sprite";kt(un);F.addGetterSetter(un,"animation");F.addGetterSetter(un,"animations");F.addGetterSetter(un,"frameOffsets");F.addGetterSetter(un,"image");F.addGetterSetter(un,"frameIndex",0,ge());F.addGetterSetter(un,"frameRate",17,ge());F.backCompat(un,{index:"frameIndex",getIndex:"getFrameIndex",setIndex:"setFrameIndex"});class as extends he{_sceneFunc(e){const t=this.innerRadius(),n=this.outerRadius(),i=this.numPoints();e.beginPath(),e.moveTo(0,0-n);for(let l=1;l<i*2;l++){const c=l%2===0?n:t,d=c*Math.sin(l*Math.PI/i),u=-1*c*Math.cos(l*Math.PI/i);e.lineTo(d,u)}e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(e){this.outerRadius(e/2)}setHeight(e){this.outerRadius(e/2)}}as.prototype.className="Star";as.prototype._centroid=!0;as.prototype._attrsAffectingSize=["innerRadius","outerRadius"];kt(as);F.addGetterSetter(as,"numPoints",5,ge());F.addGetterSetter(as,"innerRadius",0,ge());F.addGetterSetter(as,"outerRadius",0,ge());function Un(r){return[...r].reduce((e,t,n,i)=>{if(new RegExp("\\p{Emoji}","u").test(t)){const l=i[n+1];l&&new RegExp("\\p{Emoji_Modifier}|\\u200D","u").test(l)?(e.push(t+l),i[n+1]=""):e.push(t)}else new RegExp("\\p{Regional_Indicator}{2}","u").test(t+(i[n+1]||""))?e.push(t+i[n+1]):n>0&&new RegExp("\\p{Mn}|\\p{Me}|\\p{Mc}","u").test(t)?e[e.length-1]+=t:t&&e.push(t);return e},[])}const Zs="auto",v6="center",Q0="inherit",$i="justify",w6="Change.konva",b6="2d",pp="-",Z0="left",_6="text",S6="Text",C6="top",k6="bottom",mp="middle",J0="normal",N6="px ",Oo=" ",j6="right",gp="rtl",E6="word",P6="char",xp="none",Qc="",e1=["direction","fontFamily","fontSize","fontStyle","fontVariant","padding","align","verticalAlign","lineHeight","text","width","height","wrap","ellipsis","letterSpacing"],A6=e1.length;function T6(r){return r.split(",").map(e=>{e=e.trim();const t=e.indexOf(" ")>=0,n=e.indexOf('"')>=0||e.indexOf("'")>=0;return t&&!n&&(e=`"${e}"`),e}).join(", ")}let Io;function Zc(){return Io||(Io=$.createCanvasElement().getContext(b6),Io)}function R6(r){r.fillText(this._partialText,this._partialTextX,this._partialTextY)}function D6(r){r.setAttr("miterLimit",2),r.strokeText(this._partialText,this._partialTextX,this._partialTextY)}function O6(r){return r=r||{},!r.fillLinearGradientColorStops&&!r.fillRadialGradientColorStops&&!r.fillPatternImage&&(r.fill=r.fill||"black"),r}let mt=class extends he{constructor(e){super(O6(e)),this._partialTextX=0,this._partialTextY=0;for(let t=0;t<A6;t++)this.on(e1[t]+w6,this._setTextData);this._setTextData()}_sceneFunc(e){var t,n;const i=this.textArr,l=i.length;if(!this.text())return;let c=this.padding(),d=this.fontSize(),u=this.lineHeight()*d,f=this.verticalAlign(),p=this.direction(),m=0,y=this.align(),w=this.getWidth(),_=this.letterSpacing(),x=this.charRenderFunc(),v=this.fill(),S=this.textDecoration(),C=this.underlineOffset(),k=S.indexOf("underline")!==-1,E=S.indexOf("line-through")!==-1,P;p=p===Q0?e.direction:p;let D=u/2,I=mp;if(!we.legacyTextRendering){const B=this.measureSize("M");I="alphabetic";const z=(t=B.fontBoundingBoxAscent)!==null&&t!==void 0?t:B.actualBoundingBoxAscent,X=(n=B.fontBoundingBoxDescent)!==null&&n!==void 0?n:B.actualBoundingBoxDescent;D=(z-X)/2+u/2}for(p===gp&&e.setAttr("direction",p),e.setAttr("font",this._getContextFont()),e.setAttr("textBaseline",I),e.setAttr("textAlign",Z0),f===mp?m=(this.getHeight()-l*u-c*2)/2:f===k6&&(m=this.getHeight()-l*u-c*2),e.translate(c,m+c),P=0;P<l;P++){let B=0,z=0;const X=i[P],se=X.text,R=X.width,H=X.lastInParagraph;if(e.save(),y===j6?B+=w-R-c*2:y===v6&&(B+=(w-R-c*2)/2),k){e.save(),e.beginPath();const G=C??(we.legacyTextRendering?Math.round(d/2):Math.round(d/4)),Q=B,K=D+z+G;e.moveTo(Q,K);const J=y===$i&&!H?w-c*2:R;e.lineTo(Q+Math.round(J),K),e.lineWidth=d/15;const ee=this._getLinearGradient();e.strokeStyle=ee||v,e.stroke(),e.restore()}const j=B;if(p!==gp&&(_!==0||y===$i||x)){const G=se.split(" ").length-1,Q=Un(se);for(let K=0;K<Q.length;K++){const J=Q[K];if(J===" "&&!H&&y===$i&&(B+=(w-c*2-R)/G),this._partialTextX=B,this._partialTextY=D+z,this._partialText=J,x){e.save();const be=i.slice(0,P).reduce((Y,Se)=>Y+Un(Se.text).length,0),V=K+be;x({char:J,index:V,x:B,y:D+z,lineIndex:P,column:K,isLastInLine:H,width:this.measureSize(J).width,context:e})}e.fillStrokeShape(this),x&&e.restore(),B+=this.measureSize(J).width+_}}else _!==0&&e.setAttr("letterSpacing",`${_}px`),this._partialTextX=B,this._partialTextY=D+z,this._partialText=se,e.fillStrokeShape(this);if(E){e.save(),e.beginPath();const G=we.legacyTextRendering?0:-Math.round(d/4),Q=j;e.moveTo(Q,D+z+G);const K=y===$i&&!H?w-c*2:R;e.lineTo(Q+Math.round(K),D+z+G),e.lineWidth=d/15;const J=this._getLinearGradient();e.strokeStyle=J||v,e.stroke(),e.restore()}e.restore(),l>1&&(D+=u)}}_hitFunc(e){const t=this.getWidth(),n=this.getHeight();e.beginPath(),e.rect(0,0,t,n),e.closePath(),e.fillStrokeShape(this)}setText(e){const t=$._isString(e)?e:e==null?"":e+"";return this._setAttr(_6,t),this}getWidth(){return this.attrs.width===Zs||this.attrs.width===void 0?this.getTextWidth()+this.padding()*2:this.attrs.width}getHeight(){return this.attrs.height===Zs||this.attrs.height===void 0?this.fontSize()*this.textArr.length*this.lineHeight()+this.padding()*2:this.attrs.height}getTextWidth(){return this.textWidth}getTextHeight(){return $.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}measureSize(e){var t,n,i,l,c,d,u,f,p,m,y;let w=Zc(),_=this.fontSize(),x;w.save(),w.font=this._getContextFont(),x=w.measureText(e),w.restore();const v=_/100;return{actualBoundingBoxAscent:(t=x.actualBoundingBoxAscent)!==null&&t!==void 0?t:71.58203125*v,actualBoundingBoxDescent:(n=x.actualBoundingBoxDescent)!==null&&n!==void 0?n:0,actualBoundingBoxLeft:(i=x.actualBoundingBoxLeft)!==null&&i!==void 0?i:-7.421875*v,actualBoundingBoxRight:(l=x.actualBoundingBoxRight)!==null&&l!==void 0?l:75.732421875*v,alphabeticBaseline:(c=x.alphabeticBaseline)!==null&&c!==void 0?c:0,emHeightAscent:(d=x.emHeightAscent)!==null&&d!==void 0?d:100*v,emHeightDescent:(u=x.emHeightDescent)!==null&&u!==void 0?u:-20*v,fontBoundingBoxAscent:(f=x.fontBoundingBoxAscent)!==null&&f!==void 0?f:91*v,fontBoundingBoxDescent:(p=x.fontBoundingBoxDescent)!==null&&p!==void 0?p:21*v,hangingBaseline:(m=x.hangingBaseline)!==null&&m!==void 0?m:72.80000305175781*v,ideographicBaseline:(y=x.ideographicBaseline)!==null&&y!==void 0?y:-21*v,width:x.width,height:_}}_getContextFont(){return this.fontStyle()+Oo+this.fontVariant()+Oo+(this.fontSize()+N6)+T6(this.fontFamily())}_addTextLine(e){this.align()===$i&&(e=e.trim());const n=this._getTextWidth(e);return this.textArr.push({text:e,width:n,lastInParagraph:!1})}_getTextWidth(e){const t=this.letterSpacing(),n=e.length;return Zc().measureText(e).width+t*n}_setTextData(){let e=this.text().split(`
`),t=+this.fontSize(),n=0,i=this.lineHeight()*t,l=this.attrs.width,c=this.attrs.height,d=l!==Zs&&l!==void 0,u=c!==Zs&&c!==void 0,f=this.padding(),p=l-f*2,m=c-f*2,y=0,w=this.wrap(),_=w!==xp,x=w!==P6&&_,v=this.ellipsis();this.textArr=[],Zc().font=this._getContextFont();const S=v?this._getTextWidth(Qc):0;for(let C=0,k=e.length;C<k;++C){let E=e[C],P=this._getTextWidth(E);if(d&&P>p)for(;E.length>0;){let D=0,I=Un(E).length,B="",z=0;for(;D<I;){const X=D+I>>>1,se=Un(E),R=se.slice(0,X+1).join(""),H=this._getTextWidth(R);(v&&u&&y+i>m?H+S:H)<=p?(D=X+1,B=R,z=H):I=X}if(B){if(x){const R=Un(E),H=Un(B),j=R[H.length],G=j===Oo||j===pp;let Q;if(G&&z<=p)Q=H.length;else{const K=H.lastIndexOf(Oo),J=H.lastIndexOf(pp);Q=Math.max(K,J)+1}Q>0&&(D=Q,B=R.slice(0,D).join(""),z=this._getTextWidth(B))}if(B=B.trimRight(),this._addTextLine(B),n=Math.max(n,z),y+=i,this._shouldHandleEllipsis(y)){this._tryToAddEllipsisToLastLine();break}if(E=Un(E).slice(D).join("").trimLeft(),E.length>0&&(P=this._getTextWidth(E),P<=p)){this._addTextLine(E),y+=i,n=Math.max(n,P);break}}else break}else this._addTextLine(E),y+=i,n=Math.max(n,P),this._shouldHandleEllipsis(y)&&C<k-1&&this._tryToAddEllipsisToLastLine();if(this.textArr[this.textArr.length-1]&&(this.textArr[this.textArr.length-1].lastInParagraph=!0),u&&y+i>m)break}this.textHeight=t,this.textWidth=n}_shouldHandleEllipsis(e){const t=+this.fontSize(),n=this.lineHeight()*t,i=this.attrs.height,l=i!==Zs&&i!==void 0,c=this.padding(),d=i-c*2;return!(this.wrap()!==xp)||l&&e+n>d}_tryToAddEllipsisToLastLine(){const e=this.attrs.width,t=e!==Zs&&e!==void 0,n=this.padding(),i=e-n*2,l=this.ellipsis(),c=this.textArr[this.textArr.length-1];!c||!l||(t&&(this._getTextWidth(c.text+Qc)<i||(c.text=c.text.slice(0,c.text.length-3))),this.textArr.splice(this.textArr.length-1,1),this._addTextLine(c.text+Qc))}getStrokeScaleEnabled(){return!0}_useBufferCanvas(){const e=this.textDecoration().indexOf("underline")!==-1||this.textDecoration().indexOf("line-through")!==-1,t=this.hasShadow();return e&&t?!0:super._useBufferCanvas()}};mt.prototype._fillFunc=R6;mt.prototype._strokeFunc=D6;mt.prototype.className=S6;mt.prototype._attrsAffectingSize=["text","fontSize","padding","wrap","lineHeight","letterSpacing"];kt(mt);F.overWriteSetter(mt,"width",fu());F.overWriteSetter(mt,"height",fu());F.addGetterSetter(mt,"direction",Q0);F.addGetterSetter(mt,"fontFamily","Arial");F.addGetterSetter(mt,"fontSize",12,ge());F.addGetterSetter(mt,"fontStyle",J0);F.addGetterSetter(mt,"fontVariant",J0);F.addGetterSetter(mt,"padding",0,ge());F.addGetterSetter(mt,"align",Z0);F.addGetterSetter(mt,"verticalAlign",C6);F.addGetterSetter(mt,"lineHeight",1,ge());F.addGetterSetter(mt,"wrap",E6);F.addGetterSetter(mt,"ellipsis",!1,$r());F.addGetterSetter(mt,"letterSpacing",0,ge());F.addGetterSetter(mt,"text","",As());F.addGetterSetter(mt,"textDecoration","");F.addGetterSetter(mt,"underlineOffset",void 0,ge());F.addGetterSetter(mt,"charRenderFunc",void 0);const I6="",t1="normal";function r1(r){r.fillText(this.partialText,0,0)}function n1(r){r.strokeText(this.partialText,0,0)}class Lt extends he{constructor(e){super(e),this.dummyCanvas=$.createCanvasElement(),this.dataArray=[],this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute(),this._setTextData()}),this.on("textChange.konva alignChange.konva letterSpacingChange.konva kerningFuncChange.konva fontSizeChange.konva fontFamilyChange.konva",this._setTextData),this._setTextData()}_getTextPathLength(){return ft.getPathLength(this.dataArray)}_getPointAtLength(e){if(!this.attrs.data)return null;const t=this.pathLength;return e>t?null:ft.getPointAtLengthOfDataArray(e,this.dataArray)}_readDataAttribute(){this.dataArray=ft.parsePathData(this.attrs.data),this.pathLength=this._getTextPathLength()}_sceneFunc(e){e.setAttr("font",this._getContextFont()),e.setAttr("textBaseline",this.textBaseline()),e.setAttr("textAlign","left"),e.save();const t=this.textDecoration(),n=this.fill(),i=this.fontSize(),l=this.glyphInfo,c=t.indexOf("underline")!==-1,d=t.indexOf("line-through")!==-1;c&&e.beginPath();for(let u=0;u<l.length;u++){e.save();const f=l[u].p0;e.translate(f.x,f.y),e.rotate(l[u].rotation),this.partialText=l[u].text,e.fillStrokeShape(this),c&&(u===0&&e.moveTo(0,i/2+1),e.lineTo(l[u].width,i/2+1)),e.restore()}if(c&&(e.strokeStyle=n,e.lineWidth=i/20,e.stroke()),d){e.beginPath();for(let u=0;u<l.length;u++){e.save();const f=l[u].p0;e.translate(f.x,f.y),e.rotate(l[u].rotation),u===0&&e.moveTo(0,0),e.lineTo(l[u].width,0),e.restore()}e.strokeStyle=n,e.lineWidth=i/20,e.stroke()}e.restore()}_hitFunc(e){e.beginPath();const t=this.glyphInfo;if(t.length>=1){const n=t[0].p0;e.moveTo(n.x,n.y)}for(let n=0;n<t.length;n++){const i=t[n].p1;e.lineTo(i.x,i.y)}e.setAttr("lineWidth",this.fontSize()),e.setAttr("strokeStyle",this.colorKey),e.stroke()}getTextWidth(){return this.textWidth}getTextHeight(){return $.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}setText(e){return mt.prototype.setText.call(this,e)}_getContextFont(){return mt.prototype._getContextFont.call(this)}_getTextSize(e){const n=this.dummyCanvas.getContext("2d");n.save(),n.font=this._getContextFont();const i=n.measureText(e);return n.restore(),{width:i.width,height:parseInt(`${this.fontSize()}`,10)}}_setTextData(){const e=Un(this.text()),t=[];let n=0;for(let m=0;m<e.length;m++)t.push({char:e[m],width:this._getTextSize(e[m]).width}),n+=t[m].width;const{height:i}=this._getTextSize(this.attrs.text);if(this.textWidth=n,this.textHeight=i,this.glyphInfo=[],!this.attrs.data)return null;const l=this.letterSpacing(),c=this.align(),d=this.kerningFunc(),u=Math.max(this.textWidth+((this.attrs.text||"").length-1)*l,0);let f=0;c==="center"&&(f=Math.max(0,this.pathLength/2-u/2)),c==="right"&&(f=Math.max(0,this.pathLength-u));let p=f;for(let m=0;m<t.length;m++){const y=this._getPointAtLength(p);if(!y)return;const w=t[m].char;let _=t[m].width+l;if(w===" "&&c==="justify"){const E=this.text().split(" ").length-1;_+=(this.pathLength-u)/E}const x=this._getPointAtLength(p+_);if(!x)return;const v=ft.getLineLength(y.x,y.y,x.x,x.y);let S=0;if(d)try{S=d(t[m-1].char,w)*this.fontSize()}catch{S=0}y.x+=S,x.x+=S,this.textWidth+=S;const C=ft.getPointOnLine(S+v/2,y.x,y.y,x.x,x.y),k=Math.atan2(x.y-y.y,x.x-y.x);this.glyphInfo.push({transposeX:C.x,transposeY:C.y,text:e[m],rotation:k,p0:y,p1:x,width:v}),p+=_}}getSelfRect(){if(!this.glyphInfo.length)return{x:0,y:0,width:0,height:0};const e=[];this.glyphInfo.forEach(function(f){e.push(f.p0.x),e.push(f.p0.y),e.push(f.p1.x),e.push(f.p1.y)});let t=e[0]||0,n=e[0]||0,i=e[1]||0,l=e[1]||0,c,d;for(let f=0;f<e.length/2;f++)c=e[f*2],d=e[f*2+1],t=Math.min(t,c),n=Math.max(n,c),i=Math.min(i,d),l=Math.max(l,d);const u=this.fontSize();return{x:t-u/2,y:i-u/2,width:n-t+u,height:l-i+u}}destroy(){return $.releaseCanvas(this.dummyCanvas),super.destroy()}}Lt.prototype._fillFunc=r1;Lt.prototype._strokeFunc=n1;Lt.prototype._fillFuncHit=r1;Lt.prototype._strokeFuncHit=n1;Lt.prototype.className="TextPath";Lt.prototype._attrsAffectingSize=["text","fontSize","data"];kt(Lt);F.addGetterSetter(Lt,"data");F.addGetterSetter(Lt,"fontFamily","Arial");F.addGetterSetter(Lt,"fontSize",12,ge());F.addGetterSetter(Lt,"fontStyle",t1);F.addGetterSetter(Lt,"align","left");F.addGetterSetter(Lt,"letterSpacing",0,ge());F.addGetterSetter(Lt,"textBaseline","middle");F.addGetterSetter(Lt,"fontVariant",t1);F.addGetterSetter(Lt,"text",I6);F.addGetterSetter(Lt,"textDecoration","");F.addGetterSetter(Lt,"kerningFunc",void 0);const s1="tr-konva",M6=["resizeEnabledChange","rotateAnchorOffsetChange","rotateAnchorAngleChange","rotateEnabledChange","enabledAnchorsChange","anchorSizeChange","borderEnabledChange","borderStrokeChange","borderStrokeWidthChange","borderDashChange","anchorStrokeChange","anchorStrokeWidthChange","anchorFillChange","anchorCornerRadiusChange","ignoreStrokeChange","anchorStyleFuncChange"].map(r=>r+`.${s1}`).join(" "),yp="nodesRect",L6=["widthChange","heightChange","scaleXChange","scaleYChange","skewXChange","skewYChange","rotationChange","offsetXChange","offsetYChange","transformsEnabledChange","strokeWidthChange","draggableChange"],F6={"top-left":-45,"top-center":0,"top-right":45,"middle-right":-90,"middle-left":90,"bottom-left":-135,"bottom-center":180,"bottom-right":135},z6="ontouchstart"in we._global;function B6(r,e,t){if(r==="rotater")return t;e+=$.degToRad(F6[r]||0);const n=($.radToDeg(e)%360+360)%360;return $._inRange(n,315+22.5,360)||$._inRange(n,0,22.5)?"ns-resize":$._inRange(n,45-22.5,45+22.5)?"nesw-resize":$._inRange(n,90-22.5,90+22.5)?"ew-resize":$._inRange(n,135-22.5,135+22.5)?"nwse-resize":$._inRange(n,180-22.5,180+22.5)?"ns-resize":$._inRange(n,225-22.5,225+22.5)?"nesw-resize":$._inRange(n,270-22.5,270+22.5)?"ew-resize":$._inRange(n,315-22.5,315+22.5)?"nwse-resize":($.error("Transformer has unknown angle for cursor detection: "+n),"pointer")}const Qo=["top-left","top-center","top-right","middle-right","middle-left","bottom-left","bottom-center","bottom-right"];function G6(r){return{x:r.x+r.width/2*Math.cos(r.rotation)+r.height/2*Math.sin(-r.rotation),y:r.y+r.height/2*Math.cos(r.rotation)+r.width/2*Math.sin(r.rotation)}}function i1(r,e,t){const n=t.x+(r.x-t.x)*Math.cos(e)-(r.y-t.y)*Math.sin(e),i=t.y+(r.x-t.x)*Math.sin(e)+(r.y-t.y)*Math.cos(e);return{...r,rotation:r.rotation+e,x:n,y:i}}function H6(r,e){const t=G6(r);return i1(r,e,t)}function U6(r,e,t){let n=e;for(let i=0;i<r.length;i++){const l=we.getAngle(r[i]),c=Math.abs(l-e)%(Math.PI*2);Math.min(c,Math.PI*2-c)<t&&(n=l)}return n}let Pd=0;class Ye extends xi{constructor(e){super(e),this._movingAnchorName=null,this._transforming=!1,this._createElements(),this._handleMouseMove=this._handleMouseMove.bind(this),this._handleMouseUp=this._handleMouseUp.bind(this),this.update=this.update.bind(this),this.on(M6,this.update),this.getNode()&&this.update()}attachTo(e){return this.setNode(e),this}setNode(e){return $.warn("tr.setNode(shape), tr.node(shape) and tr.attachTo(shape) methods are deprecated. Please use tr.nodes(nodesArray) instead."),this.setNodes([e])}getNode(){return this._nodes&&this._nodes[0]}_getEventNamespace(){return s1+this._id}setNodes(e=[]){this._nodes&&this._nodes.length&&this.detach();const t=e.filter(i=>i.isAncestorOf(this)?($.error("Konva.Transformer cannot be an a child of the node you are trying to attach"),!1):!0);return this._nodes=e=t,e.length===1&&this.useSingleNodeRotation()?this.rotation(e[0].getAbsoluteRotation()):this.rotation(0),this._nodes.forEach(i=>{const l=()=>{this.nodes().length===1&&this.useSingleNodeRotation()&&this.rotation(this.nodes()[0].getAbsoluteRotation()),this._resetTransformCache(),!this._transforming&&!this.isDragging()&&this.update()};if(i._attrsAffectingSize.length){const c=i._attrsAffectingSize.map(d=>d+"Change."+this._getEventNamespace()).join(" ");i.on(c,l)}i.on(L6.map(c=>c+`.${this._getEventNamespace()}`).join(" "),l),i.on(`absoluteTransformChange.${this._getEventNamespace()}`,l),this._proxyDrag(i)}),this._resetTransformCache(),!!this.findOne(".top-left")&&this.update(),this}_proxyDrag(e){let t;e.on(`dragstart.${this._getEventNamespace()}`,n=>{t=e.getAbsolutePosition(),!this.isDragging()&&e!==this.findOne(".back")&&this.startDrag(n,!1)}),e.on(`dragmove.${this._getEventNamespace()}`,n=>{if(!t)return;const i=e.getAbsolutePosition(),l=i.x-t.x,c=i.y-t.y;this.nodes().forEach(d=>{if(d===e||d.isDragging())return;const u=d.getAbsolutePosition();d.setAbsolutePosition({x:u.x+l,y:u.y+c}),d.startDrag(n)}),t=null})}getNodes(){return this._nodes||[]}getActiveAnchor(){return this._movingAnchorName}detach(){this._nodes&&this._nodes.forEach(e=>{e.off("."+this._getEventNamespace())}),this._nodes=[],this._resetTransformCache()}_resetTransformCache(){this._clearCache(yp),this._clearCache("transform"),this._clearSelfAndDescendantCache("absoluteTransform")}_getNodeRect(){return this._getCache(yp,this.__getNodeRect)}__getNodeShape(e,t=this.rotation(),n){const i=e.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),l=e.getAbsoluteScale(n),c=e.getAbsolutePosition(n),d=i.x*l.x-e.offsetX()*l.x,u=i.y*l.y-e.offsetY()*l.y,f=(we.getAngle(e.getAbsoluteRotation())+Math.PI*2)%(Math.PI*2),p={x:c.x+d*Math.cos(f)+u*Math.sin(-f),y:c.y+u*Math.cos(f)+d*Math.sin(f),width:i.width*l.x,height:i.height*l.y,rotation:f};return i1(p,-we.getAngle(t),{x:0,y:0})}__getNodeRect(){if(!this.getNode())return{x:-1e8,y:-1e8,width:0,height:0,rotation:0};const t=[];this.nodes().map(f=>{const p=f.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),m=[{x:p.x,y:p.y},{x:p.x+p.width,y:p.y},{x:p.x+p.width,y:p.y+p.height},{x:p.x,y:p.y+p.height}],y=f.getAbsoluteTransform();m.forEach(function(w){const _=y.point(w);t.push(_)})});const n=new pr;n.rotate(-we.getAngle(this.rotation()));let i=1/0,l=1/0,c=-1/0,d=-1/0;t.forEach(function(f){const p=n.point(f);i===void 0&&(i=c=p.x,l=d=p.y),i=Math.min(i,p.x),l=Math.min(l,p.y),c=Math.max(c,p.x),d=Math.max(d,p.y)}),n.invert();const u=n.point({x:i,y:l});return{x:u.x,y:u.y,width:c-i,height:d-l,rotation:we.getAngle(this.rotation())}}getX(){return this._getNodeRect().x}getY(){return this._getNodeRect().y}getWidth(){return this._getNodeRect().width}getHeight(){return this._getNodeRect().height}_createElements(){this._createBack(),Qo.forEach(e=>{this._createAnchor(e)}),this._createAnchor("rotater")}_createAnchor(e){const t=new Ca({stroke:"rgb(0, 161, 255)",fill:"white",strokeWidth:1,name:e+" _anchor",dragDistance:0,draggable:!0,hitStrokeWidth:z6?10:"auto"}),n=this;t.on("mousedown touchstart",function(i){n._handleMouseDown(i)}),t.on("dragstart",i=>{t.stopDrag(),i.cancelBubble=!0}),t.on("dragend",i=>{i.cancelBubble=!0}),t.on("mouseenter",()=>{const i=we.getAngle(this.rotation()),l=this.rotateAnchorCursor(),c=B6(e,i,l);t.getStage().content&&(t.getStage().content.style.cursor=c),this._cursorChange=!0}),t.on("mouseout",()=>{t.getStage().content&&(t.getStage().content.style.cursor=""),this._cursorChange=!1}),this.add(t)}_createBack(){const e=new he({name:"back",width:0,height:0,sceneFunc(t,n){const i=n.getParent(),l=i.padding(),c=n.width(),d=n.height();if(t.beginPath(),t.rect(-l,-l,c+l*2,d+l*2),i.rotateEnabled()&&i.rotateLineVisible()){const u=i.rotateAnchorAngle(),f=i.rotateAnchorOffset(),p=$.degToRad(u),m=Math.sin(p),y=-Math.cos(p),w=c/2,_=d/2;let x=1/0;y<0?x=Math.min(x,-_/y):y>0&&(x=Math.min(x,(d-_)/y)),m<0?x=Math.min(x,-w/m):m>0&&(x=Math.min(x,(c-w)/m));const v=w+m*x,S=_+y*x,C=$._sign(d),k=v+m*f*C,E=S+y*f*C;t.moveTo(v,S),t.lineTo(k,E)}t.fillStrokeShape(n)},hitFunc:(t,n)=>{if(!this.shouldOverdrawWholeArea())return;const i=this.padding();t.beginPath(),t.rect(-i,-i,n.width()+i*2,n.height()+i*2),t.fillStrokeShape(n)}});this.add(e),this._proxyDrag(e),e.on("dragstart",t=>{t.cancelBubble=!0}),e.on("dragmove",t=>{t.cancelBubble=!0}),e.on("dragend",t=>{t.cancelBubble=!0}),this.on("dragmove",t=>{this.update()})}_handleMouseDown(e){if(this._transforming)return;this._movingAnchorName=e.target.name().split(" ")[0];const t=this._getNodeRect(),n=t.width,i=t.height,l=Math.sqrt(Math.pow(n,2)+Math.pow(i,2));this.sin=Math.abs(i/l),this.cos=Math.abs(n/l),typeof window<"u"&&(window.addEventListener("mousemove",this._handleMouseMove),window.addEventListener("touchmove",this._handleMouseMove),window.addEventListener("mouseup",this._handleMouseUp,!0),window.addEventListener("touchend",this._handleMouseUp,!0)),this._transforming=!0;const c=e.target.getAbsolutePosition(),d=e.target.getStage().getPointerPosition();this._anchorDragOffset={x:d.x-c.x,y:d.y-c.y},Pd++,this._fire("transformstart",{evt:e.evt,target:this.getNode()}),this._nodes.forEach(u=>{u._fire("transformstart",{evt:e.evt,target:u})})}_handleMouseMove(e){let t,n,i;const l=this.findOne("."+this._movingAnchorName),c=l.getStage();c.setPointersPositions(e);const d=c.getPointerPosition();let u={x:d.x-this._anchorDragOffset.x,y:d.y-this._anchorDragOffset.y};const f=l.getAbsolutePosition();this.anchorDragBoundFunc()&&(u=this.anchorDragBoundFunc()(f,u,e)),l.setAbsolutePosition(u);const p=l.getAbsolutePosition();if(f.x===p.x&&f.y===p.y)return;if(this._movingAnchorName==="rotater"){const C=this._getNodeRect();t=l.x()-C.width/2,n=-l.y()+C.height/2;const k=we.getAngle(this.rotateAnchorAngle());let E=Math.atan2(-n,t)+Math.PI/2-k;C.height<0&&(E-=Math.PI);const D=we.getAngle(this.rotation())+E,I=we.getAngle(this.rotationSnapTolerance()),z=U6(this.rotationSnaps(),D,I)-C.rotation,X=H6(C,z);this._fitNodesInto(X,e);return}const m=this.shiftBehavior();let y;m==="inverted"?y=this.keepRatio()&&!e.shiftKey:m==="none"?y=this.keepRatio():y=this.keepRatio()||e.shiftKey;let w=this.centeredScaling()||e.altKey;if(this._movingAnchorName==="top-left"){if(y){const C=w?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-right").x(),y:this.findOne(".bottom-right").y()};i=Math.sqrt(Math.pow(C.x-l.x(),2)+Math.pow(C.y-l.y(),2));const k=this.findOne(".top-left").x()>C.x?-1:1,E=this.findOne(".top-left").y()>C.y?-1:1;t=i*this.cos*k,n=i*this.sin*E,this.findOne(".top-left").x(C.x-t),this.findOne(".top-left").y(C.y-n)}}else if(this._movingAnchorName==="top-center")this.findOne(".top-left").y(l.y());else if(this._movingAnchorName==="top-right"){if(y){const C=w?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-left").x(),y:this.findOne(".bottom-left").y()};i=Math.sqrt(Math.pow(l.x()-C.x,2)+Math.pow(C.y-l.y(),2));const k=this.findOne(".top-right").x()<C.x?-1:1,E=this.findOne(".top-right").y()>C.y?-1:1;t=i*this.cos*k,n=i*this.sin*E,this.findOne(".top-right").x(C.x+t),this.findOne(".top-right").y(C.y-n)}var _=l.position();this.findOne(".top-left").y(_.y),this.findOne(".bottom-right").x(_.x)}else if(this._movingAnchorName==="middle-left")this.findOne(".top-left").x(l.x());else if(this._movingAnchorName==="middle-right")this.findOne(".bottom-right").x(l.x());else if(this._movingAnchorName==="bottom-left"){if(y){const C=w?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-right").x(),y:this.findOne(".top-right").y()};i=Math.sqrt(Math.pow(C.x-l.x(),2)+Math.pow(l.y()-C.y,2));const k=C.x<l.x()?-1:1,E=l.y()<C.y?-1:1;t=i*this.cos*k,n=i*this.sin*E,l.x(C.x-t),l.y(C.y+n)}_=l.position(),this.findOne(".top-left").x(_.x),this.findOne(".bottom-right").y(_.y)}else if(this._movingAnchorName==="bottom-center")this.findOne(".bottom-right").y(l.y());else if(this._movingAnchorName==="bottom-right"){if(y){const C=w?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-left").x(),y:this.findOne(".top-left").y()};i=Math.sqrt(Math.pow(l.x()-C.x,2)+Math.pow(l.y()-C.y,2));const k=this.findOne(".bottom-right").x()<C.x?-1:1,E=this.findOne(".bottom-right").y()<C.y?-1:1;t=i*this.cos*k,n=i*this.sin*E,this.findOne(".bottom-right").x(C.x+t),this.findOne(".bottom-right").y(C.y+n)}}else console.error(new Error("Wrong position argument of selection resizer: "+this._movingAnchorName));if(w=this.centeredScaling()||e.altKey,w){const C=this.findOne(".top-left"),k=this.findOne(".bottom-right"),E=C.x(),P=C.y(),D=this.getWidth()-k.x(),I=this.getHeight()-k.y();k.move({x:-E,y:-P}),C.move({x:D,y:I})}const x=this.findOne(".top-left").getAbsolutePosition();t=x.x,n=x.y;const v=this.findOne(".bottom-right").x()-this.findOne(".top-left").x(),S=this.findOne(".bottom-right").y()-this.findOne(".top-left").y();this._fitNodesInto({x:t,y:n,width:v,height:S,rotation:we.getAngle(this.rotation())},e)}_handleMouseUp(e){this._removeEvents(e)}getAbsoluteTransform(){return this.getTransform()}_removeEvents(e){var t;if(this._transforming){this._transforming=!1,typeof window<"u"&&(window.removeEventListener("mousemove",this._handleMouseMove),window.removeEventListener("touchmove",this._handleMouseMove),window.removeEventListener("mouseup",this._handleMouseUp,!0),window.removeEventListener("touchend",this._handleMouseUp,!0));const n=this.getNode();Pd--,this._fire("transformend",{evt:e,target:n}),(t=this.getLayer())===null||t===void 0||t.batchDraw(),n&&this._nodes.forEach(i=>{var l;i._fire("transformend",{evt:e,target:i}),(l=i.getLayer())===null||l===void 0||l.batchDraw()}),this._movingAnchorName=null}}_fitNodesInto(e,t){const n=this._getNodeRect(),i=1;if($._inRange(e.width,-this.padding()*2-i,i)){this.update();return}if($._inRange(e.height,-this.padding()*2-i,i)){this.update();return}const l=new pr;if(l.rotate(we.getAngle(this.rotation())),this._movingAnchorName&&e.width<0&&this._movingAnchorName.indexOf("left")>=0){const y=l.point({x:-this.padding()*2,y:0});e.x+=y.x,e.y+=y.y,e.width+=this.padding()*2,this._movingAnchorName=this._movingAnchorName.replace("left","right"),this._anchorDragOffset.x-=y.x,this._anchorDragOffset.y-=y.y}else if(this._movingAnchorName&&e.width<0&&this._movingAnchorName.indexOf("right")>=0){const y=l.point({x:this.padding()*2,y:0});this._movingAnchorName=this._movingAnchorName.replace("right","left"),this._anchorDragOffset.x-=y.x,this._anchorDragOffset.y-=y.y,e.width+=this.padding()*2}if(this._movingAnchorName&&e.height<0&&this._movingAnchorName.indexOf("top")>=0){const y=l.point({x:0,y:-this.padding()*2});e.x+=y.x,e.y+=y.y,this._movingAnchorName=this._movingAnchorName.replace("top","bottom"),this._anchorDragOffset.x-=y.x,this._anchorDragOffset.y-=y.y,e.height+=this.padding()*2}else if(this._movingAnchorName&&e.height<0&&this._movingAnchorName.indexOf("bottom")>=0){const y=l.point({x:0,y:this.padding()*2});this._movingAnchorName=this._movingAnchorName.replace("bottom","top"),this._anchorDragOffset.x-=y.x,this._anchorDragOffset.y-=y.y,e.height+=this.padding()*2}if(this.boundBoxFunc()){const y=this.boundBoxFunc()(n,e);y?e=y:$.warn("boundBoxFunc returned falsy. You should return new bound rect from it!")}const c=1e7,d=new pr;d.translate(n.x,n.y),d.rotate(n.rotation),d.scale(n.width/c,n.height/c);const u=new pr,f=e.width/c,p=e.height/c;this.flipEnabled()===!1?(u.translate(e.x,e.y),u.rotate(e.rotation),u.translate(e.width<0?e.width:0,e.height<0?e.height:0),u.scale(Math.abs(f),Math.abs(p))):(u.translate(e.x,e.y),u.rotate(e.rotation),u.scale(f,p));const m=u.multiply(d.invert());this._nodes.forEach(y=>{var w;if(!y.getStage())return;const _=y.getParent().getAbsoluteTransform(),x=y.getTransform().copy();x.translate(y.offsetX(),y.offsetY());const v=new pr;v.multiply(_.copy().invert()).multiply(m).multiply(_).multiply(x);const S=v.decompose();y.setAttrs(S),(w=y.getLayer())===null||w===void 0||w.batchDraw()}),this.rotation($._getRotation(e.rotation)),this._nodes.forEach(y=>{this._fire("transform",{evt:t,target:y}),y._fire("transform",{evt:t,target:y})}),this._resetTransformCache(),this.update(),this.getLayer().batchDraw()}forceUpdate(){this._resetTransformCache(),this.update()}_batchChangeChild(e,t){this.findOne(e).setAttrs(t)}update(){var e;const t=this._getNodeRect();this.rotation($._getRotation(t.rotation));const n=t.width,i=t.height,l=this.enabledAnchors(),c=this.resizeEnabled(),d=this.padding(),u=this.anchorSize(),f=this.find("._anchor");f.forEach(D=>{D.setAttrs({width:u,height:u,offsetX:u/2,offsetY:u/2,stroke:this.anchorStroke(),strokeWidth:this.anchorStrokeWidth(),fill:this.anchorFill(),cornerRadius:this.anchorCornerRadius()})}),this._batchChangeChild(".top-left",{x:0,y:0,offsetX:u/2+d,offsetY:u/2+d,visible:c&&l.indexOf("top-left")>=0}),this._batchChangeChild(".top-center",{x:n/2,y:0,offsetY:u/2+d,visible:c&&l.indexOf("top-center")>=0}),this._batchChangeChild(".top-right",{x:n,y:0,offsetX:u/2-d,offsetY:u/2+d,visible:c&&l.indexOf("top-right")>=0}),this._batchChangeChild(".middle-left",{x:0,y:i/2,offsetX:u/2+d,visible:c&&l.indexOf("middle-left")>=0}),this._batchChangeChild(".middle-right",{x:n,y:i/2,offsetX:u/2-d,visible:c&&l.indexOf("middle-right")>=0}),this._batchChangeChild(".bottom-left",{x:0,y:i,offsetX:u/2+d,offsetY:u/2-d,visible:c&&l.indexOf("bottom-left")>=0}),this._batchChangeChild(".bottom-center",{x:n/2,y:i,offsetY:u/2-d,visible:c&&l.indexOf("bottom-center")>=0}),this._batchChangeChild(".bottom-right",{x:n,y:i,offsetX:u/2-d,offsetY:u/2-d,visible:c&&l.indexOf("bottom-right")>=0});const p=this.rotateAnchorAngle(),m=this.rotateAnchorOffset(),y=$.degToRad(p),w=Math.sin(y),_=-Math.cos(y),x=n/2,v=i/2;let S=1/0;_<0?S=Math.min(S,-v/_):_>0&&(S=Math.min(S,(i-v)/_)),w<0?S=Math.min(S,-x/w):w>0&&(S=Math.min(S,(n-x)/w));const C=x+w*S,k=v+_*S,E=$._sign(i);this._batchChangeChild(".rotater",{x:C+w*m*E,y:k+_*m*E-d*_,visible:this.rotateEnabled()}),this._batchChangeChild(".back",{width:n,height:i,visible:this.borderEnabled(),stroke:this.borderStroke(),strokeWidth:this.borderStrokeWidth(),dash:this.borderDash(),draggable:this.nodes().some(D=>D.draggable()),x:0,y:0});const P=this.anchorStyleFunc();P&&f.forEach(D=>{P(D)}),(e=this.getLayer())===null||e===void 0||e.batchDraw()}isTransforming(){return this._transforming}stopTransform(){if(this._transforming){this._removeEvents();const e=this.findOne("."+this._movingAnchorName);e&&e.stopDrag()}}destroy(){return this.getStage()&&this._cursorChange&&this.getStage().content&&(this.getStage().content.style.cursor=""),xi.prototype.destroy.call(this),this.detach(),this._removeEvents(),this}toObject(){return ve.prototype.toObject.call(this)}clone(e){return ve.prototype.clone.call(this,e)}getClientRect(){return this.nodes().length>0?super.getClientRect():{x:0,y:0,width:0,height:0}}}Ye.isTransforming=()=>Pd>0;function W6(r){return r instanceof Array||$.warn("enabledAnchors value should be an array"),r instanceof Array&&r.forEach(function(e){Qo.indexOf(e)===-1&&$.warn("Unknown anchor name: "+e+". Available names are: "+Qo.join(", "))}),r||[]}Ye.prototype.className="Transformer";kt(Ye);F.addGetterSetter(Ye,"enabledAnchors",Qo,W6);F.addGetterSetter(Ye,"flipEnabled",!0,$r());F.addGetterSetter(Ye,"resizeEnabled",!0);F.addGetterSetter(Ye,"anchorSize",10,ge());F.addGetterSetter(Ye,"rotateEnabled",!0);F.addGetterSetter(Ye,"rotateLineVisible",!0);F.addGetterSetter(Ye,"rotationSnaps",[]);F.addGetterSetter(Ye,"rotateAnchorOffset",50,ge());F.addGetterSetter(Ye,"rotateAnchorAngle",0,ge());F.addGetterSetter(Ye,"rotateAnchorCursor","crosshair");F.addGetterSetter(Ye,"rotationSnapTolerance",5,ge());F.addGetterSetter(Ye,"borderEnabled",!0);F.addGetterSetter(Ye,"anchorStroke","rgb(0, 161, 255)");F.addGetterSetter(Ye,"anchorStrokeWidth",1,ge());F.addGetterSetter(Ye,"anchorFill","white");F.addGetterSetter(Ye,"anchorCornerRadius",0,ge());F.addGetterSetter(Ye,"borderStroke","rgb(0, 161, 255)");F.addGetterSetter(Ye,"borderStrokeWidth",1,ge());F.addGetterSetter(Ye,"borderDash");F.addGetterSetter(Ye,"keepRatio",!0);F.addGetterSetter(Ye,"shiftBehavior","default");F.addGetterSetter(Ye,"centeredScaling",!1);F.addGetterSetter(Ye,"ignoreStroke",!1);F.addGetterSetter(Ye,"padding",0,ge());F.addGetterSetter(Ye,"nodes");F.addGetterSetter(Ye,"node");F.addGetterSetter(Ye,"boundBoxFunc");F.addGetterSetter(Ye,"anchorDragBoundFunc");F.addGetterSetter(Ye,"anchorStyleFunc");F.addGetterSetter(Ye,"shouldOverdrawWholeArea",!1);F.addGetterSetter(Ye,"useSingleNodeRotation",!0);F.backCompat(Ye,{lineEnabled:"borderEnabled",rotateHandlerOffset:"rotateAnchorOffset",enabledHandlers:"enabledAnchors"});class An extends he{_sceneFunc(e){e.beginPath(),e.arc(0,0,this.radius(),0,we.getAngle(this.angle()),this.clockwise()),e.lineTo(0,0),e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(e){this.radius(e/2)}setHeight(e){this.radius(e/2)}}An.prototype.className="Wedge";An.prototype._centroid=!0;An.prototype._attrsAffectingSize=["radius"];kt(An);F.addGetterSetter(An,"radius",0,ge());F.addGetterSetter(An,"angle",0,ge());F.addGetterSetter(An,"clockwise",!1);F.backCompat(An,{angleDeg:"angle",getAngleDeg:"getAngle",setAngleDeg:"setAngle"});function vp(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}const V6=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],$6=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];function Y6(r,e){const t=r.data,n=r.width,i=r.height;let l,c,d,u,f,p,m,y,w,_,x,v,S,C,k,E,P,D,I,B;const z=e+e+1,X=n-1,se=i-1,R=e+1,H=R*(R+1)/2,j=new vp,G=V6[e],Q=$6[e];let K=null,J=j,ee=null,be=null;for(let V=1;V<z;V++)J=J.next=new vp,V===R&&(K=J);J.next=j,d=c=0;for(let V=0;V<i;V++){v=S=C=k=u=f=p=m=0,y=R*(E=t[c]),w=R*(P=t[c+1]),_=R*(D=t[c+2]),x=R*(I=t[c+3]),u+=H*E,f+=H*P,p+=H*D,m+=H*I,J=j;for(let Y=0;Y<R;Y++)J.r=E,J.g=P,J.b=D,J.a=I,J=J.next;for(let Y=1;Y<R;Y++)l=c+((X<Y?X:Y)<<2),u+=(J.r=E=t[l])*(B=R-Y),f+=(J.g=P=t[l+1])*B,p+=(J.b=D=t[l+2])*B,m+=(J.a=I=t[l+3])*B,v+=E,S+=P,C+=D,k+=I,J=J.next;ee=j,be=K;for(let Y=0;Y<n;Y++)t[c+3]=I=m*G>>Q,I!==0?(I=255/I,t[c]=(u*G>>Q)*I,t[c+1]=(f*G>>Q)*I,t[c+2]=(p*G>>Q)*I):t[c]=t[c+1]=t[c+2]=0,u-=y,f-=w,p-=_,m-=x,y-=ee.r,w-=ee.g,_-=ee.b,x-=ee.a,l=d+((l=Y+e+1)<X?l:X)<<2,v+=ee.r=t[l],S+=ee.g=t[l+1],C+=ee.b=t[l+2],k+=ee.a=t[l+3],u+=v,f+=S,p+=C,m+=k,ee=ee.next,y+=E=be.r,w+=P=be.g,_+=D=be.b,x+=I=be.a,v-=E,S-=P,C-=D,k-=I,be=be.next,c+=4;d+=n}for(let V=0;V<n;V++){S=C=k=v=f=p=m=u=0,c=V<<2,y=R*(E=t[c]),w=R*(P=t[c+1]),_=R*(D=t[c+2]),x=R*(I=t[c+3]),u+=H*E,f+=H*P,p+=H*D,m+=H*I,J=j;for(let Se=0;Se<R;Se++)J.r=E,J.g=P,J.b=D,J.a=I,J=J.next;let Y=n;for(let Se=1;Se<=e;Se++)c=Y+V<<2,u+=(J.r=E=t[c])*(B=R-Se),f+=(J.g=P=t[c+1])*B,p+=(J.b=D=t[c+2])*B,m+=(J.a=I=t[c+3])*B,v+=E,S+=P,C+=D,k+=I,J=J.next,Se<se&&(Y+=n);c=V,ee=j,be=K;for(let Se=0;Se<i;Se++)l=c<<2,t[l+3]=I=m*G>>Q,I>0?(I=255/I,t[l]=(u*G>>Q)*I,t[l+1]=(f*G>>Q)*I,t[l+2]=(p*G>>Q)*I):t[l]=t[l+1]=t[l+2]=0,u-=y,f-=w,p-=_,m-=x,y-=ee.r,w-=ee.g,_-=ee.b,x-=ee.a,l=V+((l=Se+R)<se?l:se)*n<<2,u+=v+=ee.r=t[l],f+=S+=ee.g=t[l+1],p+=C+=ee.b=t[l+2],m+=k+=ee.a=t[l+3],ee=ee.next,y+=E=be.r,w+=P=be.g,_+=D=be.b,x+=I=be.a,v-=E,S-=P,C-=D,k-=I,be=be.next,c+=n}}const X6=function(e){const t=Math.round(this.blurRadius());t>0&&Y6(e,t)};F.addGetterSetter(ve,"blurRadius",0,ge(),F.afterSetFilter);const q6=function(r){const e=this.brightness()*255,t=r.data,n=t.length;for(let i=0;i<n;i+=4)t[i]+=e,t[i+1]+=e,t[i+2]+=e};F.addGetterSetter(ve,"brightness",0,ge(),F.afterSetFilter);const K6=function(r){const e=this.brightness(),t=r.data,n=t.length;for(let i=0;i<n;i+=4)t[i]=Math.min(255,t[i]*e),t[i+1]=Math.min(255,t[i+1]*e),t[i+2]=Math.min(255,t[i+2]*e)},Q6=function(r){const e=Math.pow((this.contrast()+100)/100,2),t=r.data,n=t.length;let i=150,l=150,c=150;for(let d=0;d<n;d+=4)i=t[d],l=t[d+1],c=t[d+2],i/=255,i-=.5,i*=e,i+=.5,i*=255,l/=255,l-=.5,l*=e,l+=.5,l*=255,c/=255,c-=.5,c*=e,c+=.5,c*=255,i=i<0?0:i>255?255:i,l=l<0?0:l>255?255:l,c=c<0?0:c>255?255:c,t[d]=i,t[d+1]=l,t[d+2]=c};F.addGetterSetter(ve,"contrast",0,ge(),F.afterSetFilter);const Z6=function(r){var e,t,n,i,l,c,d,u,f;const p=r.data,m=r.width,y=r.height,w=Math.min(1,Math.max(0,(t=(e=this.embossStrength)===null||e===void 0?void 0:e.call(this))!==null&&t!==void 0?t:.5)),_=Math.min(1,Math.max(0,(i=(n=this.embossWhiteLevel)===null||n===void 0?void 0:n.call(this))!==null&&i!==void 0?i:.5)),v=(d={"top-left":315,top:270,"top-right":225,right:180,"bottom-right":135,bottom:90,"bottom-left":45,left:0}[(c=(l=this.embossDirection)===null||l===void 0?void 0:l.call(this))!==null&&c!==void 0?c:"top-left"])!==null&&d!==void 0?d:315,S=!!((f=(u=this.embossBlend)===null||u===void 0?void 0:u.call(this))!==null&&f!==void 0&&f),C=w*10,k=_*255,E=v*Math.PI/180,P=Math.cos(E),D=Math.sin(E),I=128/1020*C,B=new Uint8ClampedArray(p),z=new Float32Array(m*y);for(let j=0,G=0;G<p.length;G+=4,j++)z[j]=.2126*B[G]+.7152*B[G+1]+.0722*B[G+2];const X=[-1,0,1,-2,0,2,-1,0,1],se=[-1,-2,-1,0,0,0,1,2,1],R=[-m-1,-m,-m+1,-1,0,1,m-1,m,m+1],H=j=>j<0?0:j>255?255:j;for(let j=1;j<y-1;j++)for(let G=1;G<m-1;G++){const Q=j*m+G;let K=0,J=0;K+=z[Q+R[0]]*X[0],J+=z[Q+R[0]]*se[0],K+=z[Q+R[1]]*X[1],J+=z[Q+R[1]]*se[1],K+=z[Q+R[2]]*X[2],J+=z[Q+R[2]]*se[2],K+=z[Q+R[3]]*X[3],J+=z[Q+R[3]]*se[3],K+=z[Q+R[5]]*X[5],J+=z[Q+R[5]]*se[5],K+=z[Q+R[6]]*X[6],J+=z[Q+R[6]]*se[6],K+=z[Q+R[7]]*X[7],J+=z[Q+R[7]]*se[7],K+=z[Q+R[8]]*X[8],J+=z[Q+R[8]]*se[8];const ee=P*K+D*J,be=H(k+ee*I),V=Q*4;if(S){const Y=be-k;p[V]=H(B[V]+Y),p[V+1]=H(B[V+1]+Y),p[V+2]=H(B[V+2]+Y),p[V+3]=B[V+3]}else p[V]=p[V+1]=p[V+2]=be,p[V+3]=B[V+3]}for(let j=0;j<m;j++){let G=j*4,Q=((y-1)*m+j)*4;p[G]=B[G],p[G+1]=B[G+1],p[G+2]=B[G+2],p[G+3]=B[G+3],p[Q]=B[Q],p[Q+1]=B[Q+1],p[Q+2]=B[Q+2],p[Q+3]=B[Q+3]}for(let j=1;j<y-1;j++){let G=j*m*4,Q=(j*m+(m-1))*4;p[G]=B[G],p[G+1]=B[G+1],p[G+2]=B[G+2],p[G+3]=B[G+3],p[Q]=B[Q],p[Q+1]=B[Q+1],p[Q+2]=B[Q+2],p[Q+3]=B[Q+3]}return r};F.addGetterSetter(ve,"embossStrength",.5,ge(),F.afterSetFilter);F.addGetterSetter(ve,"embossWhiteLevel",.5,ge(),F.afterSetFilter);F.addGetterSetter(ve,"embossDirection","top-left",void 0,F.afterSetFilter);F.addGetterSetter(ve,"embossBlend",!1,void 0,F.afterSetFilter);function Jc(r,e,t,n,i){const l=t-e,c=i-n;if(l===0)return n+c/2;if(c===0)return n;let d=(r-e)/l;return d=c*d+n,d}const J6=function(r){const e=r.data,t=e.length;let n=e[0],i=n,l,c=e[1],d=c,u,f=e[2],p=f,m;const y=this.enhance();if(y===0)return;for(let k=0;k<t;k+=4)l=e[k+0],l<n?n=l:l>i&&(i=l),u=e[k+1],u<c?c=u:u>d&&(d=u),m=e[k+2],m<f?f=m:m>p&&(p=m);i===n&&(i=255,n=0),d===c&&(d=255,c=0),p===f&&(p=255,f=0);let w,_,x,v,S,C;if(y>0)w=i+y*(255-i),_=n-y*(n-0),x=d+y*(255-d),v=c-y*(c-0),S=p+y*(255-p),C=f-y*(f-0);else{const k=(i+n)*.5;w=i+y*(i-k),_=n+y*(n-k);const E=(d+c)*.5;x=d+y*(d-E),v=c+y*(c-E);const P=(p+f)*.5;S=p+y*(p-P),C=f+y*(f-P)}for(let k=0;k<t;k+=4)e[k+0]=Jc(e[k+0],n,i,_,w),e[k+1]=Jc(e[k+1],c,d,v,x),e[k+2]=Jc(e[k+2],f,p,C,S)};F.addGetterSetter(ve,"enhance",0,ge(),F.afterSetFilter);const e8=function(r){const e=r.data,t=e.length;for(let n=0;n<t;n+=4){const i=.34*e[n]+.5*e[n+1]+.16*e[n+2];e[n]=i,e[n+1]=i,e[n+2]=i}};F.addGetterSetter(ve,"hue",0,ge(),F.afterSetFilter);F.addGetterSetter(ve,"saturation",0,ge(),F.afterSetFilter);F.addGetterSetter(ve,"luminance",0,ge(),F.afterSetFilter);const t8=function(r){const e=r.data,t=e.length,n=1,i=Math.pow(2,this.saturation()),l=Math.abs(this.hue()+360)%360,c=this.luminance()*127,d=n*i*Math.cos(l*Math.PI/180),u=n*i*Math.sin(l*Math.PI/180),f=.299*n+.701*d+.167*u,p=.587*n-.587*d+.33*u,m=.114*n-.114*d-.497*u,y=.299*n-.299*d-.328*u,w=.587*n+.413*d+.035*u,_=.114*n-.114*d+.293*u,x=.299*n-.3*d+1.25*u,v=.587*n-.586*d-1.05*u,S=.114*n+.886*d-.2*u;let C,k,E,P;for(let D=0;D<t;D+=4)C=e[D+0],k=e[D+1],E=e[D+2],P=e[D+3],e[D+0]=f*C+p*k+m*E+c,e[D+1]=y*C+w*k+_*E+c,e[D+2]=x*C+v*k+S*E+c,e[D+3]=P},r8=function(r){const e=r.data,t=e.length,n=Math.pow(2,this.value()),i=Math.pow(2,this.saturation()),l=Math.abs(this.hue()+360)%360,c=n*i*Math.cos(l*Math.PI/180),d=n*i*Math.sin(l*Math.PI/180),u=.299*n+.701*c+.167*d,f=.587*n-.587*c+.33*d,p=.114*n-.114*c-.497*d,m=.299*n-.299*c-.328*d,y=.587*n+.413*c+.035*d,w=.114*n-.114*c+.293*d,_=.299*n-.3*c+1.25*d,x=.587*n-.586*c-1.05*d,v=.114*n+.886*c-.2*d;for(let S=0;S<t;S+=4){const C=e[S+0],k=e[S+1],E=e[S+2],P=e[S+3];e[S+0]=u*C+f*k+p*E,e[S+1]=m*C+y*k+w*E,e[S+2]=_*C+x*k+v*E,e[S+3]=P}};F.addGetterSetter(ve,"hue",0,ge(),F.afterSetFilter);F.addGetterSetter(ve,"saturation",0,ge(),F.afterSetFilter);F.addGetterSetter(ve,"value",0,ge(),F.afterSetFilter);const n8=function(r){const e=r.data,t=e.length;for(let n=0;n<t;n+=4)e[n]=255-e[n],e[n+1]=255-e[n+1],e[n+2]=255-e[n+2]},s8=function(r,e,t){const n=r.data,i=e.data,l=r.width,c=r.height,d=t.polarCenterX||l/2,u=t.polarCenterY||c/2;let f=Math.sqrt(d*d+u*u),p=l-d,m=c-u;const y=Math.sqrt(p*p+m*m);f=y>f?y:f;const w=c,_=l,x=360/_*Math.PI/180;for(let v=0;v<_;v+=1){const S=Math.sin(v*x),C=Math.cos(v*x);for(let k=0;k<w;k+=1){p=Math.floor(d+f*k/w*C),m=Math.floor(u+f*k/w*S);let E=(m*l+p)*4;const P=n[E+0],D=n[E+1],I=n[E+2],B=n[E+3];E=(v+k*l)*4,i[E+0]=P,i[E+1]=D,i[E+2]=I,i[E+3]=B}}},i8=function(r,e,t){const n=r.data,i=e.data,l=r.width,c=r.height,d=t.polarCenterX||l/2,u=t.polarCenterY||c/2;let f=Math.sqrt(d*d+u*u),p=l-d,m=c-u;const y=Math.sqrt(p*p+m*m);f=y>f?y:f;const w=c,_=l,x=0;let v,S;for(p=0;p<l;p+=1)for(m=0;m<c;m+=1){const C=p-d,k=m-u,E=Math.sqrt(C*C+k*k)*w/f;let P=(Math.atan2(k,C)*180/Math.PI+360+x)%360;P=P*_/360,v=Math.floor(P),S=Math.floor(E);let D=(S*l+v)*4;const I=n[D+0],B=n[D+1],z=n[D+2],X=n[D+3];D=(m*l+p)*4,i[D+0]=I,i[D+1]=B,i[D+2]=z,i[D+3]=X}},a8=function(r){const e=r.width,t=r.height;let n,i,l,c,d,u,f,p,m,y,w=Math.round(this.kaleidoscopePower());const _=Math.round(this.kaleidoscopeAngle()),x=Math.floor(e*(_%360)/360);if(w<1)return;const v=$.createCanvasElement();v.width=e,v.height=t;const S=v.getContext("2d").getImageData(0,0,e,t);$.releaseCanvas(v),s8(r,S,{polarCenterX:e/2,polarCenterY:t/2});let C=e/Math.pow(2,w);for(;C<=8;)C=C*2,w-=1;C=Math.ceil(C);let k=C,E=0,P=k,D=1;for(x+C>e&&(E=k,P=0,D=-1),i=0;i<t;i+=1)for(n=E;n!==P;n+=D)l=Math.round(n+x)%e,m=(e*i+l)*4,d=S.data[m+0],u=S.data[m+1],f=S.data[m+2],p=S.data[m+3],y=(e*i+n)*4,S.data[y+0]=d,S.data[y+1]=u,S.data[y+2]=f,S.data[y+3]=p;for(i=0;i<t;i+=1)for(k=Math.floor(C),c=0;c<w;c+=1){for(n=0;n<k+1;n+=1)m=(e*i+n)*4,d=S.data[m+0],u=S.data[m+1],f=S.data[m+2],p=S.data[m+3],y=(e*i+k*2-n-1)*4,S.data[y+0]=d,S.data[y+1]=u,S.data[y+2]=f,S.data[y+3]=p;k*=2}i8(S,r,{})};F.addGetterSetter(ve,"kaleidoscopePower",2,ge(),F.afterSetFilter);F.addGetterSetter(ve,"kaleidoscopeAngle",0,ge(),F.afterSetFilter);function Mo(r,e,t){let n=(t*r.width+e)*4;const i=[];return i.push(r.data[n++],r.data[n++],r.data[n++],r.data[n++]),i}function Yi(r,e){return Math.sqrt(Math.pow(r[0]-e[0],2)+Math.pow(r[1]-e[1],2)+Math.pow(r[2]-e[2],2))}function o8(r){const e=[0,0,0];for(let t=0;t<r.length;t++)e[0]+=r[t][0],e[1]+=r[t][1],e[2]+=r[t][2];return e[0]/=r.length,e[1]/=r.length,e[2]/=r.length,e}function l8(r,e){const t=Mo(r,0,0),n=Mo(r,r.width-1,0),i=Mo(r,0,r.height-1),l=Mo(r,r.width-1,r.height-1),c=e||10;if(Yi(t,n)<c&&Yi(n,l)<c&&Yi(l,i)<c&&Yi(i,t)<c){const d=o8([n,t,l,i]),u=[];for(let f=0;f<r.width*r.height;f++){const p=Yi(d,[r.data[f*4],r.data[f*4+1],r.data[f*4+2]]);u[f]=p<c?0:255}return u}}function c8(r,e){for(let t=0;t<r.width*r.height;t++)r.data[4*t+3]=e[t]}function d8(r,e,t){const n=[1,1,1,1,0,1,1,1,1],i=Math.round(Math.sqrt(n.length)),l=Math.floor(i/2),c=[];for(let d=0;d<t;d++)for(let u=0;u<e;u++){const f=d*e+u;let p=0;for(let m=0;m<i;m++)for(let y=0;y<i;y++){const w=d+m-l,_=u+y-l;if(w>=0&&w<t&&_>=0&&_<e){const x=w*e+_,v=n[m*i+y];p+=r[x]*v}}c[f]=p===255*8?255:0}return c}function u8(r,e,t){const n=[1,1,1,1,1,1,1,1,1],i=Math.round(Math.sqrt(n.length)),l=Math.floor(i/2),c=[];for(let d=0;d<t;d++)for(let u=0;u<e;u++){const f=d*e+u;let p=0;for(let m=0;m<i;m++)for(let y=0;y<i;y++){const w=d+m-l,_=u+y-l;if(w>=0&&w<t&&_>=0&&_<e){const x=w*e+_,v=n[m*i+y];p+=r[x]*v}}c[f]=p>=255*4?255:0}return c}function h8(r,e,t){const n=[.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111],i=Math.round(Math.sqrt(n.length)),l=Math.floor(i/2),c=[];for(let d=0;d<t;d++)for(let u=0;u<e;u++){const f=d*e+u;let p=0;for(let m=0;m<i;m++)for(let y=0;y<i;y++){const w=d+m-l,_=u+y-l;if(w>=0&&w<t&&_>=0&&_<e){const x=w*e+_,v=n[m*i+y];p+=r[x]*v}}c[f]=p}return c}const f8=function(r){const e=this.threshold();let t=l8(r,e);return t&&(t=d8(t,r.width,r.height),t=u8(t,r.width,r.height),t=h8(t,r.width,r.height),c8(r,t)),r};F.addGetterSetter(ve,"threshold",0,ge(),F.afterSetFilter);const p8=function(r){const e=this.noise()*255,t=r.data,n=t.length,i=e/2;for(let l=0;l<n;l+=4)t[l+0]+=i-2*i*Math.random(),t[l+1]+=i-2*i*Math.random(),t[l+2]+=i-2*i*Math.random()};F.addGetterSetter(ve,"noise",.2,ge(),F.afterSetFilter);const m8=function(r){let e=Math.ceil(this.pixelSize()),t=r.width,n=r.height,i=Math.ceil(t/e),l=Math.ceil(n/e),c=r.data;if(e<=0){$.error("pixelSize value can not be <= 0");return}for(let d=0;d<i;d+=1)for(let u=0;u<l;u+=1){let f=0,p=0,m=0,y=0;const w=d*e,_=w+e,x=u*e,v=x+e;let S=0;for(let C=w;C<_;C+=1)if(!(C>=t))for(let k=x;k<v;k+=1){if(k>=n)continue;const E=(t*k+C)*4;f+=c[E+0],p+=c[E+1],m+=c[E+2],y+=c[E+3],S+=1}f=f/S,p=p/S,m=m/S,y=y/S;for(let C=w;C<_;C+=1)if(!(C>=t))for(let k=x;k<v;k+=1){if(k>=n)continue;const E=(t*k+C)*4;c[E+0]=f,c[E+1]=p,c[E+2]=m,c[E+3]=y}}};F.addGetterSetter(ve,"pixelSize",8,ge(),F.afterSetFilter);const g8=function(r){const e=Math.round(this.levels()*254)+1,t=r.data,n=t.length,i=255/e;for(let l=0;l<n;l+=1)t[l]=Math.floor(t[l]/i)*i};F.addGetterSetter(ve,"levels",.5,ge(),F.afterSetFilter);const x8=function(r){const e=r.data,t=e.length,n=this.red(),i=this.green(),l=this.blue();for(let c=0;c<t;c+=4){const d=(.34*e[c]+.5*e[c+1]+.16*e[c+2])/255;e[c]=d*n,e[c+1]=d*i,e[c+2]=d*l,e[c+3]=e[c+3]}};F.addGetterSetter(ve,"red",0,function(r){return this._filterUpToDate=!1,r>255?255:r<0?0:Math.round(r)});F.addGetterSetter(ve,"green",0,function(r){return this._filterUpToDate=!1,r>255?255:r<0?0:Math.round(r)});F.addGetterSetter(ve,"blue",0,P0,F.afterSetFilter);const y8=function(r){const e=r.data,t=e.length,n=this.red(),i=this.green(),l=this.blue(),c=this.alpha();for(let d=0;d<t;d+=4){const u=1-c;e[d]=n*c+e[d]*u,e[d+1]=i*c+e[d+1]*u,e[d+2]=l*c+e[d+2]*u}};F.addGetterSetter(ve,"red",0,function(r){return this._filterUpToDate=!1,r>255?255:r<0?0:Math.round(r)});F.addGetterSetter(ve,"green",0,function(r){return this._filterUpToDate=!1,r>255?255:r<0?0:Math.round(r)});F.addGetterSetter(ve,"blue",0,P0,F.afterSetFilter);F.addGetterSetter(ve,"alpha",1,function(r){return this._filterUpToDate=!1,r>1?1:r<0?0:r});const v8=function(r){const e=r.data,t=e.length;for(let n=0;n<t;n+=4){const i=e[n+0],l=e[n+1],c=e[n+2];e[n+0]=Math.min(255,i*.393+l*.769+c*.189),e[n+1]=Math.min(255,i*.349+l*.686+c*.168),e[n+2]=Math.min(255,i*.272+l*.534+c*.131)}},w8=function(r){const t=r.data;for(let n=0;n<t.length;n+=4){const i=t[n],l=t[n+1],c=t[n+2];.2126*i+.7152*l+.0722*c>=128&&(t[n]=255-i,t[n+1]=255-l,t[n+2]=255-c)}return r},b8=function(r){const e=this.threshold()*255,t=r.data,n=t.length;for(let i=0;i<n;i+=1)t[i]=t[i]<e?0:255};F.addGetterSetter(ve,"threshold",.5,ge(),F.afterSetFilter);Ps.Util._assign(Ps,{Arc:En,Arrow:Rs,Circle:bi,Ellipse:ss,Image:yr,Label:gu,Tag:Ds,Line:Pn,Path:ft,Rect:Ca,RegularPolygon:is,Ring:Os,Sprite:un,Star:as,Text:mt,TextPath:Lt,Transformer:Ye,Wedge:An,Filters:{Blur:X6,Brightness:K6,Brighten:q6,Contrast:Q6,Emboss:Z6,Enhance:J6,Grayscale:e8,HSL:t8,HSV:r8,Invert:n8,Kaleidoscope:a8,Mask:f8,Noise:p8,Pixelate:m8,Posterize:g8,RGB:x8,RGBA:y8,Sepia:v8,Solarize:w8,Threshold:b8}});var a1={exports:{}};/**
 * @license React
 * react-reconciler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _8=function(e){var t={},n=T,i=Lo,l=Object.assign;function c(s){for(var o="https://reactjs.org/docs/error-decoder.html?invariant="+s,h=1;h<arguments.length;h++)o+="&args[]="+encodeURIComponent(arguments[h]);return"Minified React error #"+s+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var d=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,u=Symbol.for("react.element"),f=Symbol.for("react.portal"),p=Symbol.for("react.fragment"),m=Symbol.for("react.strict_mode"),y=Symbol.for("react.profiler"),w=Symbol.for("react.provider"),_=Symbol.for("react.context"),x=Symbol.for("react.forward_ref"),v=Symbol.for("react.suspense"),S=Symbol.for("react.suspense_list"),C=Symbol.for("react.memo"),k=Symbol.for("react.lazy"),E=Symbol.for("react.offscreen"),P=Symbol.iterator;function D(s){return s===null||typeof s!="object"?null:(s=P&&s[P]||s["@@iterator"],typeof s=="function"?s:null)}function I(s){if(s==null)return null;if(typeof s=="function")return s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case p:return"Fragment";case f:return"Portal";case y:return"Profiler";case m:return"StrictMode";case v:return"Suspense";case S:return"SuspenseList"}if(typeof s=="object")switch(s.$$typeof){case _:return(s.displayName||"Context")+".Consumer";case w:return(s._context.displayName||"Context")+".Provider";case x:var o=s.render;return s=s.displayName,s||(s=o.displayName||o.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case C:return o=s.displayName||null,o!==null?o:I(s.type)||"Memo";case k:o=s._payload,s=s._init;try{return I(s(o))}catch{}}return null}function B(s){var o=s.type;switch(s.tag){case 24:return"Cache";case 9:return(o.displayName||"Context")+".Consumer";case 10:return(o._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return s=o.render,s=s.displayName||s.name||"",o.displayName||(s!==""?"ForwardRef("+s+")":"ForwardRef");case 7:return"Fragment";case 5:return o;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return I(o);case 8:return o===m?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof o=="function")return o.displayName||o.name||null;if(typeof o=="string")return o}return null}function z(s){var o=s,h=s;if(s.alternate)for(;o.return;)o=o.return;else{s=o;do o=s,o.flags&4098&&(h=o.return),s=o.return;while(s)}return o.tag===3?h:null}function X(s){if(z(s)!==s)throw Error(c(188))}function se(s){var o=s.alternate;if(!o){if(o=z(s),o===null)throw Error(c(188));return o!==s?null:s}for(var h=s,g=o;;){var b=h.return;if(b===null)break;var N=b.alternate;if(N===null){if(g=b.return,g!==null){h=g;continue}break}if(b.child===N.child){for(N=b.child;N;){if(N===h)return X(b),s;if(N===g)return X(b),o;N=N.sibling}throw Error(c(188))}if(h.return!==g.return)h=b,g=N;else{for(var O=!1,W=b.child;W;){if(W===h){O=!0,h=b,g=N;break}if(W===g){O=!0,g=b,h=N;break}W=W.sibling}if(!O){for(W=N.child;W;){if(W===h){O=!0,h=N,g=b;break}if(W===g){O=!0,g=N,h=b;break}W=W.sibling}if(!O)throw Error(c(189))}}if(h.alternate!==g)throw Error(c(190))}if(h.tag!==3)throw Error(c(188));return h.stateNode.current===h?s:o}function R(s){return s=se(s),s!==null?H(s):null}function H(s){if(s.tag===5||s.tag===6)return s;for(s=s.child;s!==null;){var o=H(s);if(o!==null)return o;s=s.sibling}return null}function j(s){if(s.tag===5||s.tag===6)return s;for(s=s.child;s!==null;){if(s.tag!==4){var o=j(s);if(o!==null)return o}s=s.sibling}return null}var G=Array.isArray,Q=e.getPublicInstance,K=e.getRootHostContext,J=e.getChildHostContext,ee=e.prepareForCommit,be=e.resetAfterCommit,V=e.createInstance,Y=e.appendInitialChild,Se=e.finalizeInitialChildren,Ce=e.prepareUpdate,ye=e.shouldSetTextContent,at=e.createTextInstance,gt=e.scheduleTimeout,Ge=e.cancelTimeout,He=e.noTimeout,ot=e.isPrimaryRenderer,Ue=e.supportsMutation,At=e.supportsPersistence,Qe=e.supportsHydration,A=e.getInstanceFromNode,oe=e.preparePortalMount,ne=e.getCurrentEventPriority,L=e.detachDeletedInstance,M=e.supportsMicrotasks,U=e.scheduleMicrotask,le=e.supportsTestSelectors,ue=e.findFiberRoot,Z=e.getBoundingRect,pe=e.getTextContent,ke=e.isHiddenSubtree,xe=e.matchAccessibilityRole,Oe=e.setFocusIfFocusable,tt=e.setupIntersectionObserver,Ve=e.appendChild,Et=e.appendChildToContainer,vr=e.commitTextUpdate,Yt=e.commitMount,hn=e.commitUpdate,De=e.insertBefore,_e=e.insertInContainerBefore,Re=e.removeChild,Me=e.removeChildFromContainer,Xe=e.resetTextContent,Ft=e.hideInstance,fe=e.hideTextInstance,Pe=e.unhideInstance,Fe=e.unhideTextInstance,Wt=e.clearContainer,Nt=e.cloneInstance,vu=e.createContainerChildSet,wu=e.appendChildToContainerChildSet,p1=e.finalizeContainerChildren,Cl=e.replaceContainerChildren,bu=e.cloneHiddenInstance,_u=e.cloneHiddenTextInstance,m1=e.canHydrateInstance,g1=e.canHydrateTextInstance,x1=e.canHydrateSuspenseInstance,Su=e.isSuspenseInstancePending,kl=e.isSuspenseInstanceFallback,y1=e.getSuspenseInstanceFallbackErrorDetails,v1=e.registerSuspenseInstanceRetry,ka=e.getNextHydratableSibling,w1=e.getFirstHydratableChild,b1=e.getFirstHydratableChildWithinContainer,_1=e.getFirstHydratableChildWithinSuspenseInstance,S1=e.hydrateInstance,C1=e.hydrateTextInstance,k1=e.hydrateSuspenseInstance,N1=e.getNextHydratableInstanceAfterSuspenseInstance,j1=e.commitHydratedContainer,E1=e.commitHydratedSuspenseInstance,P1=e.clearSuspenseBoundary,A1=e.clearSuspenseBoundaryFromContainer,T1=e.shouldDeleteUnhydratedTailInstances,R1=e.didNotMatchHydratedContainerTextInstance,D1=e.didNotMatchHydratedTextInstance,Nl;function _i(s){if(Nl===void 0)try{throw Error()}catch(h){var o=h.stack.trim().match(/\n( *(at )?)/);Nl=o&&o[1]||""}return`
`+Nl+s}var jl=!1;function El(s,o){if(!s||jl)return"";jl=!0;var h=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(o)if(o=function(){throw Error()},Object.defineProperty(o.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(o,[])}catch(me){var g=me}Reflect.construct(s,[],o)}else{try{o.call()}catch(me){g=me}s.call(o.prototype)}else{try{throw Error()}catch(me){g=me}s()}}catch(me){if(me&&g&&typeof me.stack=="string"){for(var b=me.stack.split(`
`),N=g.stack.split(`
`),O=b.length-1,W=N.length-1;1<=O&&0<=W&&b[O]!==N[W];)W--;for(;1<=O&&0<=W;O--,W--)if(b[O]!==N[W]){if(O!==1||W!==1)do if(O--,W--,0>W||b[O]!==N[W]){var re=`
`+b[O].replace(" at new "," at ");return s.displayName&&re.includes("<anonymous>")&&(re=re.replace("<anonymous>",s.displayName)),re}while(1<=O&&0<=W);break}}}finally{jl=!1,Error.prepareStackTrace=h}return(s=s?s.displayName||s.name:"")?_i(s):""}var O1=Object.prototype.hasOwnProperty,Pl=[],Ms=-1;function Tn(s){return{current:s}}function xt(s){0>Ms||(s.current=Pl[Ms],Pl[Ms]=null,Ms--)}function ut(s,o){Ms++,Pl[Ms]=s.current,s.current=o}var Rn={},Xt=Tn(Rn),nr=Tn(!1),ls=Rn;function Ls(s,o){var h=s.type.contextTypes;if(!h)return Rn;var g=s.stateNode;if(g&&g.__reactInternalMemoizedUnmaskedChildContext===o)return g.__reactInternalMemoizedMaskedChildContext;var b={},N;for(N in h)b[N]=o[N];return g&&(s=s.stateNode,s.__reactInternalMemoizedUnmaskedChildContext=o,s.__reactInternalMemoizedMaskedChildContext=b),b}function sr(s){return s=s.childContextTypes,s!=null}function Na(){xt(nr),xt(Xt)}function Cu(s,o,h){if(Xt.current!==Rn)throw Error(c(168));ut(Xt,o),ut(nr,h)}function ku(s,o,h){var g=s.stateNode;if(o=o.childContextTypes,typeof g.getChildContext!="function")return h;g=g.getChildContext();for(var b in g)if(!(b in o))throw Error(c(108,B(s)||"Unknown",b));return l({},h,g)}function ja(s){return s=(s=s.stateNode)&&s.__reactInternalMemoizedMergedChildContext||Rn,ls=Xt.current,ut(Xt,s),ut(nr,nr.current),!0}function Nu(s,o,h){var g=s.stateNode;if(!g)throw Error(c(169));h?(s=ku(s,o,ls),g.__reactInternalMemoizedMergedChildContext=s,xt(nr),xt(Xt),ut(Xt,s)):xt(nr),ut(nr,h)}var Dr=Math.clz32?Math.clz32:L1,I1=Math.log,M1=Math.LN2;function L1(s){return s>>>=0,s===0?32:31-(I1(s)/M1|0)|0}var Ea=64,Pa=4194304;function Si(s){switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return s&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return s}}function Aa(s,o){var h=s.pendingLanes;if(h===0)return 0;var g=0,b=s.suspendedLanes,N=s.pingedLanes,O=h&268435455;if(O!==0){var W=O&~b;W!==0?g=Si(W):(N&=O,N!==0&&(g=Si(N)))}else O=h&~b,O!==0?g=Si(O):N!==0&&(g=Si(N));if(g===0)return 0;if(o!==0&&o!==g&&!(o&b)&&(b=g&-g,N=o&-o,b>=N||b===16&&(N&4194240)!==0))return o;if(g&4&&(g|=h&16),o=s.entangledLanes,o!==0)for(s=s.entanglements,o&=g;0<o;)h=31-Dr(o),b=1<<h,g|=s[h],o&=~b;return g}function F1(s,o){switch(s){case 1:case 2:case 4:return o+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function z1(s,o){for(var h=s.suspendedLanes,g=s.pingedLanes,b=s.expirationTimes,N=s.pendingLanes;0<N;){var O=31-Dr(N),W=1<<O,re=b[O];re===-1?(!(W&h)||W&g)&&(b[O]=F1(W,o)):re<=o&&(s.expiredLanes|=W),N&=~W}}function Al(s){return s=s.pendingLanes&-1073741825,s!==0?s:s&1073741824?1073741824:0}function ju(){var s=Ea;return Ea<<=1,!(Ea&4194240)&&(Ea=64),s}function Tl(s){for(var o=[],h=0;31>h;h++)o.push(s);return o}function Ci(s,o,h){s.pendingLanes|=o,o!==536870912&&(s.suspendedLanes=0,s.pingedLanes=0),s=s.eventTimes,o=31-Dr(o),s[o]=h}function B1(s,o){var h=s.pendingLanes&~o;s.pendingLanes=o,s.suspendedLanes=0,s.pingedLanes=0,s.expiredLanes&=o,s.mutableReadLanes&=o,s.entangledLanes&=o,o=s.entanglements;var g=s.eventTimes;for(s=s.expirationTimes;0<h;){var b=31-Dr(h),N=1<<b;o[b]=0,g[b]=-1,s[b]=-1,h&=~N}}function Rl(s,o){var h=s.entangledLanes|=o;for(s=s.entanglements;h;){var g=31-Dr(h),b=1<<g;b&o|s[g]&o&&(s[g]|=o),h&=~b}}var Ze=0;function Eu(s){return s&=-s,1<s?4<s?s&268435455?16:536870912:4:1}var Dl=i.unstable_scheduleCallback,Pu=i.unstable_cancelCallback,G1=i.unstable_shouldYield,H1=i.unstable_requestPaint,zt=i.unstable_now,Ol=i.unstable_ImmediatePriority,U1=i.unstable_UserBlockingPriority,Il=i.unstable_NormalPriority,W1=i.unstable_IdlePriority,Ta=null,Yr=null;function V1(s){if(Yr&&typeof Yr.onCommitFiberRoot=="function")try{Yr.onCommitFiberRoot(Ta,s,void 0,(s.current.flags&128)===128)}catch{}}function $1(s,o){return s===o&&(s!==0||1/s===1/o)||s!==s&&o!==o}var Or=typeof Object.is=="function"?Object.is:$1,fn=null,Ra=!1,Ml=!1;function Au(s){fn===null?fn=[s]:fn.push(s)}function Y1(s){Ra=!0,Au(s)}function Xr(){if(!Ml&&fn!==null){Ml=!0;var s=0,o=Ze;try{var h=fn;for(Ze=1;s<h.length;s++){var g=h[s];do g=g(!0);while(g!==null)}fn=null,Ra=!1}catch(b){throw fn!==null&&(fn=fn.slice(s+1)),Dl(Ol,Xr),b}finally{Ze=o,Ml=!1}}return null}var Fs=[],zs=0,Da=null,Oa=0,wr=[],br=0,cs=null,pn=1,mn="";function ds(s,o){Fs[zs++]=Oa,Fs[zs++]=Da,Da=s,Oa=o}function Tu(s,o,h){wr[br++]=pn,wr[br++]=mn,wr[br++]=cs,cs=s;var g=pn;s=mn;var b=32-Dr(g)-1;g&=~(1<<b),h+=1;var N=32-Dr(o)+b;if(30<N){var O=b-b%5;N=(g&(1<<O)-1).toString(32),g>>=O,b-=O,pn=1<<32-Dr(o)+b|h<<b|g,mn=N+s}else pn=1<<N|h<<b|g,mn=s}function Ll(s){s.return!==null&&(ds(s,1),Tu(s,1,0))}function Fl(s){for(;s===Da;)Da=Fs[--zs],Fs[zs]=null,Oa=Fs[--zs],Fs[zs]=null;for(;s===cs;)cs=wr[--br],wr[br]=null,mn=wr[--br],wr[br]=null,pn=wr[--br],wr[br]=null}var ur=null,_r=null,wt=!1,ki=!1,Ir=null;function Ru(s,o){var h=jr(5,null,null,0);h.elementType="DELETED",h.stateNode=o,h.return=s,o=s.deletions,o===null?(s.deletions=[h],s.flags|=16):o.push(h)}function Du(s,o){switch(s.tag){case 5:return o=m1(o,s.type,s.pendingProps),o!==null?(s.stateNode=o,ur=s,_r=w1(o),!0):!1;case 6:return o=g1(o,s.pendingProps),o!==null?(s.stateNode=o,ur=s,_r=null,!0):!1;case 13:if(o=x1(o),o!==null){var h=cs!==null?{id:pn,overflow:mn}:null;return s.memoizedState={dehydrated:o,treeContext:h,retryLane:1073741824},h=jr(18,null,null,0),h.stateNode=o,h.return=s,s.child=h,ur=s,_r=null,!0}return!1;default:return!1}}function zl(s){return(s.mode&1)!==0&&(s.flags&128)===0}function Bl(s){if(wt){var o=_r;if(o){var h=o;if(!Du(s,o)){if(zl(s))throw Error(c(418));o=ka(h);var g=ur;o&&Du(s,o)?Ru(g,h):(s.flags=s.flags&-4097|2,wt=!1,ur=s)}}else{if(zl(s))throw Error(c(418));s.flags=s.flags&-4097|2,wt=!1,ur=s}}}function Ou(s){for(s=s.return;s!==null&&s.tag!==5&&s.tag!==3&&s.tag!==13;)s=s.return;ur=s}function Ia(s){if(!Qe||s!==ur)return!1;if(!wt)return Ou(s),wt=!0,!1;if(s.tag!==3&&(s.tag!==5||T1(s.type)&&!ye(s.type,s.memoizedProps))){var o=_r;if(o){if(zl(s))throw Iu(),Error(c(418));for(;o;)Ru(s,o),o=ka(o)}}if(Ou(s),s.tag===13){if(!Qe)throw Error(c(316));if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(c(317));_r=N1(s)}else _r=ur?ka(s.stateNode):null;return!0}function Iu(){for(var s=_r;s;)s=ka(s)}function Bs(){Qe&&(_r=ur=null,ki=wt=!1)}function Gl(s){Ir===null?Ir=[s]:Ir.push(s)}var X1=d.ReactCurrentBatchConfig;function Ma(s,o){if(Or(s,o))return!0;if(typeof s!="object"||s===null||typeof o!="object"||o===null)return!1;var h=Object.keys(s),g=Object.keys(o);if(h.length!==g.length)return!1;for(g=0;g<h.length;g++){var b=h[g];if(!O1.call(o,b)||!Or(s[b],o[b]))return!1}return!0}function q1(s){switch(s.tag){case 5:return _i(s.type);case 16:return _i("Lazy");case 13:return _i("Suspense");case 19:return _i("SuspenseList");case 0:case 2:case 15:return s=El(s.type,!1),s;case 11:return s=El(s.type.render,!1),s;case 1:return s=El(s.type,!0),s;default:return""}}function Ni(s,o,h){if(s=h.ref,s!==null&&typeof s!="function"&&typeof s!="object"){if(h._owner){if(h=h._owner,h){if(h.tag!==1)throw Error(c(309));var g=h.stateNode}if(!g)throw Error(c(147,s));var b=g,N=""+s;return o!==null&&o.ref!==null&&typeof o.ref=="function"&&o.ref._stringRef===N?o.ref:(o=function(O){var W=b.refs;O===null?delete W[N]:W[N]=O},o._stringRef=N,o)}if(typeof s!="string")throw Error(c(284));if(!h._owner)throw Error(c(290,s))}return s}function La(s,o){throw s=Object.prototype.toString.call(o),Error(c(31,s==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":s))}function Mu(s){var o=s._init;return o(s._payload)}function Lu(s){function o(te,q){if(s){var ie=te.deletions;ie===null?(te.deletions=[q],te.flags|=16):ie.push(q)}}function h(te,q){if(!s)return null;for(;q!==null;)o(te,q),q=q.sibling;return null}function g(te,q){for(te=new Map;q!==null;)q.key!==null?te.set(q.key,q):te.set(q.index,q),q=q.sibling;return te}function b(te,q){return te=zn(te,q),te.index=0,te.sibling=null,te}function N(te,q,ie){return te.index=ie,s?(ie=te.alternate,ie!==null?(ie=ie.index,ie<q?(te.flags|=2,q):ie):(te.flags|=2,q)):(te.flags|=1048576,q)}function O(te){return s&&te.alternate===null&&(te.flags|=2),te}function W(te,q,ie,je){return q===null||q.tag!==6?(q=Mc(ie,te.mode,je),q.return=te,q):(q=b(q,ie),q.return=te,q)}function re(te,q,ie,je){var Ie=ie.type;return Ie===p?Te(te,q,ie.props.children,je,ie.key):q!==null&&(q.elementType===Ie||typeof Ie=="object"&&Ie!==null&&Ie.$$typeof===k&&Mu(Ie)===q.type)?(je=b(q,ie.props),je.ref=Ni(te,q,ie),je.return=te,je):(je=mo(ie.type,ie.key,ie.props,null,te.mode,je),je.ref=Ni(te,q,ie),je.return=te,je)}function me(te,q,ie,je){return q===null||q.tag!==4||q.stateNode.containerInfo!==ie.containerInfo||q.stateNode.implementation!==ie.implementation?(q=Lc(ie,te.mode,je),q.return=te,q):(q=b(q,ie.children||[]),q.return=te,q)}function Te(te,q,ie,je,Ie){return q===null||q.tag!==7?(q=xs(ie,te.mode,je,Ie),q.return=te,q):(q=b(q,ie),q.return=te,q)}function ze(te,q,ie){if(typeof q=="string"&&q!==""||typeof q=="number")return q=Mc(""+q,te.mode,ie),q.return=te,q;if(typeof q=="object"&&q!==null){switch(q.$$typeof){case u:return ie=mo(q.type,q.key,q.props,null,te.mode,ie),ie.ref=Ni(te,null,q),ie.return=te,ie;case f:return q=Lc(q,te.mode,ie),q.return=te,q;case k:var je=q._init;return ze(te,je(q._payload),ie)}if(G(q)||D(q))return q=xs(q,te.mode,ie,null),q.return=te,q;La(te,q)}return null}function Ne(te,q,ie,je){var Ie=q!==null?q.key:null;if(typeof ie=="string"&&ie!==""||typeof ie=="number")return Ie!==null?null:W(te,q,""+ie,je);if(typeof ie=="object"&&ie!==null){switch(ie.$$typeof){case u:return ie.key===Ie?re(te,q,ie,je):null;case f:return ie.key===Ie?me(te,q,ie,je):null;case k:return Ie=ie._init,Ne(te,q,Ie(ie._payload),je)}if(G(ie)||D(ie))return Ie!==null?null:Te(te,q,ie,je,null);La(te,ie)}return null}function yt(te,q,ie,je,Ie){if(typeof je=="string"&&je!==""||typeof je=="number")return te=te.get(ie)||null,W(q,te,""+je,Ie);if(typeof je=="object"&&je!==null){switch(je.$$typeof){case u:return te=te.get(je.key===null?ie:je.key)||null,re(q,te,je,Ie);case f:return te=te.get(je.key===null?ie:je.key)||null,me(q,te,je,Ie);case k:var We=je._init;return yt(te,q,ie,We(je._payload),Ie)}if(G(je)||D(je))return te=te.get(ie)||null,Te(q,te,je,Ie,null);La(q,je)}return null}function ct(te,q,ie,je){for(var Ie=null,We=null,Be=q,Je=q=0,Ht=null;Be!==null&&Je<ie.length;Je++){Be.index>Je?(Ht=Be,Be=null):Ht=Be.sibling;var et=Ne(te,Be,ie[Je],je);if(et===null){Be===null&&(Be=Ht);break}s&&Be&&et.alternate===null&&o(te,Be),q=N(et,q,Je),We===null?Ie=et:We.sibling=et,We=et,Be=Ht}if(Je===ie.length)return h(te,Be),wt&&ds(te,Je),Ie;if(Be===null){for(;Je<ie.length;Je++)Be=ze(te,ie[Je],je),Be!==null&&(q=N(Be,q,Je),We===null?Ie=Be:We.sibling=Be,We=Be);return wt&&ds(te,Je),Ie}for(Be=g(te,Be);Je<ie.length;Je++)Ht=yt(Be,te,Je,ie[Je],je),Ht!==null&&(s&&Ht.alternate!==null&&Be.delete(Ht.key===null?Je:Ht.key),q=N(Ht,q,Je),We===null?Ie=Ht:We.sibling=Ht,We=Ht);return s&&Be.forEach(function(Bn){return o(te,Bn)}),wt&&ds(te,Je),Ie}function lr(te,q,ie,je){var Ie=D(ie);if(typeof Ie!="function")throw Error(c(150));if(ie=Ie.call(ie),ie==null)throw Error(c(151));for(var We=Ie=null,Be=q,Je=q=0,Ht=null,et=ie.next();Be!==null&&!et.done;Je++,et=ie.next()){Be.index>Je?(Ht=Be,Be=null):Ht=Be.sibling;var Bn=Ne(te,Be,et.value,je);if(Bn===null){Be===null&&(Be=Ht);break}s&&Be&&Bn.alternate===null&&o(te,Be),q=N(Bn,q,Je),We===null?Ie=Bn:We.sibling=Bn,We=Bn,Be=Ht}if(et.done)return h(te,Be),wt&&ds(te,Je),Ie;if(Be===null){for(;!et.done;Je++,et=ie.next())et=ze(te,et.value,je),et!==null&&(q=N(et,q,Je),We===null?Ie=et:We.sibling=et,We=et);return wt&&ds(te,Je),Ie}for(Be=g(te,Be);!et.done;Je++,et=ie.next())et=yt(Be,te,Je,et.value,je),et!==null&&(s&&et.alternate!==null&&Be.delete(et.key===null?Je:et.key),q=N(et,q,Je),We===null?Ie=et:We.sibling=et,We=et);return s&&Be.forEach(function(kx){return o(te,kx)}),wt&&ds(te,Je),Ie}function vn(te,q,ie,je){if(typeof ie=="object"&&ie!==null&&ie.type===p&&ie.key===null&&(ie=ie.props.children),typeof ie=="object"&&ie!==null){switch(ie.$$typeof){case u:e:{for(var Ie=ie.key,We=q;We!==null;){if(We.key===Ie){if(Ie=ie.type,Ie===p){if(We.tag===7){h(te,We.sibling),q=b(We,ie.props.children),q.return=te,te=q;break e}}else if(We.elementType===Ie||typeof Ie=="object"&&Ie!==null&&Ie.$$typeof===k&&Mu(Ie)===We.type){h(te,We.sibling),q=b(We,ie.props),q.ref=Ni(te,We,ie),q.return=te,te=q;break e}h(te,We);break}else o(te,We);We=We.sibling}ie.type===p?(q=xs(ie.props.children,te.mode,je,ie.key),q.return=te,te=q):(je=mo(ie.type,ie.key,ie.props,null,te.mode,je),je.ref=Ni(te,q,ie),je.return=te,te=je)}return O(te);case f:e:{for(We=ie.key;q!==null;){if(q.key===We)if(q.tag===4&&q.stateNode.containerInfo===ie.containerInfo&&q.stateNode.implementation===ie.implementation){h(te,q.sibling),q=b(q,ie.children||[]),q.return=te,te=q;break e}else{h(te,q);break}else o(te,q);q=q.sibling}q=Lc(ie,te.mode,je),q.return=te,te=q}return O(te);case k:return We=ie._init,vn(te,q,We(ie._payload),je)}if(G(ie))return ct(te,q,ie,je);if(D(ie))return lr(te,q,ie,je);La(te,ie)}return typeof ie=="string"&&ie!==""||typeof ie=="number"?(ie=""+ie,q!==null&&q.tag===6?(h(te,q.sibling),q=b(q,ie),q.return=te,te=q):(h(te,q),q=Mc(ie,te.mode,je),q.return=te,te=q),O(te)):h(te,q)}return vn}var Gs=Lu(!0),Fu=Lu(!1),Fa=Tn(null),za=null,Hs=null,Hl=null;function Ul(){Hl=Hs=za=null}function zu(s,o,h){ot?(ut(Fa,o._currentValue),o._currentValue=h):(ut(Fa,o._currentValue2),o._currentValue2=h)}function Wl(s){var o=Fa.current;xt(Fa),ot?s._currentValue=o:s._currentValue2=o}function Vl(s,o,h){for(;s!==null;){var g=s.alternate;if((s.childLanes&o)!==o?(s.childLanes|=o,g!==null&&(g.childLanes|=o)):g!==null&&(g.childLanes&o)!==o&&(g.childLanes|=o),s===h)break;s=s.return}}function Us(s,o){za=s,Hl=Hs=null,s=s.dependencies,s!==null&&s.firstContext!==null&&(s.lanes&o&&(ir=!0),s.firstContext=null)}function Sr(s){var o=ot?s._currentValue:s._currentValue2;if(Hl!==s)if(s={context:s,memoizedValue:o,next:null},Hs===null){if(za===null)throw Error(c(308));Hs=s,za.dependencies={lanes:0,firstContext:s}}else Hs=Hs.next=s;return o}var us=null;function $l(s){us===null?us=[s]:us.push(s)}function Bu(s,o,h,g){var b=o.interleaved;return b===null?(h.next=h,$l(o)):(h.next=b.next,b.next=h),o.interleaved=h,qr(s,g)}function qr(s,o){s.lanes|=o;var h=s.alternate;for(h!==null&&(h.lanes|=o),h=s,s=s.return;s!==null;)s.childLanes|=o,h=s.alternate,h!==null&&(h.childLanes|=o),h=s,s=s.return;return h.tag===3?h.stateNode:null}var Dn=!1;function Yl(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Gu(s,o){s=s.updateQueue,o.updateQueue===s&&(o.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,effects:s.effects})}function gn(s,o){return{eventTime:s,lane:o,tag:0,payload:null,callback:null,next:null}}function On(s,o,h){var g=s.updateQueue;if(g===null)return null;if(g=g.shared,$e&2){var b=g.pending;return b===null?o.next=o:(o.next=b.next,b.next=o),g.pending=o,qr(s,h)}return b=g.interleaved,b===null?(o.next=o,$l(g)):(o.next=b.next,b.next=o),g.interleaved=o,qr(s,h)}function Ba(s,o,h){if(o=o.updateQueue,o!==null&&(o=o.shared,(h&4194240)!==0)){var g=o.lanes;g&=s.pendingLanes,h|=g,o.lanes=h,Rl(s,h)}}function Hu(s,o){var h=s.updateQueue,g=s.alternate;if(g!==null&&(g=g.updateQueue,h===g)){var b=null,N=null;if(h=h.firstBaseUpdate,h!==null){do{var O={eventTime:h.eventTime,lane:h.lane,tag:h.tag,payload:h.payload,callback:h.callback,next:null};N===null?b=N=O:N=N.next=O,h=h.next}while(h!==null);N===null?b=N=o:N=N.next=o}else b=N=o;h={baseState:g.baseState,firstBaseUpdate:b,lastBaseUpdate:N,shared:g.shared,effects:g.effects},s.updateQueue=h;return}s=h.lastBaseUpdate,s===null?h.firstBaseUpdate=o:s.next=o,h.lastBaseUpdate=o}function Ga(s,o,h,g){var b=s.updateQueue;Dn=!1;var N=b.firstBaseUpdate,O=b.lastBaseUpdate,W=b.shared.pending;if(W!==null){b.shared.pending=null;var re=W,me=re.next;re.next=null,O===null?N=me:O.next=me,O=re;var Te=s.alternate;Te!==null&&(Te=Te.updateQueue,W=Te.lastBaseUpdate,W!==O&&(W===null?Te.firstBaseUpdate=me:W.next=me,Te.lastBaseUpdate=re))}if(N!==null){var ze=b.baseState;O=0,Te=me=re=null,W=N;do{var Ne=W.lane,yt=W.eventTime;if((g&Ne)===Ne){Te!==null&&(Te=Te.next={eventTime:yt,lane:0,tag:W.tag,payload:W.payload,callback:W.callback,next:null});e:{var ct=s,lr=W;switch(Ne=o,yt=h,lr.tag){case 1:if(ct=lr.payload,typeof ct=="function"){ze=ct.call(yt,ze,Ne);break e}ze=ct;break e;case 3:ct.flags=ct.flags&-65537|128;case 0:if(ct=lr.payload,Ne=typeof ct=="function"?ct.call(yt,ze,Ne):ct,Ne==null)break e;ze=l({},ze,Ne);break e;case 2:Dn=!0}}W.callback!==null&&W.lane!==0&&(s.flags|=64,Ne=b.effects,Ne===null?b.effects=[W]:Ne.push(W))}else yt={eventTime:yt,lane:Ne,tag:W.tag,payload:W.payload,callback:W.callback,next:null},Te===null?(me=Te=yt,re=ze):Te=Te.next=yt,O|=Ne;if(W=W.next,W===null){if(W=b.shared.pending,W===null)break;Ne=W,W=Ne.next,Ne.next=null,b.lastBaseUpdate=Ne,b.shared.pending=null}}while(!0);if(Te===null&&(re=ze),b.baseState=re,b.firstBaseUpdate=me,b.lastBaseUpdate=Te,o=b.shared.interleaved,o!==null){b=o;do O|=b.lane,b=b.next;while(b!==o)}else N===null&&(b.shared.lanes=0);fs|=O,s.lanes=O,s.memoizedState=ze}}function Uu(s,o,h){if(s=o.effects,o.effects=null,s!==null)for(o=0;o<s.length;o++){var g=s[o],b=g.callback;if(b!==null){if(g.callback=null,g=h,typeof b!="function")throw Error(c(191,b));b.call(g)}}}var ji={},Cr=Tn(ji),Ei=Tn(ji),Ws=Tn(ji);function Kr(s){if(s===ji)throw Error(c(174));return s}function Xl(s,o){ut(Ws,o),ut(Ei,s),ut(Cr,ji),s=K(o),xt(Cr),ut(Cr,s)}function Vs(){xt(Cr),xt(Ei),xt(Ws)}function Wu(s){var o=Kr(Ws.current),h=Kr(Cr.current);o=J(h,s.type,o),h!==o&&(ut(Ei,s),ut(Cr,o))}function ql(s){Ei.current===s&&(xt(Cr),xt(Ei))}var _t=Tn(0);function Ha(s){for(var o=s;o!==null;){if(o.tag===13){var h=o.memoizedState;if(h!==null&&(h=h.dehydrated,h===null||Su(h)||kl(h)))return o}else if(o.tag===19&&o.memoizedProps.revealOrder!==void 0){if(o.flags&128)return o}else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===s)break;for(;o.sibling===null;){if(o.return===null||o.return===s)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}return null}var Kl=[];function Ql(){for(var s=0;s<Kl.length;s++){var o=Kl[s];ot?o._workInProgressVersionPrimary=null:o._workInProgressVersionSecondary=null}Kl.length=0}var Ua=d.ReactCurrentDispatcher,Zl=d.ReactCurrentBatchConfig,hs=0,St=null,Ot=null,Bt=null,Wa=!1,Pi=!1,Ai=0,K1=0;function qt(){throw Error(c(321))}function Jl(s,o){if(o===null)return!1;for(var h=0;h<o.length&&h<s.length;h++)if(!Or(s[h],o[h]))return!1;return!0}function ec(s,o,h,g,b,N){if(hs=N,St=o,o.memoizedState=null,o.updateQueue=null,o.lanes=0,Ua.current=s===null||s.memoizedState===null?ex:tx,s=h(g,b),Pi){N=0;do{if(Pi=!1,Ai=0,25<=N)throw Error(c(301));N+=1,Bt=Ot=null,o.updateQueue=null,Ua.current=rx,s=h(g,b)}while(Pi)}if(Ua.current=Ya,o=Ot!==null&&Ot.next!==null,hs=0,Bt=Ot=St=null,Wa=!1,o)throw Error(c(300));return s}function tc(){var s=Ai!==0;return Ai=0,s}function Qr(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Bt===null?St.memoizedState=Bt=s:Bt=Bt.next=s,Bt}function kr(){if(Ot===null){var s=St.alternate;s=s!==null?s.memoizedState:null}else s=Ot.next;var o=Bt===null?St.memoizedState:Bt.next;if(o!==null)Bt=o,Ot=s;else{if(s===null)throw Error(c(310));Ot=s,s={memoizedState:Ot.memoizedState,baseState:Ot.baseState,baseQueue:Ot.baseQueue,queue:Ot.queue,next:null},Bt===null?St.memoizedState=Bt=s:Bt=Bt.next=s}return Bt}function Ti(s,o){return typeof o=="function"?o(s):o}function rc(s){var o=kr(),h=o.queue;if(h===null)throw Error(c(311));h.lastRenderedReducer=s;var g=Ot,b=g.baseQueue,N=h.pending;if(N!==null){if(b!==null){var O=b.next;b.next=N.next,N.next=O}g.baseQueue=b=N,h.pending=null}if(b!==null){N=b.next,g=g.baseState;var W=O=null,re=null,me=N;do{var Te=me.lane;if((hs&Te)===Te)re!==null&&(re=re.next={lane:0,action:me.action,hasEagerState:me.hasEagerState,eagerState:me.eagerState,next:null}),g=me.hasEagerState?me.eagerState:s(g,me.action);else{var ze={lane:Te,action:me.action,hasEagerState:me.hasEagerState,eagerState:me.eagerState,next:null};re===null?(W=re=ze,O=g):re=re.next=ze,St.lanes|=Te,fs|=Te}me=me.next}while(me!==null&&me!==N);re===null?O=g:re.next=W,Or(g,o.memoizedState)||(ir=!0),o.memoizedState=g,o.baseState=O,o.baseQueue=re,h.lastRenderedState=g}if(s=h.interleaved,s!==null){b=s;do N=b.lane,St.lanes|=N,fs|=N,b=b.next;while(b!==s)}else b===null&&(h.lanes=0);return[o.memoizedState,h.dispatch]}function nc(s){var o=kr(),h=o.queue;if(h===null)throw Error(c(311));h.lastRenderedReducer=s;var g=h.dispatch,b=h.pending,N=o.memoizedState;if(b!==null){h.pending=null;var O=b=b.next;do N=s(N,O.action),O=O.next;while(O!==b);Or(N,o.memoizedState)||(ir=!0),o.memoizedState=N,o.baseQueue===null&&(o.baseState=N),h.lastRenderedState=N}return[N,g]}function Vu(){}function $u(s,o){var h=St,g=kr(),b=o(),N=!Or(g.memoizedState,b);if(N&&(g.memoizedState=b,ir=!0),g=g.queue,sc(qu.bind(null,h,g,s),[s]),g.getSnapshot!==o||N||Bt!==null&&Bt.memoizedState.tag&1){if(h.flags|=2048,Ri(9,Xu.bind(null,h,g,b,o),void 0,null),Gt===null)throw Error(c(349));hs&30||Yu(h,o,b)}return b}function Yu(s,o,h){s.flags|=16384,s={getSnapshot:o,value:h},o=St.updateQueue,o===null?(o={lastEffect:null,stores:null},St.updateQueue=o,o.stores=[s]):(h=o.stores,h===null?o.stores=[s]:h.push(s))}function Xu(s,o,h,g){o.value=h,o.getSnapshot=g,Ku(o)&&Qu(s)}function qu(s,o,h){return h(function(){Ku(o)&&Qu(s)})}function Ku(s){var o=s.getSnapshot;s=s.value;try{var h=o();return!Or(s,h)}catch{return!0}}function Qu(s){var o=qr(s,1);o!==null&&Nr(o,s,1,-1)}function Zu(s){var o=Qr();return typeof s=="function"&&(s=s()),o.memoizedState=o.baseState=s,s={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ti,lastRenderedState:s},o.queue=s,s=s.dispatch=J1.bind(null,St,s),[o.memoizedState,s]}function Ri(s,o,h,g){return s={tag:s,create:o,destroy:h,deps:g,next:null},o=St.updateQueue,o===null?(o={lastEffect:null,stores:null},St.updateQueue=o,o.lastEffect=s.next=s):(h=o.lastEffect,h===null?o.lastEffect=s.next=s:(g=h.next,h.next=s,s.next=g,o.lastEffect=s)),s}function Ju(){return kr().memoizedState}function Va(s,o,h,g){var b=Qr();St.flags|=s,b.memoizedState=Ri(1|o,h,void 0,g===void 0?null:g)}function $a(s,o,h,g){var b=kr();g=g===void 0?null:g;var N=void 0;if(Ot!==null){var O=Ot.memoizedState;if(N=O.destroy,g!==null&&Jl(g,O.deps)){b.memoizedState=Ri(o,h,N,g);return}}St.flags|=s,b.memoizedState=Ri(1|o,h,N,g)}function eh(s,o){return Va(8390656,8,s,o)}function sc(s,o){return $a(2048,8,s,o)}function th(s,o){return $a(4,2,s,o)}function rh(s,o){return $a(4,4,s,o)}function nh(s,o){if(typeof o=="function")return s=s(),o(s),function(){o(null)};if(o!=null)return s=s(),o.current=s,function(){o.current=null}}function sh(s,o,h){return h=h!=null?h.concat([s]):null,$a(4,4,nh.bind(null,o,s),h)}function ic(){}function ih(s,o){var h=kr();o=o===void 0?null:o;var g=h.memoizedState;return g!==null&&o!==null&&Jl(o,g[1])?g[0]:(h.memoizedState=[s,o],s)}function ah(s,o){var h=kr();o=o===void 0?null:o;var g=h.memoizedState;return g!==null&&o!==null&&Jl(o,g[1])?g[0]:(s=s(),h.memoizedState=[s,o],s)}function oh(s,o,h){return hs&21?(Or(h,o)||(h=ju(),St.lanes|=h,fs|=h,s.baseState=!0),o):(s.baseState&&(s.baseState=!1,ir=!0),s.memoizedState=h)}function Q1(s,o){var h=Ze;Ze=h!==0&&4>h?h:4,s(!0);var g=Zl.transition;Zl.transition={};try{s(!1),o()}finally{Ze=h,Zl.transition=g}}function lh(){return kr().memoizedState}function Z1(s,o,h){var g=Ln(s);if(h={lane:g,action:h,hasEagerState:!1,eagerState:null,next:null},ch(s))dh(o,h);else if(h=Bu(s,o,h,g),h!==null){var b=Zt();Nr(h,s,g,b),uh(h,o,g)}}function J1(s,o,h){var g=Ln(s),b={lane:g,action:h,hasEagerState:!1,eagerState:null,next:null};if(ch(s))dh(o,b);else{var N=s.alternate;if(s.lanes===0&&(N===null||N.lanes===0)&&(N=o.lastRenderedReducer,N!==null))try{var O=o.lastRenderedState,W=N(O,h);if(b.hasEagerState=!0,b.eagerState=W,Or(W,O)){var re=o.interleaved;re===null?(b.next=b,$l(o)):(b.next=re.next,re.next=b),o.interleaved=b;return}}catch{}finally{}h=Bu(s,o,b,g),h!==null&&(b=Zt(),Nr(h,s,g,b),uh(h,o,g))}}function ch(s){var o=s.alternate;return s===St||o!==null&&o===St}function dh(s,o){Pi=Wa=!0;var h=s.pending;h===null?o.next=o:(o.next=h.next,h.next=o),s.pending=o}function uh(s,o,h){if(h&4194240){var g=o.lanes;g&=s.pendingLanes,h|=g,o.lanes=h,Rl(s,h)}}var Ya={readContext:Sr,useCallback:qt,useContext:qt,useEffect:qt,useImperativeHandle:qt,useInsertionEffect:qt,useLayoutEffect:qt,useMemo:qt,useReducer:qt,useRef:qt,useState:qt,useDebugValue:qt,useDeferredValue:qt,useTransition:qt,useMutableSource:qt,useSyncExternalStore:qt,useId:qt,unstable_isNewReconciler:!1},ex={readContext:Sr,useCallback:function(s,o){return Qr().memoizedState=[s,o===void 0?null:o],s},useContext:Sr,useEffect:eh,useImperativeHandle:function(s,o,h){return h=h!=null?h.concat([s]):null,Va(4194308,4,nh.bind(null,o,s),h)},useLayoutEffect:function(s,o){return Va(4194308,4,s,o)},useInsertionEffect:function(s,o){return Va(4,2,s,o)},useMemo:function(s,o){var h=Qr();return o=o===void 0?null:o,s=s(),h.memoizedState=[s,o],s},useReducer:function(s,o,h){var g=Qr();return o=h!==void 0?h(o):o,g.memoizedState=g.baseState=o,s={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:o},g.queue=s,s=s.dispatch=Z1.bind(null,St,s),[g.memoizedState,s]},useRef:function(s){var o=Qr();return s={current:s},o.memoizedState=s},useState:Zu,useDebugValue:ic,useDeferredValue:function(s){return Qr().memoizedState=s},useTransition:function(){var s=Zu(!1),o=s[0];return s=Q1.bind(null,s[1]),Qr().memoizedState=s,[o,s]},useMutableSource:function(){},useSyncExternalStore:function(s,o,h){var g=St,b=Qr();if(wt){if(h===void 0)throw Error(c(407));h=h()}else{if(h=o(),Gt===null)throw Error(c(349));hs&30||Yu(g,o,h)}b.memoizedState=h;var N={value:h,getSnapshot:o};return b.queue=N,eh(qu.bind(null,g,N,s),[s]),g.flags|=2048,Ri(9,Xu.bind(null,g,N,h,o),void 0,null),h},useId:function(){var s=Qr(),o=Gt.identifierPrefix;if(wt){var h=mn,g=pn;h=(g&~(1<<32-Dr(g)-1)).toString(32)+h,o=":"+o+"R"+h,h=Ai++,0<h&&(o+="H"+h.toString(32)),o+=":"}else h=K1++,o=":"+o+"r"+h.toString(32)+":";return s.memoizedState=o},unstable_isNewReconciler:!1},tx={readContext:Sr,useCallback:ih,useContext:Sr,useEffect:sc,useImperativeHandle:sh,useInsertionEffect:th,useLayoutEffect:rh,useMemo:ah,useReducer:rc,useRef:Ju,useState:function(){return rc(Ti)},useDebugValue:ic,useDeferredValue:function(s){var o=kr();return oh(o,Ot.memoizedState,s)},useTransition:function(){var s=rc(Ti)[0],o=kr().memoizedState;return[s,o]},useMutableSource:Vu,useSyncExternalStore:$u,useId:lh,unstable_isNewReconciler:!1},rx={readContext:Sr,useCallback:ih,useContext:Sr,useEffect:sc,useImperativeHandle:sh,useInsertionEffect:th,useLayoutEffect:rh,useMemo:ah,useReducer:nc,useRef:Ju,useState:function(){return nc(Ti)},useDebugValue:ic,useDeferredValue:function(s){var o=kr();return Ot===null?o.memoizedState=s:oh(o,Ot.memoizedState,s)},useTransition:function(){var s=nc(Ti)[0],o=kr().memoizedState;return[s,o]},useMutableSource:Vu,useSyncExternalStore:$u,useId:lh,unstable_isNewReconciler:!1};function Mr(s,o){if(s&&s.defaultProps){o=l({},o),s=s.defaultProps;for(var h in s)o[h]===void 0&&(o[h]=s[h]);return o}return o}function ac(s,o,h,g){o=s.memoizedState,h=h(g,o),h=h==null?o:l({},o,h),s.memoizedState=h,s.lanes===0&&(s.updateQueue.baseState=h)}var Xa={isMounted:function(s){return(s=s._reactInternals)?z(s)===s:!1},enqueueSetState:function(s,o,h){s=s._reactInternals;var g=Zt(),b=Ln(s),N=gn(g,b);N.payload=o,h!=null&&(N.callback=h),o=On(s,N,b),o!==null&&(Nr(o,s,b,g),Ba(o,s,b))},enqueueReplaceState:function(s,o,h){s=s._reactInternals;var g=Zt(),b=Ln(s),N=gn(g,b);N.tag=1,N.payload=o,h!=null&&(N.callback=h),o=On(s,N,b),o!==null&&(Nr(o,s,b,g),Ba(o,s,b))},enqueueForceUpdate:function(s,o){s=s._reactInternals;var h=Zt(),g=Ln(s),b=gn(h,g);b.tag=2,o!=null&&(b.callback=o),o=On(s,b,g),o!==null&&(Nr(o,s,g,h),Ba(o,s,g))}};function hh(s,o,h,g,b,N,O){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(g,N,O):o.prototype&&o.prototype.isPureReactComponent?!Ma(h,g)||!Ma(b,N):!0}function fh(s,o,h){var g=!1,b=Rn,N=o.contextType;return typeof N=="object"&&N!==null?N=Sr(N):(b=sr(o)?ls:Xt.current,g=o.contextTypes,N=(g=g!=null)?Ls(s,b):Rn),o=new o(h,N),s.memoizedState=o.state!==null&&o.state!==void 0?o.state:null,o.updater=Xa,s.stateNode=o,o._reactInternals=s,g&&(s=s.stateNode,s.__reactInternalMemoizedUnmaskedChildContext=b,s.__reactInternalMemoizedMaskedChildContext=N),o}function ph(s,o,h,g){s=o.state,typeof o.componentWillReceiveProps=="function"&&o.componentWillReceiveProps(h,g),typeof o.UNSAFE_componentWillReceiveProps=="function"&&o.UNSAFE_componentWillReceiveProps(h,g),o.state!==s&&Xa.enqueueReplaceState(o,o.state,null)}function oc(s,o,h,g){var b=s.stateNode;b.props=h,b.state=s.memoizedState,b.refs={},Yl(s);var N=o.contextType;typeof N=="object"&&N!==null?b.context=Sr(N):(N=sr(o)?ls:Xt.current,b.context=Ls(s,N)),b.state=s.memoizedState,N=o.getDerivedStateFromProps,typeof N=="function"&&(ac(s,o,N,h),b.state=s.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof b.getSnapshotBeforeUpdate=="function"||typeof b.UNSAFE_componentWillMount!="function"&&typeof b.componentWillMount!="function"||(o=b.state,typeof b.componentWillMount=="function"&&b.componentWillMount(),typeof b.UNSAFE_componentWillMount=="function"&&b.UNSAFE_componentWillMount(),o!==b.state&&Xa.enqueueReplaceState(b,b.state,null),Ga(s,h,b,g),b.state=s.memoizedState),typeof b.componentDidMount=="function"&&(s.flags|=4194308)}function $s(s,o){try{var h="",g=o;do h+=q1(g),g=g.return;while(g);var b=h}catch(N){b=`
Error generating stack: `+N.message+`
`+N.stack}return{value:s,source:o,stack:b,digest:null}}function lc(s,o,h){return{value:s,source:null,stack:h??null,digest:o??null}}function cc(s,o){try{console.error(o.value)}catch(h){setTimeout(function(){throw h})}}var nx=typeof WeakMap=="function"?WeakMap:Map;function mh(s,o,h){h=gn(-1,h),h.tag=3,h.payload={element:null};var g=o.value;return h.callback=function(){lo||(lo=!0,Pc=g),cc(s,o)},h}function gh(s,o,h){h=gn(-1,h),h.tag=3;var g=s.type.getDerivedStateFromError;if(typeof g=="function"){var b=o.value;h.payload=function(){return g(b)},h.callback=function(){cc(s,o)}}var N=s.stateNode;return N!==null&&typeof N.componentDidCatch=="function"&&(h.callback=function(){cc(s,o),typeof g!="function"&&(In===null?In=new Set([this]):In.add(this));var O=o.stack;this.componentDidCatch(o.value,{componentStack:O!==null?O:""})}),h}function xh(s,o,h){var g=s.pingCache;if(g===null){g=s.pingCache=new nx;var b=new Set;g.set(o,b)}else b=g.get(o),b===void 0&&(b=new Set,g.set(o,b));b.has(h)||(b.add(h),s=xx.bind(null,s,o,h),o.then(s,s))}function yh(s){do{var o;if((o=s.tag===13)&&(o=s.memoizedState,o=o!==null?o.dehydrated!==null:!0),o)return s;s=s.return}while(s!==null);return null}function vh(s,o,h,g,b){return s.mode&1?(s.flags|=65536,s.lanes=b,s):(s===o?s.flags|=65536:(s.flags|=128,h.flags|=131072,h.flags&=-52805,h.tag===1&&(h.alternate===null?h.tag=17:(o=gn(-1,1),o.tag=2,On(h,o,1))),h.lanes|=1),s)}var sx=d.ReactCurrentOwner,ir=!1;function tr(s,o,h,g){o.child=s===null?Fu(o,null,h,g):Gs(o,s.child,h,g)}function wh(s,o,h,g,b){h=h.render;var N=o.ref;return Us(o,b),g=ec(s,o,h,g,N,b),h=tc(),s!==null&&!ir?(o.updateQueue=s.updateQueue,o.flags&=-2053,s.lanes&=~b,xn(s,o,b)):(wt&&h&&Ll(o),o.flags|=1,tr(s,o,g,b),o.child)}function bh(s,o,h,g,b){if(s===null){var N=h.type;return typeof N=="function"&&!Ic(N)&&N.defaultProps===void 0&&h.compare===null&&h.defaultProps===void 0?(o.tag=15,o.type=N,_h(s,o,N,g,b)):(s=mo(h.type,null,g,o,o.mode,b),s.ref=o.ref,s.return=o,o.child=s)}if(N=s.child,!(s.lanes&b)){var O=N.memoizedProps;if(h=h.compare,h=h!==null?h:Ma,h(O,g)&&s.ref===o.ref)return xn(s,o,b)}return o.flags|=1,s=zn(N,g),s.ref=o.ref,s.return=o,o.child=s}function _h(s,o,h,g,b){if(s!==null){var N=s.memoizedProps;if(Ma(N,g)&&s.ref===o.ref)if(ir=!1,o.pendingProps=g=N,(s.lanes&b)!==0)s.flags&131072&&(ir=!0);else return o.lanes=s.lanes,xn(s,o,b)}return dc(s,o,h,g,b)}function Sh(s,o,h){var g=o.pendingProps,b=g.children,N=s!==null?s.memoizedState:null;if(g.mode==="hidden")if(!(o.mode&1))o.memoizedState={baseLanes:0,cachePool:null,transitions:null},ut(Xs,hr),hr|=h;else{if(!(h&1073741824))return s=N!==null?N.baseLanes|h:h,o.lanes=o.childLanes=1073741824,o.memoizedState={baseLanes:s,cachePool:null,transitions:null},o.updateQueue=null,ut(Xs,hr),hr|=s,null;o.memoizedState={baseLanes:0,cachePool:null,transitions:null},g=N!==null?N.baseLanes:h,ut(Xs,hr),hr|=g}else N!==null?(g=N.baseLanes|h,o.memoizedState=null):g=h,ut(Xs,hr),hr|=g;return tr(s,o,b,h),o.child}function Ch(s,o){var h=o.ref;(s===null&&h!==null||s!==null&&s.ref!==h)&&(o.flags|=512,o.flags|=2097152)}function dc(s,o,h,g,b){var N=sr(h)?ls:Xt.current;return N=Ls(o,N),Us(o,b),h=ec(s,o,h,g,N,b),g=tc(),s!==null&&!ir?(o.updateQueue=s.updateQueue,o.flags&=-2053,s.lanes&=~b,xn(s,o,b)):(wt&&g&&Ll(o),o.flags|=1,tr(s,o,h,b),o.child)}function kh(s,o,h,g,b){if(sr(h)){var N=!0;ja(o)}else N=!1;if(Us(o,b),o.stateNode===null)Ka(s,o),fh(o,h,g),oc(o,h,g,b),g=!0;else if(s===null){var O=o.stateNode,W=o.memoizedProps;O.props=W;var re=O.context,me=h.contextType;typeof me=="object"&&me!==null?me=Sr(me):(me=sr(h)?ls:Xt.current,me=Ls(o,me));var Te=h.getDerivedStateFromProps,ze=typeof Te=="function"||typeof O.getSnapshotBeforeUpdate=="function";ze||typeof O.UNSAFE_componentWillReceiveProps!="function"&&typeof O.componentWillReceiveProps!="function"||(W!==g||re!==me)&&ph(o,O,g,me),Dn=!1;var Ne=o.memoizedState;O.state=Ne,Ga(o,g,O,b),re=o.memoizedState,W!==g||Ne!==re||nr.current||Dn?(typeof Te=="function"&&(ac(o,h,Te,g),re=o.memoizedState),(W=Dn||hh(o,h,W,g,Ne,re,me))?(ze||typeof O.UNSAFE_componentWillMount!="function"&&typeof O.componentWillMount!="function"||(typeof O.componentWillMount=="function"&&O.componentWillMount(),typeof O.UNSAFE_componentWillMount=="function"&&O.UNSAFE_componentWillMount()),typeof O.componentDidMount=="function"&&(o.flags|=4194308)):(typeof O.componentDidMount=="function"&&(o.flags|=4194308),o.memoizedProps=g,o.memoizedState=re),O.props=g,O.state=re,O.context=me,g=W):(typeof O.componentDidMount=="function"&&(o.flags|=4194308),g=!1)}else{O=o.stateNode,Gu(s,o),W=o.memoizedProps,me=o.type===o.elementType?W:Mr(o.type,W),O.props=me,ze=o.pendingProps,Ne=O.context,re=h.contextType,typeof re=="object"&&re!==null?re=Sr(re):(re=sr(h)?ls:Xt.current,re=Ls(o,re));var yt=h.getDerivedStateFromProps;(Te=typeof yt=="function"||typeof O.getSnapshotBeforeUpdate=="function")||typeof O.UNSAFE_componentWillReceiveProps!="function"&&typeof O.componentWillReceiveProps!="function"||(W!==ze||Ne!==re)&&ph(o,O,g,re),Dn=!1,Ne=o.memoizedState,O.state=Ne,Ga(o,g,O,b);var ct=o.memoizedState;W!==ze||Ne!==ct||nr.current||Dn?(typeof yt=="function"&&(ac(o,h,yt,g),ct=o.memoizedState),(me=Dn||hh(o,h,me,g,Ne,ct,re)||!1)?(Te||typeof O.UNSAFE_componentWillUpdate!="function"&&typeof O.componentWillUpdate!="function"||(typeof O.componentWillUpdate=="function"&&O.componentWillUpdate(g,ct,re),typeof O.UNSAFE_componentWillUpdate=="function"&&O.UNSAFE_componentWillUpdate(g,ct,re)),typeof O.componentDidUpdate=="function"&&(o.flags|=4),typeof O.getSnapshotBeforeUpdate=="function"&&(o.flags|=1024)):(typeof O.componentDidUpdate!="function"||W===s.memoizedProps&&Ne===s.memoizedState||(o.flags|=4),typeof O.getSnapshotBeforeUpdate!="function"||W===s.memoizedProps&&Ne===s.memoizedState||(o.flags|=1024),o.memoizedProps=g,o.memoizedState=ct),O.props=g,O.state=ct,O.context=re,g=me):(typeof O.componentDidUpdate!="function"||W===s.memoizedProps&&Ne===s.memoizedState||(o.flags|=4),typeof O.getSnapshotBeforeUpdate!="function"||W===s.memoizedProps&&Ne===s.memoizedState||(o.flags|=1024),g=!1)}return uc(s,o,h,g,N,b)}function uc(s,o,h,g,b,N){Ch(s,o);var O=(o.flags&128)!==0;if(!g&&!O)return b&&Nu(o,h,!1),xn(s,o,N);g=o.stateNode,sx.current=o;var W=O&&typeof h.getDerivedStateFromError!="function"?null:g.render();return o.flags|=1,s!==null&&O?(o.child=Gs(o,s.child,null,N),o.child=Gs(o,null,W,N)):tr(s,o,W,N),o.memoizedState=g.state,b&&Nu(o,h,!0),o.child}function Nh(s){var o=s.stateNode;o.pendingContext?Cu(s,o.pendingContext,o.pendingContext!==o.context):o.context&&Cu(s,o.context,!1),Xl(s,o.containerInfo)}function jh(s,o,h,g,b){return Bs(),Gl(b),o.flags|=256,tr(s,o,h,g),o.child}var hc={dehydrated:null,treeContext:null,retryLane:0};function fc(s){return{baseLanes:s,cachePool:null,transitions:null}}function Eh(s,o,h){var g=o.pendingProps,b=_t.current,N=!1,O=(o.flags&128)!==0,W;if((W=O)||(W=s!==null&&s.memoizedState===null?!1:(b&2)!==0),W?(N=!0,o.flags&=-129):(s===null||s.memoizedState!==null)&&(b|=1),ut(_t,b&1),s===null)return Bl(o),s=o.memoizedState,s!==null&&(s=s.dehydrated,s!==null)?(o.mode&1?kl(s)?o.lanes=8:o.lanes=1073741824:o.lanes=1,null):(O=g.children,s=g.fallback,N?(g=o.mode,N=o.child,O={mode:"hidden",children:O},!(g&1)&&N!==null?(N.childLanes=0,N.pendingProps=O):N=go(O,g,0,null),s=xs(s,g,h,null),N.return=o,s.return=o,N.sibling=s,o.child=N,o.child.memoizedState=fc(h),o.memoizedState=hc,s):pc(o,O));if(b=s.memoizedState,b!==null&&(W=b.dehydrated,W!==null))return ix(s,o,O,g,W,b,h);if(N){N=g.fallback,O=o.mode,b=s.child,W=b.sibling;var re={mode:"hidden",children:g.children};return!(O&1)&&o.child!==b?(g=o.child,g.childLanes=0,g.pendingProps=re,o.deletions=null):(g=zn(b,re),g.subtreeFlags=b.subtreeFlags&14680064),W!==null?N=zn(W,N):(N=xs(N,O,h,null),N.flags|=2),N.return=o,g.return=o,g.sibling=N,o.child=g,g=N,N=o.child,O=s.child.memoizedState,O=O===null?fc(h):{baseLanes:O.baseLanes|h,cachePool:null,transitions:O.transitions},N.memoizedState=O,N.childLanes=s.childLanes&~h,o.memoizedState=hc,g}return N=s.child,s=N.sibling,g=zn(N,{mode:"visible",children:g.children}),!(o.mode&1)&&(g.lanes=h),g.return=o,g.sibling=null,s!==null&&(h=o.deletions,h===null?(o.deletions=[s],o.flags|=16):h.push(s)),o.child=g,o.memoizedState=null,g}function pc(s,o){return o=go({mode:"visible",children:o},s.mode,0,null),o.return=s,s.child=o}function qa(s,o,h,g){return g!==null&&Gl(g),Gs(o,s.child,null,h),s=pc(o,o.pendingProps.children),s.flags|=2,o.memoizedState=null,s}function ix(s,o,h,g,b,N,O){if(h)return o.flags&256?(o.flags&=-257,g=lc(Error(c(422))),qa(s,o,O,g)):o.memoizedState!==null?(o.child=s.child,o.flags|=128,null):(N=g.fallback,b=o.mode,g=go({mode:"visible",children:g.children},b,0,null),N=xs(N,b,O,null),N.flags|=2,g.return=o,N.return=o,g.sibling=N,o.child=g,o.mode&1&&Gs(o,s.child,null,O),o.child.memoizedState=fc(O),o.memoizedState=hc,N);if(!(o.mode&1))return qa(s,o,O,null);if(kl(b))return g=y1(b).digest,N=Error(c(419)),g=lc(N,g,void 0),qa(s,o,O,g);if(h=(O&s.childLanes)!==0,ir||h){if(g=Gt,g!==null){switch(O&-O){case 4:b=2;break;case 16:b=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:b=32;break;case 536870912:b=268435456;break;default:b=0}b=b&(g.suspendedLanes|O)?0:b,b!==0&&b!==N.retryLane&&(N.retryLane=b,qr(s,b),Nr(g,s,b,-1))}return Oc(),g=lc(Error(c(421))),qa(s,o,O,g)}return Su(b)?(o.flags|=128,o.child=s.child,o=yx.bind(null,s),v1(b,o),null):(s=N.treeContext,Qe&&(_r=_1(b),ur=o,wt=!0,Ir=null,ki=!1,s!==null&&(wr[br++]=pn,wr[br++]=mn,wr[br++]=cs,pn=s.id,mn=s.overflow,cs=o)),o=pc(o,g.children),o.flags|=4096,o)}function Ph(s,o,h){s.lanes|=o;var g=s.alternate;g!==null&&(g.lanes|=o),Vl(s.return,o,h)}function mc(s,o,h,g,b){var N=s.memoizedState;N===null?s.memoizedState={isBackwards:o,rendering:null,renderingStartTime:0,last:g,tail:h,tailMode:b}:(N.isBackwards=o,N.rendering=null,N.renderingStartTime=0,N.last=g,N.tail=h,N.tailMode=b)}function Ah(s,o,h){var g=o.pendingProps,b=g.revealOrder,N=g.tail;if(tr(s,o,g.children,h),g=_t.current,g&2)g=g&1|2,o.flags|=128;else{if(s!==null&&s.flags&128)e:for(s=o.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&Ph(s,h,o);else if(s.tag===19)Ph(s,h,o);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===o)break e;for(;s.sibling===null;){if(s.return===null||s.return===o)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}g&=1}if(ut(_t,g),!(o.mode&1))o.memoizedState=null;else switch(b){case"forwards":for(h=o.child,b=null;h!==null;)s=h.alternate,s!==null&&Ha(s)===null&&(b=h),h=h.sibling;h=b,h===null?(b=o.child,o.child=null):(b=h.sibling,h.sibling=null),mc(o,!1,b,h,N);break;case"backwards":for(h=null,b=o.child,o.child=null;b!==null;){if(s=b.alternate,s!==null&&Ha(s)===null){o.child=b;break}s=b.sibling,b.sibling=h,h=b,b=s}mc(o,!0,h,null,N);break;case"together":mc(o,!1,null,null,void 0);break;default:o.memoizedState=null}return o.child}function Ka(s,o){!(o.mode&1)&&s!==null&&(s.alternate=null,o.alternate=null,o.flags|=2)}function xn(s,o,h){if(s!==null&&(o.dependencies=s.dependencies),fs|=o.lanes,!(h&o.childLanes))return null;if(s!==null&&o.child!==s.child)throw Error(c(153));if(o.child!==null){for(s=o.child,h=zn(s,s.pendingProps),o.child=h,h.return=o;s.sibling!==null;)s=s.sibling,h=h.sibling=zn(s,s.pendingProps),h.return=o;h.sibling=null}return o.child}function ax(s,o,h){switch(o.tag){case 3:Nh(o),Bs();break;case 5:Wu(o);break;case 1:sr(o.type)&&ja(o);break;case 4:Xl(o,o.stateNode.containerInfo);break;case 10:zu(o,o.type._context,o.memoizedProps.value);break;case 13:var g=o.memoizedState;if(g!==null)return g.dehydrated!==null?(ut(_t,_t.current&1),o.flags|=128,null):h&o.child.childLanes?Eh(s,o,h):(ut(_t,_t.current&1),s=xn(s,o,h),s!==null?s.sibling:null);ut(_t,_t.current&1);break;case 19:if(g=(h&o.childLanes)!==0,s.flags&128){if(g)return Ah(s,o,h);o.flags|=128}var b=o.memoizedState;if(b!==null&&(b.rendering=null,b.tail=null,b.lastEffect=null),ut(_t,_t.current),g)break;return null;case 22:case 23:return o.lanes=0,Sh(s,o,h)}return xn(s,o,h)}function Zr(s){s.flags|=4}function Th(s,o){if(s!==null&&s.child===o.child)return!0;if(o.flags&16)return!1;for(s=o.child;s!==null;){if(s.flags&12854||s.subtreeFlags&12854)return!1;s=s.sibling}return!0}var Di,Oi,Qa,Za;if(Ue)Di=function(s,o){for(var h=o.child;h!==null;){if(h.tag===5||h.tag===6)Y(s,h.stateNode);else if(h.tag!==4&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===o)break;for(;h.sibling===null;){if(h.return===null||h.return===o)return;h=h.return}h.sibling.return=h.return,h=h.sibling}},Oi=function(){},Qa=function(s,o,h,g,b){if(s=s.memoizedProps,s!==g){var N=o.stateNode,O=Kr(Cr.current);h=Ce(N,h,s,g,b,O),(o.updateQueue=h)&&Zr(o)}},Za=function(s,o,h,g){h!==g&&Zr(o)};else if(At){Di=function(s,o,h,g){for(var b=o.child;b!==null;){if(b.tag===5){var N=b.stateNode;h&&g&&(N=bu(N,b.type,b.memoizedProps,b)),Y(s,N)}else if(b.tag===6)N=b.stateNode,h&&g&&(N=_u(N,b.memoizedProps,b)),Y(s,N);else if(b.tag!==4){if(b.tag===22&&b.memoizedState!==null)N=b.child,N!==null&&(N.return=b),Di(s,b,!0,!0);else if(b.child!==null){b.child.return=b,b=b.child;continue}}if(b===o)break;for(;b.sibling===null;){if(b.return===null||b.return===o)return;b=b.return}b.sibling.return=b.return,b=b.sibling}};var Rh=function(s,o,h,g){for(var b=o.child;b!==null;){if(b.tag===5){var N=b.stateNode;h&&g&&(N=bu(N,b.type,b.memoizedProps,b)),wu(s,N)}else if(b.tag===6)N=b.stateNode,h&&g&&(N=_u(N,b.memoizedProps,b)),wu(s,N);else if(b.tag!==4){if(b.tag===22&&b.memoizedState!==null)N=b.child,N!==null&&(N.return=b),Rh(s,b,!0,!0);else if(b.child!==null){b.child.return=b,b=b.child;continue}}if(b===o)break;for(;b.sibling===null;){if(b.return===null||b.return===o)return;b=b.return}b.sibling.return=b.return,b=b.sibling}};Oi=function(s,o){var h=o.stateNode;if(!Th(s,o)){s=h.containerInfo;var g=vu(s);Rh(g,o,!1,!1),h.pendingChildren=g,Zr(o),p1(s,g)}},Qa=function(s,o,h,g,b){var N=s.stateNode,O=s.memoizedProps;if((s=Th(s,o))&&O===g)o.stateNode=N;else{var W=o.stateNode,re=Kr(Cr.current),me=null;O!==g&&(me=Ce(W,h,O,g,b,re)),s&&me===null?o.stateNode=N:(N=Nt(N,me,h,O,g,o,s,W),Se(N,h,g,b,re)&&Zr(o),o.stateNode=N,s?Zr(o):Di(N,o,!1,!1))}},Za=function(s,o,h,g){h!==g?(s=Kr(Ws.current),h=Kr(Cr.current),o.stateNode=at(g,s,h,o),Zr(o)):o.stateNode=s.stateNode}}else Oi=function(){},Qa=function(){},Za=function(){};function Ii(s,o){if(!wt)switch(s.tailMode){case"hidden":o=s.tail;for(var h=null;o!==null;)o.alternate!==null&&(h=o),o=o.sibling;h===null?s.tail=null:h.sibling=null;break;case"collapsed":h=s.tail;for(var g=null;h!==null;)h.alternate!==null&&(g=h),h=h.sibling;g===null?o||s.tail===null?s.tail=null:s.tail.sibling=null:g.sibling=null}}function Kt(s){var o=s.alternate!==null&&s.alternate.child===s.child,h=0,g=0;if(o)for(var b=s.child;b!==null;)h|=b.lanes|b.childLanes,g|=b.subtreeFlags&14680064,g|=b.flags&14680064,b.return=s,b=b.sibling;else for(b=s.child;b!==null;)h|=b.lanes|b.childLanes,g|=b.subtreeFlags,g|=b.flags,b.return=s,b=b.sibling;return s.subtreeFlags|=g,s.childLanes=h,o}function ox(s,o,h){var g=o.pendingProps;switch(Fl(o),o.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Kt(o),null;case 1:return sr(o.type)&&Na(),Kt(o),null;case 3:return h=o.stateNode,Vs(),xt(nr),xt(Xt),Ql(),h.pendingContext&&(h.context=h.pendingContext,h.pendingContext=null),(s===null||s.child===null)&&(Ia(o)?Zr(o):s===null||s.memoizedState.isDehydrated&&!(o.flags&256)||(o.flags|=1024,Ir!==null&&(Rc(Ir),Ir=null))),Oi(s,o),Kt(o),null;case 5:ql(o),h=Kr(Ws.current);var b=o.type;if(s!==null&&o.stateNode!=null)Qa(s,o,b,g,h),s.ref!==o.ref&&(o.flags|=512,o.flags|=2097152);else{if(!g){if(o.stateNode===null)throw Error(c(166));return Kt(o),null}if(s=Kr(Cr.current),Ia(o)){if(!Qe)throw Error(c(175));s=S1(o.stateNode,o.type,o.memoizedProps,h,s,o,!ki),o.updateQueue=s,s!==null&&Zr(o)}else{var N=V(b,g,h,s,o);Di(N,o,!1,!1),o.stateNode=N,Se(N,b,g,h,s)&&Zr(o)}o.ref!==null&&(o.flags|=512,o.flags|=2097152)}return Kt(o),null;case 6:if(s&&o.stateNode!=null)Za(s,o,s.memoizedProps,g);else{if(typeof g!="string"&&o.stateNode===null)throw Error(c(166));if(s=Kr(Ws.current),h=Kr(Cr.current),Ia(o)){if(!Qe)throw Error(c(176));if(s=o.stateNode,h=o.memoizedProps,(g=C1(s,h,o,!ki))&&(b=ur,b!==null))switch(b.tag){case 3:R1(b.stateNode.containerInfo,s,h,(b.mode&1)!==0);break;case 5:D1(b.type,b.memoizedProps,b.stateNode,s,h,(b.mode&1)!==0)}g&&Zr(o)}else o.stateNode=at(g,s,h,o)}return Kt(o),null;case 13:if(xt(_t),g=o.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(wt&&_r!==null&&o.mode&1&&!(o.flags&128))Iu(),Bs(),o.flags|=98560,b=!1;else if(b=Ia(o),g!==null&&g.dehydrated!==null){if(s===null){if(!b)throw Error(c(318));if(!Qe)throw Error(c(344));if(b=o.memoizedState,b=b!==null?b.dehydrated:null,!b)throw Error(c(317));k1(b,o)}else Bs(),!(o.flags&128)&&(o.memoizedState=null),o.flags|=4;Kt(o),b=!1}else Ir!==null&&(Rc(Ir),Ir=null),b=!0;if(!b)return o.flags&65536?o:null}return o.flags&128?(o.lanes=h,o):(h=g!==null,h!==(s!==null&&s.memoizedState!==null)&&h&&(o.child.flags|=8192,o.mode&1&&(s===null||_t.current&1?It===0&&(It=3):Oc())),o.updateQueue!==null&&(o.flags|=4),Kt(o),null);case 4:return Vs(),Oi(s,o),s===null&&oe(o.stateNode.containerInfo),Kt(o),null;case 10:return Wl(o.type._context),Kt(o),null;case 17:return sr(o.type)&&Na(),Kt(o),null;case 19:if(xt(_t),b=o.memoizedState,b===null)return Kt(o),null;if(g=(o.flags&128)!==0,N=b.rendering,N===null)if(g)Ii(b,!1);else{if(It!==0||s!==null&&s.flags&128)for(s=o.child;s!==null;){if(N=Ha(s),N!==null){for(o.flags|=128,Ii(b,!1),s=N.updateQueue,s!==null&&(o.updateQueue=s,o.flags|=4),o.subtreeFlags=0,s=h,h=o.child;h!==null;)g=h,b=s,g.flags&=14680066,N=g.alternate,N===null?(g.childLanes=0,g.lanes=b,g.child=null,g.subtreeFlags=0,g.memoizedProps=null,g.memoizedState=null,g.updateQueue=null,g.dependencies=null,g.stateNode=null):(g.childLanes=N.childLanes,g.lanes=N.lanes,g.child=N.child,g.subtreeFlags=0,g.deletions=null,g.memoizedProps=N.memoizedProps,g.memoizedState=N.memoizedState,g.updateQueue=N.updateQueue,g.type=N.type,b=N.dependencies,g.dependencies=b===null?null:{lanes:b.lanes,firstContext:b.firstContext}),h=h.sibling;return ut(_t,_t.current&1|2),o.child}s=s.sibling}b.tail!==null&&zt()>Ec&&(o.flags|=128,g=!0,Ii(b,!1),o.lanes=4194304)}else{if(!g)if(s=Ha(N),s!==null){if(o.flags|=128,g=!0,s=s.updateQueue,s!==null&&(o.updateQueue=s,o.flags|=4),Ii(b,!0),b.tail===null&&b.tailMode==="hidden"&&!N.alternate&&!wt)return Kt(o),null}else 2*zt()-b.renderingStartTime>Ec&&h!==1073741824&&(o.flags|=128,g=!0,Ii(b,!1),o.lanes=4194304);b.isBackwards?(N.sibling=o.child,o.child=N):(s=b.last,s!==null?s.sibling=N:o.child=N,b.last=N)}return b.tail!==null?(o=b.tail,b.rendering=o,b.tail=o.sibling,b.renderingStartTime=zt(),o.sibling=null,s=_t.current,ut(_t,g?s&1|2:s&1),o):(Kt(o),null);case 22:case 23:return Dc(),h=o.memoizedState!==null,s!==null&&s.memoizedState!==null!==h&&(o.flags|=8192),h&&o.mode&1?hr&1073741824&&(Kt(o),Ue&&o.subtreeFlags&6&&(o.flags|=8192)):Kt(o),null;case 24:return null;case 25:return null}throw Error(c(156,o.tag))}function lx(s,o){switch(Fl(o),o.tag){case 1:return sr(o.type)&&Na(),s=o.flags,s&65536?(o.flags=s&-65537|128,o):null;case 3:return Vs(),xt(nr),xt(Xt),Ql(),s=o.flags,s&65536&&!(s&128)?(o.flags=s&-65537|128,o):null;case 5:return ql(o),null;case 13:if(xt(_t),s=o.memoizedState,s!==null&&s.dehydrated!==null){if(o.alternate===null)throw Error(c(340));Bs()}return s=o.flags,s&65536?(o.flags=s&-65537|128,o):null;case 19:return xt(_t),null;case 4:return Vs(),null;case 10:return Wl(o.type._context),null;case 22:case 23:return Dc(),null;case 24:return null;default:return null}}var Ja=!1,Qt=!1,cx=typeof WeakSet=="function"?WeakSet:Set,Ae=null;function Ys(s,o){var h=s.ref;if(h!==null)if(typeof h=="function")try{h(null)}catch(g){bt(s,o,g)}else h.current=null}function gc(s,o,h){try{h()}catch(g){bt(s,o,g)}}var Dh=!1;function dx(s,o){for(ee(s.containerInfo),Ae=o;Ae!==null;)if(s=Ae,o=s.child,(s.subtreeFlags&1028)!==0&&o!==null)o.return=s,Ae=o;else for(;Ae!==null;){s=Ae;try{var h=s.alternate;if(s.flags&1024)switch(s.tag){case 0:case 11:case 15:break;case 1:if(h!==null){var g=h.memoizedProps,b=h.memoizedState,N=s.stateNode,O=N.getSnapshotBeforeUpdate(s.elementType===s.type?g:Mr(s.type,g),b);N.__reactInternalSnapshotBeforeUpdate=O}break;case 3:Ue&&Wt(s.stateNode.containerInfo);break;case 5:case 6:case 4:case 17:break;default:throw Error(c(163))}}catch(W){bt(s,s.return,W)}if(o=s.sibling,o!==null){o.return=s.return,Ae=o;break}Ae=s.return}return h=Dh,Dh=!1,h}function Mi(s,o,h){var g=o.updateQueue;if(g=g!==null?g.lastEffect:null,g!==null){var b=g=g.next;do{if((b.tag&s)===s){var N=b.destroy;b.destroy=void 0,N!==void 0&&gc(o,h,N)}b=b.next}while(b!==g)}}function eo(s,o){if(o=o.updateQueue,o=o!==null?o.lastEffect:null,o!==null){var h=o=o.next;do{if((h.tag&s)===s){var g=h.create;h.destroy=g()}h=h.next}while(h!==o)}}function xc(s){var o=s.ref;if(o!==null){var h=s.stateNode;switch(s.tag){case 5:s=Q(h);break;default:s=h}typeof o=="function"?o(s):o.current=s}}function Oh(s){var o=s.alternate;o!==null&&(s.alternate=null,Oh(o)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(o=s.stateNode,o!==null&&L(o)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}function Ih(s){return s.tag===5||s.tag===3||s.tag===4}function Mh(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||Ih(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function yc(s,o,h){var g=s.tag;if(g===5||g===6)s=s.stateNode,o?_e(h,s,o):Et(h,s);else if(g!==4&&(s=s.child,s!==null))for(yc(s,o,h),s=s.sibling;s!==null;)yc(s,o,h),s=s.sibling}function vc(s,o,h){var g=s.tag;if(g===5||g===6)s=s.stateNode,o?De(h,s,o):Ve(h,s);else if(g!==4&&(s=s.child,s!==null))for(vc(s,o,h),s=s.sibling;s!==null;)vc(s,o,h),s=s.sibling}var Vt=null,Lr=!1;function Jr(s,o,h){for(h=h.child;h!==null;)wc(s,o,h),h=h.sibling}function wc(s,o,h){if(Yr&&typeof Yr.onCommitFiberUnmount=="function")try{Yr.onCommitFiberUnmount(Ta,h)}catch{}switch(h.tag){case 5:Qt||Ys(h,o);case 6:if(Ue){var g=Vt,b=Lr;Vt=null,Jr(s,o,h),Vt=g,Lr=b,Vt!==null&&(Lr?Me(Vt,h.stateNode):Re(Vt,h.stateNode))}else Jr(s,o,h);break;case 18:Ue&&Vt!==null&&(Lr?A1(Vt,h.stateNode):P1(Vt,h.stateNode));break;case 4:Ue?(g=Vt,b=Lr,Vt=h.stateNode.containerInfo,Lr=!0,Jr(s,o,h),Vt=g,Lr=b):(At&&(g=h.stateNode.containerInfo,b=vu(g),Cl(g,b)),Jr(s,o,h));break;case 0:case 11:case 14:case 15:if(!Qt&&(g=h.updateQueue,g!==null&&(g=g.lastEffect,g!==null))){b=g=g.next;do{var N=b,O=N.destroy;N=N.tag,O!==void 0&&(N&2||N&4)&&gc(h,o,O),b=b.next}while(b!==g)}Jr(s,o,h);break;case 1:if(!Qt&&(Ys(h,o),g=h.stateNode,typeof g.componentWillUnmount=="function"))try{g.props=h.memoizedProps,g.state=h.memoizedState,g.componentWillUnmount()}catch(W){bt(h,o,W)}Jr(s,o,h);break;case 21:Jr(s,o,h);break;case 22:h.mode&1?(Qt=(g=Qt)||h.memoizedState!==null,Jr(s,o,h),Qt=g):Jr(s,o,h);break;default:Jr(s,o,h)}}function Lh(s){var o=s.updateQueue;if(o!==null){s.updateQueue=null;var h=s.stateNode;h===null&&(h=s.stateNode=new cx),o.forEach(function(g){var b=vx.bind(null,s,g);h.has(g)||(h.add(g),g.then(b,b))})}}function Fr(s,o){var h=o.deletions;if(h!==null)for(var g=0;g<h.length;g++){var b=h[g];try{var N=s,O=o;if(Ue){var W=O;e:for(;W!==null;){switch(W.tag){case 5:Vt=W.stateNode,Lr=!1;break e;case 3:Vt=W.stateNode.containerInfo,Lr=!0;break e;case 4:Vt=W.stateNode.containerInfo,Lr=!0;break e}W=W.return}if(Vt===null)throw Error(c(160));wc(N,O,b),Vt=null,Lr=!1}else wc(N,O,b);var re=b.alternate;re!==null&&(re.return=null),b.return=null}catch(me){bt(b,o,me)}}if(o.subtreeFlags&12854)for(o=o.child;o!==null;)Fh(o,s),o=o.sibling}function Fh(s,o){var h=s.alternate,g=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:if(Fr(o,s),en(s),g&4){try{Mi(3,s,s.return),eo(3,s)}catch(Ne){bt(s,s.return,Ne)}try{Mi(5,s,s.return)}catch(Ne){bt(s,s.return,Ne)}}break;case 1:Fr(o,s),en(s),g&512&&h!==null&&Ys(h,h.return);break;case 5:if(Fr(o,s),en(s),g&512&&h!==null&&Ys(h,h.return),Ue){if(s.flags&32){var b=s.stateNode;try{Xe(b)}catch(Ne){bt(s,s.return,Ne)}}if(g&4&&(b=s.stateNode,b!=null)){var N=s.memoizedProps;if(h=h!==null?h.memoizedProps:N,g=s.type,o=s.updateQueue,s.updateQueue=null,o!==null)try{hn(b,o,g,h,N,s)}catch(Ne){bt(s,s.return,Ne)}}}break;case 6:if(Fr(o,s),en(s),g&4&&Ue){if(s.stateNode===null)throw Error(c(162));b=s.stateNode,N=s.memoizedProps,h=h!==null?h.memoizedProps:N;try{vr(b,h,N)}catch(Ne){bt(s,s.return,Ne)}}break;case 3:if(Fr(o,s),en(s),g&4){if(Ue&&Qe&&h!==null&&h.memoizedState.isDehydrated)try{j1(o.containerInfo)}catch(Ne){bt(s,s.return,Ne)}if(At){b=o.containerInfo,N=o.pendingChildren;try{Cl(b,N)}catch(Ne){bt(s,s.return,Ne)}}}break;case 4:if(Fr(o,s),en(s),g&4&&At){N=s.stateNode,b=N.containerInfo,N=N.pendingChildren;try{Cl(b,N)}catch(Ne){bt(s,s.return,Ne)}}break;case 13:Fr(o,s),en(s),b=s.child,b.flags&8192&&(N=b.memoizedState!==null,b.stateNode.isHidden=N,!N||b.alternate!==null&&b.alternate.memoizedState!==null||(jc=zt())),g&4&&Lh(s);break;case 22:var O=h!==null&&h.memoizedState!==null;if(s.mode&1?(Qt=(h=Qt)||O,Fr(o,s),Qt=h):Fr(o,s),en(s),g&8192){if(h=s.memoizedState!==null,(s.stateNode.isHidden=h)&&!O&&s.mode&1)for(Ae=s,g=s.child;g!==null;){for(o=Ae=g;Ae!==null;){O=Ae;var W=O.child;switch(O.tag){case 0:case 11:case 14:case 15:Mi(4,O,O.return);break;case 1:Ys(O,O.return);var re=O.stateNode;if(typeof re.componentWillUnmount=="function"){var me=O,Te=O.return;try{var ze=me;re.props=ze.memoizedProps,re.state=ze.memoizedState,re.componentWillUnmount()}catch(Ne){bt(me,Te,Ne)}}break;case 5:Ys(O,O.return);break;case 22:if(O.memoizedState!==null){Gh(o);continue}}W!==null?(W.return=O,Ae=W):Gh(o)}g=g.sibling}if(Ue){e:if(g=null,Ue)for(o=s;;){if(o.tag===5){if(g===null){g=o;try{b=o.stateNode,h?Ft(b):Pe(o.stateNode,o.memoizedProps)}catch(Ne){bt(s,s.return,Ne)}}}else if(o.tag===6){if(g===null)try{N=o.stateNode,h?fe(N):Fe(N,o.memoizedProps)}catch(Ne){bt(s,s.return,Ne)}}else if((o.tag!==22&&o.tag!==23||o.memoizedState===null||o===s)&&o.child!==null){o.child.return=o,o=o.child;continue}if(o===s)break e;for(;o.sibling===null;){if(o.return===null||o.return===s)break e;g===o&&(g=null),o=o.return}g===o&&(g=null),o.sibling.return=o.return,o=o.sibling}}}break;case 19:Fr(o,s),en(s),g&4&&Lh(s);break;case 21:break;default:Fr(o,s),en(s)}}function en(s){var o=s.flags;if(o&2){try{if(Ue){e:{for(var h=s.return;h!==null;){if(Ih(h)){var g=h;break e}h=h.return}throw Error(c(160))}switch(g.tag){case 5:var b=g.stateNode;g.flags&32&&(Xe(b),g.flags&=-33);var N=Mh(s);vc(s,N,b);break;case 3:case 4:var O=g.stateNode.containerInfo,W=Mh(s);yc(s,W,O);break;default:throw Error(c(161))}}}catch(re){bt(s,s.return,re)}s.flags&=-3}o&4096&&(s.flags&=-4097)}function ux(s,o,h){Ae=s,zh(s)}function zh(s,o,h){for(var g=(s.mode&1)!==0;Ae!==null;){var b=Ae,N=b.child;if(b.tag===22&&g){var O=b.memoizedState!==null||Ja;if(!O){var W=b.alternate,re=W!==null&&W.memoizedState!==null||Qt;W=Ja;var me=Qt;if(Ja=O,(Qt=re)&&!me)for(Ae=b;Ae!==null;)O=Ae,re=O.child,O.tag===22&&O.memoizedState!==null?Hh(b):re!==null?(re.return=O,Ae=re):Hh(b);for(;N!==null;)Ae=N,zh(N),N=N.sibling;Ae=b,Ja=W,Qt=me}Bh(s)}else b.subtreeFlags&8772&&N!==null?(N.return=b,Ae=N):Bh(s)}}function Bh(s){for(;Ae!==null;){var o=Ae;if(o.flags&8772){var h=o.alternate;try{if(o.flags&8772)switch(o.tag){case 0:case 11:case 15:Qt||eo(5,o);break;case 1:var g=o.stateNode;if(o.flags&4&&!Qt)if(h===null)g.componentDidMount();else{var b=o.elementType===o.type?h.memoizedProps:Mr(o.type,h.memoizedProps);g.componentDidUpdate(b,h.memoizedState,g.__reactInternalSnapshotBeforeUpdate)}var N=o.updateQueue;N!==null&&Uu(o,N,g);break;case 3:var O=o.updateQueue;if(O!==null){if(h=null,o.child!==null)switch(o.child.tag){case 5:h=Q(o.child.stateNode);break;case 1:h=o.child.stateNode}Uu(o,O,h)}break;case 5:var W=o.stateNode;h===null&&o.flags&4&&Yt(W,o.type,o.memoizedProps,o);break;case 6:break;case 4:break;case 12:break;case 13:if(Qe&&o.memoizedState===null){var re=o.alternate;if(re!==null){var me=re.memoizedState;if(me!==null){var Te=me.dehydrated;Te!==null&&E1(Te)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(c(163))}Qt||o.flags&512&&xc(o)}catch(ze){bt(o,o.return,ze)}}if(o===s){Ae=null;break}if(h=o.sibling,h!==null){h.return=o.return,Ae=h;break}Ae=o.return}}function Gh(s){for(;Ae!==null;){var o=Ae;if(o===s){Ae=null;break}var h=o.sibling;if(h!==null){h.return=o.return,Ae=h;break}Ae=o.return}}function Hh(s){for(;Ae!==null;){var o=Ae;try{switch(o.tag){case 0:case 11:case 15:var h=o.return;try{eo(4,o)}catch(re){bt(o,h,re)}break;case 1:var g=o.stateNode;if(typeof g.componentDidMount=="function"){var b=o.return;try{g.componentDidMount()}catch(re){bt(o,b,re)}}var N=o.return;try{xc(o)}catch(re){bt(o,N,re)}break;case 5:var O=o.return;try{xc(o)}catch(re){bt(o,O,re)}}}catch(re){bt(o,o.return,re)}if(o===s){Ae=null;break}var W=o.sibling;if(W!==null){W.return=o.return,Ae=W;break}Ae=o.return}}var to=0,ro=1,no=2,so=3,io=4;if(typeof Symbol=="function"&&Symbol.for){var Li=Symbol.for;to=Li("selector.component"),ro=Li("selector.has_pseudo_class"),no=Li("selector.role"),so=Li("selector.test_id"),io=Li("selector.text")}function bc(s){var o=A(s);if(o!=null){if(typeof o.memoizedProps["data-testname"]!="string")throw Error(c(364));return o}if(s=ue(s),s===null)throw Error(c(362));return s.stateNode.current}function _c(s,o){switch(o.$$typeof){case to:if(s.type===o.value)return!0;break;case ro:e:{o=o.value,s=[s,0];for(var h=0;h<s.length;){var g=s[h++],b=s[h++],N=o[b];if(g.tag!==5||!ke(g)){for(;N!=null&&_c(g,N);)b++,N=o[b];if(b===o.length){o=!0;break e}else for(g=g.child;g!==null;)s.push(g,b),g=g.sibling}}o=!1}return o;case no:if(s.tag===5&&xe(s.stateNode,o.value))return!0;break;case io:if((s.tag===5||s.tag===6)&&(s=pe(s),s!==null&&0<=s.indexOf(o.value)))return!0;break;case so:if(s.tag===5&&(s=s.memoizedProps["data-testname"],typeof s=="string"&&s.toLowerCase()===o.value.toLowerCase()))return!0;break;default:throw Error(c(365))}return!1}function Sc(s){switch(s.$$typeof){case to:return"<"+(I(s.value)||"Unknown")+">";case ro:return":has("+(Sc(s)||"")+")";case no:return'[role="'+s.value+'"]';case io:return'"'+s.value+'"';case so:return'[data-testname="'+s.value+'"]';default:throw Error(c(365))}}function Uh(s,o){var h=[];s=[s,0];for(var g=0;g<s.length;){var b=s[g++],N=s[g++],O=o[N];if(b.tag!==5||!ke(b)){for(;O!=null&&_c(b,O);)N++,O=o[N];if(N===o.length)h.push(b);else for(b=b.child;b!==null;)s.push(b,N),b=b.sibling}}return h}function Cc(s,o){if(!le)throw Error(c(363));s=bc(s),s=Uh(s,o),o=[],s=Array.from(s);for(var h=0;h<s.length;){var g=s[h++];if(g.tag===5)ke(g)||o.push(g.stateNode);else for(g=g.child;g!==null;)s.push(g),g=g.sibling}return o}var hx=Math.ceil,ao=d.ReactCurrentDispatcher,kc=d.ReactCurrentOwner,Pt=d.ReactCurrentBatchConfig,$e=0,Gt=null,Tt=null,$t=0,hr=0,Xs=Tn(0),It=0,Fi=null,fs=0,oo=0,Nc=0,zi=null,ar=null,jc=0,Ec=1/0,yn=null;function qs(){Ec=zt()+500}var lo=!1,Pc=null,In=null,co=!1,Mn=null,uo=0,Bi=0,Ac=null,ho=-1,fo=0;function Zt(){return $e&6?zt():ho!==-1?ho:ho=zt()}function Ln(s){return s.mode&1?$e&2&&$t!==0?$t&-$t:X1.transition!==null?(fo===0&&(fo=ju()),fo):(s=Ze,s!==0?s:ne()):1}function Nr(s,o,h,g){if(50<Bi)throw Bi=0,Ac=null,Error(c(185));Ci(s,h,g),(!($e&2)||s!==Gt)&&(s===Gt&&(!($e&2)&&(oo|=h),It===4&&Fn(s,$t)),or(s,g),h===1&&$e===0&&!(o.mode&1)&&(qs(),Ra&&Xr()))}function or(s,o){var h=s.callbackNode;z1(s,o);var g=Aa(s,s===Gt?$t:0);if(g===0)h!==null&&Pu(h),s.callbackNode=null,s.callbackPriority=0;else if(o=g&-g,s.callbackPriority!==o){if(h!=null&&Pu(h),o===1)s.tag===0?Y1(Vh.bind(null,s)):Au(Vh.bind(null,s)),M?U(function(){!($e&6)&&Xr()}):Dl(Ol,Xr),h=null;else{switch(Eu(g)){case 1:h=Ol;break;case 4:h=U1;break;case 16:h=Il;break;case 536870912:h=W1;break;default:h=Il}h=ef(h,Wh.bind(null,s))}s.callbackPriority=o,s.callbackNode=h}}function Wh(s,o){if(ho=-1,fo=0,$e&6)throw Error(c(327));var h=s.callbackNode;if(gs()&&s.callbackNode!==h)return null;var g=Aa(s,s===Gt?$t:0);if(g===0)return null;if(g&30||g&s.expiredLanes||o)o=po(s,g);else{o=g;var b=$e;$e|=2;var N=Xh();(Gt!==s||$t!==o)&&(yn=null,qs(),ps(s,o));do try{mx();break}catch(W){Yh(s,W)}while(!0);Ul(),ao.current=N,$e=b,Tt!==null?o=0:(Gt=null,$t=0,o=It)}if(o!==0){if(o===2&&(b=Al(s),b!==0&&(g=b,o=Tc(s,b))),o===1)throw h=Fi,ps(s,0),Fn(s,g),or(s,zt()),h;if(o===6)Fn(s,g);else{if(b=s.current.alternate,!(g&30)&&!fx(b)&&(o=po(s,g),o===2&&(N=Al(s),N!==0&&(g=N,o=Tc(s,N))),o===1))throw h=Fi,ps(s,0),Fn(s,g),or(s,zt()),h;switch(s.finishedWork=b,s.finishedLanes=g,o){case 0:case 1:throw Error(c(345));case 2:ms(s,ar,yn);break;case 3:if(Fn(s,g),(g&130023424)===g&&(o=jc+500-zt(),10<o)){if(Aa(s,0)!==0)break;if(b=s.suspendedLanes,(b&g)!==g){Zt(),s.pingedLanes|=s.suspendedLanes&b;break}s.timeoutHandle=gt(ms.bind(null,s,ar,yn),o);break}ms(s,ar,yn);break;case 4:if(Fn(s,g),(g&4194240)===g)break;for(o=s.eventTimes,b=-1;0<g;){var O=31-Dr(g);N=1<<O,O=o[O],O>b&&(b=O),g&=~N}if(g=b,g=zt()-g,g=(120>g?120:480>g?480:1080>g?1080:1920>g?1920:3e3>g?3e3:4320>g?4320:1960*hx(g/1960))-g,10<g){s.timeoutHandle=gt(ms.bind(null,s,ar,yn),g);break}ms(s,ar,yn);break;case 5:ms(s,ar,yn);break;default:throw Error(c(329))}}}return or(s,zt()),s.callbackNode===h?Wh.bind(null,s):null}function Tc(s,o){var h=zi;return s.current.memoizedState.isDehydrated&&(ps(s,o).flags|=256),s=po(s,o),s!==2&&(o=ar,ar=h,o!==null&&Rc(o)),s}function Rc(s){ar===null?ar=s:ar.push.apply(ar,s)}function fx(s){for(var o=s;;){if(o.flags&16384){var h=o.updateQueue;if(h!==null&&(h=h.stores,h!==null))for(var g=0;g<h.length;g++){var b=h[g],N=b.getSnapshot;b=b.value;try{if(!Or(N(),b))return!1}catch{return!1}}}if(h=o.child,o.subtreeFlags&16384&&h!==null)h.return=o,o=h;else{if(o===s)break;for(;o.sibling===null;){if(o.return===null||o.return===s)return!0;o=o.return}o.sibling.return=o.return,o=o.sibling}}return!0}function Fn(s,o){for(o&=~Nc,o&=~oo,s.suspendedLanes|=o,s.pingedLanes&=~o,s=s.expirationTimes;0<o;){var h=31-Dr(o),g=1<<h;s[h]=-1,o&=~g}}function Vh(s){if($e&6)throw Error(c(327));gs();var o=Aa(s,0);if(!(o&1))return or(s,zt()),null;var h=po(s,o);if(s.tag!==0&&h===2){var g=Al(s);g!==0&&(o=g,h=Tc(s,g))}if(h===1)throw h=Fi,ps(s,0),Fn(s,o),or(s,zt()),h;if(h===6)throw Error(c(345));return s.finishedWork=s.current.alternate,s.finishedLanes=o,ms(s,ar,yn),or(s,zt()),null}function $h(s){Mn!==null&&Mn.tag===0&&!($e&6)&&gs();var o=$e;$e|=1;var h=Pt.transition,g=Ze;try{if(Pt.transition=null,Ze=1,s)return s()}finally{Ze=g,Pt.transition=h,$e=o,!($e&6)&&Xr()}}function Dc(){hr=Xs.current,xt(Xs)}function ps(s,o){s.finishedWork=null,s.finishedLanes=0;var h=s.timeoutHandle;if(h!==He&&(s.timeoutHandle=He,Ge(h)),Tt!==null)for(h=Tt.return;h!==null;){var g=h;switch(Fl(g),g.tag){case 1:g=g.type.childContextTypes,g!=null&&Na();break;case 3:Vs(),xt(nr),xt(Xt),Ql();break;case 5:ql(g);break;case 4:Vs();break;case 13:xt(_t);break;case 19:xt(_t);break;case 10:Wl(g.type._context);break;case 22:case 23:Dc()}h=h.return}if(Gt=s,Tt=s=zn(s.current,null),$t=hr=o,It=0,Fi=null,Nc=oo=fs=0,ar=zi=null,us!==null){for(o=0;o<us.length;o++)if(h=us[o],g=h.interleaved,g!==null){h.interleaved=null;var b=g.next,N=h.pending;if(N!==null){var O=N.next;N.next=b,g.next=O}h.pending=g}us=null}return s}function Yh(s,o){do{var h=Tt;try{if(Ul(),Ua.current=Ya,Wa){for(var g=St.memoizedState;g!==null;){var b=g.queue;b!==null&&(b.pending=null),g=g.next}Wa=!1}if(hs=0,Bt=Ot=St=null,Pi=!1,Ai=0,kc.current=null,h===null||h.return===null){It=1,Fi=o,Tt=null;break}e:{var N=s,O=h.return,W=h,re=o;if(o=$t,W.flags|=32768,re!==null&&typeof re=="object"&&typeof re.then=="function"){var me=re,Te=W,ze=Te.tag;if(!(Te.mode&1)&&(ze===0||ze===11||ze===15)){var Ne=Te.alternate;Ne?(Te.updateQueue=Ne.updateQueue,Te.memoizedState=Ne.memoizedState,Te.lanes=Ne.lanes):(Te.updateQueue=null,Te.memoizedState=null)}var yt=yh(O);if(yt!==null){yt.flags&=-257,vh(yt,O,W,N,o),yt.mode&1&&xh(N,me,o),o=yt,re=me;var ct=o.updateQueue;if(ct===null){var lr=new Set;lr.add(re),o.updateQueue=lr}else ct.add(re);break e}else{if(!(o&1)){xh(N,me,o),Oc();break e}re=Error(c(426))}}else if(wt&&W.mode&1){var vn=yh(O);if(vn!==null){!(vn.flags&65536)&&(vn.flags|=256),vh(vn,O,W,N,o),Gl($s(re,W));break e}}N=re=$s(re,W),It!==4&&(It=2),zi===null?zi=[N]:zi.push(N),N=O;do{switch(N.tag){case 3:N.flags|=65536,o&=-o,N.lanes|=o;var te=mh(N,re,o);Hu(N,te);break e;case 1:W=re;var q=N.type,ie=N.stateNode;if(!(N.flags&128)&&(typeof q.getDerivedStateFromError=="function"||ie!==null&&typeof ie.componentDidCatch=="function"&&(In===null||!In.has(ie)))){N.flags|=65536,o&=-o,N.lanes|=o;var je=gh(N,W,o);Hu(N,je);break e}}N=N.return}while(N!==null)}Kh(h)}catch(Ie){o=Ie,Tt===h&&h!==null&&(Tt=h=h.return);continue}break}while(!0)}function Xh(){var s=ao.current;return ao.current=Ya,s===null?Ya:s}function Oc(){(It===0||It===3||It===2)&&(It=4),Gt===null||!(fs&268435455)&&!(oo&268435455)||Fn(Gt,$t)}function po(s,o){var h=$e;$e|=2;var g=Xh();(Gt!==s||$t!==o)&&(yn=null,ps(s,o));do try{px();break}catch(b){Yh(s,b)}while(!0);if(Ul(),$e=h,ao.current=g,Tt!==null)throw Error(c(261));return Gt=null,$t=0,It}function px(){for(;Tt!==null;)qh(Tt)}function mx(){for(;Tt!==null&&!G1();)qh(Tt)}function qh(s){var o=Jh(s.alternate,s,hr);s.memoizedProps=s.pendingProps,o===null?Kh(s):Tt=o,kc.current=null}function Kh(s){var o=s;do{var h=o.alternate;if(s=o.return,o.flags&32768){if(h=lx(h,o),h!==null){h.flags&=32767,Tt=h;return}if(s!==null)s.flags|=32768,s.subtreeFlags=0,s.deletions=null;else{It=6,Tt=null;return}}else if(h=ox(h,o,hr),h!==null){Tt=h;return}if(o=o.sibling,o!==null){Tt=o;return}Tt=o=s}while(o!==null);It===0&&(It=5)}function ms(s,o,h){var g=Ze,b=Pt.transition;try{Pt.transition=null,Ze=1,gx(s,o,h,g)}finally{Pt.transition=b,Ze=g}return null}function gx(s,o,h,g){do gs();while(Mn!==null);if($e&6)throw Error(c(327));h=s.finishedWork;var b=s.finishedLanes;if(h===null)return null;if(s.finishedWork=null,s.finishedLanes=0,h===s.current)throw Error(c(177));s.callbackNode=null,s.callbackPriority=0;var N=h.lanes|h.childLanes;if(B1(s,N),s===Gt&&(Tt=Gt=null,$t=0),!(h.subtreeFlags&2064)&&!(h.flags&2064)||co||(co=!0,ef(Il,function(){return gs(),null})),N=(h.flags&15990)!==0,h.subtreeFlags&15990||N){N=Pt.transition,Pt.transition=null;var O=Ze;Ze=1;var W=$e;$e|=4,kc.current=null,dx(s,h),Fh(h,s),be(s.containerInfo),s.current=h,ux(h),H1(),$e=W,Ze=O,Pt.transition=N}else s.current=h;if(co&&(co=!1,Mn=s,uo=b),N=s.pendingLanes,N===0&&(In=null),V1(h.stateNode),or(s,zt()),o!==null)for(g=s.onRecoverableError,h=0;h<o.length;h++)b=o[h],g(b.value,{componentStack:b.stack,digest:b.digest});if(lo)throw lo=!1,s=Pc,Pc=null,s;return uo&1&&s.tag!==0&&gs(),N=s.pendingLanes,N&1?s===Ac?Bi++:(Bi=0,Ac=s):Bi=0,Xr(),null}function gs(){if(Mn!==null){var s=Eu(uo),o=Pt.transition,h=Ze;try{if(Pt.transition=null,Ze=16>s?16:s,Mn===null)var g=!1;else{if(s=Mn,Mn=null,uo=0,$e&6)throw Error(c(331));var b=$e;for($e|=4,Ae=s.current;Ae!==null;){var N=Ae,O=N.child;if(Ae.flags&16){var W=N.deletions;if(W!==null){for(var re=0;re<W.length;re++){var me=W[re];for(Ae=me;Ae!==null;){var Te=Ae;switch(Te.tag){case 0:case 11:case 15:Mi(8,Te,N)}var ze=Te.child;if(ze!==null)ze.return=Te,Ae=ze;else for(;Ae!==null;){Te=Ae;var Ne=Te.sibling,yt=Te.return;if(Oh(Te),Te===me){Ae=null;break}if(Ne!==null){Ne.return=yt,Ae=Ne;break}Ae=yt}}}var ct=N.alternate;if(ct!==null){var lr=ct.child;if(lr!==null){ct.child=null;do{var vn=lr.sibling;lr.sibling=null,lr=vn}while(lr!==null)}}Ae=N}}if(N.subtreeFlags&2064&&O!==null)O.return=N,Ae=O;else e:for(;Ae!==null;){if(N=Ae,N.flags&2048)switch(N.tag){case 0:case 11:case 15:Mi(9,N,N.return)}var te=N.sibling;if(te!==null){te.return=N.return,Ae=te;break e}Ae=N.return}}var q=s.current;for(Ae=q;Ae!==null;){O=Ae;var ie=O.child;if(O.subtreeFlags&2064&&ie!==null)ie.return=O,Ae=ie;else e:for(O=q;Ae!==null;){if(W=Ae,W.flags&2048)try{switch(W.tag){case 0:case 11:case 15:eo(9,W)}}catch(Ie){bt(W,W.return,Ie)}if(W===O){Ae=null;break e}var je=W.sibling;if(je!==null){je.return=W.return,Ae=je;break e}Ae=W.return}}if($e=b,Xr(),Yr&&typeof Yr.onPostCommitFiberRoot=="function")try{Yr.onPostCommitFiberRoot(Ta,s)}catch{}g=!0}return g}finally{Ze=h,Pt.transition=o}}return!1}function Qh(s,o,h){o=$s(h,o),o=mh(s,o,1),s=On(s,o,1),o=Zt(),s!==null&&(Ci(s,1,o),or(s,o))}function bt(s,o,h){if(s.tag===3)Qh(s,s,h);else for(;o!==null;){if(o.tag===3){Qh(o,s,h);break}else if(o.tag===1){var g=o.stateNode;if(typeof o.type.getDerivedStateFromError=="function"||typeof g.componentDidCatch=="function"&&(In===null||!In.has(g))){s=$s(h,s),s=gh(o,s,1),o=On(o,s,1),s=Zt(),o!==null&&(Ci(o,1,s),or(o,s));break}}o=o.return}}function xx(s,o,h){var g=s.pingCache;g!==null&&g.delete(o),o=Zt(),s.pingedLanes|=s.suspendedLanes&h,Gt===s&&($t&h)===h&&(It===4||It===3&&($t&130023424)===$t&&500>zt()-jc?ps(s,0):Nc|=h),or(s,o)}function Zh(s,o){o===0&&(s.mode&1?(o=Pa,Pa<<=1,!(Pa&130023424)&&(Pa=4194304)):o=1);var h=Zt();s=qr(s,o),s!==null&&(Ci(s,o,h),or(s,h))}function yx(s){var o=s.memoizedState,h=0;o!==null&&(h=o.retryLane),Zh(s,h)}function vx(s,o){var h=0;switch(s.tag){case 13:var g=s.stateNode,b=s.memoizedState;b!==null&&(h=b.retryLane);break;case 19:g=s.stateNode;break;default:throw Error(c(314))}g!==null&&g.delete(o),Zh(s,h)}var Jh;Jh=function(s,o,h){if(s!==null)if(s.memoizedProps!==o.pendingProps||nr.current)ir=!0;else{if(!(s.lanes&h)&&!(o.flags&128))return ir=!1,ax(s,o,h);ir=!!(s.flags&131072)}else ir=!1,wt&&o.flags&1048576&&Tu(o,Oa,o.index);switch(o.lanes=0,o.tag){case 2:var g=o.type;Ka(s,o),s=o.pendingProps;var b=Ls(o,Xt.current);Us(o,h),b=ec(null,o,g,s,b,h);var N=tc();return o.flags|=1,typeof b=="object"&&b!==null&&typeof b.render=="function"&&b.$$typeof===void 0?(o.tag=1,o.memoizedState=null,o.updateQueue=null,sr(g)?(N=!0,ja(o)):N=!1,o.memoizedState=b.state!==null&&b.state!==void 0?b.state:null,Yl(o),b.updater=Xa,o.stateNode=b,b._reactInternals=o,oc(o,g,s,h),o=uc(null,o,g,!0,N,h)):(o.tag=0,wt&&N&&Ll(o),tr(null,o,b,h),o=o.child),o;case 16:g=o.elementType;e:{switch(Ka(s,o),s=o.pendingProps,b=g._init,g=b(g._payload),o.type=g,b=o.tag=bx(g),s=Mr(g,s),b){case 0:o=dc(null,o,g,s,h);break e;case 1:o=kh(null,o,g,s,h);break e;case 11:o=wh(null,o,g,s,h);break e;case 14:o=bh(null,o,g,Mr(g.type,s),h);break e}throw Error(c(306,g,""))}return o;case 0:return g=o.type,b=o.pendingProps,b=o.elementType===g?b:Mr(g,b),dc(s,o,g,b,h);case 1:return g=o.type,b=o.pendingProps,b=o.elementType===g?b:Mr(g,b),kh(s,o,g,b,h);case 3:e:{if(Nh(o),s===null)throw Error(c(387));g=o.pendingProps,N=o.memoizedState,b=N.element,Gu(s,o),Ga(o,g,null,h);var O=o.memoizedState;if(g=O.element,Qe&&N.isDehydrated)if(N={element:g,isDehydrated:!1,cache:O.cache,pendingSuspenseBoundaries:O.pendingSuspenseBoundaries,transitions:O.transitions},o.updateQueue.baseState=N,o.memoizedState=N,o.flags&256){b=$s(Error(c(423)),o),o=jh(s,o,g,h,b);break e}else if(g!==b){b=$s(Error(c(424)),o),o=jh(s,o,g,h,b);break e}else for(Qe&&(_r=b1(o.stateNode.containerInfo),ur=o,wt=!0,Ir=null,ki=!1),h=Fu(o,null,g,h),o.child=h;h;)h.flags=h.flags&-3|4096,h=h.sibling;else{if(Bs(),g===b){o=xn(s,o,h);break e}tr(s,o,g,h)}o=o.child}return o;case 5:return Wu(o),s===null&&Bl(o),g=o.type,b=o.pendingProps,N=s!==null?s.memoizedProps:null,O=b.children,ye(g,b)?O=null:N!==null&&ye(g,N)&&(o.flags|=32),Ch(s,o),tr(s,o,O,h),o.child;case 6:return s===null&&Bl(o),null;case 13:return Eh(s,o,h);case 4:return Xl(o,o.stateNode.containerInfo),g=o.pendingProps,s===null?o.child=Gs(o,null,g,h):tr(s,o,g,h),o.child;case 11:return g=o.type,b=o.pendingProps,b=o.elementType===g?b:Mr(g,b),wh(s,o,g,b,h);case 7:return tr(s,o,o.pendingProps,h),o.child;case 8:return tr(s,o,o.pendingProps.children,h),o.child;case 12:return tr(s,o,o.pendingProps.children,h),o.child;case 10:e:{if(g=o.type._context,b=o.pendingProps,N=o.memoizedProps,O=b.value,zu(o,g,O),N!==null)if(Or(N.value,O)){if(N.children===b.children&&!nr.current){o=xn(s,o,h);break e}}else for(N=o.child,N!==null&&(N.return=o);N!==null;){var W=N.dependencies;if(W!==null){O=N.child;for(var re=W.firstContext;re!==null;){if(re.context===g){if(N.tag===1){re=gn(-1,h&-h),re.tag=2;var me=N.updateQueue;if(me!==null){me=me.shared;var Te=me.pending;Te===null?re.next=re:(re.next=Te.next,Te.next=re),me.pending=re}}N.lanes|=h,re=N.alternate,re!==null&&(re.lanes|=h),Vl(N.return,h,o),W.lanes|=h;break}re=re.next}}else if(N.tag===10)O=N.type===o.type?null:N.child;else if(N.tag===18){if(O=N.return,O===null)throw Error(c(341));O.lanes|=h,W=O.alternate,W!==null&&(W.lanes|=h),Vl(O,h,o),O=N.sibling}else O=N.child;if(O!==null)O.return=N;else for(O=N;O!==null;){if(O===o){O=null;break}if(N=O.sibling,N!==null){N.return=O.return,O=N;break}O=O.return}N=O}tr(s,o,b.children,h),o=o.child}return o;case 9:return b=o.type,g=o.pendingProps.children,Us(o,h),b=Sr(b),g=g(b),o.flags|=1,tr(s,o,g,h),o.child;case 14:return g=o.type,b=Mr(g,o.pendingProps),b=Mr(g.type,b),bh(s,o,g,b,h);case 15:return _h(s,o,o.type,o.pendingProps,h);case 17:return g=o.type,b=o.pendingProps,b=o.elementType===g?b:Mr(g,b),Ka(s,o),o.tag=1,sr(g)?(s=!0,ja(o)):s=!1,Us(o,h),fh(o,g,b),oc(o,g,b,h),uc(null,o,g,!0,s,h);case 19:return Ah(s,o,h);case 22:return Sh(s,o,h)}throw Error(c(156,o.tag))};function ef(s,o){return Dl(s,o)}function wx(s,o,h,g){this.tag=s,this.key=h,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=o,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=g,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function jr(s,o,h,g){return new wx(s,o,h,g)}function Ic(s){return s=s.prototype,!(!s||!s.isReactComponent)}function bx(s){if(typeof s=="function")return Ic(s)?1:0;if(s!=null){if(s=s.$$typeof,s===x)return 11;if(s===C)return 14}return 2}function zn(s,o){var h=s.alternate;return h===null?(h=jr(s.tag,o,s.key,s.mode),h.elementType=s.elementType,h.type=s.type,h.stateNode=s.stateNode,h.alternate=s,s.alternate=h):(h.pendingProps=o,h.type=s.type,h.flags=0,h.subtreeFlags=0,h.deletions=null),h.flags=s.flags&14680064,h.childLanes=s.childLanes,h.lanes=s.lanes,h.child=s.child,h.memoizedProps=s.memoizedProps,h.memoizedState=s.memoizedState,h.updateQueue=s.updateQueue,o=s.dependencies,h.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext},h.sibling=s.sibling,h.index=s.index,h.ref=s.ref,h}function mo(s,o,h,g,b,N){var O=2;if(g=s,typeof s=="function")Ic(s)&&(O=1);else if(typeof s=="string")O=5;else e:switch(s){case p:return xs(h.children,b,N,o);case m:O=8,b|=8;break;case y:return s=jr(12,h,o,b|2),s.elementType=y,s.lanes=N,s;case v:return s=jr(13,h,o,b),s.elementType=v,s.lanes=N,s;case S:return s=jr(19,h,o,b),s.elementType=S,s.lanes=N,s;case E:return go(h,b,N,o);default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case w:O=10;break e;case _:O=9;break e;case x:O=11;break e;case C:O=14;break e;case k:O=16,g=null;break e}throw Error(c(130,s==null?s:typeof s,""))}return o=jr(O,h,o,b),o.elementType=s,o.type=g,o.lanes=N,o}function xs(s,o,h,g){return s=jr(7,s,g,o),s.lanes=h,s}function go(s,o,h,g){return s=jr(22,s,g,o),s.elementType=E,s.lanes=h,s.stateNode={isHidden:!1},s}function Mc(s,o,h){return s=jr(6,s,null,o),s.lanes=h,s}function Lc(s,o,h){return o=jr(4,s.children!==null?s.children:[],s.key,o),o.lanes=h,o.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},o}function _x(s,o,h,g,b){this.tag=o,this.containerInfo=s,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=He,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Tl(0),this.expirationTimes=Tl(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Tl(0),this.identifierPrefix=g,this.onRecoverableError=b,Qe&&(this.mutableSourceEagerHydrationData=null)}function tf(s,o,h,g,b,N,O,W,re){return s=new _x(s,o,h,W,re),o===1?(o=1,N===!0&&(o|=8)):o=0,N=jr(3,null,null,o),s.current=N,N.stateNode=s,N.memoizedState={element:g,isDehydrated:h,cache:null,transitions:null,pendingSuspenseBoundaries:null},Yl(N),s}function rf(s){if(!s)return Rn;s=s._reactInternals;e:{if(z(s)!==s||s.tag!==1)throw Error(c(170));var o=s;do{switch(o.tag){case 3:o=o.stateNode.context;break e;case 1:if(sr(o.type)){o=o.stateNode.__reactInternalMemoizedMergedChildContext;break e}}o=o.return}while(o!==null);throw Error(c(171))}if(s.tag===1){var h=s.type;if(sr(h))return ku(s,h,o)}return o}function nf(s){var o=s._reactInternals;if(o===void 0)throw typeof s.render=="function"?Error(c(188)):(s=Object.keys(s).join(","),Error(c(268,s)));return s=R(o),s===null?null:s.stateNode}function sf(s,o){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var h=s.retryLane;s.retryLane=h!==0&&h<o?h:o}}function xo(s,o){sf(s,o),(s=s.alternate)&&sf(s,o)}function Sx(s){return s=R(s),s===null?null:s.stateNode}function Cx(){return null}return t.attemptContinuousHydration=function(s){if(s.tag===13){var o=qr(s,134217728);if(o!==null){var h=Zt();Nr(o,s,134217728,h)}xo(s,134217728)}},t.attemptDiscreteHydration=function(s){if(s.tag===13){var o=qr(s,1);if(o!==null){var h=Zt();Nr(o,s,1,h)}xo(s,1)}},t.attemptHydrationAtCurrentPriority=function(s){if(s.tag===13){var o=Ln(s),h=qr(s,o);if(h!==null){var g=Zt();Nr(h,s,o,g)}xo(s,o)}},t.attemptSynchronousHydration=function(s){switch(s.tag){case 3:var o=s.stateNode;if(o.current.memoizedState.isDehydrated){var h=Si(o.pendingLanes);h!==0&&(Rl(o,h|1),or(o,zt()),!($e&6)&&(qs(),Xr()))}break;case 13:$h(function(){var g=qr(s,1);if(g!==null){var b=Zt();Nr(g,s,1,b)}}),xo(s,1)}},t.batchedUpdates=function(s,o){var h=$e;$e|=1;try{return s(o)}finally{$e=h,$e===0&&(qs(),Ra&&Xr())}},t.createComponentSelector=function(s){return{$$typeof:to,value:s}},t.createContainer=function(s,o,h,g,b,N,O){return tf(s,o,!1,null,h,g,b,N,O)},t.createHasPseudoClassSelector=function(s){return{$$typeof:ro,value:s}},t.createHydrationContainer=function(s,o,h,g,b,N,O,W,re){return s=tf(h,g,!0,s,b,N,O,W,re),s.context=rf(null),h=s.current,g=Zt(),b=Ln(h),N=gn(g,b),N.callback=o??null,On(h,N,b),s.current.lanes=b,Ci(s,b,g),or(s,g),s},t.createPortal=function(s,o,h){var g=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:f,key:g==null?null:""+g,children:s,containerInfo:o,implementation:h}},t.createRoleSelector=function(s){return{$$typeof:no,value:s}},t.createTestNameSelector=function(s){return{$$typeof:so,value:s}},t.createTextSelector=function(s){return{$$typeof:io,value:s}},t.deferredUpdates=function(s){var o=Ze,h=Pt.transition;try{return Pt.transition=null,Ze=16,s()}finally{Ze=o,Pt.transition=h}},t.discreteUpdates=function(s,o,h,g,b){var N=Ze,O=Pt.transition;try{return Pt.transition=null,Ze=1,s(o,h,g,b)}finally{Ze=N,Pt.transition=O,$e===0&&qs()}},t.findAllNodes=Cc,t.findBoundingRects=function(s,o){if(!le)throw Error(c(363));o=Cc(s,o),s=[];for(var h=0;h<o.length;h++)s.push(Z(o[h]));for(o=s.length-1;0<o;o--){h=s[o];for(var g=h.x,b=g+h.width,N=h.y,O=N+h.height,W=o-1;0<=W;W--)if(o!==W){var re=s[W],me=re.x,Te=me+re.width,ze=re.y,Ne=ze+re.height;if(g>=me&&N>=ze&&b<=Te&&O<=Ne){s.splice(o,1);break}else if(g!==me||h.width!==re.width||Ne<N||ze>O){if(!(N!==ze||h.height!==re.height||Te<g||me>b)){me>g&&(re.width+=me-g,re.x=g),Te<b&&(re.width=b-me),s.splice(o,1);break}}else{ze>N&&(re.height+=ze-N,re.y=N),Ne<O&&(re.height=O-ze),s.splice(o,1);break}}}return s},t.findHostInstance=nf,t.findHostInstanceWithNoPortals=function(s){return s=se(s),s=s!==null?j(s):null,s===null?null:s.stateNode},t.findHostInstanceWithWarning=function(s){return nf(s)},t.flushControlled=function(s){var o=$e;$e|=1;var h=Pt.transition,g=Ze;try{Pt.transition=null,Ze=1,s()}finally{Ze=g,Pt.transition=h,$e=o,$e===0&&(qs(),Xr())}},t.flushPassiveEffects=gs,t.flushSync=$h,t.focusWithin=function(s,o){if(!le)throw Error(c(363));for(s=bc(s),o=Uh(s,o),o=Array.from(o),s=0;s<o.length;){var h=o[s++];if(!ke(h)){if(h.tag===5&&Oe(h.stateNode))return!0;for(h=h.child;h!==null;)o.push(h),h=h.sibling}}return!1},t.getCurrentUpdatePriority=function(){return Ze},t.getFindAllNodesFailureDescription=function(s,o){if(!le)throw Error(c(363));var h=0,g=[];s=[bc(s),0];for(var b=0;b<s.length;){var N=s[b++],O=s[b++],W=o[O];if((N.tag!==5||!ke(N))&&(_c(N,W)&&(g.push(Sc(W)),O++,O>h&&(h=O)),O<o.length))for(N=N.child;N!==null;)s.push(N,O),N=N.sibling}if(h<o.length){for(s=[];h<o.length;h++)s.push(Sc(o[h]));return`findAllNodes was able to match part of the selector:
  `+(g.join(" > ")+`

No matching component was found for:
  `)+s.join(" > ")}return null},t.getPublicRootInstance=function(s){if(s=s.current,!s.child)return null;switch(s.child.tag){case 5:return Q(s.child.stateNode);default:return s.child.stateNode}},t.injectIntoDevTools=function(s){if(s={bundleType:s.bundleType,version:s.version,rendererPackageName:s.rendererPackageName,rendererConfig:s.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:d.ReactCurrentDispatcher,findHostInstanceByFiber:Sx,findFiberByHostInstance:s.findFiberByHostInstance||Cx,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1"},typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")s=!1;else{var o=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(o.isDisabled||!o.supportsFiber)s=!0;else{try{Ta=o.inject(s),Yr=o}catch{}s=!!o.checkDCE}}return s},t.isAlreadyRendering=function(){return!1},t.observeVisibleRects=function(s,o,h,g){if(!le)throw Error(c(363));s=Cc(s,o);var b=tt(s,h,g).disconnect;return{disconnect:function(){b()}}},t.registerMutableSourceForHydration=function(s,o){var h=o._getVersion;h=h(o._source),s.mutableSourceEagerHydrationData==null?s.mutableSourceEagerHydrationData=[o,h]:s.mutableSourceEagerHydrationData.push(o,h)},t.runWithPriority=function(s,o){var h=Ze;try{return Ze=s,o()}finally{Ze=h}},t.shouldError=function(){return null},t.shouldSuspend=function(){return!1},t.updateContainer=function(s,o,h,g){var b=o.current,N=Zt(),O=Ln(b);return h=rf(h),o.context===null?o.context=h:o.pendingContext=h,o=gn(N,O),o.payload={element:s},g=g===void 0?null:g,g!==null&&(o.callback=g),s=On(b,o,O),s!==null&&(Nr(s,b,O,N),Ba(s,b,O)),O},t};a1.exports=_8;var S8=a1.exports;const C8=um(S8);var o1={exports:{}},Is={};/**
 * @license React
 * react-reconciler-constants.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */Is.ConcurrentRoot=1;Is.ContinuousEventPriority=4;Is.DefaultEventPriority=16;Is.DiscreteEventPriority=1;Is.IdleEventPriority=536870912;Is.LegacyRoot=0;o1.exports=Is;var l1=o1.exports;const wp={children:!0,ref:!0,key:!0,style:!0,forwardedRef:!0,unstable_applyCache:!0,unstable_applyDrawHitFromCache:!0};let bp=!1,_p=!1;const xu=".react-konva-event",k8=`ReactKonva: You have a Konva node with draggable = true and position defined but no onDragMove or onDragEnd events are handled.
Position of a node will be changed during drag&drop, so you should update state of the react app as well.
Consider to add onDragMove or onDragEnd events.
For more info see: https://github.com/konvajs/react-konva/issues/256
`,N8=`ReactKonva: You are using "zIndex" attribute for a Konva node.
react-konva may get confused with ordering. Just define correct order of elements in your render function of a component.
For more info see: https://github.com/konvajs/react-konva/issues/194
`,j8={};function Sl(r,e,t=j8){if(!bp&&"zIndex"in e&&(console.warn(N8),bp=!0),!_p&&e.draggable){var n=e.x!==void 0||e.y!==void 0,i=e.onDragEnd||e.onDragMove;n&&!i&&(console.warn(k8),_p=!0)}for(var l in t)if(!wp[l]){var c=l.slice(0,2)==="on",d=t[l]!==e[l];if(c&&d){var u=l.substr(2).toLowerCase();u.substr(0,7)==="content"&&(u="content"+u.substr(7,1).toUpperCase()+u.substr(8)),r.off(u,t[l])}var f=!e.hasOwnProperty(l);f&&r.setAttr(l,void 0)}var p=e._useStrictMode,m={},y=!1;const w={};for(var l in e)if(!wp[l]){var c=l.slice(0,2)==="on",_=t[l]!==e[l];if(c&&_){var u=l.substr(2).toLowerCase();u.substr(0,7)==="content"&&(u="content"+u.substr(7,1).toUpperCase()+u.substr(8)),e[l]&&(w[u]=e[l])}!c&&(e[l]!==t[l]||p&&e[l]!==r.getAttr(l))&&(y=!0,m[l]=e[l])}y&&(r.setAttrs(m),os(r));for(var u in w)r.on(u+xu,w[u])}function os(r){if(!we.autoDrawEnabled){var e=r.getLayer()||r.getStage();e&&e.batchDraw()}}const c1={},E8={};Ps.Node.prototype._applyProps=Sl;function P8(r,e){if(typeof e=="string"){console.error(`Do not use plain text as child of Konva.Node. You are using text: ${e}`);return}r.add(e),os(r)}function A8(r,e,t){let n=Ps[r];n||(console.error(`Konva has no node with the type ${r}. Group will be used instead. If you use minimal version of react-konva, just import required nodes into Konva: "import "konva/lib/shapes/${r}"  If you want to render DOM elements as part of canvas tree take a look into this demo: https://konvajs.github.io/docs/react/DOM_Portal.html`),n=Ps.Group);const i={},l={};for(var c in e){var d=c.slice(0,2)==="on";d?l[c]=e[c]:i[c]=e[c]}const u=new n(i);return Sl(u,l),u}function T8(r,e,t){console.error(`Text components are not supported for now in ReactKonva. Your text is: "${r}"`)}function R8(r,e,t){return!1}function D8(r){return r}function O8(){return null}function I8(){return null}function M8(r,e,t,n){return E8}function L8(){}function F8(r){}function z8(r,e){return!1}function B8(){return c1}function G8(){return c1}const H8=setTimeout,U8=clearTimeout,W8=-1;function V8(r,e){return!1}const $8=!1,Y8=!0,X8=!0;function q8(r,e){e.parent===r?e.moveToTop():r.add(e),os(r)}function K8(r,e){e.parent===r?e.moveToTop():r.add(e),os(r)}function d1(r,e,t){e._remove(),r.add(e),e.setZIndex(t.getZIndex()),os(r)}function Q8(r,e,t){d1(r,e,t)}function Z8(r,e){e.destroy(),e.off(xu),os(r)}function J8(r,e){e.destroy(),e.off(xu),os(r)}function e_(r,e,t){console.error(`Text components are not yet supported in ReactKonva. You text is: "${t}"`)}function t_(r,e,t){}function r_(r,e,t,n,i){Sl(r,i,n)}function n_(r){r.hide(),os(r)}function s_(r){}function i_(r,e){(e.visible==null||e.visible)&&r.show()}function a_(r,e){}function o_(r){}function l_(){}const c_=()=>l1.DefaultEventPriority,d_=Object.freeze(Object.defineProperty({__proto__:null,appendChild:q8,appendChildToContainer:K8,appendInitialChild:P8,cancelTimeout:U8,clearContainer:o_,commitMount:t_,commitTextUpdate:e_,commitUpdate:r_,createInstance:A8,createTextInstance:T8,detachDeletedInstance:l_,finalizeInitialChildren:R8,getChildHostContext:G8,getCurrentEventPriority:c_,getPublicInstance:D8,getRootHostContext:B8,hideInstance:n_,hideTextInstance:s_,idlePriority:Lo.unstable_IdlePriority,insertBefore:d1,insertInContainerBefore:Q8,isPrimaryRenderer:$8,noTimeout:W8,now:Lo.unstable_now,prepareForCommit:O8,preparePortalMount:I8,prepareUpdate:M8,removeChild:Z8,removeChildFromContainer:J8,resetAfterCommit:L8,resetTextContent:F8,run:Lo.unstable_runWithPriority,scheduleTimeout:H8,shouldDeprioritizeSubtree:z8,shouldSetTextContent:V8,supportsMutation:X8,unhideInstance:i_,unhideTextInstance:a_,warnsIfNotActing:Y8},Symbol.toStringTag,{value:"Module"}));var u_=Object.defineProperty,h_=Object.defineProperties,f_=Object.getOwnPropertyDescriptors,Sp=Object.getOwnPropertySymbols,p_=Object.prototype.hasOwnProperty,m_=Object.prototype.propertyIsEnumerable,Cp=(r,e,t)=>e in r?u_(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,kp=(r,e)=>{for(var t in e||(e={}))p_.call(e,t)&&Cp(r,t,e[t]);if(Sp)for(var t of Sp(e))m_.call(e,t)&&Cp(r,t,e[t]);return r},g_=(r,e)=>h_(r,f_(e)),Np,jp;typeof window<"u"&&((Np=window.document)!=null&&Np.createElement||((jp=window.navigator)==null?void 0:jp.product)==="ReactNative")?T.useLayoutEffect:T.useEffect;function u1(r,e,t){if(!r)return;if(t(r)===!0)return r;let n=r.child;for(;n;){const i=u1(n,e,t);if(i)return i;n=n.sibling}}function h1(r){try{return Object.defineProperties(r,{_currentRenderer:{get(){return null},set(){}},_currentRenderer2:{get(){return null},set(){}}})}catch{return r}}const Ep=console.error;console.error=function(){const r=[...arguments].join("");if(r!=null&&r.startsWith("Warning:")&&r.includes("useContext")){console.error=Ep;return}return Ep.apply(this,arguments)};const yu=h1(T.createContext(null));class f1 extends T.Component{render(){return T.createElement(yu.Provider,{value:this._reactInternals},this.props.children)}}function x_(){const r=T.useContext(yu);if(r===null)throw new Error("its-fine: useFiber must be called within a <FiberProvider />!");const e=T.useId();return T.useMemo(()=>{for(const n of[r,r==null?void 0:r.alternate]){if(!n)continue;const i=u1(n,!1,l=>{let c=l.memoizedState;for(;c;){if(c.memoizedState===e)return!0;c=c.next}});if(i)return i}},[r,e])}function y_(){const r=x_(),[e]=T.useState(()=>new Map);e.clear();let t=r;for(;t;){if(t.type&&typeof t.type=="object"){const i=t.type._context===void 0&&t.type.Provider===t.type?t.type:t.type._context;i&&i!==yu&&!e.has(i)&&e.set(i,T.useContext(h1(i)))}t=t.return}return e}function v_(){const r=y_();return T.useMemo(()=>Array.from(r.keys()).reduce((e,t)=>n=>T.createElement(e,null,T.createElement(t.Provider,g_(kp({},n),{value:r.get(t)}))),e=>T.createElement(f1,kp({},e))),[r])}function w_(r){const e=Ke.useRef({});return Ke.useLayoutEffect(()=>{e.current=r}),Ke.useLayoutEffect(()=>()=>{e.current={}},[]),e.current}const b_=r=>{const e=Ke.useRef(null),t=Ke.useRef(null),n=Ke.useRef(null),i=w_(r),l=v_(),c=d=>{const{forwardedRef:u}=r;u&&(typeof u=="function"?u(d):u.current=d)};return Ke.useLayoutEffect(()=>(t.current=new Ps.Stage({width:r.width,height:r.height,container:e.current}),c(t.current),n.current=ta.createContainer(t.current,l1.LegacyRoot,!1,null),ta.updateContainer(Ke.createElement(l,{},r.children),n.current),()=>{Ps.isBrowser&&(c(null),ta.updateContainer(null,n.current,null),t.current.destroy())}),[]),Ke.useLayoutEffect(()=>{c(t.current),Sl(t.current,r,i),ta.updateContainer(Ke.createElement(l,{},r.children),n.current,null)}),Ke.createElement("div",{ref:e,id:r.id,accessKey:r.accessKey,className:r.className,role:r.role,style:r.style,tabIndex:r.tabIndex,title:r.title})},__="Layer",Pp="Group",S_="Rect",Ap="Line",C_="Text",ta=C8(d_);ta.injectIntoDevTools({findHostInstanceByFiber:()=>null,bundleType:0,version:Ke.version,rendererPackageName:"react-konva"});const k_=Ke.forwardRef((r,e)=>Ke.createElement(f1,{},Ke.createElement(b_,{...r,forwardedRef:e}))),Rt=20,Js=48*Rt,ei=36*Rt,Xi={rails:[{id:"flat-rail",name:"Flat Rail",icon:"",defaultWidth:8,defaultLength:12,defaultHeight:2},{id:"round-rail",name:"Round Rail",icon:"",defaultWidth:8,defaultLength:12,defaultHeight:2},{id:"kinked-rail",name:"Kinked Rail",icon:"",defaultWidth:8,defaultLength:12,defaultHeight:2}],ledges:[{id:"flat-ledge",name:"Flat Ledge",icon:"",defaultWidth:12,defaultLength:16,defaultHeight:3},{id:"angled-ledge",name:"Angled Ledge",icon:"",defaultWidth:12,defaultLength:16,defaultHeight:3}],stairs:[{id:"stair-set",name:"Stair Set",icon:"",defaultWidth:12,defaultLength:12,defaultHeight:4},{id:"gap",name:"Gap",icon:"",defaultWidth:12,defaultLength:8,defaultHeight:2}],ramps:[{id:"quarter-pipe",name:"Quarter Pipe",icon:"",defaultWidth:12,defaultLength:8,defaultHeight:6},{id:"bank-ramp",name:"Bank Ramp",icon:"",defaultWidth:12,defaultLength:8,defaultHeight:4},{id:"launch-ramp",name:"Launch Ramp",icon:"",defaultWidth:10,defaultLength:6,defaultHeight:3}],boxes:[{id:"flat-box",name:"Flat Box",icon:"",defaultWidth:12,defaultLength:12,defaultHeight:3},{id:"pyramid",name:"Pyramid",icon:"",defaultWidth:12,defaultLength:12,defaultHeight:4},{id:"manual-pad",name:"Manual Pad",icon:"",defaultWidth:16,defaultLength:4,defaultHeight:2}]};function N_(){const[r,e]=T.useState([]),[t,n]=T.useState(null),[i,l]=T.useState(!0),[c,d]=T.useState("My Fingerpark Setup"),u=T.useRef(null),f=x=>{const v={id:`${x.id}-${Date.now()}`,type:x.id.includes("rail")?"rail":x.id.includes("ledge")?"ledge":x.id.includes("stair")||x.id.includes("gap")?"stairs":x.id.includes("ramp")||x.id.includes("quarter")||x.id.includes("bank")||x.id.includes("launch")?"ramp":"box",subtype:x.id,x:Js/2-x.defaultLength*Rt/2,y:ei/2-x.defaultWidth*Rt/2,width:x.defaultWidth*Rt,length:x.defaultLength*Rt,height:x.defaultHeight,rotation:0,color:"#8B4513"};e([...r,v]),n(v.id),ce.success(`Added ${x.name}`)},p=(x,v)=>{e(r.map(S=>S.id===x?{...S,...v}:S))},m=()=>{t&&(e(r.filter(x=>x.id!==t)),n(null),ce.success("Obstacle deleted"))},y=()=>{confirm("Clear all obstacles?")&&(e([]),n(null),ce.success("Canvas cleared"))},w=()=>{if(!u.current)return;const x=u.current.toDataURL({pixelRatio:2}),v=document.createElement("a");v.download=`${c.replace(/[^a-z0-9]/gi,"_")}_blueprint.png`,v.href=x,document.body.appendChild(v),v.click(),document.body.removeChild(v),ce.success("Blueprint exported!")},_=r.find(x=>x.id===t);return a.jsxs("div",{className:"min-h-screen bg-background flex flex-col",children:[a.jsx("div",{className:"border-b border-border bg-card px-4 py-3",children:a.jsxs("div",{className:"max-w-[1800px] mx-auto flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("h1",{className:"text-xl font-bold text-foreground",children:"Fingerpark Builder"}),a.jsx(pt,{value:c,onChange:x=>d(x.target.value),className:"w-64 h-8",placeholder:"Park name..."})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs(de,{variant:"outline",size:"sm",onClick:()=>l(!i),className:"gap-2",children:[a.jsx(Dd,{className:"w-4 h-4"}),i?"Hide":"Show"," Grid"]}),a.jsxs(de,{variant:"outline",size:"sm",onClick:y,className:"gap-2",children:[a.jsx(tm,{className:"w-4 h-4"}),"Clear"]}),a.jsxs(de,{variant:"outline",size:"sm",onClick:w,className:"gap-2",children:[a.jsx(Hr,{className:"w-4 h-4"}),"Export Blueprint"]})]})]})}),a.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[a.jsx("div",{className:"w-64 border-r border-border bg-card overflow-y-auto",children:a.jsxs("div",{className:"p-4 space-y-4",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-sm font-semibold text-foreground mb-2 uppercase tracking-wider",children:"Rails"}),a.jsx("div",{className:"space-y-1",children:Xi.rails.map(x=>a.jsxs("button",{onClick:()=>f(x),className:"w-full text-left px-3 py-2 rounded bg-secondary hover:bg-secondary/80 transition-colors flex items-center gap-2 text-sm",children:[a.jsx("span",{className:"text-lg",children:x.icon}),a.jsx("span",{children:x.name})]},x.id))})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-sm font-semibold text-foreground mb-2 uppercase tracking-wider",children:"Ledges"}),a.jsx("div",{className:"space-y-1",children:Xi.ledges.map(x=>a.jsxs("button",{onClick:()=>f(x),className:"w-full text-left px-3 py-2 rounded bg-secondary hover:bg-secondary/80 transition-colors flex items-center gap-2 text-sm",children:[a.jsx("span",{className:"text-lg",children:x.icon}),a.jsx("span",{children:x.name})]},x.id))})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-sm font-semibold text-foreground mb-2 uppercase tracking-wider",children:"Stairs"}),a.jsx("div",{className:"space-y-1",children:Xi.stairs.map(x=>a.jsxs("button",{onClick:()=>f(x),className:"w-full text-left px-3 py-2 rounded bg-secondary hover:bg-secondary/80 transition-colors flex items-center gap-2 text-sm",children:[a.jsx("span",{className:"text-lg",children:x.icon}),a.jsx("span",{children:x.name})]},x.id))})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-sm font-semibold text-foreground mb-2 uppercase tracking-wider",children:"Ramps"}),a.jsx("div",{className:"space-y-1",children:Xi.ramps.map(x=>a.jsxs("button",{onClick:()=>f(x),className:"w-full text-left px-3 py-2 rounded bg-secondary hover:bg-secondary/80 transition-colors flex items-center gap-2 text-sm",children:[a.jsx("span",{className:"text-lg",children:x.icon}),a.jsx("span",{children:x.name})]},x.id))})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-sm font-semibold text-foreground mb-2 uppercase tracking-wider",children:"Boxes"}),a.jsx("div",{className:"space-y-1",children:Xi.boxes.map(x=>a.jsxs("button",{onClick:()=>f(x),className:"w-full text-left px-3 py-2 rounded bg-secondary hover:bg-secondary/80 transition-colors flex items-center gap-2 text-sm",children:[a.jsx("span",{className:"text-lg",children:x.icon}),a.jsx("span",{children:x.name})]},x.id))})]})]})}),a.jsxs("div",{className:"flex-1 flex flex-col bg-muted/20 overflow-auto",children:[a.jsx("div",{className:"flex-1 flex items-center justify-center p-8",children:a.jsx("div",{className:"bg-white rounded-lg shadow-lg",style:{width:Js,height:ei},children:a.jsx(k_,{ref:u,width:Js,height:ei,onClick:x=>{x.target===x.target.getStage()&&n(null)},children:a.jsxs(__,{children:[i&&a.jsxs(Pp,{children:[Array.from({length:Math.ceil(Js/Rt)+1}).map((x,v)=>a.jsx(Ap,{points:[v*Rt,0,v*Rt,ei],stroke:"#e0e0e0",strokeWidth:v%5===0?1.5:.5},`v-${v}`)),Array.from({length:Math.ceil(ei/Rt)+1}).map((x,v)=>a.jsx(Ap,{points:[0,v*Rt,Js,v*Rt],stroke:"#e0e0e0",strokeWidth:v%5===0?1.5:.5},`h-${v}`))]}),r.map(x=>a.jsxs(Pp,{x:x.x,y:x.y,rotation:x.rotation,draggable:!0,onClick:()=>n(x.id),onDragEnd:v=>{p(x.id,{x:v.target.x(),y:v.target.y()})},children:[a.jsx(S_,{width:x.length,height:x.width,fill:x.color,stroke:t===x.id?"#3b82f6":"#666",strokeWidth:t===x.id?3:1,shadowColor:"black",shadowBlur:5,shadowOpacity:.3,shadowOffsetY:2}),a.jsx(C_,{text:`${(x.length/Rt).toFixed(1)}"  ${(x.width/Rt).toFixed(1)}"`,fontSize:10,fill:"white",align:"center",verticalAlign:"middle",width:x.length,height:x.width})]},x.id))]})})})}),a.jsx("div",{className:"border-t border-border bg-card px-4 py-2 text-sm text-muted-foreground",children:a.jsxs("div",{className:"max-w-[1800px] mx-auto flex items-center justify-between",children:[a.jsxs("div",{children:["Canvas: ",Js/Rt,'"  ',ei/Rt,'" | Grid: ',i?"On":"Off"]}),a.jsxs("div",{children:["Objects: ",r.length," | Selected: ",t?"Yes":"None"]})]})})]}),_&&a.jsx("div",{className:"w-64 border-l border-border bg-card p-4 overflow-y-auto",children:a.jsxs("div",{className:"space-y-4",children:[a.jsx("div",{children:a.jsx("h3",{className:"text-sm font-semibold text-foreground mb-3 uppercase tracking-wider",children:"Properties"})}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Ee,{className:"text-xs",children:"Length (inches)"}),a.jsx(pt,{type:"number",value:(_.length/Rt).toFixed(1),onChange:x=>p(t,{length:parseFloat(x.target.value)*Rt}),step:"0.5",className:"h-8"})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Ee,{className:"text-xs",children:"Width (inches)"}),a.jsx(pt,{type:"number",value:(_.width/Rt).toFixed(1),onChange:x=>p(t,{width:parseFloat(x.target.value)*Rt}),step:"0.5",className:"h-8"})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Ee,{className:"text-xs",children:"Height (inches)"}),a.jsx(pt,{type:"number",value:_.height,onChange:x=>p(t,{height:parseFloat(x.target.value)}),step:"0.5",className:"h-8"})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Ee,{className:"text-xs",children:"Rotation (degrees)"}),a.jsx(pt,{type:"number",value:_.rotation,onChange:x=>p(t,{rotation:parseFloat(x.target.value)}),step:"15",className:"h-8"})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Ee,{className:"text-xs",children:"Color"}),a.jsx("input",{type:"color",value:_.color,onChange:x=>p(t,{color:x.target.value}),className:"w-full h-8 border border-border rounded"})]}),a.jsxs(de,{onClick:m,variant:"destructive",className:"w-full gap-2",size:"sm",children:[a.jsx(jn,{className:"w-4 h-4"}),"Delete Obstacle"]})]})})]})]})}const j_=()=>{const r=Sy();return T.useEffect(()=>{console.error("404 Error: User attempted to access non-existent route:",r.pathname)},[r.pathname]),a.jsx("div",{className:"flex min-h-screen items-center justify-center bg-muted",children:a.jsxs("div",{className:"text-center",children:[a.jsx("h1",{className:"mb-4 text-4xl font-bold",children:"404"}),a.jsx("p",{className:"mb-4 text-xl text-muted-foreground",children:"Oops! Page not found"}),a.jsx("a",{href:"/",className:"text-primary underline hover:text-primary/90",children:"Return to Home"})]})})},E_=new w3,P_=()=>a.jsx(S3,{children:a.jsx(_3,{client:E_,children:a.jsxs(Y5,{children:[a.jsx(tv,{}),a.jsx(av,{}),a.jsx(Cy,{children:a.jsxs(ky,{children:[a.jsx(Er,{path:"/",element:a.jsx(Ow,{})}),a.jsx(Er,{path:"/auth",element:a.jsx(Iw,{})}),a.jsx(Er,{path:"/designs",element:a.jsx(Gw,{})}),a.jsx(Er,{path:"/templates",element:a.jsx(Uw,{})}),a.jsx(Er,{path:"/gallery",element:a.jsx(Vw,{})}),a.jsx(Er,{path:"/marketplace",element:a.jsx(Yw,{})}),a.jsx(Er,{path:"/marketplace/design/:id",element:a.jsx(qw,{})}),a.jsx(Er,{path:"/marketplace/upload",element:a.jsx(Kw,{})}),a.jsx(Er,{path:"/marketplace/dashboard",element:a.jsx(Qw,{})}),a.jsx(Er,{path:"/fingerpark",element:a.jsx(N_,{})}),a.jsx(Er,{path:"/share/:token",element:a.jsx($w,{})}),a.jsx(Er,{path:"*",element:a.jsx(j_,{})})]})})]})})});pm(document.getElementById("root")).render(a.jsx(P_,{}));export{f1 as F,st as S,v_ as u};
